(function(){var C=window.jQuery,v,aw,K="mathquill-command-id",l="mathquill-block-id",ar=Math.min,D=Math.max;var S=[].slice;function am(){}function f(L){var P=S.call(arguments,1);return function(){return L.apply(this,P)}}function aj(P,L){if(!L){throw new Error("prayer failed: "+P)}}var j=(function(R,ax,aB){function L(P){return typeof P==="object"}function aA(P){return typeof P==="function"}function az(){}return function ay(aG,aC){if(aC===aB){aC=aG;aG=Object}function aH(){var aI=new P;if(aA(aI.init)){aI.init.apply(aI,arguments)}return aI}function P(){}aH.Bare=P;var aF=az[R]=aG[R];var aE=P[R]=aH[R]=aH.p=new az;var aD;aE.constructor=aH;aH.mixin=function(aI){P[R]=aH[R]=ay(aH,aI)[R];return aH};return(aH.open=function(aJ){aD={};if(aA(aJ)){aD=aJ.call(aH,aE,aF,aH,aG)}else{if(L(aJ)){aD=aJ}}if(L(aD)){for(var aI in aD){if(ax.call(aD,aI)){aE[aI]=aD[aI]}}}if(!aA(aE.init)){aE.init=aG}return aH})(aC)}})("prototype",({}).hasOwnProperty);var n=(function(){var L={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};function R(ay){var aB=ay.which||ay.keyCode;var ax=L[aB];var aA;var az=[];if(ay.ctrlKey){az.push("Ctrl")}if(ay.originalEvent&&ay.originalEvent.metaKey){az.push("Meta")}if(ay.altKey){az.push("Alt")}if(ay.shiftKey){az.push("Shift")}aA=ax||String.fromCharCode(aB);if(!az.length&&!ax){return aA}az.push(aA);return az.join("-")}return function P(ay,aJ){var aL=null;var aE=null;if(!aJ){aJ={}}var aH=aJ.text||am;var aD=aJ.key||am;var aR=aJ.paste||am;var aB=aJ.cut||am;var aK=C(ay);var aT=C(aJ.container||aK);var aG=am,aC;function aQ(aU){aG=aU;clearTimeout(aC);aC=setTimeout(aU)}aT.bind("keydown keypress input keyup focusout paste",function(){aG()});function aM(aU){aG();aG=am;clearTimeout(aC);aK.val(aU);if(aU){aK[0].select()}}function aP(){var aU=aK[0];if(!("selectionStart" in aU)){return false}return aU.selectionStart!==aU.selectionEnd}function az(aV){var aU=aK.val();aK.val("");if(aU){aV(aU)}}function aI(){aD(R(aL),aL)}function aS(aU){aL=aU;aE=null;aI()}function aA(aU){if(aL&&aE){aI()}aE=aU;aQ(aO)}function aO(){if(aP()){return}az(aH)}function aF(){aL=aE=null}function ax(aU){aK.focus();aQ(aN)}function aN(){az(aR)}aT.bind({keydown:aS,keypress:aA,focusout:aF,cut:aB,paste:ax});return{select:aM}}}());var d=j(function(aI,aK,ay){function az(aM,aL){if(aM){aM="'"+aM+"'"}else{aM="EOF"}throw"Parse Error: "+aL+" at "+aM}aI.init=function(aL){this._=aL};aI.parse=function(aM){return this.skip(aJ)._(aM,aL,az);function aL(aO,aN){return aN}};aI.or=function(aM){aj("or is passed a parser",aM instanceof ay);var aL=this;return ay(function(aQ,aP,aO){return aL._(aQ,aP,aN);function aN(aR){return aM._(aQ,aP,aO)}})};aI.then=function(aM){var aL=this;return ay(function(aQ,aP,aN){return aL._(aQ,aO,aN);function aO(aT,aR){var aS=(aM instanceof ay?aM:aM(aR));aj("a parser is returned",aS instanceof ay);return aS._(aT,aP,aN)}})};aI.many=function(){var aL=this;return ay(function(aR,aQ,aO){var aN=[];while(aL._(aR,aP,aM)){}return aQ(aR,aN);function aP(aT,aS){aR=aT;aN.push(aS);return true}function aM(){return false}})};aI.times=function(aN,aL){if(arguments.length<2){aL=aN}var aM=this;return ay(function(aV,aU,aO){var aQ=[];var aX=true;var aP;for(var aS=0;aS<aN;aS+=1){aX=aM._(aV,aW,aR);if(!aX){return aO(aV,aP)}}for(;aS<aL&&aX;aS+=1){aX=aM._(aV,aW,aT)}return aU(aV,aQ);function aW(aZ,aY){aQ.push(aY);aV=aZ;return true}function aR(aZ,aY){aP=aY;aV=aZ;return false}function aT(aZ,aY){return false}})};aI.result=function(aL){return this.then(aA(aL))};aI.atMost=function(aL){return this.times(0,aL)};aI.atLeast=function(aM){var aL=this;return aL.times(aM).then(function(aN){return aL.many().map(function(aO){return aN.concat(aO)})})};aI.map=function(aL){return this.then(function(aM){return aA(aL(aM))})};aI.skip=function(aL){return this.then(function(aM){return aL.result(aM)})};var aB=this.string=function(aN){var aL=aN.length;var aM="expected '"+aN+"'";return ay(function(aR,aQ,aP){var aO=aR.slice(0,aL);if(aO===aN){return aQ(aR.slice(aL),aO)}else{return aP(aR,aM)}})};var aG=this.regex=function(aL){aj("regexp parser is anchored",aL.toString().charAt(1)==="^");var aM="expected "+aL;return ay(function(aR,aQ,aP){var aO=aL.exec(aR);if(aO){var aN=aO[0];return aQ(aR.slice(aN.length),aN)}else{return aP(aR,aM)}})};var aA=ay.succeed=function(aL){return ay(function(aN,aM){return aM(aN,aL)})};var ax=ay.fail=function(aL){return ay(function(aO,aM,aN){return aN(aO,aL)})};var R=ay.letter=aG(/^[a-z]/i);var aD=ay.letters=aG(/^[a-z]*/i);var aF=ay.digit=aG(/^[0-9]/);var P=ay.digits=aG(/^[0-9]*/);var L=ay.whitespace=aG(/^\s+/);var aE=ay.optWhitespace=aG(/^\s*/);var aC=ay.any=ay(function(aN,aM,aL){if(!aN){return aL(aN,"expected any character")}return aM(aN.slice(1),aN.charAt(0))});var aH=ay.all=ay(function(aN,aM,aL){return aM("",aN)});var aJ=ay.eof=ay(function(aN,aM,aL){if(aN){return aL(aN,"expected EOF")}return aM(aN,aN)})});var p=-1;var h=1;function av(L){aj("a direction was passed",L===p||L===h)}var W=j(C,function(L){L.insDirOf=function(P,R){return P===p?this.insertBefore(R.first()):this.insertAfter(R.last())};L.insAtDirEnd=function(P,R){return P===p?this.prependTo(R):this.appendTo(R)}});var A=j(function(L){L.parent=0;L[p]=0;L[h]=0;L.init=function(R,P,ax){this.parent=R;this[p]=P;this[h]=ax}});var E=j(function(L){L[p]=0;L[h]=0;L.parent=0;L.init=function(){this.ends={};this.ends[p]=0;this.ends[h]=0};L.children=function(){return M(this.ends[p],this.ends[h])};L.eachChild=function(P){return this.children().each(P)};L.foldChildren=function(P,R){return this.children().fold(P,R)};L.adopt=function(R,P,ax){M(this,this).adopt(R,P,ax);return this};L.disown=function(){M(this,this).disown();return this}});var M=j(function(L){L.init=function(R,ax){aj("no half-empty fragments",!R===!ax);this.ends={};if(!R){return}aj("left end node is passed to Fragment",R instanceof E);aj("right end node is passed to Fragment",ax instanceof E);aj("leftEnd and rightEnd have the same parent",R.parent===ax.parent);this.ends[p]=R;this.ends[h]=ax};function P(ax,R,ay){aj("a parent is always present",ax);aj("leftward is properly set up",(function(){if(!R){return ax.ends[p]===ay}return R[h]===ay&&R.parent===ax})());aj("rightward is properly set up",(function(){if(!ay){return ax.ends[h]===R}return ay[p]===R&&ay.parent===ax})())}L.adopt=function(ay,ax,aA){P(ay,ax,aA);var R=this;R.disowned=false;var az=R.ends[p];if(!az){return this}var aB=R.ends[h];if(ax){}else{ay.ends[p]=az}if(aA){aA[p]=aB}else{ay.ends[h]=aB}R.ends[h][h]=aA;R.each(function(aC){aC[p]=ax;aC.parent=ay;if(ax){ax[h]=aC}ax=aC});return R};L.disown=function(){var R=this;var ay=R.ends[p];if(!ay||R.disowned){return R}R.disowned=true;var az=R.ends[h];var ax=ay.parent;P(ax,ay[p],ay);P(ax,az,az[h]);if(ay[p]){ay[p][h]=az[h]}else{ax.ends[p]=az[h]}if(az[h]){az[h][p]=ay[p]}else{ax.ends[h]=ay[p]}return R};L.each=function(ay){var R=this;var ax=R.ends[p];if(!ax){return R}for(;ax!==R.ends[h][h];ax=ax[h]){if(ay.call(R,ax)===false){break}}return R};L.fold=function(R,ax){this.each(function(ay){R=ax.call(this,R,ay)});return R}});var k=(function(){var L=0;return function(){return L+=1}})();var I=j(E,function(L,P){L.init=function(R){P.init.call(this);this.id=k();I[this.id]=this};L.toString=function(){return"[MathElement "+this.id+"]"};L.bubble=function(az){var R=S.call(arguments,1);for(var ay=this;ay;ay=ay.parent){var ax=ay[az]&&ay[az].apply(ay,R);if(ax===false){break}}return this};L.postOrder=function(ay){var ax=S.call(arguments,1);if(typeof ay==="string"){var R=ay;ay=function(aA){if(R in aA){aA[R].apply(aA,ax)}}}(function az(aA){aA.eachChild(az);ay(aA)})(this)};L.jQ=W();L.jQadd=function(R){this.jQ=this.jQ.add(R)};this.jQize=function(R){var ax=W(R);ax.find("*").andSelf().each(function(){var aA=W(this),ay=aA.attr("mathquill-command-id"),az=aA.attr("mathquill-block-id");if(ay){I[ay].jQadd(aA)}if(az){I[az].jQadd(aA)}});return ax};L.finalizeInsert=function(){var R=this;R.postOrder("finalizeTree");R.postOrder("blur");R.postOrder("respace");if(R[h].respace){R[h].respace()}if(R[p].respace){R[p].respace()}R.postOrder("redraw");R.bubble("redraw")}});var G=j(I,function(L,P){L.init=function(ay,az,R){var ax=this;P.init.call(ax);if(!ax.ctrlSeq){ax.ctrlSeq=ay}if(az){ax.htmlTemplate=az}if(R){ax.textTemplate=R}};L.replaces=function(R){R.disown();this.replacedFragment=R};L.isEmpty=function(){return this.foldChildren(true,function(R,ax){return R&&ax.isEmpty()})};L.parser=function(){var ax=Z.block;var R=this;return ax.times(R.numBlocks()).map(function(az){R.blocks=az;for(var ay=0;ay<az.length;ay+=1){az[ay].adopt(R,R.ends[h],0)}return R})};L.createLeftOf=function(ay){var R=this;var ax=R.replacedFragment;R.createBlocks();I.jQize(R.html());if(ax){ax.adopt(R.ends[p],0,0);ax.jQ.appendTo(R.ends[p].jQ)}ay.jQ.before(R.jQ);ay[p]=R.adopt(ay.parent,ay[p],ay[h]);R.finalizeInsert(ay);R.placeCursor(ay)};L.createBlocks=function(){var ax=this,az=ax.numBlocks(),ay=ax.blocks=Array(az);for(var R=0;R<az;R+=1){var aA=ay[R]=y();aA.adopt(ax,ax.ends[h],0)}};L.respace=am;L.placeCursor=function(R){R.insAtRightEnd(this.foldChildren(this.ends[p],function(ax,ay){return ax.isEmpty()?ax:ay}))};L.remove=function(){this.disown();this.jQ.remove();this.postOrder(function(R){delete I[R.id]});return this};L.numBlocks=function(){var R=this.htmlTemplate.match(/&\d+/g);return R?R.length:0};L.html=function(){var aA=this;var aC=aA.blocks;var R=" mathquill-command-id="+aA.id;var aB=aA.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);aj("no unmatched angle brackets",aB.join("")===this.htmlTemplate);for(var ay=0,ax=aB[0];ax;ay+=1,ax=aB[ay]){if(ax.slice(-2)==="/>"){aB[ay]=ax.slice(0,-2)+R+"/>"}else{if(ax.charAt(0)==="<"){aj("not an unmatched top-level close tag",ax.charAt(1)!=="/");aB[ay]=ax.slice(0,-1)+R+">";var az=1;do{ay+=1,ax=aB[ay];aj("no missing close tags",ax);if(ax.slice(0,2)==="</"){az-=1}else{if(ax.charAt(0)==="<"&&ax.slice(-2)!=="/>"){az+=1}}}while(az>0)}}}return aB.join("").replace(/>&(\d+)/g,function(aE,aD){return" mathquill-block-id="+aC[aD].id+">"+aC[aD].join("html")})};L.latex=function(){return this.foldChildren(this.ctrlSeq,function(R,ax){return R+"{"+(ax.latex()||" ")+"}"})};L.textTemplate=[""];L.text=function(){var ax=this,R=0;return ax.foldChildren(ax.textTemplate[R],function(az,aA){R+=1;var ay=aA.text();if(az&&ax.textTemplate[R]==="("&&ay[0]==="("&&ay.slice(-1)===")"){return az+ay.slice(1,-1)+ax.textTemplate[R]}return az+aA.text()+(ax.textTemplate[R]||"")})}});var ad=j(G,function(L,P){L.init=function(ax,R,ay){if(!ay){ay=ax&&ax.length>1?ax.slice(1):ax}P.init.call(this,ax,R,[ay])};L.parser=function(){return d.succeed(this)};L.numBlocks=function(){return 0};L.replaces=function(R){R.remove()};L.createBlocks=am;L.latex=function(){return this.ctrlSeq};L.text=function(){return this.textTemplate};L.placeCursor=am;L.isEmpty=function(){return true}});var y=j(I,function(L){L.join=function(P){return this.foldChildren("",function(R,ax){return R+ax[P]()})};L.latex=function(){return this.join("latex")};L.text=function(){return this.ends[p]===this.ends[h]?this.ends[p].text():"("+this.join("text")+")"};L.isEmpty=function(){return this.ends[p]===0&&this.ends[h]===0};L.write=function(ay,P,ax){var R;if(P.match(/^[a-eg-zA-Z]$/)){R=u(P)}else{if(R=B[P]||Q[P]){R=R(P)}else{R=ah(P)}}if(ax){R.replaces(ax)}R.createLeftOf(ay)};L.focus=function(){this.jQ.addClass("hasCursor");this.jQ.removeClass("empty");return this};L.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){this.jQ.addClass("empty")}return this}});var af=j(M,function(L,P){L.init=function(R,ax){P.init.call(this,R,ax||R);this.jQ=this.fold(W(),function(ay,az){return az.jQ.add(ay)})};L.latex=function(){return this.fold("",function(ax,R){return ax+R.latex()})};L.remove=function(){this.jQ.remove();this.each(function(R){R.postOrder(function(ax){delete I[ax.id]})});return this.disown()}});function al(aA,aD,aC,R){var ax=aA.contents().detach();if(!aC){aA.addClass("mathquill-rendered-math")}aD.jQ=aA.attr(l,aD.id);aD.revert=function(){aA.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(ax)};var aG=aD.cursor=O(aD);aD.renderLatex(ax.text());var aH=aD.textarea=W('<span class="textarea"><textarea></textarea></span>'),aF=aH.children();var az;aD.selectionChanged=function(){if(az===v){az=setTimeout(L)}m(aA[0])};function L(){az=v;var aI=aG.selection?"$"+aG.selection.latex()+"$":"";aB.select(aI)}aA.bind("selectstart.mathquill",function(aI){if(aI.target!==aF[0]){aI.preventDefault()}aI.stopPropagation()});var ay,P=aG.blink;aA.bind("mousedown.mathquill",function(aJ){function aI(aM){aG.seek(W(aM.target),aM.pageX,aM.pageY);if(aG[p]!==ay[p]||aG.parent!==ay.parent){aG.selectFrom(ay)}return false}function aL(aM){delete aM.target;return aI(aM)}function aK(aM){ay=v;aG.blink=P;if(!aG.selection){if(R){aG.show()}else{aH.detach()}}aA.unbind("mousemove",aI);W(aM.target.ownerDocument).unbind("mousemove",aL).unbind("mouseup",aK)}setTimeout(function(){aF.focus();aF.focused=true});aG.blink=am;aG.seek(W(aJ.target),aJ.pageX,aJ.pageY);ay=A(aG.parent,aG[p],aG[h]);if(!R&&!aF.focused){aA.prepend(aH)}aA.mousemove(aI);W(aJ.target.ownerDocument).mousemove(aL).mouseup(aK);return false});if(!R){var aB=n(aF,{container:aA});aA.bind("cut paste",false).bind("copy",L).prepend('<span class="selectable">$'+aD.latex()+"$</span>");aF.blur(function(){aG.clearSelection();setTimeout(aE)});function aE(){aH.detach();aF.focused=false}return}var aB=n(aF,{container:aA,key:function(aJ,aI){},text:function(aI){},cut:function(aI){if(aG.selection){setTimeout(function(){aG.prepareEdit();aG.parent.bubble("redraw")})}aI.stopPropagation()},paste:function(aI){if(aI.slice(0,1)==="$"&&aI.slice(-1)==="$"){aI=aI.slice(1,-1)}else{aI="\\text{"+aI+"}"}aG.writeLatex(aI).show()}});aA.prepend(aH);aA.addClass("mathquill-editable");if(aC){aA.addClass("mathquill-textbox")}aF.focus(function(aI){if(!aG.parent){aG.insAtRightEnd(aD)}aG.parent.jQ.addClass("hasCursor");if(aG.selection){aG.selection.jQ.removeClass("blur");setTimeout(aD.selectionChanged)}else{aG.show()}aI.stopPropagation()}).blur(function(aI){aG.hide().parent.blur();if(aG.selection){aG.selection.jQ.addClass("blur")}aI.stopPropagation()});aA.bind("focus.mathquill blur.mathquill",function(aI){aF.trigger(aI)}).blur()}var o=j(y,function(L,P){L.latex=function(){return P.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/ig,"$1")};L.text=function(){return this.foldChildren("",function(R,ax){return R+ax.text()})};L.renderLatex=function(R){var ax=this.jQ;ax.children().slice(1).remove();this.ends[p]=this.ends[h]=0;delete this.cursor.selection;this.cursor.insAtRightEnd(this).writeLatex(R)};L.onKey=function(R,ay){switch(R){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":while(this.cursor[p]||this.cursor.selection){this.cursor.backspace()}break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();break;case"Esc":case"Tab":case"Spacebar":var ax=this.cursor.parent;if(ax===this.cursor.root){if(R==="Spacebar"){ay.preventDefault()}return}this.cursor.prepareMove();if(ax[h]){this.cursor.insAtLeftEnd(ax[h])}else{this.cursor.insRightOf(ax.parent)}break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":var ax=this.cursor.parent;if(ax===this.cursor.root){if(R==="Shift-Spacebar"){ay.preventDefault()}return}this.cursor.prepareMove();if(ax[p]){this.cursor.insAtRightEnd(ax[p])}else{this.cursor.insLeftOf(ax.parent)}break;case"Enter":break;case"End":this.cursor.prepareMove().insAtRightEnd(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().insAtRightEnd(this);break;case"Shift-End":while(this.cursor[h]){this.cursor.selectRight()}break;case"Ctrl-Shift-End":while(this.cursor[h]||this.cursor.parent!==this){this.cursor.selectRight()}break;case"Home":this.cursor.prepareMove().insAtLeftEnd(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().insAtLeftEnd(this);break;case"Shift-Home":while(this.cursor[p]){this.cursor.selectLeft()}break;case"Ctrl-Shift-Home":while(this.cursor[p]||this.cursor.parent!==this){this.cursor.selectLeft()}break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor[p]){while(this.cursor[p]){this.cursor.selectLeft()}}else{this.cursor.selectLeft()}case"Shift-Down":if(this.cursor[h]){while(this.cursor[h]){this.cursor.selectRight()}}else{this.cursor.selectRight()}case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":while(this.cursor[h]||this.cursor.selection){this.cursor.deleteForward()}break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root){return}this.cursor.prepareMove().insAtRightEnd(this);while(this.cursor[p]){this.cursor.selectLeft()}break;default:return false}ay.preventDefault();return false};L.onText=function(R){this.cursor.write(R);return false}});var ao=j(G,function(L,P){L.init=function(R){P.init.call(this,"$");this.cursor=R};L.htmlTemplate='<span class="mathquill-rendered-math">&0</span>';L.createBlocks=function(){this.ends[p]=this.ends[h]=o();this.blocks=[this.ends[p]];this.ends[p].parent=this;this.ends[p].cursor=this.cursor;this.ends[p].write=function(ay,R,ax){if(R!=="$"){y.prototype.write.call(this,ay,R,ax)}else{if(this.isEmpty()){ay.insRightOf(this.parent).backspace().show();ah("\\$","$").createLeftOf(ay)}else{if(!ay[h]){ay.insRightOf(this.parent)}else{if(!ay[p]){ay.insLeftOf(this.parent)}else{y.prototype.write.call(this,ay,R,ax)}}}}}};L.latex=function(){return"$"+this.ends[p].latex()+"$"}});var ab=j(y,function(L){L.renderLatex=function(ay){var aI=this;var aG=aI.cursor;aI.jQ.children().slice(1).remove();aI.ends[p]=aI.ends[h]=0;delete aG.selection;aG.show().insAtRightEnd(aI);var aD=d.regex;var aB=d.string;var aH=d.eof;var aF=d.all;var aC=aB("$").then(Z).skip(aB("$").or(aH)).map(function(aL){var aK=ao(aG);aK.createBlocks();var aJ=aK.ends[p];aL.children().adopt(aJ,0,0);return aK});var aE=aB("\\$").result("$");var R=aE.or(aD(/^[^$]/)).map(ah);var P=aC.or(R).many();var ax=P.skip(aH).or(aF.result(false)).parse(ay);if(ax){for(var az=0;az<ax.length;az+=1){ax[az].adopt(aI,aI.ends[h],0)}var aA=aI.join("html");I.jQize(aA).appendTo(aI.jQ);this.finalizeInsert()}};L.onKey=function(P){if(P==="Spacebar"||P==="Shift-Spacebar"){return}o.prototype.onKey.apply(this,arguments)};L.onText=o.prototype.onText;L.write=function(ay,R,ax){if(ax){ax.remove()}if(R==="$"){ao(ay).createLeftOf(ay)}else{var P;if(R==="<"){P="&lt;"}else{if(R===">"){P="&gt;"}}ah(R,P).createLeftOf(ay)}}});var B={},Q={};var X,m=am,an=document.createElement("div"),au=an.style,J={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1},b;for(var z in J){if(z in au){b=z;break}}if(b){X=function(P,L,R){P.css(b,"scale("+L+","+R+")")}}else{if("filter" in au){m=function(L){L.className=L.className};X=function(ax,L,az){L/=(1+(az-1)/2);ax.css("fontSize",az+"em");if(!ax.hasClass("matrixed-container")){ax.addClass("matrixed-container").wrapInner('<span class="matrixed"></span>')}var ay=ax.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+L+",SizingMethod='auto expand')");function R(){ax.css("marginRight",(ay.width()-1)*(L-1)/L+"px")}R();var P=setInterval(R);W(window).load(function(){clearTimeout(P);R()})}}else{X=function(P,L,R){P.css("fontSize",R+"em")}}}var N=j(G,function(L,P){L.init=function(ay,ax,R){P.init.call(this,ay,"<"+ax+" "+R+">&0</"+ax+">")}});Q.mathrm=f(N,"\\mathrm","span",'class="roman font"');Q.mathit=f(N,"\\mathit","i",'class="font"');Q.mathbf=f(N,"\\mathbf","b",'class="font"');Q.mathsf=f(N,"\\mathsf","span",'class="sans-serif font"');Q.mathtt=f(N,"\\mathtt","span",'class="monospace font"');Q.underline=f(N,"\\underline","span",'class="non-leaf underline"');Q.overline=Q.bar=f(N,"\\overline","span",'class="non-leaf overline"');var at=j(G,function(L,P){L.init=function(ax,R,ay){P.init.call(this,ax,"<"+R+' class="non-leaf">&0</'+R+">",[ay])};L.finalizeTree=function(){aj("SupSub is only _ and ^",this.ctrlSeq==="^"||this.ctrlSeq==="_");if(this.ctrlSeq==="_"){this.down=this.ends[p];this.ends[p].up=R}else{this.up=this.ends[p];this.ends[p].down=R}function R(az){var ax=this.parent,ay=az;do{if(ay[h]){az.insLeftOf(ax);return false}ay=ay.parent.parent}while(ay!==ax);az.insRightOf(ax);return false}};L.latex=function(){var R=this.ends[p].latex();if(R.length===1){return this.ctrlSeq+R}else{return this.ctrlSeq+"{"+(R||" ")+"}"}};L.redraw=function(){if(this[p]){this[p].respace()}if(!(this[p] instanceof at)){this.respace();if(this[h]&&!(this[h] instanceof at)){this[h].respace()}}};L.respace=function(){if(this[p].ctrlSeq==="\\int "||(this[p] instanceof at&&this[p].ctrlSeq!=this.ctrlSeq&&this[p][p]&&this[p][p].ctrlSeq==="\\int ")){if(!this.limit){this.limit=true;this.jQ.addClass("limit")}}else{if(this.limit){this.limit=false;this.jQ.removeClass("limit")}}this.respaced=this[p] instanceof at&&this[p].ctrlSeq!=this.ctrlSeq&&!this[p].respaced;if(this.respaced){var ax=+this.jQ.css("fontSize").slice(0,-2),R=this[p].jQ.outerWidth(),ay=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&this.ctrlSeq==="_"?-0.25:0)-R/ax+"em",marginRight:0.1-ar(ay,R)/ax+"em"})}else{if(this.limit&&this.ctrlSeq==="_"){this.jQ.css({left:"-.25em",marginRight:""})}else{this.jQ.css({left:"",marginRight:""})}}if(this[h] instanceof at){this[h].respace()}return this}});Q.subscript=Q._=f(at,"_","sub","_");Q.superscript=Q.supscript=Q["^"]=f(at,"^","sup","**");var ag=Q.frac=Q.dfrac=Q.cfrac=Q.fraction=j(G,function(L,P){L.ctrlSeq="\\frac";L.htmlTemplate='<span class="fraction non-leaf"><span class="numerator">&0</span><span class="denominator">&1</span><span style="display:inline-block;width:0">&nbsp;</span></span>';L.textTemplate=["(","/",")"];L.finalizeTree=function(){this.up=this.ends[h].up=this.ends[p];this.down=this.ends[p].down=this.ends[h]}});var i=Q.over=B["/"]=j(ag,function(L,P){L.createLeftOf=function(ax){if(!this.replacedFragment){var R=ax[p];while(R&&!(R instanceof ap||R instanceof ai||R instanceof x||/^[,;:]$/.test(R.ctrlSeq))){R=R[p]}if(R instanceof x&&R[h] instanceof at){R=R[h];if(R[h] instanceof at&&R[h].ctrlSeq!=R.ctrlSeq){R=R[h]}}if(R!==ax[p]){this.replaces(af(R[h]||ax.parent.ends[p],ax[p]));ax[p]=R}}P.createLeftOf.call(this,ax)}});var w=Q.sqrt=Q["√"]=j(G,function(L,P){L.ctrlSeq="\\sqrt";L.htmlTemplate='<span class="non-leaf"><span class="scaled sqrt-prefix">&radic;</span><span class="non-leaf sqrt-stem">&0</span></span>';L.textTemplate=["sqrt(",")"];L.parser=function(){return Z.optBlock.then(function(R){return Z.block.map(function(ay){var ax=aq();ax.blocks=[R,ay];R.adopt(ax,0,0);ay.adopt(ax,R,0);return ax})}).or(P.parser.call(this))};L.redraw=function(){var R=this.ends[h].jQ;X(R.prev(),1,R.innerHeight()/+R.css("fontSize").slice(0,-2)-0.1)}});var a=Q.vec=j(G,function(L,P){L.ctrlSeq="\\vec";L.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&rarr;</span><span class="vector-stem">&0</span></span>';L.textTemplate=["vec(",")"]});var aq=Q.nthroot=j(w,function(L,P){L.htmlTemplate='<sup class="nthroot non-leaf">&0</sup><span class="scaled"><span class="sqrt-prefix scaled">&radic;</span><span class="sqrt-stem non-leaf">&1</span></span>';L.textTemplate=["sqrt[","](",")"];L.latex=function(){return"\\sqrt["+this.ends[p].latex()+"]{"+this.ends[h].latex()+"}"}});var F=j(G,function(L,P){L.init=function(ax,az,ay,R){P.init.call(this,"\\left"+ay,'<span class="non-leaf"><span class="scaled paren">'+ax+'</span><span class="non-leaf">&0</span><span class="scaled paren">'+az+"</span></span>",[ax,az]);this.end="\\right"+R};L.jQadd=function(){P.jQadd.apply(this,arguments);var R=this.jQ;this.bracketjQs=R.children(":first").add(R.children(":last"))};L.latex=function(){return this.ctrlSeq+this.ends[p].latex()+this.end};L.redraw=function(){var ax=this.ends[p].jQ;var R=ax.outerHeight()/+ax.css("fontSize").slice(0,-2);X(this.bracketjQs,ar(1+0.2*(R-1),1.2),1.05*R)}});Q.left=j(G,function(L){L.parser=function(){var R=d.regex;var P=d.string;var ax=d.succeed;var ay=d.optWhitespace;return ay.then(R(/^(?:[([|]|\\\{)/)).then(function(az){if(az.charAt(0)==="\\"){az=az.slice(1)}var aA=B[az]();return Z.map(function(aB){aA.blocks=[aB];aB.adopt(aA,0,0)}).then(P("\\right")).skip(ay).then(R(/^(?:[\])|]|\\\})/)).then(function(aB){if(aB.slice(-1)!==aA.end.slice(-1)){return d.fail("open doesn't match close")}return ax(aA)})})}});Q.right=j(G,function(L){L.parser=function(){return d.fail("unmatched \\right")}});Q.lbrace=B["{"]=f(F,"{","}","\\{","\\}");Q.langle=Q.lang=f(F,"&lang;","&rang;","\\langle ","\\rangle ");var ac=j(F,function(L,P){L.createLeftOf=function(R){if(!R[h]&&R.parent.parent&&R.parent.parent.end===this.end&&!this.replacedFragment){R.insRightOf(R.parent.parent)}else{P.createLeftOf.call(this,R)}};L.placeCursor=function(R){this.ends[p].blur();R.insRightOf(this)}});Q.rbrace=B["}"]=f(ac,"{","}","\\{","\\}");Q.rangle=Q.rang=f(ac,"&lang;","&rang;","\\langle ","\\rangle ");var t=function(L,P){L.init=function(R,ax){P.init.call(this,R,ax,R,ax)}};var T=j(F,t);Q.lparen=B["("]=f(T,"(",")");Q.lbrack=Q.lbracket=B["["]=f(T,"[","]");var V=j(ac,t);Q.rparen=B[")"]=f(V,"(",")");Q.rbrack=Q.rbracket=B["]"]=f(V,"[","]");var c=Q.lpipe=Q.rpipe=B["|"]=j(T,function(L,P){L.init=function(){P.init.call(this,"|","|")};L.createLeftOf=ac.prototype.createLeftOf});var ai=B.$=Q.text=Q.textnormal=Q.textrm=Q.textup=Q.textmd=j(G,function(L,P){L.ctrlSeq="\\text";L.htmlTemplate='<span class="text">&0</span>';L.replaces=function(R){if(R instanceof af){this.replacedText=R.remove().jQ.text()}else{if(typeof R==="string"){this.replacedText=R}}};L.textTemplate=['"','"'];L.parser=function(){var R=this;var ax=d.string;var ay=d.regex;var az=d.optWhitespace;return az.then(ax("{")).then(ay(/^[^}]*/)).skip(ax("}")).map(function(aD){R.createBlocks();var aC=R.ends[p];for(var aA=0;aA<aD.length;aA+=1){var aB=ah(aD.charAt(aA));aB.adopt(aC,aC.ends[h],0)}return R})};L.createBlocks=function(){this.ends[p]=this.ends[h]=s();this.blocks=[this.ends[p]];this.ends[p].parent=this};L.finalizeInsert=function(){this.ends[p].blur=function(){delete this.blur;return this};P.finalizeInsert.call(this)};L.createLeftOf=function(ax){P.createLeftOf.call(this,this.cursor=ax);if(this.replacedText){for(var R=0;R<this.replacedText.length;R+=1){this.ends[p].write(ax,this.replacedText.charAt(R))}}}});var s=j(y,function(L,P){L.onKey=function(R,ax){if(R==="Spacebar"||R==="Shift-Spacebar"){return false}};L.deleteOutOf=function(R,ax){if(this.isEmpty()){ax.insRightOf(this.parent)}};L.write=function(aA,ax,az){if(az){az.remove()}if(ax!=="$"){var R;if(ax==="<"){R="&lt;"}else{if(ax===">"){R="&gt;"}}ah(ax,R).createLeftOf(aA)}else{if(this.isEmpty()){aA.insRightOf(this.parent).backspace();ah("\\$","$").createLeftOf(aA)}else{if(!aA[h]){aA.insRightOf(this.parent)}else{if(!aA[p]){aA.insLeftOf(this.parent)}else{var ay=ai();ay.replaces(af(aA[h],this.ends[h]));aA.insRightOf(this.parent);ay.adopt=function(){delete this.adopt;this.adopt.apply(this,arguments);this[p]=0};ay.createLeftOf(aA);ay[p]=this.parent;aA.insLeftOf(ay)}}}}return false};L.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){var R=this.parent,ax=R.cursor;if(ax.parent===this){this.jQ.addClass("empty")}else{ax.hide();R.remove();if(ax[h]===R){ax[h]=R[h]}else{if(ax[p]===R){ax[p]=R[p]}}ax.show().parent.bubble("redraw")}}return this};L.focus=function(){P.focus.call(this);var ax=this.parent;if(ax[h].ctrlSeq===ax.ctrlSeq){var az=this,ay=ax.cursor,R=ax[h].ends[p];R.eachChild(function(aA){aA.parent=az;aA.jQ.appendTo(az.jQ)});if(this.ends[h]){this.ends[h][h]=R.ends[p]}else{this.ends[p]=R.ends[p]}R.ends[p][p]=this.ends[h];this.ends[h]=R.ends[h];R.parent.remove();if(ay[p]){ay.insRightOf(ay[p])}else{ay.insAtLeftEnd(this)}ay.parent.bubble("redraw")}else{if(ax[p].ctrlSeq===ax.ctrlSeq){var ay=ax.cursor;if(ay[p]){ax[p].ends[p].focus()}else{ay.insAtRightEnd(ax[p].ends[p])}}}return this}});function q(R,P,L){return j(ai,{ctrlSeq:R,htmlTemplate:"<"+P+" "+L+">&0</"+P+">"})}Q.em=Q.italic=Q.italics=Q.emph=Q.textit=Q.textsl=q("\\textit","i",'class="text"');Q.strong=Q.bold=Q.textbf=q("\\textbf","b",'class="text"');Q.sf=Q.textsf=q("\\textsf","span",'class="sans-serif text"');Q.tt=Q.texttt=q("\\texttt","span",'class="monospace text"');Q.textsc=q("\\textsc","span",'style="font-variant:small-caps" class="text"');Q.uppercase=q("\\uppercase","span",'style="text-transform:uppercase" class="text"');Q.lowercase=q("\\lowercase","span",'style="text-transform:lowercase" class="text"');var ae=B["\\"]=j(G,function(L,P){L.ctrlSeq="\\";L.replaces=function(R){this._replacedFragment=R.disown();this.isEmpty=function(){return false}};L.htmlTemplate='<span class="latex-command-input non-leaf">\\<span>&0</span></span>';L.textTemplate=["\\"];L.createBlocks=function(){P.createBlocks.call(this);this.ends[p].focus=function(){this.parent.jQ.addClass("hasCursor");if(this.isEmpty()){this.parent.jQ.removeClass("empty")}return this};this.ends[p].blur=function(){this.parent.jQ.removeClass("hasCursor");if(this.isEmpty()){this.parent.jQ.addClass("empty")}return this}};L.createLeftOf=function(ax){P.createLeftOf.call(this,ax);this.cursor=ax.insAtRightEnd(this.ends[p]);if(this._replacedFragment){var R=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(ay){W(ay.target=R).trigger(ay);return false}).insertBefore(this.jQ).add(this.jQ)}this.ends[p].write=function(aA,ay,az){if(az){az.remove()}if(ay.match(/[a-z]/i)){ah(ay).createLeftOf(aA)}else{this.parent.renderCommand();if(ay!=="\\"||!this.isEmpty()){this.parent.parent.write(aA,ay)}}}};L.latex=function(){return"\\"+this.ends[p].latex()+" "};L.onKey=function(R,ax){if(R==="Tab"||R==="Enter"||R==="Spacebar"){this.renderCommand();ax.preventDefault();return false}};L.renderCommand=function(){this.jQ=this.jQ.last();this.remove();if(this[h]){this.cursor.insLeftOf(this[h])}else{this.cursor.insAtRightEnd(this.parent)}var ax=this.ends[p].latex(),R;if(!ax){ax="backslash"}this.cursor.insertCmd(ax,this._replacedFragment)}});var U=Q.binom=Q.binomial=j(G,function(L,P){L.ctrlSeq="\\binom";L.htmlTemplate='<span class="paren scaled">(</span><span class="non-leaf"><span class="array non-leaf"><span>&0</span><span>&1</span></span></span><span class="paren scaled">)</span>';L.textTemplate=["choose(",",",")"];L.redraw=function(){var ay=this.jQ.eq(1);var R=ay.outerHeight()/+ay.css("fontSize").slice(0,-2);var ax=this.jQ.filter(".paren");X(ax,ar(1+0.2*(R-1),1.2),1.05*R)}});var r=Q.choose=j(U,function(L){L.createLeftOf=i.prototype.createLeftOf});var H=Q.vector=j(G,function(L,P){L.ctrlSeq="\\vector";L.htmlTemplate='<span class="array"><span>&0</span></span>';L.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(R,ax){R.push(ax.latex());return R}).join("\\\\")+"\\end{matrix}"};L.text=function(){return"["+this.foldChildren([],function(R,ax){R.push(ax.text());return R}).join()+"]"};L.createLeftOf=function(R){P.createLeftOf.call(this,this.cursor=R)};L.onKey=function(R,ay){var ax=this.cursor.parent;if(ax.parent===this){if(R==="Enter"){var az=y();az.parent=this;az.jQ=W("<span></span>").attr(l,az.id).insertAfter(ax.jQ);if(ax[h]){ax[h][p]=az}else{this.ends[h]=az}az[h]=ax[h];ax[h]=az;az[p]=ax;this.bubble("redraw").cursor.insAtRightEnd(az);ay.preventDefault();return false}else{if(R==="Tab"&&!ax[h]){if(ax.isEmpty()){if(ax[p]){this.cursor.insRightOf(this);delete ax[p][h];this.ends[h]=ax[p];ax.jQ.remove();this.bubble("redraw");ay.preventDefault();return false}else{return}}var az=y();az.parent=this;az.jQ=W("<span></span>").attr(l,az.id).appendTo(this.jQ);this.ends[h]=az;ax[h]=az;az[p]=ax;this.bubble("redraw").cursor.insAtRightEnd(az);ay.preventDefault();return false}else{if(ay.which===8){if(ax.isEmpty()){if(ax[p]){this.cursor.insAtRightEnd(ax[p]);ax[p][h]=ax[h]}else{this.cursor.insLeftOf(this);this.ends[p]=ax[h]}if(ax[h]){ax[h][p]=ax[p]}else{this.ends[h]=ax[p]}ax.jQ.remove();if(this.isEmpty()){this.cursor.deleteForward()}else{this.bubble("redraw")}ay.preventDefault();return false}else{if(!this.cursor[p]){ay.preventDefault();return false}}}}}}}});Q.editable=j(ao,function(L,P){L.init=function(){G.prototype.init.call(this,"\\editable")};L.jQadd=function(){var R=this;P.jQadd.apply(R,arguments);var ax=R.ends[p].disown();var ay=R.jQ.children().detach();R.ends[p]=R.ends[h]=o();R.blocks=[R.ends[p]];R.ends[p].parent=R;al(R.jQ,R.ends[p],false,true);R.cursor=R.ends[p].cursor;ax.children().adopt(R.ends[p],0,0);ay.appendTo(R.ends[p].jQ);R.ends[p].cursor.insAtRightEnd(R.ends[p])};L.latex=function(){return this.ends[p].latex()};L.text=function(){return this.ends[p].text()}});Q.f=f(ad,"f",'<var class="florin">&fnof;</var><span style="display:inline-block;width:0">&nbsp;</span>');var u=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,"<var>"+(R||ax)+"</var>")};L.text=function(){var R=this.ctrlSeq;if(this[p]&&!(this[p] instanceof u)&&!(this[p] instanceof ap)){R="*"+R}if(this[h]&&!(this[h] instanceof ap)&&!(this[h].ctrlSeq==="^")){R+="*"}return R}});var ah=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,"<span>"+(R||ax)+"</span>")}});B[" "]=f(ah,"\\:"," ");Q.prime=B["'"]=f(ah,"'","&prime;");var g=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,'<span class="nonSymbola">'+(R||ax)+"</span>")}});Q["@"]=g;Q["&"]=f(g,"\\&","&amp;");Q["%"]=f(g,"\\%","%");Q.alpha=Q.beta=Q.gamma=Q.delta=Q.zeta=Q.eta=Q.theta=Q.iota=Q.kappa=Q.mu=Q.nu=Q.xi=Q.rho=Q.sigma=Q.tau=Q.chi=Q.psi=Q.omega=j(u,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","&"+R+";")}});Q.phi=f(u,"\\phi ","&#981;");Q.phiv=Q.varphi=f(u,"\\varphi ","&phi;");Q.epsilon=f(u,"\\epsilon ","&#1013;");Q.epsiv=Q.varepsilon=f(u,"\\varepsilon ","&epsilon;");Q.piv=Q.varpi=f(u,"\\varpi ","&piv;");Q.sigmaf=Q.sigmav=Q.varsigma=f(u,"\\varsigma ","&sigmaf;");Q.thetav=Q.vartheta=Q.thetasym=f(u,"\\vartheta ","&thetasym;");Q.upsilon=Q.upsi=f(u,"\\upsilon ","&upsilon;");Q.gammad=Q.Gammad=Q.digamma=f(u,"\\digamma ","&#989;");Q.kappav=Q.varkappa=f(u,"\\varkappa ","&#1008;");Q.rhov=Q.varrho=f(u,"\\varrho ","&#1009;");Q.pi=Q["π"]=f(g,"\\pi ","&pi;");Q.lambda=f(g,"\\lambda ","&lambda;");Q.Upsilon=Q.Upsi=Q.upsih=Q.Upsih=f(ad,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>');Q.Gamma=Q.Delta=Q.Theta=Q.Lambda=Q.Xi=Q.Pi=Q.Sigma=Q.Phi=Q.Psi=Q.Omega=Q.forall=j(ah,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","&"+R+";")}});var ak=j(G,function(L){L.init=function(P){this.latex=P};L.createLeftOf=function(P){P.writeLatex(this.latex)};L.parser=function(){var P=Z.parse(this.latex).children();return d.succeed(P)}});Q["¹"]=f(ak,"^1");Q["²"]=f(ak,"^2");Q["³"]=f(ak,"^3");Q["¼"]=f(ak,"\\frac14");Q["½"]=f(ak,"\\frac12");Q["¾"]=f(ak,"\\frac34");var ap=j(ad,function(L,P){L.init=function(ax,R,ay){P.init.call(this,ax,'<span class="binary-operator">'+R+"</span>",ay)}});var e=j(ap,function(L){L.init=ah.prototype.init;L.respace=function(){if(!this[p]){this.jQ[0].className=""}else{if(this[p] instanceof ap&&this[h]&&!(this[h] instanceof ap)){this.jQ[0].className="unary-operator"}else{this.jQ[0].className="binary-operator"}}return this}});Q["+"]=f(e,"+","+");Q["–"]=Q["-"]=f(e,"-","&minus;");Q["±"]=Q.pm=Q.plusmn=Q.plusminus=f(e,"\\pm ","&plusmn;");Q.mp=Q.mnplus=Q.minusplus=f(e,"\\mp ","&#8723;");B["*"]=Q.sdot=Q.cdot=f(ap,"\\cdot ","&middot;");Q["="]=f(ap,"=","=");Q["<"]=f(ap,"<","&lt;");Q[">"]=f(ap,">","&gt;");Q.notin=Q.sim=Q.cong=Q.equiv=Q.oplus=Q.otimes=j(ap,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","&"+R+";")}});Q.times=f(ap,"\\times ","&times;","[x]");Q["÷"]=Q.div=Q.divide=Q.divides=f(ap,"\\div ","&divide;","[/]");Q["≠"]=Q.ne=Q.neq=f(ap,"\\ne ","&ne;");Q.ast=Q.star=Q.loast=Q.lowast=f(ap,"\\ast ","&lowast;");Q.therefor=Q.therefore=f(ap,"\\therefore ","&there4;");Q.cuz=Q.because=f(ap,"\\because ","&#8757;");Q.prop=Q.propto=f(ap,"\\propto ","&prop;");Q["≈"]=Q.asymp=Q.approx=f(ap,"\\approx ","&asymp;");Q.lt=f(ap,"<","&lt;");Q.gt=f(ap,">","&gt;");Q["≤"]=Q.le=Q.leq=f(ap,"\\le ","&le;");Q["≥"]=Q.ge=Q.geq=f(ap,"\\ge ","&ge;");Q.isin=Q["in"]=f(ap,"\\in ","&isin;");Q.ni=Q.contains=f(ap,"\\ni ","&ni;");Q.notni=Q.niton=Q.notcontains=Q.doesnotcontain=f(ap,"\\not\\ni ","&#8716;");Q.sub=Q.subset=f(ap,"\\subset ","&sub;");Q.sup=Q.supset=Q.superset=f(ap,"\\supset ","&sup;");Q.nsub=Q.notsub=Q.nsubset=Q.notsubset=f(ap,"\\not\\subset ","&#8836;");Q.nsup=Q.notsup=Q.nsupset=Q.notsupset=Q.nsuperset=Q.notsuperset=f(ap,"\\not\\supset ","&#8837;");Q.sube=Q.subeq=Q.subsete=Q.subseteq=f(ap,"\\subseteq ","&sube;");Q.supe=Q.supeq=Q.supsete=Q.supseteq=Q.supersete=Q.superseteq=f(ap,"\\supseteq ","&supe;");Q.nsube=Q.nsubeq=Q.notsube=Q.notsubeq=Q.nsubsete=Q.nsubseteq=Q.notsubsete=Q.notsubseteq=f(ap,"\\not\\subseteq ","&#8840;");Q.nsupe=Q.nsupeq=Q.notsupe=Q.notsupeq=Q.nsupsete=Q.nsupseteq=Q.notsupsete=Q.notsupseteq=Q.nsupersete=Q.nsuperseteq=Q.notsupersete=Q.notsuperseteq=f(ap,"\\not\\supseteq ","&#8841;");var x=j(ad,function(L,P){L.init=function(ax,R){P.init.call(this,ax,"<big>"+R+"</big>")}});Q["∑"]=Q.sum=Q.summation=f(x,"\\sum ","&sum;");Q["∏"]=Q.prod=Q.product=f(x,"\\prod ","&prod;");Q.coprod=Q.coproduct=f(x,"\\coprod ","&#8720;");Q["∫"]=Q["int"]=Q.integral=f(x,"\\int ","&int;");Q.N=Q.naturals=Q.Naturals=f(ah,"\\mathbb{N}","&#8469;");Q.P=Q.primes=Q.Primes=Q.projective=Q.Projective=Q.probability=Q.Probability=f(ah,"\\mathbb{P}","&#8473;");Q.Z=Q.integers=Q.Integers=f(ah,"\\mathbb{Z}","&#8484;");Q.Q=Q.rationals=Q.Rationals=f(ah,"\\mathbb{Q}","&#8474;");Q.R=Q.reals=Q.Reals=f(ah,"\\mathbb{R}","&#8477;");Q.C=Q.complex=Q.Complex=Q.complexes=Q.Complexes=Q.complexplane=Q.Complexplane=Q.ComplexPlane=f(ah,"\\mathbb{C}","&#8450;");Q.H=Q.Hamiltonian=Q.quaternions=Q.Quaternions=f(ah,"\\mathbb{H}","&#8461;");Q.quad=Q.emsp=f(ah,"\\quad ","    ");Q.qquad=f(ah,"\\qquad ","        ");Q.diamond=f(ah,"\\diamond ","&#9671;");Q.bigtriangleup=f(ah,"\\bigtriangleup ","&#9651;");Q.ominus=f(ah,"\\ominus ","&#8854;");Q.uplus=f(ah,"\\uplus ","&#8846;");Q.bigtriangledown=f(ah,"\\bigtriangledown ","&#9661;");Q.sqcap=f(ah,"\\sqcap ","&#8851;");Q.triangleleft=f(ah,"\\triangleleft ","&#8882;");Q.sqcup=f(ah,"\\sqcup ","&#8852;");Q.triangleright=f(ah,"\\triangleright ","&#8883;");Q.odot=f(ah,"\\odot ","&#8857;");Q.bigcirc=f(ah,"\\bigcirc ","&#9711;");Q.dagger=f(ah,"\\dagger ","&#0134;");Q.ddagger=f(ah,"\\ddagger ","&#135;");Q.wr=f(ah,"\\wr ","&#8768;");Q.amalg=f(ah,"\\amalg ","&#8720;");Q.models=f(ah,"\\models ","&#8872;");Q.prec=f(ah,"\\prec ","&#8826;");Q.succ=f(ah,"\\succ ","&#8827;");Q.preceq=f(ah,"\\preceq ","&#8828;");Q.succeq=f(ah,"\\succeq ","&#8829;");Q.simeq=f(ah,"\\simeq ","&#8771;");Q.mid=f(ah,"\\mid ","&#8739;");Q.ll=f(ah,"\\ll ","&#8810;");Q.gg=f(ah,"\\gg ","&#8811;");Q.parallel=f(ah,"\\parallel ","&#8741;");Q.bowtie=f(ah,"\\bowtie ","&#8904;");Q.sqsubset=f(ah,"\\sqsubset ","&#8847;");Q.sqsupset=f(ah,"\\sqsupset ","&#8848;");Q.smile=f(ah,"\\smile ","&#8995;");Q.sqsubseteq=f(ah,"\\sqsubseteq ","&#8849;");Q.sqsupseteq=f(ah,"\\sqsupseteq ","&#8850;");Q.doteq=f(ah,"\\doteq ","&#8784;");Q.frown=f(ah,"\\frown ","&#8994;");Q.vdash=f(ah,"\\vdash ","&#8870;");Q.dashv=f(ah,"\\dashv ","&#8867;");Q.longleftarrow=f(ah,"\\longleftarrow ","&#8592;");Q.longrightarrow=f(ah,"\\longrightarrow ","&#8594;");Q.Longleftarrow=f(ah,"\\Longleftarrow ","&#8656;");Q.Longrightarrow=f(ah,"\\Longrightarrow ","&#8658;");Q.longleftrightarrow=f(ah,"\\longleftrightarrow ","&#8596;");Q.updownarrow=f(ah,"\\updownarrow ","&#8597;");Q.Longleftrightarrow=f(ah,"\\Longleftrightarrow ","&#8660;");Q.Updownarrow=f(ah,"\\Updownarrow ","&#8661;");Q.mapsto=f(ah,"\\mapsto ","&#8614;");Q.nearrow=f(ah,"\\nearrow ","&#8599;");Q.hookleftarrow=f(ah,"\\hookleftarrow ","&#8617;");Q.hookrightarrow=f(ah,"\\hookrightarrow ","&#8618;");Q.searrow=f(ah,"\\searrow ","&#8600;");Q.leftharpoonup=f(ah,"\\leftharpoonup ","&#8636;");Q.rightharpoonup=f(ah,"\\rightharpoonup ","&#8640;");Q.swarrow=f(ah,"\\swarrow ","&#8601;");Q.leftharpoondown=f(ah,"\\leftharpoondown ","&#8637;");Q.rightharpoondown=f(ah,"\\rightharpoondown ","&#8641;");Q.nwarrow=f(ah,"\\nwarrow ","&#8598;");Q.ldots=f(ah,"\\ldots ","&#8230;");Q.cdots=f(ah,"\\cdots ","&#8943;");Q.vdots=f(ah,"\\vdots ","&#8942;");Q.ddots=f(ah,"\\ddots ","&#8944;");Q.surd=f(ah,"\\surd ","&#8730;");Q.triangle=f(ah,"\\triangle ","&#9653;");Q.ell=f(ah,"\\ell ","&#8467;");Q.top=f(ah,"\\top ","&#8868;");Q.flat=f(ah,"\\flat ","&#9837;");Q.natural=f(ah,"\\natural ","&#9838;");Q.sharp=f(ah,"\\sharp ","&#9839;");Q.wp=f(ah,"\\wp ","&#8472;");Q.bot=f(ah,"\\bot ","&#8869;");Q.clubsuit=f(ah,"\\clubsuit ","&#9827;");Q.diamondsuit=f(ah,"\\diamondsuit ","&#9826;");Q.heartsuit=f(ah,"\\heartsuit ","&#9825;");Q.spadesuit=f(ah,"\\spadesuit ","&#9824;");Q.oint=f(ah,"\\oint ","&#8750;");Q.bigcap=f(ah,"\\bigcap ","&#8745;");Q.bigcup=f(ah,"\\bigcup ","&#8746;");Q.bigsqcup=f(ah,"\\bigsqcup ","&#8852;");Q.bigvee=f(ah,"\\bigvee ","&#8744;");Q.bigwedge=f(ah,"\\bigwedge ","&#8743;");Q.bigodot=f(ah,"\\bigodot ","&#8857;");Q.bigotimes=f(ah,"\\bigotimes ","&#8855;");Q.bigoplus=f(ah,"\\bigoplus ","&#8853;");Q.biguplus=f(ah,"\\biguplus ","&#8846;");Q.lfloor=f(ah,"\\lfloor ","&#8970;");Q.rfloor=f(ah,"\\rfloor ","&#8971;");Q.lceil=f(ah,"\\lceil ","&#8968;");Q.rceil=f(ah,"\\rceil ","&#8969;");Q.slash=f(ah,"\\slash ","&#47;");Q.opencurlybrace=f(ah,"\\opencurlybrace ","&#123;");Q.closecurlybrace=f(ah,"\\closecurlybrace ","&#125;");Q.caret=f(ah,"\\caret ","^");Q.underscore=f(ah,"\\underscore ","_");Q.backslash=f(ah,"\\backslash ","\\");Q.vert=f(ah,"|");Q.perp=Q.perpendicular=f(ah,"\\perp ","&perp;");Q.nabla=Q.del=f(ah,"\\nabla ","&nabla;");Q.hbar=f(ah,"\\hbar ","&#8463;");Q.AA=Q.Angstrom=Q.angstrom=f(ah,"\\text\\AA ","&#8491;");Q.ring=Q.circ=Q.circle=f(ah,"\\circ ","&#8728;");Q.bull=Q.bullet=f(ah,"\\bullet ","&bull;");Q.setminus=Q.smallsetminus=f(ah,"\\setminus ","&#8726;");Q.not=Q["¬"]=Q.neg=f(ah,"\\neg ","&not;");Q["…"]=Q.dots=Q.ellip=Q.hellip=Q.ellipsis=Q.hellipsis=f(ah,"\\dots ","&hellip;");Q.converges=Q.darr=Q.dnarr=Q.dnarrow=Q.downarrow=f(ah,"\\downarrow ","&darr;");Q.dArr=Q.dnArr=Q.dnArrow=Q.Downarrow=f(ah,"\\Downarrow ","&dArr;");Q.diverges=Q.uarr=Q.uparrow=f(ah,"\\uparrow ","&uarr;");Q.uArr=Q.Uparrow=f(ah,"\\Uparrow ","&uArr;");Q.to=f(ap,"\\to ","&rarr;");Q.rarr=Q.rightarrow=f(ah,"\\rightarrow ","&rarr;");Q.implies=f(ap,"\\Rightarrow ","&rArr;");Q.rArr=Q.Rightarrow=f(ah,"\\Rightarrow ","&rArr;");Q.gets=f(ap,"\\gets ","&larr;");Q.larr=Q.leftarrow=f(ah,"\\leftarrow ","&larr;");Q.impliedby=f(ap,"\\Leftarrow ","&lArr;");Q.lArr=Q.Leftarrow=f(ah,"\\Leftarrow ","&lArr;");Q.harr=Q.lrarr=Q.leftrightarrow=f(ah,"\\leftrightarrow ","&harr;");Q.iff=f(ap,"\\Leftrightarrow ","&hArr;");Q.hArr=Q.lrArr=Q.Leftrightarrow=f(ah,"\\Leftrightarrow ","&hArr;");Q.Re=Q.Real=Q.real=f(ah,"\\Re ","&real;");Q.Im=Q.imag=Q.image=Q.imagin=Q.imaginary=Q.Imaginary=f(ah,"\\Im ","&image;");Q.part=Q.partial=f(ah,"\\partial ","&part;");Q.inf=Q.infin=Q.infty=Q.infinity=f(ah,"\\infty ","&infin;");Q.alef=Q.alefsym=Q.aleph=Q.alephsym=f(ah,"\\aleph ","&alefsym;");Q.xist=Q.xists=Q.exist=Q.exists=f(ah,"\\exists ","&exist;");Q.and=Q.land=Q.wedge=f(ah,"\\wedge ","&and;");Q.or=Q.lor=Q.vee=f(ah,"\\vee ","&or;");Q.o=Q.O=Q.empty=Q.emptyset=Q.oslash=Q.Oslash=Q.nothing=Q.varnothing=f(ap,"\\varnothing ","&empty;");Q.cup=Q.union=f(ap,"\\cup ","&cup;");Q.cap=Q.intersect=Q.intersection=f(ap,"\\cap ","&cap;");Q.deg=Q.degree=f(ah,"^\\circ ","&deg;");Q.ang=Q.angle=f(ah,"\\angle ","&ang;");var aa=j(ad,function(L,P){L.init=function(R){P.init.call(this,"\\"+R+" ","<span>"+R+"</span>")};L.respace=function(){this.jQ[0].className=(this[h] instanceof at||this[h] instanceof F)?"":"non-italicized-function"}});Q.ln=Q.lg=Q.log=Q.span=Q.proj=Q.det=Q.dim=Q.min=Q.max=Q.mod=Q.lcm=Q.gcd=Q.gcf=Q.hcf=Q.lim=aa;(function(){var P=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(var L in P){Q[P[L]]=Q[P[L]+"h"]=Q["a"+P[L]]=Q["arc"+P[L]]=Q["a"+P[L]+"h"]=Q["arc"+P[L]+"h"]=aa}}());var Z=(function(){function aJ(aM){var aN=y();aM.adopt(aN,0,0);return aN}function aC(aO){var aN=aO[0]||y();for(var aM=1;aM<aO.length;aM+=1){aO[aM].children().adopt(aN,aN.ends[h],0)}return aN}var L=d.string;var ax=d.regex;var aL=d.letter;var aD=d.any;var aI=d.optWhitespace;var aK=d.succeed;var aB=d.fail;var aE=aL.map(u);var aF=ax(/^[^${}\\_^]/).map(ah);var P=ax(/^[^\\a-eg-zA-Z]/).or(L("\\").then(ax(/^[a-z]+/i).or(ax(/^\s+/).result(" ")).or(aD))).then(function(aN){var aM=Q[aN];if(aM){return aM(aN).parser()}else{return aB("unknown command: \\"+aN)}});var ay=P.or(aE).or(aF);var aA=L("{").then(function(){return aH}).skip(L("}"));var az=aI.then(aA.or(ay.map(aJ)));var aH=az.many().map(aC).skip(aI);var aG=L("[").then(az.then(function(aM){return aM.join("latex")!=="]"?aK(aM):aB()}).many().map(aC).skip(aI)).skip(L("]"));var R=aH;R.block=az;R.optBlock=aG;return R})();var O=j(A,function(P){P.init=function(ay){this.parent=this.root=ay;var az=this.jQ=this._jQ=W('<span class="cursor">&#8203;</span>');this.blink=function(){az.toggleClass("blink")};this.upDownCache={}};P.show=function(){this.jQ=this._jQ.removeClass("blink");if("intervalId" in this){clearInterval(this.intervalId)}else{if(this[h]){if(this.selection&&this.selection.ends[p][p]===this[p]){this.jQ.insertBefore(this.selection.jQ)}else{this.jQ.insertBefore(this[h].jQ.first())}}else{this.jQ.appendTo(this.parent.jQ)}this.parent.focus()}this.intervalId=setInterval(this.blink,500);return this};P.hide=function(){if("intervalId" in this){clearInterval(this.intervalId)}delete this.intervalId;this.jQ.detach();this.jQ=W();return this};P.withDirInsertAt=function(az,aB,ay,aC){var aA=this.parent;this.parent=aB;this[az]=ay;this[-az]=aC;aA.blur()};P.insDirOf=function(ay,az){av(ay);this.withDirInsertAt(ay,az.parent,az[ay],az);this.parent.jQ.addClass("hasCursor");this.jQ.insDirOf(ay,az.jQ);return this};P.insLeftOf=function(ay){return this.insDirOf(p,ay)};P.insRightOf=function(ay){return this.insDirOf(h,ay)};P.insAtDirEnd=function(ay,az){av(ay);this.withDirInsertAt(ay,az,0,az.ends[ay]);if(ay===p&&az.textarea){this.jQ.insDirOf(-ay,az.textarea)}else{this.jQ.insAtDirEnd(ay,az.jQ)}az.focus();return this};P.insAtLeftEnd=function(ay){return this.insAtDirEnd(p,ay)};P.insAtRightEnd=function(ay){return this.insAtDirEnd(h,ay)};P.hopDir=function(ay){av(ay);this.jQ.insDirOf(ay,this[ay].jQ);this[-ay]=this[ay];this[ay]=this[ay][ay];return this};P.hopLeft=function(){return this.hopDir(p)};P.hopRight=function(){return this.hopDir(h)};P.moveDirWithin=function(ay,az){av(ay);if(this[ay]){if(this[ay].ends[-ay]){this.insAtDirEnd(-ay,this[ay].ends[-ay])}else{this.hopDir(ay)}}else{if(this.parent===az){return}if(this.parent[ay]){this.insAtDirEnd(-ay,this.parent[ay])}else{this.insDirOf(ay,this.parent.parent)}}};P.moveLeftWithin=function(ay){return this.moveDirWithin(p,ay)};P.moveRightWithin=function(ay){return this.moveDirWithin(h,ay)};P.moveDir=function(ay){av(ay);R(this);if(this.selection){this.insDirOf(ay,this.selection.ends[ay]).clearSelection()}else{this.moveDirWithin(ay,this.root)}return this.show()};P.moveLeft=function(){return this.moveDir(p)};P.moveRight=function(){return this.moveDir(h)};P.moveUp=function(){return L(this,"up")};P.moveDown=function(){return L(this,"down")};function L(ay,az){ay.clearSelection().show();if(ay[h][az]){ay.insAtLeftEnd(ay[h][az])}else{if(ay[p][az]){ay.insAtRightEnd(ay[p][az])}else{var aC=ay.parent;do{var aD=aC[az];if(aD){if(typeof aD==="function"){aD=aC[az](ay)}if(aD===false||aD instanceof y){ay.upDownCache[aC.id]=A(ay.parent,ay[p],ay[h]);if(aD instanceof y){var aB=ay.upDownCache[aD.id];if(aB){if(aB[h]){ay.insLeftOf(aB[h])}else{ay.insAtRightEnd(aB.parent)}}else{var aA=ax(ay).left;ay.insAtRightEnd(aD);ay.seekHoriz(aA,aD)}}break}}aC=aC.parent.parent}while(aC)}}return ay}P.seek=function(aB,az,ay){R(this);var aA,aD,aC=this.clearSelection().show();if(aB.hasClass("empty")){aC.insAtLeftEnd(I[aB.attr(l)]);return aC}aA=I[aB.attr(K)];if(aA instanceof ad){if(aB.outerWidth()>2*(az-aB.offset().left)){aC.insLeftOf(aA)}else{aC.insRightOf(aA)}return aC}if(!aA){aD=I[aB.attr(l)];if(!aD){aB=aB.parent();aA=I[aB.attr(K)];if(!aA){aD=I[aB.attr(l)];if(!aD){aD=aC.root}}}}if(aA){aC.insRightOf(aA)}else{aC.insAtRightEnd(aD)}return aC.seekHoriz(az,aC.root)};P.seekHoriz=function(ay,aB){var aA=this;var az=ax(aA).left-ay;var aC;do{aA.moveLeftWithin(aB);aC=az;az=ax(aA).left-ay}while(az>0&&(aA[p]||aA.parent!==aB));if(-az>aC){aA.moveRightWithin(aB)}return aA};function ax(ay){var az=ay.jQ.removeClass("cursor").offset();ay.jQ.addClass("cursor");return az}P.writeLatex=function(aB){var az=this;R(az);az.show().deleteSelection();var aA=d.all;var ay=d.eof;var aC=Z.skip(ay).or(aA.result(false)).parse(aB);if(aC){aC.children().adopt(az.parent,az[p],az[h]);I.jQize(aC.join("html")).insertBefore(az.jQ);az[p]=aC.ends[h];aC.finalizeInsert();az.parent.bubble("redraw")}return this.hide()};P.write=function(az){var ay=this.prepareWrite();return this.insertCh(az,ay)};P.insertCh=function(ay,az){this.parent.write(this,ay,az);return this};P.insertCmd=function(ay,aA){var az=Q[ay];if(az){az=az(ay);if(aA){az.replaces(aA)}az.createLeftOf(this)}else{az=ai();az.replaces(ay);az.ends[p].focus=function(){delete this.focus;return this};az.createLeftOf(this);this.insRightOf(az);if(aA){aA.remove()}}return this};P.unwrapGramp=function(){var aA=this.parent.parent;var ay=aA.parent;var aB=aA[h];var aC=this;var az=aA[p];aA.disown().eachChild(function(aD){if(aD.isEmpty()){return}aD.children().adopt(ay,az,aB).each(function(aE){aE.jQ.insertBefore(aA.jQ.first())});az=aD.ends[h]});if(!this[h]){if(this[p]){this[h]=this[p][h]}else{while(!this[h]){this.parent=this.parent[h];if(this.parent){this[h]=this.parent.ends[p]}else{this[h]=aA[h];this.parent=ay;break}}}}if(this[h]){this.insLeftOf(this[h])}else{this.insAtRightEnd(ay)}aA.jQ.remove();if(aA[p]){aA[p].respace()}if(aA[h]){aA[h].respace()}};P.deleteDir=function(ay){av(ay);R(this);this.show();if(this.deleteSelection()){}else{if(this[ay]){if(this[ay].isEmpty()){this[ay]=this[ay].remove()[ay]}else{this.selectDir(ay)}}else{if(this.parent!==this.root){if(this.parent.parent.isEmpty()){return this.insDirOf(-ay,this.parent.parent).deleteDir(ay)}else{this.unwrapGramp()}}}}if(this[p]){this[p].respace()}if(this[h]){this[h].respace()}this.parent.bubble("redraw");return this};P.backspace=function(){return this.deleteDir(p)};P.deleteForward=function(){return this.deleteDir(h)};P.selectFrom=function(aC){var aG=this,aB=aC;loopThroughAncestors:while(true){for(var aD=this;aD!==aG.parent.parent;aD=aD.parent.parent){if(aD.parent===aB.parent){aA=aD;aE=aB;break loopThroughAncestors}}for(var aF=aC;aF!==aB.parent.parent;aF=aF.parent.parent){if(aG.parent===aF.parent){aA=aG;aE=aF;break loopThroughAncestors}}if(aG.parent.parent){aG=aG.parent.parent}if(aB.parent.parent){aB=aB.parent.parent}}var aA,aE,ay;if(aA[h]!==aE){for(var az=aA;az;az=az[h]){if(az===aE[p]){ay=true;break}}if(!ay){ay=aE;aE=aA;aA=ay}}this.hide().selection=Y(aA[p][h]||aA.parent.ends[p],aE[h][p]||aE.parent.ends[h]);this.insRightOf(aE[h][p]||aE.parent.ends[h]);this.root.selectionChanged()};P.selectDir=function(ay){av(ay);R(this);if(this.selection){if(this.selection.ends[ay]===this[-ay]){if(this[ay]){this.hopDir(ay).selection.extendDir(ay)}else{if(this.parent!==this.root){this.insDirOf(ay,this.parent.parent).selection.levelUp()}}}else{this.hopDir(ay);if(this.selection.ends[ay]===this.selection.ends[-ay]){this.clearSelection().show();return}this.selection.retractDir(ay)}}else{if(this[ay]){this.hopDir(ay)}else{if(this.parent===this.root){return}this.insDirOf(ay,this.parent.parent)}this.hide().selection=Y(this[-ay])}this.root.selectionChanged()};P.selectLeft=function(){return this.selectDir(p)};P.selectRight=function(){return this.selectDir(h)};function R(ay){ay.upDownCache={}}P.prepareMove=function(){R(this);return this.show().clearSelection()};P.prepareEdit=function(){R(this);return this.show().deleteSelection()};P.prepareWrite=function(){R(this);return this.show().replaceSelection()};P.clearSelection=function(){if(this.selection){this.selection.clear();delete this.selection;this.root.selectionChanged()}return this};P.deleteSelection=function(){if(!this.selection){return false}this[p]=this.selection.ends[p][p];this[h]=this.selection.ends[h][h];this.selection.remove();this.root.selectionChanged();return delete this.selection};P.replaceSelection=function(){var ay=this.selection;if(ay){this[p]=ay.ends[p][p];this[h]=ay.ends[h][h];delete this.selection}return ay}});var Y=j(af,function(L,P){L.init=function(){var R=this;P.init.apply(R,arguments);R.jQwrap(R.jQ)};L.jQwrap=function(R){this.jQ=R.wrapAll('<span class="selection"></span>').parent()};L.adopt=function(){this.jQ.replaceWith(this.jQ=this.jQ.children());return P.adopt.apply(this,arguments)};L.clear=function(){this.jQ.replaceWith(this.jQ.children());return this};L.levelUp=function(){var ax=this,R=ax.ends[p]=ax.ends[h]=ax.ends[h].parent.parent;ax.clear().jQwrap(R.jQ);return ax};L.extendDir=function(R){av(R);this.ends[R]=this.ends[R][R];this.ends[R].jQ.insAtDirEnd(R,this.jQ);return this};L.extendLeft=function(){return this.extendDir(p)};L.extendRight=function(){return this.extendDir(h)};L.retractDir=function(R){av(R);this.ends[-R].jQ.insDirOf(-R,this.jQ);this.ends[-R]=this.ends[-R][R]};L.retractRight=function(){return this.retractDir(h)};L.retractLeft=function(){return this.retractDir(p)}});C.fn.mathquill=function(az,ay){switch(az){case"redraw":return this.each(function(){var aC=W(this).attr(l),aD=aC&&I[aC];if(aD){(function aB(aE){aE.eachChild(aB);if(aE.redraw){aE.redraw()}}(aD))}});case"revert":return this.each(function(){var aB=W(this).attr(l),aC=aB&&I[aB];if(aC&&aC.revert){aC.revert()}});case"latex":if(arguments.length>1){return this.each(function(){var aB=W(this).attr(l),aC=aB&&I[aB];if(aC){aC.renderLatex(ay)}})}var P=W(this).attr(l),aA=P&&I[P];return aA&&aA.latex();case"text":var P=W(this).attr(l),aA=P&&I[P];return aA&&aA.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1){return this.each(function(){var aB=W(this).attr(l),aD=aB&&I[aB],aC=aD&&aD.cursor;if(aC){aC.writeLatex(ay).parent.blur()}})}case"cmd":if(arguments.length>1){return this.each(function(){var aB=W(this).attr(l),aE=aB&&I[aB],aD=aE&&aE.cursor;if(aD){var aC=aD.prepareWrite();if(/^\\[a-z]+$/i.test(ay)){aD.insertCmd(ay.slice(1),aC)}else{aD.insertCh(ay,aC)}aD.hide().parent.blur()}})}case"cursor":if(arguments.length>1){return this.each(function(){var aB=W(this).attr(l),aD=aB&&I[aB],aC=aD&&aD.cursor;if(aC){ay(aC)}})}default:var L=az==="textbox",R=L||az==="editable",ax=L?ab:o;return this.each(function(){al(W(this),ax(),L,R)})}};C(function(){C(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable");C(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox");C(".mathquill-embedded-latex").mathquill()})}());+function(h){var e=".dropdown-backdrop";var b='[data-toggle="dropdown"]';var a=function(i){h(i).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.1";a.prototype.toggle=function(m){var l=h(this);if(l.is(".disabled, :disabled")){return}var k=f(l);var j=k.hasClass("open");d();if(!j){if("ontouchstart" in document.documentElement&&!k.closest(".navbar-nav").length){h('<div class="dropdown-backdrop"/>').insertAfter(h(this)).on("click",d)}var i={relatedTarget:this};k.trigger(m=h.Event("show.bs.dropdown",i));if(m.isDefaultPrevented()){return}l.trigger("focus").attr("aria-expanded","true");k.toggleClass("open").trigger("shown.bs.dropdown",i)}return false};a.prototype.keydown=function(m){if(!/(38|40|27|32)/.test(m.which)||/input|textarea/i.test(m.target.tagName)){return}var l=h(this);m.preventDefault();m.stopPropagation();if(l.is(".disabled, :disabled")){return}var k=f(l);var j=k.hasClass("open");if((!j&&m.which!=27)||(j&&m.which==27)){if(m.which==27){k.find(b).trigger("focus")}return l.trigger("click")}var n=" li:not(.divider):visible a";var o=k.find('[role="menu"]'+n+', [role="listbox"]'+n);if(!o.length){return}var i=o.index(m.target);if(m.which==38&&i>0){i--}if(m.which==40&&i<o.length-1){i++}if(!~i){i=0}o.eq(i).trigger("focus")};function d(i){if(i&&i.which===3){return}h(e).remove();h(b).each(function(){var l=h(this);var k=f(l);var j={relatedTarget:this};if(!k.hasClass("open")){return}k.trigger(i=h.Event("hide.bs.dropdown",j));if(i.isDefaultPrevented()){return}l.attr("aria-expanded","false");k.removeClass("open").trigger("hidden.bs.dropdown",j)})}function f(k){var i=k.attr("data-target");if(!i){i=k.attr("href");i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")}var j=i&&h(i);return j&&j.length?j:k.parent()}function g(i){return this.each(function(){var k=h(this);var j=k.data("bs.dropdown");if(!j){k.data("bs.dropdown",(j=new a(this)))}if(typeof i=="string"){j[i].call(k)}})}var c=h.fn.dropdown;h.fn.dropdown=g;h.fn.dropdown.Constructor=a;h.fn.dropdown.noConflict=function(){h.fn.dropdown=c;return this};h(document).on("click.bs.dropdown.data-api",d).on("click.bs.dropdown.data-api",".dropdown form",function(i){i.stopPropagation()}).on("click.bs.dropdown.data-api",b,a.prototype.toggle).on("keydown.bs.dropdown.data-api",b,a.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',a.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',a.prototype.keydown)}(jQuery);if(typeof JSONcanonical!=="object"){JSONcanonical={}}(function(){function d(f){return f<10?"0"+f:f}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,a,e={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},c;function b(f){i.lastIndex=0;return i.test(f)?'"'+f.replace(i,function(j){var k=e[j];return typeof k==="string"?k:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function g(t,p){var m,l,u,j,r=h,o,s=p[t];if(s&&typeof s==="object"&&typeof s.toJSON==="function"){s=s.toJSON(t)}if(typeof c==="function"){s=c.call(p,t,s)}switch(typeof s){case"string":return b(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s){return"null"}h+=a;o=[];if(Object.prototype.toString.apply(s)==="[object Array]"){j=s.length;for(m=0;m<j;m+=1){o[m]=g(m,s)||"null"}u=o.length===0?"[]":h?"[\n"+h+o.join(",\n"+h)+"\n"+r+"]":"["+o.join(",")+"]";h=r;return u}if(c&&typeof c==="object"){j=c.length;for(m=0;m<j;m+=1){if(typeof c[m]==="string"){l=c[m];u=g(l,s);if(u){o.push(b(l)+(h?": ":":")+u)}}}}else{var q=function(A,z){var v=Number(A),k=Number(z),y=isFinite(v),x=isFinite(k);if(y&&x){return v<k?-1:(v>k?1:0)}if(y){return -1}if(x){return 1}return A<z?-1:(A>z?1:0)};var w=[],f,n;for(l in s){if(Object.prototype.hasOwnProperty.call(s,l)){w.push(l)}}w.sort(q);f=w.length;for(n=0;n<f;++n){l=w[n];u=g(l,s);if(u){o.push(b(l)+(h?": ":":")+u)}}}u=o.length===0?"{}":h?"{\n"+h+o.join(",\n"+h)+"\n"+r+"}":"{"+o.join(",")+"}";h=r;return u}}if(typeof JSONcanonical.stringify!=="function"){JSONcanonical.stringify=function(l,j,k){var f;h="";a="";if(typeof k==="number"){for(f=0;f<k;f+=1){a+=" "}}else{if(typeof k==="string"){a=k}}c=j;if(j&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number")){throw new Error("JSON.stringify")}return g("",{"":l})}}}());!function(b){if("object disable exports"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function disable define"==typeof define&&define.amd){define([],b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.jsondiffpatch=b()}}}(function(){var d,b,a;return(function c(f,k,h){function g(q,n){if(!k[q]){if(!f[q]){var m=typeof require=="function"&&require;if(!n&&m){return m(q,!0)}if(e){return e(q,!0)}var p=new Error("Cannot find module '"+q+"'");throw p.code="MODULE_NOT_FOUND",p}var i=k[q]={exports:{}};f[q][0].call(i.exports,function(l){var o=f[q][1][l];return g(o?o:l)},i,i.exports,c,f,k,h)}return k[q].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(f,g,e){(function(l){var j=f("./diffpatcher").DiffPatcher;e.DiffPatcher=j,e.create=function(n){return new j(n)},e.dateReviver=f("./date-reviver");var i;if(e.diff=function(){return i||(i=new j),i.diff.apply(i,arguments)},e.patch=function(){return i||(i=new j),i.patch.apply(i,arguments)},e.unpatch=function(){return i||(i=new j),i.unpatch.apply(i,arguments)},e.reverse=function(){return i||(i=new j),i.reverse.apply(i,arguments)},l.browser){e.homepage="https://github.com/benjamine/jsondiffpatch",e.version="0.1.22"}else{var m="../package.json",h=f(m);e.homepage=h.homepage,e.version=h.version;var q="./formatters",k=f(q);e.formatters=k,e.console=k.console}}).call(this,f("_process"))},{"./date-reviver":7,"./diffpatcher":8,_process:2}],2:[function(f,g,e){function h(){}var i=g.exports={};i.nextTick=function(){var l="undefined"!=typeof window&&window.setImmediate,k="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(l){return function(m){return window.setImmediate(m)}}if(k){var j=[];return window.addEventListener("message",function(p){var m=p.source;if((m===window||null===m)&&"process-tick"===p.data&&(p.stopPropagation(),j.length>0)){var q=j.shift();q()}},!0),function(m){j.push(m),window.postMessage("process-tick","*")}}return function(m){setTimeout(m,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")}},{}],3:[function(h,i,g){var e=h("../pipe").Pipe,f=function(){};f.prototype.setResult=function(j){return this.result=j,this.hasResult=!0,this},f.prototype.exit=function(){return this.exiting=!0,this},f.prototype.switchTo=function(j,k){return"string"==typeof j||j instanceof e?this.nextPipe=j:(this.next=j,k&&(this.nextPipe=k)),this},f.prototype.push=function(j,k){return j.parent=this,"undefined"!=typeof k&&(j.childName=k),j.root=this.root||this,j.options=j.options||this.options,this.children?(this.children[this.children.length-1].next=j,this.children.push(j)):(this.children=[j],this.nextAfterChildren=this.next||null,this.next=j),j.next=this,this},g.Context=f},{"../pipe":15}],4:[function(g,h,f){var e=g("./context").Context,i=function(j,k){this.left=j,this.right=k,this.pipe="diff"};i.prototype=new e,f.DiffContext=i},{"./context":3}],5:[function(g,i,f){var e=g("./context").Context,h=function(j,k){this.left=j,this.delta=k,this.pipe="patch"};h.prototype=new e,f.PatchContext=h},{"./context":3}],6:[function(h,i,g){var f=h("./context").Context,e=function(j){this.delta=j,this.pipe="reverse"};e.prototype=new f,g.ReverseContext=e},{"./context":3}],7:[function(f,g,e){g.exports=function(j,i){var h;return"string"==typeof i&&(h=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+\-])(\d{2}):(\d{2}))$/.exec(i))?new Date(Date.UTC(+h[1],+h[2]-1,+h[3],+h[4],+h[5],+h[6],+(h[7]||0))):i}},{}],8:[function(j,i,n){var m=j("./processor").Processor,o=j("./pipe").Pipe,r=j("./contexts/diff").DiffContext,e=j("./contexts/patch").PatchContext,g=j("./contexts/reverse").ReverseContext,l=j("./filters/trivial"),p=j("./filters/nested"),h=j("./filters/arrays"),f=j("./filters/dates"),k=j("./filters/texts"),q=function(s){this.processor=new m(s),this.processor.pipe(new o("diff").append(p.collectChildrenDiffFilter,l.diffFilter,f.diffFilter,k.diffFilter,p.objectsDiffFilter,h.diffFilter).shouldHaveResult()),this.processor.pipe(new o("patch").append(p.collectChildrenPatchFilter,h.collectChildrenPatchFilter,l.patchFilter,k.patchFilter,p.patchFilter,h.patchFilter).shouldHaveResult()),this.processor.pipe(new o("reverse").append(p.collectChildrenReverseFilter,h.collectChildrenReverseFilter,l.reverseFilter,k.reverseFilter,p.reverseFilter,h.reverseFilter).shouldHaveResult())};q.prototype.options=function(){return this.processor.options.apply(this.processor,arguments)},q.prototype.diff=function(t,s){return this.processor.process(new r(t,s))},q.prototype.patch=function(t,s){return this.processor.process(new e(t,s))},q.prototype.reverse=function(s){return this.processor.process(new g(s))},q.prototype.unpatch=function(t,s){return this.patch(t,this.reverse(s))},n.DiffPatcher=q},{"./contexts/diff":4,"./contexts/patch":5,"./contexts/reverse":6,"./filters/arrays":9,"./filters/dates":10,"./filters/nested":12,"./filters/texts":13,"./filters/trivial":14,"./pipe":15,"./processor":16}],9:[function(l,k,n){var t=l("../contexts/diff").DiffContext,e=l("../contexts/patch").PatchContext,h=l("../contexts/reverse").ReverseContext,f=l("./lcs"),u=3,o="function"==typeof Array.isArray?Array.isArray:function(v){return v instanceof Array},p="function"==typeof Array.prototype.indexOf?function(w,v){return w.indexOf(v)}:function(y,x){for(var w=y.length,v=0;w>v;v++){if(y[v]===x){return v}}return -1},r=function(W){if(W.leftIsArray){for(var K,H,S,O,Z=W.options&&W.options.objectHash,Q=function(R,v,ab,C,y){var A=R[ab],ac=v[C];if(A===ac){return !0}if("object"!=typeof A||"object"!=typeof ac){return !1}if(!Z){return !1}var x,F;return"number"==typeof ab?(y.hashCache1=y.hashCache1||[],x=y.hashCache1[ab],"undefined"==typeof x&&(y.hashCache1[ab]=x=Z(A,ab))):x=Z(A),"undefined"==typeof x?!1:("number"==typeof C?(y.hashCache2=y.hashCache2||[],F=y.hashCache2[C],"undefined"==typeof F&&(y.hashCache2[C]=F=Z(ac,C))):F=Z(ac),"undefined"==typeof F?!1:x===F)},I={},N=0,V=0,Y=W.left,T=W.right,X=Y.length,G=T.length;X>N&&G>N&&Q(Y,T,N,N,I);){K=N,O=new t(W.left[K],W.right[K]),W.push(O,K),N++}for(;X>V+N&&G>V+N&&Q(Y,T,X-1-V,G-1-V,I);){H=X-1-V,S=G-1-V,O=new t(W.left[H],W.right[S]),W.push(O,S),V++}var D;if(N+V===X){if(X===G){return void W.setResult(void 0).exit()}for(D=D||{_t:"a"},K=N;G-V>K;K++){D[K]=[T[K]]}return void W.setResult(D).exit()}if(N+V===G){for(D=D||{_t:"a"},K=N;X-V>K;K++){D["_"+K]=[Y[K],0,0]}return void W.setResult(D).exit()}I={};var M=Y.slice(N,X-V),z=T.slice(N,G-V),B=f.get(M,z,Q,I),J=[];for(D=D||{_t:"a"},K=N;X-V>K;K++){p(B.indices1,K-N)<0&&(D["_"+K]=[Y[K],0,0],J.push(K))}var w=!0;W.options&&W.options.arrays&&W.options.arrays.detectMove===!1&&(w=!1);var L=!1;W.options&&W.options.arrays&&W.options.arrays.includeValueOnMove&&(L=!0);var aa=J.length;for(K=N;G-V>K;K++){var P=p(B.indices2,K-N);if(0>P){var E=!1;if(w&&aa>0){for(var U=0;aa>U;U++){if(H=J[U],Q(M,z,H-N,K-N,I)){D["_"+H].splice(1,2,K,u),L||(D["_"+H][0]=""),S=K,O=new t(W.left[H],W.right[S]),W.push(O,S),J.splice(U,1),E=!0;break}}}E||(D[K]=[T[K]])}else{H=B.indices1[P]+N,S=B.indices2[P]+N,O=new t(W.left[H],W.right[S]),W.push(O,S)}}W.setResult(D).exit()}};r.filterName="arrays";var i={numerically:function(w,v){return w-v},numericallyBy:function(v){return function(x,w){return x[v]-w[v]}}},q=function(D){if(D.nested&&"a"===D.delta._t){var w,J,A=D.delta,y=D.left,G=[],z=[],K=[];for(w in A){if("_t"!==w){if("_"===w[0]){if(0!==A[w][2]&&A[w][2]!==u){throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+A[w][2])}G.push(parseInt(w.slice(1),10))}else{1===A[w].length?z.push({index:parseInt(w,10),value:A[w][0]}):K.push({index:parseInt(w,10),delta:A[w]})}}}for(G=G.sort(i.numerically),w=G.length-1;w>=0;w--){J=G[w];var x=A["_"+J],C=y.splice(J,1)[0];x[2]===u&&z.push({index:x[1],value:C})}z=z.sort(i.numericallyBy("index"));var F=z.length;for(w=0;F>w;w++){var B=z[w];y.splice(B.index,0,B.value)}var E,I=K.length;if(I>0){for(w=0;I>w;w++){var H=K[w];E=new e(D.left[H.index],H.delta),D.push(E,H.index)}}return D.children?void D.exit():void D.setResult(D.left).exit()}};q.filterName="arrays";var s=function(y){if(y&&y.children&&"a"===y.delta._t){for(var x,w=y.children.length,v=0;w>v;v++){x=y.children[v],y.left[x.childName]=x.result}y.setResult(y.left).exit()}};s.filterName="arraysCollectChildren";var j=function(x){if(!x.nested){return void (x.delta[2]===u&&(x.newName="_"+x.delta[1],x.setResult([x.delta[0],parseInt(x.childName.substr(1),10),u]).exit()))}if("a"===x.delta._t){var w,v;for(w in x.delta){"_t"!==w&&(v=new h(x.delta[w]),x.push(v,w))}x.exit()}};j.filterName="arrays";var g=function(A,z,y){var x=z;if("string"==typeof z&&"_"===z[0]){x=parseInt(z.substr(1),10)}else{var B="_"+z;if(o(y)&&0===y[2]){x=B}else{for(var w in A){var v=A[w];o(v)&&v[2]===u&&v[1].toString()===z&&(x=w.substr(1))}}}return x},m=function(z){if(z&&z.children&&"a"===z.delta._t){for(var y,x=z.children.length,w={_t:"a"},A=0;x>A;A++){y=z.children[A];var v=y.newName;"undefined"==typeof v&&(v=g(z.delta,y.childName,y.result)),w[v]!==y.result&&(w[v]=y.result)}z.setResult(w).exit()}};m.filterName="arraysCollectChildren",n.diffFilter=r,n.patchFilter=q,n.collectChildrenPatchFilter=s,n.reverseFilter=j,n.collectChildrenReverseFilter=m},{"../contexts/diff":4,"../contexts/patch":5,"../contexts/reverse":6,"./lcs":11}],10:[function(f,g,e){var h=function(i){i.left instanceof Date?(i.setResult(i.right instanceof Date?i.left.getTime()!==i.right.getTime()?[i.left,i.right]:void 0:[i.left,i.right]),i.exit()):i.right instanceof Date&&i.setResult([i.left,i.right]).exit()};h.filterName="dates",e.diffFilter=h},{}],11:[function(g,h,e){var k=function(l,o,p,m){return l[p]===o[m]},j=function(x,q,m,l){var s,v,o=x.length,w=q.length,p=[o+1];for(s=0;o+1>s;s++){for(p[s]=[w+1],v=0;w+1>v;v++){p[s][v]=0}}for(p.match=m,s=1;o+1>s;s++){for(v=1;w+1>v;v++){p[s][v]=m(x,q,s-1,v-1,l)?p[s-1][v-1]+1:Math.max(p[s-1][v],p[s][v-1])}}return p},i=function(o,q,u,p,s,l){if(0===p||0===s){return{sequence:[],indices1:[],indices2:[]}}if(o.match(q,u,p-1,s-1,l)){var m=i(o,q,u,p-1,s-1,l);return m.sequence.push(q[p-1]),m.indices1.push(p-1),m.indices2.push(s-1),m}return o[p][s-1]>o[p-1][s]?i(o,q,u,p,s-1,l):i(o,q,u,p-1,s,l)},f=function(m,p,s,o){o=o||{};var q=j(m,p,s||k,o),l=i(q,m,p,m.length,p.length,o);return"string"==typeof m&&"string"==typeof p&&(l.sequence=l.sequence.join("")),l};e.get=f},{}],12:[function(i,h,l){var p=i("../contexts/diff").DiffContext,e=i("../contexts/patch").PatchContext,f=i("../contexts/reverse").ReverseContext,j=function(w){if(w&&w.children){for(var u,q=w.children.length,v=w.result,s=0;q>s;s++){u=w.children[s],"undefined"!=typeof u.result&&(v=v||{},v[u.childName]=u.result)}v&&w.leftIsArray&&(v._t="a"),w.setResult(v).exit()}};j.filterName="collectChildren";var n=function(s){if(!s.leftIsArray&&"object"===s.leftType){var r,q;for(r in s.left){q=new p(s.left[r],s.right[r]),s.push(q,r)}for(r in s.right){"undefined"==typeof s.left[r]&&(q=new p(void 0,s.right[r]),s.push(q,r))}return s.children&&0!==s.children.length?void s.exit():void s.setResult(void 0).exit()}};n.filterName="objects";var m=function(s){if(s.nested&&!s.delta._t){var r,q;for(r in s.delta){q=new e(s.left[r],s.delta[r]),s.push(q,r)}s.exit()}};m.filterName="objects";var o=function(v){if(v&&v.children&&!v.delta._t){for(var s,q=v.children.length,u=0;q>u;u++){s=v.children[u],v.left.hasOwnProperty(s.childName)&&void 0===s.result?delete v.left[s.childName]:v.left[s.childName]!==s.result&&(v.left[s.childName]=s.result)}v.setResult(v.left).exit()}};o.filterName="collectChildren";var g=function(s){if(s.nested&&!s.delta._t){var r,q;for(r in s.delta){q=new f(s.delta[r]),s.push(q,r)}s.exit()}};g.filterName="objects";var k=function(w){if(w&&w.children&&!w.delta._t){for(var u,q=w.children.length,v={},s=0;q>s;s++){u=w.children[s],v[u.childName]!==u.result&&(v[u.childName]=u.result)}w.setResult(v).exit()}};k.filterName="collectChildren",l.collectChildrenDiffFilter=j,l.objectsDiffFilter=n,l.patchFilter=m,l.collectChildrenPatchFilter=o,l.reverseFilter=g,l.collectChildrenReverseFilter=k},{"../contexts/diff":4,"../contexts/patch":5,"../contexts/reverse":6}],13:[function(j,h,k){var o=2,l=60,f=null,i=function(){if(!f){var q;if("undefined"!=typeof diff_match_patch){q="function"==typeof diff_match_patch?new diff_match_patch:new diff_match_patch.diff_match_patch}else{if("function"==typeof j){try{var v="diff_match_patch_uncompressed",u=j("../../public/external/"+v);q=new u.diff_match_patch}catch(p){q=null}}}if(!q){var s=new Error("text diff_match_patch library not found");throw s.diff_match_patch_not_found=!0,s}f={diff:function(t,r){return q.patch_toText(q.patch_make(t,r))},patch:function(z,y){for(var w=q.patch_apply(q.patch_fromText(y),z),x=0;x<w[1].length;x++){if(!w[1][x]){var t=new Error("text patch failed");t.textPatchFailed=!0}}return w[0]}}}return f},n=function(p){if("string"===p.leftType){var r=p.options&&p.options.textDiff&&p.options.textDiff.minLength||l;if(p.left.length<r||p.right.length<r){return void p.setResult([p.left,p.right]).exit()}var q=i().diff;p.setResult([q(p.left,p.right),0,o]).exit()}};n.filterName="texts";var m=function(p){if(!p.nested&&p.delta[2]===o){var q=i().patch;p.setResult(q(p.left,p.delta[0])).exit()}};m.filterName="texts";var e=function(C){var y,x,v,p,B,A,u,s,w=null,z=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;for(v=C.split("\n"),y=0,x=v.length;x>y;y++){p=v[y];var q=p.slice(0,1);"@"===q?(w=z.exec(p),A=y,u=null,s=null,v[A]="@@ -"+w[3]+","+w[4]+" +"+w[1]+","+w[2]+" @@"):"+"===q?(u=y,v[y]="-"+v[y].slice(1),"+"===v[y-1].slice(0,1)&&(B=v[y],v[y]=v[y-1],v[y-1]=B)):"-"===q&&(s=y,v[y]="+"+v[y].slice(1))}return v.join("\n")},g=function(p){p.nested||p.delta[2]===o&&p.setResult([e(p.delta[0]),0,o]).exit()};g.filterName="texts",k.diffFilter=n,k.patchFilter=m,k.reverseFilter=g},{}],14:[function(g,h,f){var e="function"==typeof Array.isArray?Array.isArray:function(l){return l instanceof Array},k=function(l){if(l.left===l.right){return void l.setResult(void 0).exit()}if("undefined"==typeof l.left){if("function"==typeof l.right){throw new Error("functions are not supported")}return void l.setResult([l.right]).exit()}if("undefined"==typeof l.right){return void l.setResult([l.left,0,0]).exit()}if("function"==typeof l.left||"function"==typeof l.right){throw new Error("functions are not supported")}return l.leftType=null===l.left?"null":typeof l.left,l.rightType=null===l.right?"null":typeof l.right,l.leftType!==l.rightType?void l.setResult([l.left,l.right]).exit():"boolean"===l.leftType||"number"===l.leftType?void l.setResult([l.left,l.right]).exit():("object"===l.leftType&&(l.leftIsArray=e(l.left)),"object"===l.rightType&&(l.rightIsArray=e(l.right)),l.leftIsArray!==l.rightIsArray?void l.setResult([l.left,l.right]).exit():void 0)};k.filterName="trivial";var i=function(l){return"undefined"==typeof l.delta?void l.setResult(l.left).exit():(l.nested=!e(l.delta),l.nested?void 0:1===l.delta.length?void l.setResult(l.delta[0]).exit():2===l.delta.length?void l.setResult(l.delta[1]).exit():3===l.delta.length&&0===l.delta[2]?void l.setResult(void 0).exit():void 0)};i.filterName="trivial";var j=function(l){return"undefined"==typeof l.delta?void l.setResult(l.delta).exit():(l.nested=!e(l.delta),l.nested?void 0:1===l.delta.length?void l.setResult([l.delta[0],0,0]).exit():2===l.delta.length?void l.setResult([l.delta[1],l.delta[0]]).exit():3===l.delta.length&&0===l.delta[2]?void l.setResult([l.delta[0]]).exit():void 0)};j.filterName="trivial",f.diffFilter=k,f.patchFilter=i,f.reverseFilter=j},{}],15:[function(g,h,f){var e=function(i){this.name=i,this.filters=[]};e.prototype.process=function(k){if(!this.processor){throw new Error("add this pipe to a processor before using it")}for(var n=this.debug,m=this.filters.length,j=k,l=0;m>l;l++){var p=this.filters[l];if(n&&this.log("filter: "+p.filterName),p(j),"object"==typeof j&&j.exiting){j.exiting=!1;break}}!j.next&&this.resultCheck&&this.resultCheck(j)},e.prototype.log=function(i){console.log("[jsondiffpatch] "+this.name+" pipe, "+i)},e.prototype.append=function(){return this.filters.push.apply(this.filters,arguments),this},e.prototype.prepend=function(){return this.filters.unshift.apply(this.filters,arguments),this},e.prototype.indexOf=function(i){if(!i){throw new Error("a filter name is required")}for(var k=0;k<this.filters.length;k++){var j=this.filters[k];if(j.filterName===i){return k}}throw new Error("filter not found: "+i)},e.prototype.list=function(){for(var i=[],k=0;k<this.filters.length;k++){var j=this.filters[k];i.push(j.filterName)}return i},e.prototype.after=function(i){var k=this.indexOf(i),j=Array.prototype.slice.call(arguments,1);if(!j.length){throw new Error("a filter is required")}return j.unshift(k+1,0),Array.prototype.splice.apply(this.filters,j),this},e.prototype.before=function(i){var k=this.indexOf(i),j=Array.prototype.slice.call(arguments,1);if(!j.length){throw new Error("a filter is required")}return j.unshift(k,0),Array.prototype.splice.apply(this.filters,j),this},e.prototype.clear=function(){return this.filters.length=0,this},e.prototype.shouldHaveResult=function(i){if(i===!1){return void (this.resultCheck=null)}if(!this.resultCheck){var j=this;return this.resultCheck=function(k){if(!k.hasResult){console.log(k);var l=new Error(j.name+" failed");throw l.noResult=!0,l}},this}},f.Pipe=e},{}],16:[function(f,g,e){var h=function(i){this.selfOptions=i,this.pipes={}};h.prototype.options=function(i){return i&&(this.selfOptions=i),this.selfOptions},h.prototype.pipe=function(j,i){if("string"==typeof j){if("undefined"==typeof i){return this.pipes[j]}this.pipes[j]=i}if(j&&j.name){if(i=j,i.processor===this){return i}this.pipes[i.name]=i}return i.processor=this,i},h.prototype.process=function(n,k){var l=n;l.options=this.options();for(var m,p,j=k||n.pipe||"default";j;){"undefined"!=typeof l.nextAfterChildren&&(l.next=l.nextAfterChildren,l.nextAfterChildren=null),"string"==typeof j&&(j=this.pipe(j)),j.process(l),p=l,m=j,j=null,l&&l.next&&(l=l.next,j=p.nextPipe||l.pipe||m)}return l.hasResult?l.result:void 0},e.Processor=h},{}]},{},[1])(1)});var hexcase=0;var b64pad="";function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function b64_md5(a){return rstr2b64(rstr_md5(str2rstr_utf8(a)))}function any_md5(a,b){return rstr2any(rstr_md5(str2rstr_utf8(a)),b)}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_md5(a,b){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_md5(a,c,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function md5_vm_test(){return hex_md5("abc").toLowerCase()==="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr_hmac_md5(c,f){var e=rstr2binl(c);if(e.length>16){e=binl_md5(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binl_md5(a.concat(rstr2binl(f)),512+f.length*8);return binl2rstr(binl_md5(d.concat(g),512+128))}function rstr2hex(c){var e=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=e.charAt((a>>>4)&15)+e.charAt(a&15)}return b}function rstr2b64(c){b64pad=b64pad||"";var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var e=0;e<a;e+=3){var g=(c.charCodeAt(e)<<16)|(e+1<a?c.charCodeAt(e+1)<<8:0)|(e+2<a?c.charCodeAt(e+2):0);for(var d=0;d<4;d++){if(e*8+d*6>c.length*8){b+=b64pad}else{b+=f.charAt((g>>>6*(3-d))&63)}}}return b}function rstr2any(m,c){var b=c.length;var l,f,a,n,e;var k=Array(Math.ceil(m.length/2));for(l=0;l<k.length;l++){k[l]=(m.charCodeAt(l*2)<<8)|m.charCodeAt(l*2+1)}var h=Math.ceil(m.length*8/(Math.log(c.length)/Math.log(2)));var g=Array(h);for(f=0;f<h;f++){e=Array();n=0;for(l=0;l<k.length;l++){n=(n<<16)+k[l];a=Math.floor(n/b);n-=a*b;if(e.length>0||a>0){e[e.length]=a}}g[f]=n;k=e}var d="";for(l=g.length-1;l>=0;l--){d+=c.charAt(g[l])}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binl(b){var a=Array(b.length>>2);var c;for(c=0;c<a.length;c++){a[c]=0}for(c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a}function binl2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(h,e,d,c,g,f){return safe_add(bit_rol(safe_add(safe_add(e,h),safe_add(c,f)),g),d)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))}
/*!
  Web Sketchpad. Copyright &copy; 2014 KCP Technologies, a McGraw-Hill Education Company. All rights reserved. 
  Version: Release: 2014Q4, Version: 4.0.0, Build Number: 805.17-r, Build Stamp: dn.kcptech.com/20150205084111
*/
(function(a){(function(){function b(c){if(a.event.props.indexOf(c)===-1){a.event.props.push(c)}}b("touches");b("targetTouches");b("changedTouches")})();a.fn.mousetouch=function(c){var b={};return this.each(function(){var d=a(this);if(c){a.extend(b,c)}d.css("-webkit-user-select","none");d.css("-webkit-touch-callout","none");d.css("-webkit-tap-highlight-color","rgba(0,0,0,0)");d.css("-ms-touch-action","none");d.bind("MSGestureHold",function(){return false});d.bind("contextmenu",function(){return false});d.bind("mousedown.mousetouch-mousedown",function(f){var g=function(k){var i="touchmove",h;if(!k.which&&k.button){if(k.button&1){k.which=1}else{if(k.button&4){k.which=2}else{if(k.button&2){k.which=3}}}}if(k.which>1){return false}if(k.type==="mousedown"){i="touchstart"}else{if(k.type==="mouseup"){i="touchend"}}h=a.Event(i);var j=[{identifier:"mouse0",target:k.target,clientX:k.clientX,clientY:k.clientY,screenX:k.screenX,screenY:k.screenY,pageX:k.pageX,pageY:k.pageY,mouseEvent:k}];h.touches=(i==="touchend")?[]:j;h.targetTouches=h.touches;h.changedTouches=j;d.trigger(h);return !h.isDefaultPrevented()};a(document).bind("mouseup.mousetouch mousemove.mousetouch",function(h){if(h.type==="mouseup"){a(document).unbind(".mousetouch")}return g(h)});return g(f)})})}}(jQuery));(function(e){var k,b;var a,c,f,j,i,h,d;var g;if(window.convertPointFromPageToNode){k=function(m,l){var n=window.convertPointFromPageToNode(this.get(0),new Point(m,l));return{x:n.x,y:n.y}}}if(!k){a=function(u,t){var r=u.length,q=u[0].length,p=t[0].length,o,m,l,n,s=[];for(o=0;o<r;o++){s[o]=[]}for(o=0;o<r;o++){for(m=0;m<p;m++){n=0;for(l=0;l<q;l++){n+=u[o][l]*t[l][m]}s[o][m]=n}}return s};c=function(l,n){var o,p=[];for(o=0;o<l.length;o++){p[o]=l[o].slice(0);p[o][l[o].length-1]+=+n[o]||0}return p};f=function(p){p=p.match(/matrix3?d?\(([^\)]+)\)/i)[1].split(",");if(p.length===6){p=[p[0],p[1],0,0,p[2],p[3],0,0,0,0,1,0,p[4],p[5],0,1]}var o,n,l=[];for(o=0;o<4;o++){for(n=0;n<4;n++){l[o]=l[o]||[];l[o][n]=parseFloat(p[n*4+o])}}return l};j=function(m,p){var o=m.outerWidth(false),l=m.outerHeight(false),n=a(p,[[0,o,0,o],[0,0,l,0,l],[0,0,0,0],[1,1,1,1]]);return{left:Math.min.apply(Math,n[0]),top:Math.min.apply(Math,n[1]),right:Math.max.apply(Math,n[0]),bottom:Math.max.apply(Math,n[1])}};g=f("matrix(1,0,0,1,0,0)");i=function(n){var o=window.getComputedStyle?window.getComputedStyle(n,null)||{}:{},m,l,p=1;function q(u){var t=1,s;if(typeof(u)==="number"){return u}if(u!==undefined&&u!==""&&u!=="normal"){s=u.match(/(\d+|\d+\.\d*)(%?)$/);if(s){t=parseFloat(s[1],10);if(s[2]==="%"){t/=100}}}return t}function r(t){var s=(t.currentStyle&&t.currentStyle.getAttribute)?t.currentStyle.getAttribute("zoom"):undefined;return q(s)}m=(o.msTransform||o.MozTransform||o.OTransform||o.WebkitTransform||"none");p=r(n);if("none"===m){m="matrix(1,0,0,1,0,0)"}l=o.msTransformOrigin||o.MozTransformOrigin||o.OTransformOrigin||o.WebkitTransformOrigin||"";l=l.indexOf("%")!==-1?"":l;l=l.replace(/px/g,"");return{origin:l,transform:m,zoom:p}};d=function(n){var m,l,p,o,q;p=i(n);if(null===p){return null}m=f(p.transform);l=p.origin;l=f("matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+((l||"0 0")+" 0").split(" ").slice(0,3)+",1)");l[0][0]*=p.zoom;l[1][1]*=p.zoom;o=c(g,[-l[0][3],-l[1][3],-l[2][3]]);q=a(a(l,m),o);return q};h=function(m){var l=g,o,p;function n(q){var v=q.offset(),s=q[0],u=s.ownerDocument,t,r;if(u&&u.documentElement.msContentZoomFactor&&u.documentElement.msContentZoomFactor!==1){t=u.defaultView;v.left-=t.pageXOffset;v.top-=t.pageYOffset;r=e("html");v.left+=r.scrollLeft();v.top+=r.scrollTop()}return v}m.parents().each(function(){var q=d(this);if(null!==q){l=a(q,l)}});o=j(m,l);p=n(m);l=c(l,[p.left-o.left,p.top-o.top,0]);return l};k=function(n,m){var l=h(this);return{x:((n-l[0][3])*l[1][1]-(m-l[1][3])*l[0][1])/(l[0][0]*l[1][1]-l[0][1]*l[1][0]),y:(l[0][0]*(m-l[1][3])-l[1][0]*(n-l[0][3]))/(l[0][0]*l[1][1]-l[0][1]*l[1][0])}};b=function(l,o){var n=h(this);var m={x:l*n[0][0]+o*n[0][1]+n[0][3],y:l*n[1][0]+o*n[1][1]+n[1][3]};return m}}e.fn.convertPointFromPage=k;e.fn.convertPageFromPoint=b}(jQuery));if(typeof Object.create!=="function"){Object.create=function(b){var a=function(){};a.prototype=b;return new a()}}(function(l,g,h){var r=l.document,a=l.location,b=l.navigator,C=l.GSP;var y=(function(){function G(I,N,J,L){var M=N[J],K=typeof(M);if(K==="object"){if(!I[J]){I[J]=g.isArray(M)?[]:{}}g.extend(true,I[J],M)}else{if(K==="function"){if(L){L[J]=M}}else{I[J]=M}}}function E(M,L){var J,I,N,K={};for(I=0;I<M.length;I++){N=M[I];if(!N){throw y.createError("copyData() from undefined source!")}for(J in N){G(K,N,J,L)}}return K}function D(J,I){var L={},K=[];J.forEach(function(M){L[M]=true});I.forEach(function(M){L[M]=true});y.eachKeyValue(L,function(M){K.push(M)});return K}function F(K,J){var L={},I=[];K.forEach(function(M){L[M]=true});J.forEach(function(M){if(L[M]!==h){delete L[M]}});y.eachKeyValue(L,function(M){I.push(M)});return I}return{version:{number:"4.0.0",major:"4",minor:"0",patch:"0",build:"805.17-r",release:"2014Q4"},kNormalSpeedRate:3,kIdealFrameRate:60,kWebSpeedMultiplier:0.5,gOptions:{"debug-geom-bounds":false,"graphics-engine":"standard","label-engine":"canvas",instantiateUnsupportedObjects:false,perfTestMode:false},gObjects:{},mixins:{},gConstraints:{},genera:{},signal:function(I){if(I.localize&&I.message){I.message=y.Strings.loc(I.message)}else{if(I.code&&!I.message){I.message=y.Strings.loc(I.code)}}g(r).trigger("gLog",I);return I},log:function(J){if(J.indexOf("%@")>=0){var I=Array.prototype.slice.call(arguments,1);J=y.Strings.format(J,I)}return y.signal({code:"GSP.Debug.log",message:J,logType:"debug"})},logPerf:function(I){return y.signal({code:"GSP.Debug.log",message:I,logType:"perf"})},caseData:function(K,I,J){return y.signal({message:I,logType:"data",gobj:K,data:J})},makeClass:function(P,O){var K,N,J,R,T,Q,U,M={};if(!P){if(console){console.log("makeClass with undefined baseClass")}P={}}if(!g.isArray(P)){P=[P]}function V(X){var aa,Z,Y=[];for(aa=0;aa<X.length;++aa){Z=X[aa];if(Z.baseKinds){Y=D(Y,Z.baseKinds)}if(Z.kind){Y=D(Y,[Z.kind])}}return Y}function I(Y){var aa,Z,X=[];for(aa=0;aa<Y.length;++aa){Z=Y[aa];if(Z.baseGenera){X=D(X,Z.baseGenera)}if(Z.genus){X=D(X,[Z.genus])}}return X}function S(Y){var X=[],ab,aa,Z,ac;for(ab=0;ab<Y.length;++ab){aa=Y[ab];Z=aa&&aa.doc&&aa.doc.usage;ac=Z&&Z.kinds;if(ac){X=D(X,ac)}}return X}function W(X,Y){var Z=[],aa=Y&&Y.doc&&Y.doc.usage;if(aa&&aa.kinds){return g.merge([],aa.kinds)}Z=S(X);if(aa&&aa.addKinds){return D(Z,aa.addKinds)}if(aa&&aa.subKinds){return F(Z,aa.subKinds)}return Z}T=V(P);U=I(P);Q=W(P,O);R=E(P,M);g.extend(true,R,O);if(T&&T.length){R.baseKinds=T}if(U&&U.length){R.baseGenera=U}if(R.doc&&R.doc.usage&&Q.length){R.doc.usage.kinds=Q}function L(Y){var X,Z=0;for(X=0;X<P.length;X++){if(h!==P[X][Y]){Z++}}return Z}for(K in M){J=L(K);if(h!==O[K]){R[K]=O[K];if(1===J){R[K].base=M[K]}else{R[K].base={};for(N=0;N<P.length;N++){R[K].base[N]=P[N][K]}}}else{if(J>1){throw y.createError("Ambiguous multiple inheritance for "+K)}R[K]=M[K]}}return R},makeInstance:function H(N,J,L){var I=Object.create(N),K,M={};for(K in N){if(!L||!L[K]){G(M,N,K)}}g.extend(true,M,J);for(K in M){I[K]=M[K]}return I},stringify:function(J,I){if(l.JSON&&l.JSON.stringify){return l.JSON.stringify(J,I)}return"JSON.stringify not supported"},eachKeyValue:function(K,L){var I,J;for(I in K){J=L.call(K[I],I,K[I]);if(J===false){break}}}}}());y.ConfigDefaults={NumberpadManager:{delegates:{registerElement:function(D){D.WSP_NumberpadManager(g("body"))},registerCalculatorElement:function(D){D.WSP_NumberpadManager(g("body"))},blurAllNumberpads:function(D){D.WSP_NumberpadManager.blurNumpads()}},options:{keyOrder:[["1","2","3"],["4","5","6"],["7","8","9"],["dot","0","negative"],["clear","","backspace"]],keyOrderCalculator:[["1","2","3","plus","lparen"],["4","5","6","minus","rparen"],["7","8","9","star","exponent"],["dot","0","clear","slash","backspace"]]}}};y.getConfigValue=function(E){if(typeof E==="string"){E=E.split(".")}function F(G){for(var H=0;H<E.length;H++){if(G&&typeof G==="object"){G=G[E[H]]}else{return{found:false}}}return{found:true,value:G}}var D=F(l.GSPConfig);if(D.found){return D.value}else{return F(y.ConfigDefaults).value}};jQuery.fn.WSP_NumberpadManager=(function(J){var H,K,F=[],M=0,L={"8":"backspace","9":"tab","13":"submit","27":"esc","32":"space","33":"pageup","34":"pagedown","35":"end","36":"home","37":"left","37-S":"selectleft","38":"up","39":"right","39-S":"selectright","40":"down","45":"insert","46":"delete","48":"0","48-S":"rparen","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","54-S":"exponent","55":"7","56":"8","56-S":"star","57":"9","57-S":"lparen","61-S":"plus","80":"pi","82":"r","84":"t","88":"x","89":"y","96":"0","97":"1","98":"2","99":"3","100":"4","101":"5","102":"6","103":"7","104":"8","105":"9","106":"star","107":"plus","108":"submit","109":"minus","110":"dot","111":"slash","173":"minus","187-S":"plus","188":"comma","188-S":"lessthan","189":"minus","190":"dot","190-S":"greaterthan","191":"slash"};function R(V){var X=V.altKey?"-A":"",T=V.ctrlKey?"-C":"",W=V.metaKey?"-M":"",S=V.shiftKey?"-S":"",U=String(V.which);return[U,X,T,W,S].join("")}function E(S){J.each(F,function(){if(!S||S!==this){this.vBlur()}})}function O(){E();J.each(F,function(){if(this.numpad){J(this.numpad.numpadEl).remove();this.numpad=null}});M=0}function D(){var S=null;J.each(F,function(){var T=this;if(T.hasVFocus){S=T;return}});return S}H=(function(){function S(W,V){return W<=V?W:V}function U(W,V){return W>V?W:V}function T(V,W){this.textNode=V;this.text=J(V).text()||"";this.gobj=W;this.cursor=0;this.rangeEnd=this.cursor;this.collapsed=(this.cursor===this.rangeEnd);this.startWidth=J(V).width()}T.prototype.adjustFieldWidth=function(V){if(!V){var Y=this.getTextWidth(),W=J(this.textNode).width(),X=Math.max(Y+1,this.startWidth);if(W!==X){J(this.textNode).width(X)}}else{J(this.textNode).width("auto")}};T.prototype.setCursor=function(V){this.cursor=V;this.rangeEnd=V;this.collapsed=true;this.render()};T.prototype.unsetCursor=function(){this.cursor=h;this.rangeEnd=h;this.collapsed=h;this.render()};T.prototype.getTextWidth=function(){var V=J(".wsp-numfield-text",this.textNode).width();return V};T.prototype.toString=function(){return"text/cursor/rangeEnd/collapsed = "+[this.text,this.cursor,this.rangeEnd,this.collapsed].join("/")};T.prototype.render=function(){function W(Z){var ad=S(this.cursor,this.rangeEnd),aa=U(this.cursor,this.rangeEnd),ae=this.text.substring(0,ad),Y=this.text.substring(ad,aa),X=this.text.substring(aa),ac=J("<span>"),ab=J("<span>").addClass("wsp-numfield-text");if(this.collapsed){ac.addClass("wsp-blink").html("&#124;")}else{ac.addClass("wsp-selected").text(Y)}if(ae){ab.append(ae)}ab.append(ac);if(X){ab.append(X)}ab.appendTo(Z)}var V=J(this.textNode);V.empty();if(this.cursor!==h&&this.cursor>=0&&this.cursor<=this.text.length){W.call(this,V);this.adjustFieldWidth(false)}else{J("<span>").addClass("wsp-numfield-text").html(this.text).appendTo(V);this.adjustFieldWidth(true)}};T.prototype.moveLeft=function(W){var V=W||1;if(!this.collapsed){this.collapseToStart()}else{this.cursor=Math.max(0,this.cursor-V);this.rangeEnd=this.cursor}this.render()};T.prototype.moveRight=function(W){var V=W||1;if(!this.collapsed){this.collapseToEnd()}else{this.cursor=Math.min(this.text.length,this.cursor+V);this.rangeEnd=this.cursor}this.render()};T.prototype.selectAll=function(){this.rangeEnd=0;this.cursor=this.text.length;this.collapsed=(this.cursor===this.rangeEnd);this.render()};T.prototype.selectLeft=function(W){var V=W||1;this.rangeEnd=Math.max(0,this.rangeEnd-V);this.collapsed=(this.cursor===this.rangeEnd);this.render()};T.prototype.selectRight=function(W){var V=W||1;this.rangeEnd=Math.min(this.text.length,this.rangeEnd+V);this.collapsed=(this.cursor===this.rangeEnd);this.render()};T.prototype.collapse=function(W){var V=W||this.text.length;this.cursor=V;this.rangeEnd=V;this.collapsed=true;this.render()};T.prototype.collapseToStart=function(){this.cursor=S(this.cursor,this.rangeEnd);this.rangeEnd=this.cursor;this.collapsed=true;this.render()};T.prototype.collapseToEnd=function(){this.cursor=U(this.cursor,this.rangeEnd);this.rangeEnd=this.cursor;this.collapsed=true;this.render()};T.prototype.deleteAtCursor=function(W){var V=W||1;if(this.collapsed){this.selectLeft(V)}this.insertAtCursor("")};T.prototype.deleteRight=function(W){var V=W||1;if(this.collapsed){this.selectRight(V)}this.insertAtCursor("")};T.prototype.insertAtCursor=function(V){var Z=this.text,Y=S(this.cursor,this.rangeEnd),W=U(this.cursor,this.rangeEnd),X=[];if(Y>0){X.push(Z.substring(0,Y))}X.push(V);if(W<Z.length){X.push(Z.substring(W))}this.text=X.join("");this.cursor=Y+V.length;this.rangeEnd=this.cursor;this.collapsed=true;this.render()};T.prototype.paste=function(V){this.insertAtCursor(V)};T.prototype.isValueNegative=function(){if(this.text.substring(0,1)==="-"){return true}else{return false}};T.prototype.makeValueNegative=function(){var V;if(this.text.length===0){this.insertAtCursor("-")}else{if(this.text.substring(0,1)!=="-"){V=this.cursor;this.setCursor(0);this.insertAtCursor("-");this.setCursor(V+1);this.render()}}};T.prototype.makeValuePositive=function(){var V;if(this.text.substring(0,1)==="-"){V=this.cursor;this.setCursor(1);this.deleteAtCursor();this.setCursor(V-1);this.render()}};T.prototype.prepare=function(){function X(ab){var ad="",ac;if(ab.numerator===0){ad="0"}else{if(ab.numerator<0){ad="-"}ac=Math.abs(ab.numerator);if(ac!==1){ad+=ac;ad+="*"}ad+="\u03C0";if(ab.denominator!==1){ad+="/";ad+=ab.denominator}}return ad}function Y(ad,ab){var ac=Math.pow(10,ab);return String(Math.round(ad*ac)/ac)}function Z(ae,ab){var ac=y.math.getSimplePiFraction(ae),ad;if(ac){ad=X(ac)}else{ad=Y(ae,ab)}return ad}var aa=this.gobj,W=Math.max(3,aa.style.precision),V=aa.blank?"":Z(aa.uValue,W);J(this.textNode).html(V);this.text=V;this.selectAll()};T.prototype.reset=function(){this.text="";this.cursor=0;this.rangeEnd=0;this.collapsed=true;this.render()};T.prototype.moveUp=function(){};T.prototype.moveDown=function(){};T.prototype.tab=function(){};T.prototype.positionCursorByOffset=function(W){var aa=this.text,V=aa.length,X,Y,Z;Z=W-J(this.textNode).offset().left;X=this.getTextWidth();Y=V?X/V:0;if(Z===h){console.warn("positionCursorByOffset: undefined offset")}if(Z>X){this.setCursor(aa.length)}else{this.setCursor(Math.round(Z/Y))}};T.prototype.submit=function(){J("<p>").addClass("log-entry").html("submitted: "+this.text).appendTo(".log");E()};T.prototype.submit=function(){E()};T.prototype.finishEditing=function(){var V=this.gobj.value;this.gobj.state.selected=false;this.gobj.setEditedValue(this.text);this.gobj.sQuery.sketch.event("EditParameter",{gobj:this.gobj},{oldValue:V,expression:this.text,newValue:this.gobj.value})};return T}(J));var G=-1;function Q(S,U){var T=this;this.editorEl=S;S.parent().on("mouseup",function(W){var V=J(W.target).closest(".mathquill-editable").length;if(!V){T.moveToFarRight()}return true});this.gobj=U}Q.prototype=Object.create(H.prototype);Q.prototype.showCursor=function(){this.editorEl.mathquill("cursor",function(S){S.show()})};Q.prototype.moveToFarRight=function(){this.editorEl.mathquill("cursor",function(S){S.insAtRightEnd(S.root);S.show().clearSelection()})};Q.prototype.tab=function(){this.editorEl.mathquill("cursor",function(U){var T=U.parent,S=1;if(T===U.root){return}U.prepareMove();if(T[S]){U.insAtLeftEnd(T[S])}else{U.insRightOf(T.parent)}})};Q.prototype.selectLeft=function(S){this.editorEl.mathquill("cursor",function(T){T.selectLeft();T.show()})};Q.prototype.paste=function(T){if(T.slice(0,1)==="$"&&T.slice(-1)==="$"){T=T.slice(1,-1)}else{T="\\text{"+T+"}"}var S=this;this.performEdit(function(){S.editorEl.mathquill("cursor",function(U){U.writeLatex(T).show()})})};Q.prototype.selectRight=function(S){this.editorEl.mathquill("cursor",function(T){T.selectRight();T.show()})};Q.prototype.insertAtCursor=function(T,S){this.editorEl.mathquill("cmd",T);if(!S){this.showCursor()}};Q.prototype.ascendTwo=function(){this.editorEl.mathquill("cursor",function(S){S.insRightOf(S.parent.parent)})};Q.prototype.moveRight=function(){this.editorEl.mathquill("cursor",function(S){S.moveRight()})};Q.prototype.insertFunction=function(T){var S=this;this.editorEl.mathquill("cursor",function(V){var U=V.prepareWrite();V.insertCh("(",U);V.hide().parent.blur();V.prepareMove().insLeftOf(V.parent.parent);T(V);V.moveRight();if(U){S.tab()}})};Q.prototype.insertSimpleFunction=function(S){this.insertFunction(function(T){T.insertCh(S)})};Q.prototype.insertParentFunction=function(T){var S=this;this.insertFunction(function(){y.mfs.renderMathquillFromParsedInfix(T,S,S.parents)})};Q.prototype.deleteAtCursor=function(S){this.editorEl.mathquill("cursor",function(T){T.backspace();T.show()})};Q.prototype.deleteRight=function(S){this.editorEl.mathquill("cursor",function(T){T.deleteForward();T.show()})};Q.prototype.moveLeft=function(S){this.editorEl.mathquill("cursor",function(T){T.moveLeft();T.show()})};Q.prototype.moveRight=function(S){this.editorEl.mathquill("cursor",function(T){T.moveRight();T.show()})};Q.prototype.moveUp=function(S){this.editorEl.mathquill("cursor",function(T){T.moveUp();T.show()})};Q.prototype.moveDown=function(S){this.editorEl.mathquill("cursor",function(T){T.moveDown();T.show()})};Q.prototype.insertParent=function(T){var S=this;function U(){var V=0,W;while(true){if(!S.parents[V]){S.parents[V]=T}if(S.parents[V]===T){W={type:"reference",name:String(V),kind:"reference:"+V,children:{},refCount:1,index:0};if(T.isFunction&&T.isFunction()){S.insertParentFunction(W)}else{y.mfs.renderMathquillFromParsedInfix(W,S,S.parents)}return}V++}}S.performEdit(U)};Q.prototype.coalesceParents=function(){var U=0,S={},V=this,T={};J("*[wsp-function-ref], *[wsp-non-function-ref]",this.editorEl).each(function(){var X=J(this),Y=(X.attr("wsp-function-ref")!==h)?"wsp-function-ref":"wsp-non-function-ref",W=X.attr(Y);if(!S[W]){S[W]=U;T[U]=V.parents[W];U++}X.attr(Y,S[W])});V.parents=T};Q.prototype.popTouchRegime=function(){this.gobj.sQuery.sketch.popTouchRegime()};Q.prototype.prepare=function(){var U=this;U.finishEditing=function(){U.popTouchRegime()};U.reset();try{y.mfs.renderMathquillFromParsedInfix(U.gobj.parsedInfix,U,U.gobj.parentsList);U.showCursor()}catch(T){y.signalCaughtError(T)}var S=y.BackClickRegime.createWithEditor(U);U.gobj.sQuery.sketch.pushTouchRegime(S)};Q.prototype.reset=function(){var S=this.gobj;this.parents=S.parents||{};if(S.isFunction()){this.notation=S.functionExpr.notation;this.independentVar=S.functionExpr.independentVar;this.generateEquationOptions()}this.hideErrorNotice();this.editorEl.mathquill("cursor",function(T){T.root.renderLatex("");T.show()})};Q.prototype.setIndependentVar=function(S){this.independentVar=S;J(".wsp-independent-variable",this.editorEl).each(function(){J(this).text(S)})};Q.prototype.registerIndependentVariable=function(){this.editorEl.mathquill("cursor",function(T){var S=T[G];S.jQ.eq(0).addClass("wsp-independent-variable")})};Q.prototype.registerReference=function(T,U,S){this.editorEl.mathquill("cursor",function(W){var V;if(T==="function"){V=W[G].jQ.eq(0)}else{V=W.parent.parent.jQ}V.attr("wsp-"+T+"-ref",U);if(S){V.addClass("wsp-hide")}if(T==="non-function"){W.insRightOf(W.parent.parent)}})};Q.prototype.renderAndSelect=function(S){this.editorEl.mathquill("cursor",function(U){var T=U[G];S();while(U[G]!==T){U.selectLeft()}})};Q.prototype.submit=function(){var S,V=this,U=this.gobj;if(this.errorNoticeIsVisible()){return}function W(){V.coalesceParents();S=V.translateMathQuillToInfix();if(U.isFunction()){U.functionExpr.notation=V.notation;switch(V.independentVar){case"x":U.expressionType="YofX_FunctionExprType";U.functionExpr.dependentVar="y";break;case"y":U.expressionType="XofY_FunctionExprType";U.functionExpr.dependentVar="x";break;case"r":U.expressionType="TofR_FunctionExprType";U.functionExpr.dependentVar="θ";break;case"θ":U.expressionType="RofT_FunctionExprType";U.functionExpr.dependentVar="r";break;default:break}U.functionExpr.independentVar=V.independentVar}if(S){try{y.mfs.getParsedInfixAndFunction(S)}catch(Y){return}var X=U.sQuery.sketch.gobjList;y.ObjectGraph.setParents(X.constraintList,U,V.parents);U.parents=V.parents;U.parentsList=X.createCanonicalParentReferences(U);U.parseInfixExpression(S);U.generateMeasureMFS();U.descendentGraphHasChanged()}}try{W()}catch(T){y.signalCaughtError(T)}E()};Q.prototype.getCalculatorElement=function(){return this.editorEl.closest(".wsp-Calculator")};Q.prototype.showErrorNotice=function(){this.getCalculatorElement().addClass("wsp-syntax-error");J(".wsp-Calculator-ok-button",this.getCalculatorElement()).attr("disabled","true")};Q.prototype.hideErrorNotice=function(){this.getCalculatorElement().removeClass("wsp-syntax-error");J(".wsp-Calculator-ok-button",this.getCalculatorElement()).removeAttr("disabled")};Q.prototype.errorNoticeIsVisible=function(){return this.getCalculatorElement().hasClass("wsp-syntax-error")};Q.prototype.performEdit=function(U){var S;U();try{S=this.translateMathQuillToInfix();y.mfs.getParsedInfixAndFunction(S);this.hideErrorNotice()}catch(T){this.showErrorNotice()}};Q.prototype.translateMathQuillToInfix=function(){function T(Y){function U(Z){var aa;function ag(ai,ah){if(!ah){ah=Z}return ah.children().eq(ai)}var ad=Z.prop("tagName"),af=Z.attr("wsp-function-ref"),ae=Z.attr("wsp-non-function-ref");if(ae!==h){return"(@"+ae+")"}if(af!==h){return"@"+af}if(Z.hasClass("non-leaf")){var ac=ag(0),ab;if(ac.hasClass("sqrt-prefix")){ab=ag(1);return"sqrt("+T(ab.children())+")"}else{if(ac.hasClass("paren")){ab=ag(1);aa=T(ab.children());switch(ac.text()){case"(":return"("+aa+")";case"|":return"abs("+aa+")";default:y.log("unrecognized delimiter: "+ac.text());return"("+aa+")"}}else{if(ac.hasClass("numerator")){ab=ag(1);return"("+T(ac.children())+")/("+T(ab.children())+")"}else{if(ad.toLowerCase()==="sup"){return"^("+T(Z.children())+")"}else{if(!ac.hasClass("cursor")){y.log("unrecognized child of non-leaf: "+ac[0].outerHTML)}}}}}return""}else{if(Z.hasClass("cursor")){return""}else{if(Z.hasClass("selection")){return T(Z.children())}else{if(Z.hasClass("text")){return T(Z.children())}else{if(Z.children().length===0){return Z.text()||""}else{y.log("unrecognized mathquill node: "+Z[0].outerHTML);return""}}}}}}function X(Z){return Z.replace("·","*").replace("⋅","*").replace("\u2212","-").replace("\u0192","f").replace("\xa0","")}var V="";for(var W=0;W<Y.length;W++){V+=X(U(Y.eq(W)))}return V}function S(U){return J("> :not(:first-child)",U)}return T(S(this.editorEl))};function N(){if(!(this instanceof N)){return new N()}}N.prototype={init:function(ab,Y,T,Z){var U,ac,ad,V;this.editedEl=ab;M+=1;this.numpadHome=Y;this.numpadEl=J("<div>").addClass(this.cssClass).prop({id:"numpad"+(M)}).css({position:"absolute"});var W=this.addHeader(Z);this.dragHandle=W.dragHandle;this.editor=this.createEditor(W.editorElt,Z);ad=this.addBody();var aa=y.getConfigValue(this.getConfigKey());for(U=0;U<aa.length;U+=1){V=J("<div>").addClass("wsp-Numberpad-row");for(ac=0;ac<aa[U].length;ac+=1){V.append(this.makeKey(aa[U][ac]))}ad.append(V)}this.initializeKeys(this.numpadEl);if(!T){this.hide()}this.numpadEl.css("visibility","hidden");this.numpadHome.append(this.numpadEl);this.position();this.numpadEl.css("visibility","visible");function S(ag){function ah(ak){var aj=ak.data,ai,al;ak.preventDefault();ai=ak.pageX-aj.touch.dx;al=ak.pageY-aj.touch.dy;aj.numpadEl.offset({left:ai,top:al})}function af(ai){J(r).off("mousemove",ah);J(r).off("mouseup",af)}var ae=ag.data;ag.preventDefault();ae.touch={dx:ag.pageX-J(this).offset().left,dy:ag.pageY-J(this).offset().top};J(r).on("mousemove",ae,ah);J(r).on("mouseup",ae,af)}function X(ai){function ag(ao){var ar=ao.originalEvent,am=ao.data,an=ar.touches.length,aq,al,ap;if(an>=1){ao.preventDefault();aq=ar.touches[0];al=aq.pageX-am.touch.dx;ap=aq.pageY-am.touch.dy;am.numpadEl.offset({left:al,top:ap})}}function ah(al){J(this).off("touchmove",ag);J(this).off("touchend",ah)}var ak=ai.originalEvent,ae=ai.data,af=ak.touches.length,aj;console.log("Touch Ct: "+af);if(af===1){ai.preventDefault();aj=ak.touches[0];ae.touch={dx:aj.pageX-J(this).offset().left,dy:aj.pageY-J(this).offset().top};console.log("Touch offset: "+ae.touch.dx+", "+ae.touch.dy)}J(this).on("touchmove",ae,ag);J(this).on("touchend",ae,ah)}J(this.dragHandle).on("mousedown",this,S);J(this.dragHandle).on("touchstart",this,X)},createEditor:function(S,T){return new H(S,T)},addHeader:function(){var T=J("<div>").addClass("wsp-Numberpad-header");var S=J("<div>").addClass("wsp-Numberpad-cancel");S.appendTo(T);S.on("touchstart mousedown",function(){E()});this.numpadEl.append(T);return{dragHandle:T,editorElt:this.editedEl}},addBody:function(){var S=J("<div>").addClass("wsp-Numberpad-body");this.numpadEl.append(S);return S},getConfigKey:function(){return"NumberpadManager.options.keyOrder"},cssClass:"wsp-Numberpad",keySpecs:{"1":{clss:"wsp-Numberpad-numkey",ent:"1"},"2":{clss:"wsp-Numberpad-numkey",ent:"2"},"3":{clss:"wsp-Numberpad-numkey",ent:"3"},"4":{clss:"wsp-Numberpad-numkey",ent:"4"},"5":{clss:"wsp-Numberpad-numkey",ent:"5"},"6":{clss:"wsp-Numberpad-numkey",ent:"6"},"7":{clss:"wsp-Numberpad-numkey",ent:"7"},"8":{clss:"wsp-Numberpad-numkey",ent:"8"},"9":{clss:"wsp-Numberpad-numkey",ent:"9"},"0":{clss:"wsp-Numberpad-numkey",ent:"0"},dot:{clss:"wsp-Numberpad-numkey",ent:"."},pi:{clss:"wsp-Numberpad-numkey",ent:"&pi;"},plus:{clss:"wsp-Numberpad-control-key",ent:"+"},minus:{clss:"wsp-Numberpad-control-key",ent:"-"},exponent:{clss:"wsp-Numberpad-control-key",ent:"^"},negative:{clss:"wsp-Numberpad-control-key",ent:"&#177;",op:"negative"},star:{clss:"wsp-Numberpad-control-key",ent:"*",op:"insertStar"},slash:{clss:"wsp-Numberpad-control-key",ent:"/"},lparen:{clss:"wsp-Numberpad-control-key",ent:"("},rparen:{clss:"wsp-Numberpad-control-key",ent:")"},backspace:{clss:"wsp-Numberpad-control-key wsp-Numberpad-erase-to-left",ent:"",op:"backspace"},clear:{clss:"wsp-Numberpad-control-key wsp-Numberpad-clear",ent:"",op:"reset"},submit:{clss:"wsp-Numberpad-control-key",ent:"&#10003;",op:"submit"},left:{op:"moveLeft"},right:{op:"moveRight"},up:{op:"moveUp"},down:{op:"moveDown"},tab:{op:"tab"},selectleft:{op:"selectLeft"},selectright:{op:"selectRight"},x:{op:"xPressed"},y:{op:"yPressed"},r:{op:"rPressed"},t:{op:"tPressed"},esc:{op:"doCancel"},"delete":{op:"deleteRight"}},makeKey:function(V){var T=this.keySpecs[V],U;if(T){var S=J("<div/>").html(T.ent).text();U=J("<div>").addClass("wsp-Numberpad-key wsp-Numberpad-element").addClass(T.clss).addClass("wsp-Numberpad-key-"+V).attr("data-keyText",S).data("wsp-key-name",V);T.value=S}else{if(V===""){U=J("<div>").addClass("wsp-Numberpad-element")}else{U=J("<div>").text("?")}}return U},getKeyValue:function(S){return this.keySpecs[S].value},initializeKeys:function(S){J(".wsp-Numberpad-key",S).on("mousedown",this,function(T){T.data.keyPressed(J(this).data("wsp-key-name"));return false})},hide:function(){J(this.numpadEl).hide()},position:function(){var X=this.numpadEl.outerWidth(),ab=this.numpadEl.outerHeight(),aa=J(this.editedEl).outerHeight(),Z=J(this.editedEl).offset(),T=J(r).scrollTop(),S=Z.top-J(r).scrollTop(),U=T+J(l).height()-(Z.top+aa),Y=Z.left,W=U<ab,V=S<ab&&W;if(V){Z.top=T}else{if(W){Z.top-=ab}else{Z.top+=aa}}if(Y<X){if(V){Z.left+=X/2}}else{Z.left-=X}this.numpadEl.offset(Z)},show:function(){J(this.numpadEl).show();this.position()},keyPressed:function(S){var T=this.keySpecs[S];if(T){if(T.op){if(this[T.op]){this[T.op]()}else{this.editor[T.op]()}}else{if(T.value!==h){this.editor.insertAtCursor(T.value)}}}},backspace:function(){this.editor.deleteAtCursor()},negative:function(){if(!this.editor.isValueNegative()){this.editor.makeValueNegative()}else{this.editor.makeValuePositive()}},unpressAllKeys:function(){J(".wsp-Numberpad-key",this.numpadEl).removeClass("wsp-Numberpad-key-down")},submit:function(){this.editor.submit();this.unpressAllKeys()},insertStar:function(){if(this.keySpecs.star.value){this.editor.insertAtCursor("*")}},xPressed:function(){this.insertStar()},doCancel:function(){E()}};function P(){N.apply(this,arguments)}P.prototype=Object.create(N.prototype);P.prototype.keySpecs=J.extend(true,{},N.prototype.keySpecs);P.prototype.createEditor=function(S,T){return new Q(S,T)};P.prototype.keyPressed=function(S){var T=this;this.editor.performEdit(function(){N.prototype.keyPressed.call(T,S)})};P.prototype.addHeader=function(U){var W,V,S,T,X=J("<span>").addClass("wsp-syntax-error-notice");W=J("<div/>").addClass("wsp-Calculator-title");W.text("Edit "+(U.isFunction()?"Function":"Calculation"));S=J("<span/>").mathquill("editable").css("border","none");S.addClass("wsp-calculator-editor");V=J("<div/>").addClass("wsp-Calculator-display").append(S);T=J("<div>").addClass("wsp-Calculator-display-wrapper").append(V).append(X);this.numpadEl.append(W).append(T);return{dragHandle:W,editorElt:S}};P.prototype.insertIndependentVariable=function(S){if(this.editor.gobj.isFunction()&&S===this.editor.independentVar){this.editor.insertAtCursor(S);this.editor.registerIndependentVariable()}};P.prototype.xPressed=function(){this.insertIndependentVariable("x")};P.prototype.yPressed=function(){this.insertIndependentVariable("y")};P.prototype.rPressed=function(){this.insertIndependentVariable("r")};P.prototype.tPressed=function(){this.insertIndependentVariable("θ")};P.prototype.addBody=function(){var Y=this,ab=J("<div/>").addClass("wsp-Calculator-body-wrapper"),aa=J("<div/>").addClass("wsp-Calculator-left"),ah=J("<p/>").addClass("wsp-Calculator-label-insert").text("Insert:"),ak=function(au,aw,at){var aq=J("<div/>").addClass("dropdown"),ax=J("<ul/>").addClass("dropdown-menu"),ar=J("<button/>").addClass("dropdown-toggle").attr("data-toggle","dropdown").addClass("wsp-Calculator-textual").text(aw).append(J("<span/>").addClass("caret"));aq.append(ar).append(ax);if(at){for(var av=0;av<at.length;av++){ax.append(at[av])}}return aq},T=function(){return J("<button/>").addClass("wsp-Calculator-textual").addClass("wsp-Calculator-bottom-button")},W=function(aq){return aq.addClass("wsp-Calculator-select-for-insert")},Z=function(){return J("<li/>").addClass("divider")},ag=function(ar,au,at){var aq=J("<a/>").data("value",ar).text(au?au:ar);if(at){aq.css("font-style","italic")}return J("<li/>").append(aq)},U=function(ar,aq,at){J("a",ar).data(aq,at);return ar},aj=function(aq,ar){J("a",aq).text(ar);return aq},V=function(ar,aq){J("a",ar).addClass(aq);return ar},ai=function(){return V(ag("","",true),("wsp-independent-variable-option"))},al=function(aq){return aq.addClass("selected")},ap=ak("values","Values",[Z(),ai(),Z(),ag("pi","π",true),ag("e","e",true)]).addClass("wsp-Calculator-topmost-select-for-insert"),am=W(ak("functions","Functions",[Z(),ag("function","sin"),ag("function","cos"),ag("function","tan"),ag("function","Arcsin"),ag("function","Arccos"),ag("function","Arctan"),Z(),ag("|","abs"),ag("\\sqrt","sqrt"),ag("function","ln"),ag("function","log"),ag("function","sgn"),ag("function","round"),ag("function","trunc")])).addClass("wsp-select-function"),S=W(ak("units","Units",[Z(),ag("pixels"),ag("cm"),ag("inches"),Z(),ag("radians"),ag("degrees")])).addClass("wsp-select-units"),af=J("<div/>").addClass("wsp-Calculator-body"),ad=J("<div/>").addClass("wsp-Calculator-bottom"),X=ak("equation","Equation",[]).addClass("wsp-Calculator-select-equation"),ac=T().text("Cancel"),ao=T().addClass("wsp-Calculator-ok-button").append(J("<span/>").addClass("wsp-Calculator-ok-button-inner").text("OK"));J(ac).on("click",function(){Y.doCancel()});J(ao).on("click",function(){Y.editor.submit()});aa.append(ah).append(ap).append(am).append(S);J("a",aa).on("click",function(ar){var aq=J(this),at=aq.data("value");Y.editor.performEdit(function(){if(at==="function"){Y.editor.insertSimpleFunction(aq.text())}else{Y.editor.insertAtCursor(at);if(aq.hasClass("wsp-independent-variable-option")){Y.editor.registerIndependentVariable()}}})});ab.append(aa).append(af);if(!Y.editor.gobj.isFunction()){X.css("visibility","hidden")}function an(au,aq){var at=J(".dropdown-menu",au);at.empty();for(var ar=0;ar<aq.length;ar++){at.append(aq[ar])}}function ae(){var aq=J(".wsp-independent-variable-option",ap).parent();U(aq,"value",Y.editor.independentVar);aj(aq,Y.editor.independentVar)}Y.editor.generateEquationOptions=function(){var au,aq=Y.editor.independentVar;function ar(){switch(aq){case"x":return"y";case"y":return"x";case"r":return"θ";case"θ":return"r"}throw y.createError("unrecognized independent variable")}function at(ay,aw){var ax=ag(aw);U(ax,"independentVar",ay);return(aq===ay)?al(ax):ax}function av(){var ax=ag(ar()+"= notation"),aw=ag("f("+aq+") notation");U(ax,"notation","dependentVariable");U(aw,"notation","function");if(Y.editor.notation==="function"){aw=al(aw)}else{ax=al(ax)}return[Z(),ax,aw,Z()]}au=av().concat([at("x","y = f(x)"),at("y","x = f(y)"),at("θ","r = f(θ)"),at("r","θ = f(r)")]);an(X,au);ae();J("a",X).on("click",function(az){var ax=J(this),aw=ax.data("independentVar"),ay;if(aw){Y.editor.setIndependentVar(aw)}else{ay=ax.data("notation");if(ay){Y.editor.notation=ay}}Y.editor.generateEquationOptions()})};ad.append(X).append(ac).append(ao);this.numpadEl.append(ab).append(ad);J(".dropdown-toggle",this.numpadEl).dropdown();return af};P.prototype.getConfigKey=function(){return"NumberpadManager.options.keyOrderCalculator"};P.prototype.cssClass="wsp-Calculator";function I(T,S){if(!(this instanceof I)){return new I(T)}J(T).css({"-webkit-user-select":"none","-moz-user-select":"none","-ie-user-select":"none","user-select":"none"});this.editedEl=T;this.numpadParent=S;this.hasVFocus=false;this.numpad=null;F.push(this)}I.prototype={createNumpad:function(S){if(S.isParameter()){this.numpad=new N();this.numpad.init(this.editedEl,this.numpadParent,true,S)}else{this.createCalculator(S)}},createCalculator:function(S){this.numpad=new P();this.numpad.init(this.editedEl,this.numpadParent,true,S)},vFocus:function(T){var S=this;E();l.setTimeout(function(){S.hasVFocus=true;if(!S.numpad){S.createNumpad(T)}else{S.numpad.show()}S.numpad.editor.prepare()},0)},vBlur:function(){if(this.hasVFocus){this.numpad.editor.unsetCursor();this.numpad.editor.finishEditing();this.hasVFocus=false;this.numpad.hide()}},click:function(S,T){if(S.stopPropagation){S.stopPropagation()}if(!this.hasVFocus){this.vFocus(T)}else{this.numpad.editor.positionCursorByOffset(S.pageX)}},paste:function(T){var S=T.getData("text/plain");this.numpad.editor.paste(S)}};K=function(){var S;J(r).on("paste",function(U){var T=D();if(T){T.paste(U.originalEvent.clipboardData);return false}return true});J(r).on("WillChangeCurrentPage.WSP UnloadDocument.WSP",function(){O()});J(r).on("keydown keyup",function(X){var V=D(),T,U,W;if(V){T=V.numpad;U=R(X);W=L[U];if(W){X.preventDefault();if(X.type==="keydown"){J(".wsp-Numberpad-key-"+W,T.numpadEl).addClass("wsp-Numberpad-key-down");T.keyPressed(W)}else{J(".wsp-Numberpad-key-"+W,T.numpadEl).removeClass("wsp-Numberpad-key-down")}}}});S=function(T){this.each(function(){var U=new I(this,T);J(this).data("wsp-numfield-ctl",U)})};S.blurNumpads=function(){E()};return S};return new K()}(jQuery));y.EventEmitter=(function(){var E={events:["StartCurrentPage","StopCurrentPage","LoadDocument","UnloadDocument","WillChangeCurrentPage","DidChangeCurrentPage","LoadPage","UnloadPage","StartSketchFrame","EndSketchFrame","StartDrag","MoveDrag","EndDrag","StartScroll","MoveScroll","EndScroll","PressButton","EditParameter"],trigger:function(K,I,G){var F=K+".WSP",J;if(this.events.indexOf(K)<0){throw y.createError("Unregistered event triggered: "+K)}g(this.canvasNode).trigger(F,[I,G]);try{J=new CustomEvent(F,{detail:{context:I,attributes:G}});this.canvasNode[0].dispatchEvent(J)}catch(H){}},getAvailableEvents:function(){var F=this.events;return F.map(function(G){return G+".WSP"})}};var D=function(F){var G=Object.create(E);G.canvasNode=F;return G};return D}());y.createError=function(F,E){var D=new Error(F);D.code=E;return D};y.signalCaughtError=function(D){return y.signal({message:D.message,error:D,stack:D.stack,logType:"error",code:D.code||"GSP.Error.uncodedError"})};y.signalErrorWithCode=function(F,E){var H=[F].concat(E),G=y.Strings.loc.apply(y.Strings,H),D=y.createError(G,F);this.signalCaughtError(D)};y.signalErrorWithMessage=function(F,E){var D=y.createError(F,E);this.signalCaughtError(D)};y.Prefs=(function(){var D={units:{length:"cm",angle:"deg"},precision:{length:2,angle:2,scalar:2},fadeTraces:false,fadeHalfLife:5,fadeSaturationFloor:0.0625,colorableComponents:{Points:{color:"red"},Straights:{color:"navy"},Curves:{color:"green"},Interior:{color:"rgb(138,102,217)"},Plot:{color:"purple"},PointLocus:{color:"maroon"},Selection:{color:"rgb(195,0,195)"},Background:{color:"white"},CoordSys:{color:"silver"},TextGObject_BackgroundContrast:{color:"black"},ActionButton:{color:"rgb(255,165,0)"},LabelText_BackgroundContrast:{color:"black"},Axis:{color:"rgb(96,96,96)"},AngleMarker:{color:"rgb(64,64,64)"},Picture:{color:"red"}},text:{mathItalicization:true,textTypes:{Label:{"font-family":"Times","font-size":24,"font-weight":"bold","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"},Caption:{"font-family":"Times","font-size":16,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black",padding:"2px 4px"},Measurement:{"font-family":"Times","font-size":18,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"},Action:{label:{"font-family":"Arial","font-size":16,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"}},Table:{"font-family":"Arial","font-size":14,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"},AxisTicksAndOptionalLabel:{"font-family":"Geneva","font-size":14,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black",label:{"font-family":"Geneva","font-size":14,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"}}}}};return D}());y.SketchEvent=function(E,D){if(!(this instanceof y.SketchEvent)){return new y.SketchEvent(E,D)}this.type=E;if(D){g.extend(this,D)}this.timeStamp=this.timeStamp||g.now()};y.SketchEventHandler=(function(){var D=function(){},I=1,F=1;function J(K,N){var M,L;for(L=0;L<N.length;L++){M=N[L];if(!K[M]){K[M]={}}K=K[M]}return K}function H(K,N){var M,L;for(L=0;L<N.length;L++){M=N[L];K=K[M];if(K===h){break}}return K}function E(K){var L;if(g.isArray(K)){L=K.slice();L.sort()}else{L=[K]}return L}g.extend(D,{emitterIDFromTargetList:function(K,L){var N=J(this.targetsIDMap,[L]),M=J(N,K);if(M.result===h){M.result=F++}return M.result},addHandler:function(K,N,O){var P=E(K),Q=this.emitterIDFromTargetList(P,N),L,M;if(!O.wspguid){O.wspguid=I++}L=J(this.handlers,[O.wspguid]);if(L.refCount){L.refCount++}else{L.refCount=1;L.handler=O}if(!this.emitters[Q]){this.emitters[Q]={type:N,targets:P,handlerID:[]}}this.emitters[Q].handlerID.push(O.wspguid);for(M=0;M<P.length;M++){J(this.triggers,[P[M],N])[Q]=true}},removeHandler:function(K,N,O){var R=this.emitterIDFromTargetList(E(K),N),Q=this.emitters[R],P=O.wspguid,M,L;if(!Q){y.signalErrorWithMessage("removeHandler called on unknown target "+K);return}if(this.handlers[P].refCount===1){delete this.handlers[P]}else{this.handlers[P].refCount--}Q.handlerID.splice(Q.handlerID.lastIndexOf(P),1);if(0===Q.handlerID.length){for(M in this.triggers){for(L in this.triggers[M]){delete this.triggers[M][L][R]}}delete this.emitters[R];delete this.sketchEventList[R]}},raiseSketchEvent:function(K,M){var L=H(this.triggers,[K,M]),N;if(!L){return}for(N in L){J(this.sketchEventList,[N,M])[K]=true}},processOneSketchEvent:function(Q){var N,M,O,L,P,K={};N=this.emitters[Q];M=this.handlers[N.handlerID];for(L=0;L<N.targets.length;L++){P=N.targets[L];K[P]=H(this.sketchEventList,[Q,N.type,P])?true:false}O=new y.SketchEvent(N.type,{targetMap:K});if(this.sketchEventPreprocessor){this.sketchEventPreprocessor(O)}for(L=0;L<N.handlerID.length;L++){M=this.handlers[N.handlerID[L]].handler;M(O)}},processSketchEvents:function(){var K;for(K in this.sketchEventList){this.processOneSketchEvent(K)}this.sketchEventList={};this.frameIndex++},getFrameIndex:function(){return this.frameIndex},hasSketchEvents:function(){return !g.isEmptyObject(this.sketchEventList)}});function G(K){this.sketchEventPreprocessor=K;this.targetsIDMap={};this.triggers={};this.emitters={};this.handlers={};this.sketchEventList={};this.frameIndex=0}G.prototype=D;return G}());(function(H){var G=(function(){var I=/iP(ad|hone|od).*OS 6/.test(l.navigator.userAgent),N=0,K=l.requestAnimationFrame||null,O=l.cancelAnimationFrame||null,J={};["webkit","moz"].forEach(function(P){K=K||l[P+"RequestAnimationFrame"]||null;O=O||l[P+"CancelAnimationFrame"]||l[P+"CancelRequestAnimationFrame"]||null});function M(T,Q){var P=new Date().getTime();var R=Math.max(0,16-(P-N));var S=l.setTimeout(function(){T(P+R)},R);N=P+R;return S}function L(P){clearTimeout(P)}J.nextFrame=(!I&&K!=null)?K:M;J.cancelFrame=(!I&&O!=null)?O:L;return J})();var F=G.nextFrame;var E=G.cancelFrame;var D={_preprocessJobs:null,_modelJobs:null,_renderJobs:null,_tick:function(){var L=new Date().getTime(),J,N,I;function K(P){if(P.scheduledFireTime<=L){try{if(P.callback()===false){P.isActive=false}}catch(O){O.message="Error executing job: "+O.message;P.isActive=false;H.signalCaughtError(O)}if(P.repeat){P.scheduledFireTime=L+P.delay}else{P.isActive=false}if(!P.isActive&&P.doneCallback){P.doneCallback("finished")}}}J=this._preprocessJobs.slice();J.forEach(K);L=new Date().getTime();N=this._modelJobs.slice();N.forEach(K);L=new Date().getTime();I=this._renderJobs.slice();I.forEach(K);function M(O){return O.isActive}this._preprocessJobs=this._preprocessJobs.filter(M);this._modelJobs=this._modelJobs.filter(M);this._renderJobs=this._renderJobs.filter(M);if((this._preprocessJobs.length+this._modelJobs.length+this._renderJobs)>0){this._requestAnimFrameIfNeeded()}},_animFrameHandle:null,_requestAnimFrameIfNeeded:function(){var I=this;if(this._animFrameHandle!==null){return}this._animFrameHandle=F(function(){I._animFrameHandle=null;I._tick()})},addJob:function(M,L){L=L||{};var K=L.delay||0;var J;if(K>0){J=new Date().getTime()+K}else{J=0}var I={callback:M,delay:K,scheduledFireTime:J,repeat:L.repeat,doneCallback:L.done,queue:L.priority||"model",isActive:true};if(I.queue==="preprocess"){this._preprocessJobs.push(I)}else{if(I.queue==="render"){this._renderJobs.push(I)}else{this._modelJobs.push(I)}}this._requestAnimFrameIfNeeded();return I},clearJob:function(K){var J;if(K.queue==="preprocess"){J=this._preprocessJobs}else{if(K.queue==="render"){J=this._renderJobs}else{J=this._modelJobs}}var I=J.indexOf(K);if(I===-1){throw H.createError("Job Scheduler.clearJob() called on a unscheduled job")}J.splice(I,1);K.isActive=false;if(K.doneCallback){K.doneCallback("cancelled")}if((this._preprocessJobs.length+this._renderJobs.length+this._modelJobs.length)===0){E(this._animFrameHandle);this._animFrameHandle=null}},clearAllJobs:function(){function I(J){J.isActive=false;if(J.doneCallback){J.doneCallback("cancelled")}}this._preprocessJobs.forEach(I);this._modelJobs.forEach(I);this._renderJobs.forEach(I);this._preprocessJobs=[];this._modelJobs=[];this._renderJobs=[];if(this._animFrameHandle!==null){E(this._animFrameHandle);this._animFrameHandle=null}}};H.JobScheduler={create:function(){var I=Object.create(D);I._preprocessJobs=[];I._modelJobs=[];I._renderJobs=[];return I},isActive:function(I){return !!(I&&I.isActive)}}}(y));(function(D){D.ObjectGraph={convertObjectSpec:function(L,E,I){var G=[],H={},F=I||0,K={};g.extend(H,E);D.eachKeyValue(L,function J(M,O){if(!H[M]){K[M]=true;if(O.parents){var N={};g.each(O.parents,function(P,R){var Q=H[R];if(!Q){if(K[R]){throw D.createError("Circular reference in object graph")}if(!L[R]){throw D.createError("Unknown parent id encountered building object graph: "+R)}J(R,L[R]);Q=H[R]}if(Q.children===h){Q.children=[]}Q.children.push(O);N[P]=Q});O.parents=N}O.id=M;O.topologicalIndex=F++;G.push(O);H[M]=O;K[M]=false}});return G},subgraphFromNode:function(H,K){var L={},G=K?g.extend({},K):{},F={},I=[H];G[H.id]=H;g.extend(L,G);function E(M){L[M.id]=M;if(M.children){M.children.forEach(function(N){if(!L[N.id]){E(N)}})}}function J(M){if(G[M.id]){return true}if(F[M.id]){return false}var N=!!L[M.id];if(N&&M.parents){g.each(M.parents,function(P,O){if(!J(O)){N=false;return false}})}if(!N){F[M.id]=M;return false}else{G[M.id]=M;I.push(M);return true}}E(H);g.each(L,function(M,N){J(N)});return I},getNextFreeIdNumber:function(E){var F=0,G=false;E.forEach(function(H){var I=parseInt(H.id,10);if(isNaN(I)){G=true;return false}if(I>F){F=I}});if(!G){return(F+1)}},setParents:function(G,I,H){var E;I.parents={};if(H===h||H.length===0){return}g.each(H,function(J,L){I.parents[J]=L;if(L.children===h){L.children=[]}if(L.children.indexOf(I)===-1){L.children.push(I)}var K=L.topologicalIndex;if(E===h||E<K){E=K}});I.topologicalIndex=E+1;function F(K){if(K.children){var J=K.topologicalIndex;K.children.forEach(function(L){if(L.topologicalIndex<=J){L.topologicalIndex=J+1;F(L)}})}}F(I);G.sort(function(K,J){return Number(K.topologicalIndex)-Number(J.topologicalIndex)})},createSpecFromGraph:function(E){var F={};E.forEach(function(H){var G=g.extend({},H);F[G.id]=G;G.id=h;G.topologicalIndex=h;G.children=h;if(G.parents){var I={};g.each(G.parents,function(J,K){I[J]=K.id});G.parents=I}});return F},copy:function(E){return this.convertObjectSpec(this.createSpecFromGraph(E))},mergeToNode:function(F,I,H){if(H.parents){throw D.createError("ObjectGraph.mergeToNode() merging non-free node")}if(!I.children){I.children=[]}if(H.children){I.children=I.children.concat(H.children);H.children.forEach(function(L){g.each(L.parents,function(M,N){if(N===H){L.parents[M]=I}})})}var G,E=F.length;var J,K;for(G=0;G<E;++G){if(F[G]===H){J=G}if(F[G]===I){K=G}}if(K>J){F[J]=F[K];F.splice(K,1)}else{F.splice(J,1)}},deleteNode:function(L,E){var H={},F;if(L.indexOf(E)===-1){throw D.createError("ObjectGraph.deleteNode() called on node not in graph")}function M(N){return(H[N.id]!==h)}function J(N){H[N.id]=N}function K(N){var O=N.parents,P,S,R=L.indexOf(N);if(O){for(var Q in O){if(O.hasOwnProperty(Q)){P=O[Q];if(!M(P)){S=P.children.indexOf(N);P.children.splice(S,1)}}}}if(R!==-1){L.splice(R,1)}}function G(N){J(N);if(N.children){N.children.forEach(function(O){if(!M(O)){G(O)}})}}G(E);for(var I in H){if(H.hasOwnProperty(I)){F=H[I];K(F)}}return Object.keys(H)}}}(y));y.GObjList=(function(){var D=function(){};g.extend(D,{createCanonicalParentReferences:function(F){function H(K){var J,I=[];K.sort(function(N,M){var L,P,O=y.BapEdgeInfo[F.constraint];if(O&&O[N.name]){L=O[N.name].sortIndex}if(O&&O[M.name]){P=O[M.name].sortIndex}if((h===L)&&(h===P)){L=parseInt(N.name,10);P=parseInt(M.name,10)}if((h===L)&&(h===P)){if(N.name<M.name){return -1}if(N.name>M.name){return 1}return 0}if(h===L){return 1}if(h===P){return -1}return L-P});for(J=0;J<K.length;J++){I.push(K[J].gobj)}return I}var G=[];if(F.parents){g.each(F.parents,function(I,J){G.push({name:I,gobj:J})});return H(G)}return[]},mergeToGObj:function(H,G,I){var F=this;if(G.constraint!=="Free"){throw y.createError("mergeToGObj called with illegal constraint:"+G.constraint)}delete this.gobjects[G.id];y.ObjectGraph.mergeToNode(this.constraintList,H,G);if(H.children){H.children.forEach(function(J){J.parentsList=F.createCanonicalParentReferences(J)})}if(!H.label){H.label=G.label}if(G.destroy){G.destroy()}I.renderCleanupGObj(G);H.descendentGraphHasChanged();this.renderList=y.createRenderList(this.constraintList)},addGObjects:function(K,M){var H=this;function N(P){P.toDelete=true;for(var O=0;O<P.children.length;++O){P.children[O].toDelete=true}}var F=0;if(this.constraintList.length>0){F=this.constraintList[this.constraintList.length-1].topologicalIndex+1}var G=y.ObjectGraph.convertObjectSpec(K,this.gobjects,F),J,I;this.constraintList=this.constraintList||[];this.renderList=this.renderList||[];for(I=0;I<G.length;++I){J=G[I];try{if(J.state.supported&&!J.toDelete){H.gobjects[J.id]=J;this.constraintList.push(J);J.parentsList=H.createCanonicalParentReferences(J);J.doPostReadFromSpec();J.init();if(M){y.addToRenderList(this.renderList,J);M(J)}}else{N(J)}}catch(L){L.message='Initializing "'+(J?J.id:"Unknown GObject")+'": '+L.message;y.signalCaughtError(L);J.toDelete=true}}if(!M){this.renderList=y.createRenderList(this.constraintList)}for(I=G.length-1;I>=0;--I){J=G[I];if(J.toDelete){y.ObjectGraph.deleteNode(G,J)}}},removeGObjects:function(F,I){var H=this,G=Object.keys(F),J=[];G.forEach(function(M){var L=H.gobjects[M],K;if(J.indexOf(M)!==-1){return}if(L){K=y.ObjectGraph.deleteNode(H.constraintList,L);J=J.concat(K)}});J.forEach(function(L){var K=H.gobjects[L];if(K){I.invalidateRect(K.getGeomBounds());if(K.destroy){K.destroy()}I.renderCleanupGObj(K)}delete H.gobjects[L]});this.renderList=y.createRenderList(this.constraintList)}});function E(F){this.gobjects={};if(F){this.addGObjects(F)}else{this.constraintList=y.ObjectGraph.convertObjectSpec({})}}E.prototype=D;return E}());y.SQuery=(function(I){var J=[];J.getSketch=function(){return this.sketch};J.findDottedProperty=function(V,U,T){var S=U.split("."),R,W=V;for(R=0;R<S.length;R+=1){if(typeof W!=="object"){return}W=W[S[R]]}if(typeof T==="undefined"){return W}if(typeof W!=="undefined"){return T(W)}};J.each=function(S){var R;for(R=0;R<this.length;R+=1){S.call(this[R],R,this[R])}return this};J.hide=function(){this.each(function(R,S){S.hide()});return this};J.show=function(){this.each(function(R,S){S.show()});return this};J.invalidateGeom=function(R){this.getSketch().invalidateGeom(R)};J.showLabel=function(){var R=this.getSketch();this.each(function(S,T){if(!T.style){T.style={}}if(!T.style.label){T.style.label={}}T.style.label.showLabel=true;R.invalidateAppearance(T)});return this};J.hideLabel=function(){var R=this.getSketch();this.each(function(S,T){if(!T.style){T.style={}}if(!T.style.label){T.style.label={}}T.style.label.showLabel=false;R.invalidateAppearance(T)});return this};J.get=function(S){var R=this.getSketch();return R.gobjList.gobjects[S]};J.dirty=function(){this.getSketch().isDirty=true};J.eraseTraces=function(){this.getSketch().clearTraces()};J.stopMotions=function(){};J.attr=function(U,X){function T(ag,ae,ac,ad){var ab=ac.split("."),af=ae,aa,Z;for(aa=0;aa<ab.length-1;aa+=1){Z=I.trim(ab[aa]);if(!af[Z]){af[Z]={}}af=af[Z]}if(I.type(ad)==="function"){af[I.trim(ab[ab.length-1])]=ad.call(ae,aa,ae)}else{af[I.trim(ab[ab.length-1])]=ad}}function W(ad,ac){var ab=ac.split("."),ae=ad,aa,Z;for(aa=0;aa<ab.length;aa+=1){Z=I.trim(ab[aa]);if(typeof ae[Z]==="undefined"){return}ae=ae[Z]}return ae}var Y=this.getSketch(),R="",S,V;if(X!==h&&X.length!==0){this.each(function(aa,ab){var Z;if(this){Z=W(this,U);if(Z!==h){T(aa,ab,U,X);Y.invalidateGeom(ab)}else{if(this.style){Z=W(this,"style."+U);if(Z!==h){T(aa,ab,"style."+U,X);Y.invalidateGeom(ab)}}}}})}if(I.type(U)==="object"){S=U;for(V in S){if(S.hasOwnProperty(V)){R=this.attr(V,S[V])}}}else{if(I.type(U)==="string"){if(this[0]){R=W(this[0],U)}if((R===h)&&this[0].style){R=W(this[0],"style."+U)}}}return R};J.parents=function(){var S,T,U,V,R;V=this.getSketch();R=new V.sQuery();for(S=0;S<this.length;S+=1){U=this[S];if(U.parents){for(T in U.parents){if(U.parents.hasOwnProperty(T)){R.push(U.parents[T])}}}}return R};J.press=function(R){var S=this.getSketch();this.each(function(T,U){if(U.press){if(h===R||R!==U.state.isActive){S.constrain();U.press(S);S.constrainAndRedraw()}}});return this};J.value=function(R){var S=this.getSketch();if(h===R){if(this[0].uValue!==h){return this[0].uValue}if(this[0].value!==h){return this[0].value}if(this[0].geom&&this[0].geom.loc){return this[0].geom.loc}return h}this.each(function(T,U){if(U.updateValue){U.updateValue(R)}else{if(U.geom&&U.geom.loc&&jQuery.isPlainObject(R)){U.geom.loc.x=R.x;U.geom.loc.y=R.y;S.invalidateGeom(U)}}});return this};J.prefs=function(){return this.getSketch().preferences};J.getResource=function(S,R){var T=this.getSketch().document.resources[S];return T&&T[R]};J.getSketchDelta=function(){var S=this.getSketch(),R=S.document.getPageDeltaObj(S.metadata.id);return JSONcanonical.stringify(R)};J.applySketchDelta=function(S){var R,T=this.getSketch();if(typeof S==="string"){R=JSON.parse(S)}else{R=S}T.document.applyDeltaToActivePage(R)};J.getSketchJSON=function(){return this.getSketch().document.getDocumentJSON()};J.toString=J.getSketchJSON;function O(S,T,W){var V=this.getSketch(),R=V.getCurrentPageId(),U=S.split(" ");this.each(function(X,Y){I.each(U,function(Z,aa){W.call(V.document,R,Y.id,aa,T)})})}function K(S,U,X){var W=this.getSketch(),R=W.getCurrentPageId(),V=S.split(" "),T=[];this.each(function(Y,Z){T.push(Z.id)});I.each(V,function(Y,Z){X.call(W.document,R,T,Z,U)})}J.on=function(R,S){O.call(this,R,S,this.getSketch().document.bindGObjEvent)};J.off=function(R,S){O.call(this,R,S,this.getSketch().document.unbindGObjEvent)};J.onGroup=function(R,S){K.call(this,R,S,this.getSketch().document.bindGObjEvent)};J.offGroup=function(R,S){K.call(this,R,S,this.getSketch().document.unbindGObjEvent)};function F(U,S,T){var R;for(R in S){if(S.hasOwnProperty(R)){T[R]=S[R]}}}function N(W,U,T,V){var S,R;for(S in T){if(T.hasOwnProperty(S)){R=J.findDottedProperty(T[S],W);if(typeof R==="undefined"){R=J.findDottedProperty(T[S],"style."+W)}if(U===R){V[S]=T[S]}}}}function D(R,S,T){T[R.name]=S[R.name]}function M(S,U,V){var R,T=new RegExp("\\b"+S.name+"\\b");for(R in U){if(U.hasOwnProperty(R)){if(U[R]["class"]&&(T.test(U[R]["class"]))){V[R]=U[R]}}}}function P(R,S,T){N("kind",R.name,S,T)}function H(R,T,V){var S=R.name,U=R.value;N(S,U,T,V);N("style."+S,U,T,V)}var G={attr:H,"class":M,global:F,id:D,kind:P};function L(R,V,Y){var U,T,X=R.parts,W=V,S;for(T=0;T<X.length;T+=1){U=G[X[T].type];if(T===X.length-1){S=Y}else{S={}}U(X[T],W,S);W=S}}function E(S,T,V){var R,U;for(R=0;R<S.length;R+=1){U=S[R];if(U.type==="global"){F(U,T,V)}else{if(U.type==="id"){D(U,T,V)}else{if(U.type==="class"){M(U,T,V)}else{if(U.type==="kind"){P(U,T,V)}else{if(U.type==="attr"){H(U,T,V)}else{if(U.type==="selectorAnd"){L(U,T,V)}else{y.log("Unclassified squery selector: "+U)}}}}}}}}function Q(R){var S=function S(T){if(!(this instanceof S)){return new S(T)}var V,U,Y=R.getFocusPage?R.getFocusPage():R,W=(Y.gobjList&&Y.gobjList.gobjects)||{},X={};this.sketch=R;if(T!==h){if(I.isArray(T)){V=T}else{if(I.type(T)==="string"){V=y.squerySelector.parse(T)}else{V=[]}}E(V,W,X);for(U in X){if(X.hasOwnProperty(U)){this.push(X[U])}}}};S.sketch=R;S.prototype=J;return S}return Q}(jQuery));y.PerfMonitor=(function(E){var I,D,G,F;var H=1000/60;D={clear:function(){this.data={}},set:function(K,J){this.data[K]=J},get:function(J){return this.data[J]},increment:function(L,J){var K=J||1;if(typeof this.data[L]!=="number"){this.data[L]=K}else{this.data[L]+=K}},log:function(K,J){if(typeof this.logs[K]==="undefined"){this.logs[K]=[]}this.logs[K].push(J)}};I=function(){var J=Object.create(D);J.data={};J.logs={};return J};F=function(){var J=Object.create(G);J.stats=new I();J.stats.set("Start",J.now());J.times={idle:h,active:h,constrain:h,render:h,fade:h};return J};G={now:function(){if(l.performance&&l.performance.now){return l.performance.now()}else{return E.now()}},getFrameCount:function(){return this.stats.get("Activation Count")},animFrameHandler:function(){var N=this.times.idle,M=this.times.active,K=this.now(),L=K-N,O=K-M,J=L,P=Math.max(0,(L/H)-1);this.times.last=N;this.times.frame=O;this.times.active=K;this.times.constrain=this.times.render=this.times.fade=h;this.stats.increment("Activation Count");this.stats.increment("Idle Accum",J);if(P>0){this.stats.increment("Activation Missed",Math.round(P))}},constrainHandler:function(){this.times.constrain=this.now();this.stats.increment("Constrain Count");this.stats.increment("Touch Accum",this.times.constrain-this.times.active)},renderHandler:function(){this.times.render=this.now();this.stats.increment("Render Count");this.stats.increment("Constrain Accum",this.times.render-this.times.constrain)},fadeHandler:function(){this.times.fade=this.now();this.stats.increment("Fade Count");if(typeof this.times.render!=="undefined"){this.stats.increment("Render Accum",this.times.fade-this.times.render)}},idleHandler:function(){var J=this.now(),K=J-this.times.active;this.stats.increment("Idle Count");this.times.idle=J;this.stats.increment("Active Accum",K);if(K>this.FRAME_INTERVAL){this.stats.increment("Late Frames")}if(typeof this.times.fade!=="undefined"){this.stats.increment("Fade Accum",this.times.idle-this.times.fade)}else{if(typeof this.times.render!=="undefined"){this.stats.increment("Render Accum",this.times.idle-this.times.render)}}},unknownStateHandler:function(){y.signalErrorWithMessage("PerfMonitor: unknown state")},stateChange:function(J){var K=this[J+"Handler"]||this.unknownStateHandler;K.call(this)},report:function(M,L,N){function K(P,Q){if(Q){return P/Q}else{return 0}}var O=(typeof N==="undefined")?true:N,J=y.stringify({name:M,phase:L,frames:this.stats.get("Activation Count"),frameTime:K(this.now()-this.stats.get("Start"),this.stats.get("Activation Count")),active:K(this.stats.get("Active Accum"),this.stats.get("Activation Count")),missedFrames:this.stats.get("Activation Missed"),lateFrames:this.stats.get("Late Frames"),idle:K(this.stats.get("Idle Accum"),this.stats.get("Idle Count")),touch:K(this.stats.get("Touch Accum"),this.stats.get("Activation Count")),constrainCt:this.stats.get("Constrain Count"),constrain:K(this.stats.get("Constrain Accum"),this.stats.get("Constrain Count")),renderCt:this.stats.get("Render Count"),render:K(this.stats.get("Render Accum"),this.stats.get("Render Count")),fadeCt:this.stats.get("Fade Count"),fade:K(this.stats.get("Fade Accum"),this.stats.get("Fade Count"))});if(O){this.stats.clear();this.stats.set("Start",this.now())}return J}};return F}(jQuery));y.speculativeOpacity=0.5;y.speculativeColor="#888888";y.targetHighlightColor="red";y.targetHighlightPathBolding=2;y.diffPatch=jsondiffpatch.create({objectHash:function(D){return(D.id!==h)?D.id:JSONcanonical.stringify(D)}});y.getKindObj=function(F){var D=y.gObjects[F],G=D&&D.doc,E=G&&G.supported,H=E||(G&&y.gOptions.instantiateUnsupportedObjects);return H?D:null};y.getConstraintObj=function(E){var D=y.gConstraints[E],G=D&&D.doc,F=G&&G.supported,H=F||(G&&y.gOptions.instantiateUnsupportedObjects);return H?D:null};y.gobjIdMapFromArray=function(E){var D={};E.forEach(function(F){D[F.id]=F});return D};y.getFontFamilyFromStyle=function(F,H){var G,D,E=F["font-family"];if(g.type(E)==="number"){D=H.getResource("fontList",E);if(!D){G=H.prefs().fontList;D=G[E]}}if(!D){D=E}return D};y.gobjPrototype=(function(){var D={};return function(E,H){var G=[E,H].join(":"),F=D[G];if(!F){F=y.makeClass(y.gObjects[E],y.gConstraints[H]);D[G]=F}return F}}());y.gobjFromSpec=function(O,E,N,J){var H=O.kind,D=y.getKindObj(H),F=O.constraint,M=y.getConstraintObj(F),G,L,K=D&&D.kindSupportsSpecObj(O,J),I=M&&M.constraintSupportsSpecObj(O,J);if(!K){y.log("GObject "+E+' has undefined kind: "'+O.kind+'"');H="Unknown";F="Unknown"}else{if(!I){y.log("GObject "+E+' has undefined constraint: "'+O.constraint+'"');if(D.doc.defaultConstraint){F=D.doc.defaultConstraint}else{H="Unknown";F="Unknown"}}}L=y.gobjPrototype(H,F);G=y.makeInstance(L,O,{doc:true});G.id=E;G.sQuery=N;if(!K||!I){G.state.supported=false}return G};y.gobjectsFromSpec=function(G,J){var H=G,D={},I,F,E;for(I in H){if(H.hasOwnProperty(I)){F=H[I];if(F){E=y.gobjFromSpec(F,I,J,H);D[I]=E}else{y.signalErrorWithMessage('Undefined gobject in sketch document: "'+I+'"')}}}return D};y.generateChecksum=function(D){return b64_md5(JSONcanonical.stringify(D))};y.getSketchDiff=function(E,D){function F(I){var H=g.extend(true,{},I),K=H.objects;for(var J in K){if(K.hasOwnProperty(J)){K[J].debug=h}}return H}var G={};G.diff=y.diffPatch.diff(F(E),F(D));G.checksum=y.generateChecksum(E);return G};y.applySketchDiff=function(D,F){if(F.checksum!==y.generateChecksum(D)){y.log("Applying sketch diff to the wrong source spec")}try{y.diffPatch.patch(D,F.diff)}catch(E){y.log("applySketchDiff() aborted: "+E.message)}};y.getDocumentDiff=function(F,E){var D={};D.checksum=y.generateChecksum(F);D.metadataDiff=y.diffPatch.diff(F.metadata,E.metadata);D.resourcesDiff=y.diffPatch.diff(F.resources,E.resources);D.pageDiffs=[];if(F.pages){F.pages.forEach(function(H,G){var I=E.pages[G];D.pageDiffs[G]=y.getSketchDiff(H,I)})}if(F.tools){F.tools.forEach(function(I,H){var G=E.tools[H];D.pageDiffs[H]=y.diffPatch.diff(I,G)})}return D};y.applyDocumentDiff=function(F,E){if(E.checksum!==y.generateChecksum(F)){y.log("Applying doc diff to source spec with different checksums")}try{y.diffPatch.patch(F.metadata,E.metadataDiff);y.diffPatch.patch(F.resources,E.resourcesDiff);if(F.pages){F.pages.forEach(function(I,G){var H=E.pageDiffs[G];if(H){y.applySketchDiff(I,H)}})}if(F.tools){F.tools.forEach(function(I,H){var G=E.toolDiffs[H];y.diffPatch.patch(I,G)})}}catch(D){y.log("applyDocumentDiff aborted: "+D.message)}};y.layerInfo=(function(){var E={NeverVisible:{z_index:0,engine:null,construction_sort:1},ExternalImagesAndInteriors:{z_index:1,engine:"standard",construction_sort:1},LineLoci:{z_index:2,engine:"standard",construction_sort:1},CoordinateSystem:{z_index:3,engine:"standard",construction_sort:1},Axes:{z_index:4,engine:"standard",construction_sort:1},LinesCurves:{z_index:5,engine:"standard",construction_sort:1},Rays:{z_index:5+0.1,engine:"standard",construction_sort:-1},Segments:{z_index:5+0.2,engine:"standard",construction_sort:-1},PathMarkers:{z_index:6,engine:"standard",construction_sort:1},Tables:{z_index:7,engine:"standard",construction_sort:1},Text:{z_index:8,engine:"html",construction_sort:1},Buttons:{z_index:9,engine:"html",construction_sort:1},DiscretePointVectors:{z_index:10,engine:"standard",construction_sort:1},Points:{z_index:11,engine:"standard",construction_sort:1},PointsFree:{z_index:11+0.1,engine:"standard",construction_sort:-1},PointsSemiFree:{z_index:11+0.2,engine:"standard",construction_sort:-1}},D={AngleMarker:E.LineLoci,Arc:E.LinesCurves,ArcInterior:E.ExternalImagesAndInteriors,Axis:E.Axes,Button:E.Buttons,Circle:E.LinesCurves,CircleInterior:E.ExternalImagesAndInteriors,CoordSys:E.CoordinateSystem,Expression:E.Text,Measure:E.Text,Param:E.Text,Picture:E.ExternalImagesAndInteriors,Point:E.Points,PointFree:E.PointsFree,PointSemiFree:E.PointsSemiFree,Polygon:E.ExternalImagesAndInteriors,Straight:E.LinesCurves,Segment:E.Segments,Ray:E.Rays,Text:E.Text};return function(F){var G=F.kind;if(F.getRenderingLayer){return E[F.getRenderingLayer()]}if(F.kind==="Point"){if(F.constraint==="Free"){G+=F.constraint}else{if(F.value!==h){G+="SemiFree"}}}else{if(F.kind==="Straight"){if(F.genus==="Segment"||F.genus==="Ray"){G=F.genus}}}return D.hasOwnProperty(G)?D[G]:{z_index:6,engine:"standard",construction_sort:1}}}());(function(){function E(G){var F=y.layerInfo(G).z_index;if(h===F){F=0}return F}function D(H,G,I){if(I[H.id]===h){I[H.id]={kindLayerCache:E(H)}}if(I[G.id]===h){I[G.id]={kindLayerCache:E(G)}}var J;J=I[H.id].kindLayerCache-I[G.id].kindLayerCache;if(0!==J){return J}if((H.style.layerOrder!==h)&&(G.style.layerOrder!==h)){J=H.style.layerOrder-G.style.layerOrder;if(0!==J){return J}}var K=I[H.id].constructionOrder,F=I[G.id].constructionOrder;if((K!==h)&&(F!==h)){return F-K}return y.layerInfo(G).construction_sort}y.createRenderList=function(H){var I=H.slice(),G,F={};for(G=0;G<I.length;G++){F[I[G].id]={constructionOrder:G*y.layerInfo(I[G]).construction_sort,kindLayerCache:E(I[G])}}I.sort(function(K,J){return D(K,J,F)});return I};y.addToRenderList=function(M,L){var F=0,K=M.length,I=F,H,J,G={};while(F<K){I=F+((K-F)>>1);H=D(M[I],L,G);if(H<=0){F=I+1}else{K=I}}J=(H<=0)?F:K;M.splice(J,0,L)};y.AutoplacementMetrics={Measurement:{sketchLeftMargin:10,sketchTopMargin:5,gObjTopMargin:1,rightIsolation:60,bottomIsolation:15},Button:{sketchLeftMargin:10,sketchTopMargin:5,gObjTopMargin:3,rightIsolation:50,bottomIsolation:15}}}());y.Document=(function(){var G=1,H={attachToNode:function(J){var P="wsp-version-4-0-0",I=g(J),O=this,K=O.docSpec.metadata.width,Q=O.docSpec.metadata.height,L=g('<div class="wsp-base-node '+P+'"><div class="wsp-transform-node"><div class=wsp-main-row></div></div><div class="wsp-transform-large"></div><div class="wsp-transform-medium"></div><div class="wsp-transform-small"></div></div>'),N,M={};I.empty().append(L);N=g(".wsp-main-row",L[0]);if(this.hasTools()){O.attachToolsToNode(N);K+=N.outerWidth()}N.append(g("<div class=wsp-sketch-container></div>"));g(".wsp-transform-large",L[0]).css({width:K,height:Q});g(".wsp-transform-medium",L[0]).css({width:K*0.75,height:Q*0.75});g(".wsp-transform-small",L[0]).css({width:K*0.5,height:Q*0.5});if(this.docOptions.responsiveSizing===true){L.addClass("wsp-responsiveSizing");if(K>400){L.addClass("wsp-responsiveSizing-medium-break");L.addClass("wsp-responsiveSizing-medium-size");L.addClass("wsp-responsiveSizing-small-break");L.addClass("wsp-responsiveSizing-small-size")}else{if(K>300){L.addClass("wsp-responsiveSizing-medium-size");L.addClass("wsp-responsiveSizing-small-break")}}}M.position="relative";if(this.docOptions.sizeParentToContent){if(I.prop("nodeName").toLowerCase()==="div"&&I.css("display")==="block"){M.display="inline-block"}}I.css(M);this.canvasNode=I;this.eventEmitter=y.EventEmitter(this.canvasNode)},event:function(K,J,I){J=J||{};J.document=this;this.eventEmitter.trigger(K,J,I)},getFocusPage:function(){return this.focusPage},getPageCount:function(){return this.docSpec.pages.length},getCurrentPageSpec:function(I){var K=g.extend(true,{},this.getOrigPageSpec(I)),J=this.getPageDeltaObj(I);if(J&&!g.isEmptyObject(K)){y.applySketchDiff(K,J)}return K},getOrigPageSpec:function(I){if(h===I){I=this.docSpec.metadata["start-page"];if(h===I||this.getIndexForPageId(I)===null){I=this.docSpec.pages[0].metadata.id}}if(this.pageData[I]===h){y.signalErrorWithCode("GSP.Error.invalidSwitchPage");return null}else{return this.pageData[I].spec}},getPageIdAtIndex:function(J){if((J<0)||(J>=this.docSpec.pages.length)){return null}var K=this.docSpec.pages[J],I=(K&&K.metadata&&(K.metadata.id!=null))?K.metadata.id:String(J+1);return I},getIndexForPageId:function(J){if(this.docSpec.pages){var L,I,K;for(I=0;I<this.docSpec.pages.length;I++){L=this.docSpec.pages[I];K=(L&&L.metadata&&(L.metadata.id!=null))?L.metadata.id:String(I+1);if(K===J){return I}}}return null},createSketchEventHandlersForPage:function(I,J){this.gobjectEventHandlers[J.getCurrentPageId()]=new y.SketchEventHandler(function(L){var K;function M(P){var Q,N=0,O;for(Q in P){if(P.hasOwnProperty(Q)){if(N!==0){O=h;break}N++;O=Q}}return O}K=M(L.targetMap);if(K){L.target=J.gobjList.gobjects[K]}})},bindGObjEvent:function(I,L,J,K){this.gobjectEventHandlers[I].addHandler(L,J,K)},unbindGObjEvent:function(I,L,J,K){this.gobjectEventHandlers[I].removeHandler(L,J,K)},raiseSketchEvent:function(J,K,L){var M=this.gobjectEventHandlers[J],I=this,N=this.focusPage;if(J!==N.metadata.id){throw y.createError("Document.raiseSketchEvent() can only raise events for the active page")}M.raiseSketchEvent(K,L);if(!y.JobScheduler.isActive(M.processEventsJob)){M.processEventsJob=N.jobScheduler.addJob(function(){I.processSketchEvents(J);M.processEventsJob=null},{priority:"preprocess"})}},processSketchEvents:function(I){var J=this.gobjectEventHandlers[I],K=J.getFrameIndex();if(J.hasSketchEvents()){this.focusPage.event("StartSketchFrame",{},{frameIndex:K});J.processSketchEvents();this.focusPage.event("EndSketchFrame",{},{frameIndex:K})}},triggerLoadPage:function(){var I=this.focusPage.metadata.id;if(!this.cacheSketchPagesLoaded[I]){this.event("LoadPage",{document:this,sQuery:this.focusPage.sQuery},{pageId:I})}this.cacheSketchPagesLoaded[I]=true},triggerDidChangeCurrentPage:function(I){this.event("DidChangeCurrentPage",{document:this,sQuery:this.focusPage.sQuery},{oldPageId:I,pageId:this.focusPage.metadata.id})},triggerWillChangeCurrentPage:function(J){var I=this.focusPage?this.focusPage.metadata.id:null;this.event("WillChangeCurrentPage",{document:this},{pageId:I,newPageId:J})},applyDeltaToActivePage:function(K){var I=this.focusPage.metadata.id;this.stopCurrentFocusedSketch();this.setPageDeltaObj(I,K);this.focusPage=null;var J=this.getCurrentPageSpec(I);this.focusPage=y.Sketch(this,J,this.docOptions);this.focusPage.attachToNode(this.canvasNode);this.triggerLoadPage(I);this.startCurrentFocusedSketch(true);this.sQuery=this.focusPage.sQuery},switchPage:function(I){var J=this.focusPage.metadata.id,L=I,K;if(L===J){return}if(this.focusPage.activeTool){this.focusPage.abortActiveTool()}this.recordActivePageDelta();K=this.getCurrentPageSpec(L);this.triggerWillChangeCurrentPage(L);this.stopCurrentFocusedSketch();this.focusPage=y.Sketch(this,K,this.docOptions);this.focusPage.attachToNode(this.canvasNode);this.triggerLoadPage(I);this.metadata["start-page"]=L;this.startCurrentFocusedSketch(true);this.sQuery=this.focusPage.sQuery;this.triggerDidChangeCurrentPage(J)},startCurrentFocusedSketch:function(){this.focusPage.start();this.event("StartCurrentPage",{document:this,sQuery:this.focusPage.sQuery},{pageId:this.focusPage.metadata.id})},stopCurrentFocusedSketch:function(){this.event("StopCurrentPage",{document:this},{pageId:this.focusPage.metadata.id});this.focusPage.stop()},start:function(){this.startCurrentFocusedSketch()},stop:function(){this.stopCurrentFocusedSketch();this.cleanUp()},cleanUp:function(){this.event("UnloadDocument",{document:this},{})},recordActivePageDelta:function(){var J=this.getFocusPage(),I=J&&J.metadata.id,L=this.getOrigPageSpec(I),K=y.getSketchDiff(L,J.toSpecObj());this.pageData[I].state=K},setPageDeltaObj:function(I,J){this.pageData[I].state=J},getPageDeltaObj:function(I){var J=this.getFocusPage(),K=J&&J.metadata.id,L,M;if(I===K){M=this.getOrigPageSpec(K);L=y.getSketchDiff(M,J.toSpecObj())}else{if(this.pageData[I].state){L=this.pageData[I].state}else{L=null}}return L},getCurrentSpecObject:function(){var J=g.extend(true,{},this.docSpec),I;g.extend(true,J.metadata,this.metadata);for(I=0;I<J.pages.length;++I){J.pages[I]=this.getCurrentPageSpec(this.getPageIdAtIndex(I))}return J},getDocumentJSON:function(){return JSONcanonical.stringify(this.getCurrentSpecObject(),h,2)},getDocumentDelta:function(){var I=y.getDocumentDiff(this.docSpec,this.getCurrentSpecObject());return JSONcanonical.stringify(I)},initModel:function(L,K){var I,J,M;this.docSpec=L;this.metadata=g.extend(true,{},L.metadata);this.resources=L.resources||{};this.docOptions=K||{};this.pageData={};if(L.pages){for(I=0;I<L.pages.length;I++){M=L.pages[I];J=(M&&M.metadata&&(M.metadata.id!=null))?M.metadata.id:String(I+1);M.metadata.id=J;this.pageData[J]={spec:M,state:null}}}if(L.tools){this.addTools(L.tools)}},addTools:function(J){var I=this;if(!I.tools){I.tools=[]}J.forEach(function(K){I.tools.push(y.Tool.createWithSpec(K))})},hasTools:function(){return this.tools&&this.tools.length>0},attachToolsToNode:function(O){var L=75;var J=this,I=L,N=0,M=J.focusPage.sQuery(),K;O.append(g('<div class="wsp-tool-container"><div class="wsp-tool-column"></div></div>'));K=g(".wsp-tool-column",O[0]);J.tools.forEach(function(Q){var R,T,P;R=g('<div class="wsp-tool"></div>');if(Q.metadata.image!==h){P=M.getResource("pictures",Q.metadata.image);T=g("<img>");T.attr(P);T.attr("title",Q.metadata.name);R.append(T)}else{R.text(Q.metadata.name)}R.on("touchstart mousedown",function(V){if(J.focusPage){var U=J.focusPage.activeTool;if(U){J.focusPage.abortActiveTool();if(U===Q){return}}J.focusPage.setActiveTool(Q)}V.preventDefault()});Q.$element=R;K.append(R);var S=R.outerWidth();I=Math.max(S,I);R.css({width:"100%"});N+=R.outerHeight()});K.css({width:I+"px"})}};function E(I){var O=Number(y.version.major),M=Number(y.version.minor),Q=Number("4"),J=I&&I["wsp-version"],P=J&&J.split("."),N=P&&P.length>0?Number(P[0]):null,K=P&&P.length>1?Number(P[1]):0;function L(R){return y.signal({code:"GSP.Error.incompatibleSketchVersion",message:y.Strings.loc("GSP.Error.incompatibleSketchVersion",y.version.number,J),logType:R,sketchData:I})}if(O<N){return L("error")}if(O>N){return L(Q>N?"error":"warning")}if(O===N){if(M<K){return L("debug")}return}return y.signal({code:"GSP.Error.invalidSketchVersion",message:y.Strings.loc("GSP.Error.invalidSketchVersion",y.version.number,J),logType:"error",sketchData:I})}function F(I,J){return g.extend(true,{sizeParentToContent:J,responsiveSizing:J},I)}var D=function(L,M,K){var I,P,N,O,J;P=E(M.metadata);if(P&&P.logType==="error"){if(L){N=g('<div class="wsp-error-message"></div>');N.text(P.message);g(L).empty().append(N)}throw y.createError(P.message,P.code)}I=Object.create(H);I.initModel(M,F(K,g(L).hasClass("wsp-responsiveSizing")));I.id=G++;I.gobjectEventHandlers={};I.cacheSketchPagesLoaded={};J=I.getOrigPageSpec();O=y.Sketch(I,J,K);I.focusPage=O;I.sQuery=O.sQuery;if(L){I.attachToNode(L);O.attachToNode(L);I.event("LoadDocument",{document:I},{});I.triggerLoadPage();I.triggerDidChangeCurrentPage(null)}return I};return D}());y.Sketch=(function(){var D={EventToSketch:function(G){var F=this.canvasNode.convertPointFromPage(G.pageX,G.pageY,G.mouseEvent);var E=y.GeometricPoint(F.x,F.y);this.viewToPrimalTransform().transform(E);F.x=E.x;F.y=E.y;F.pageX=G.pageX;F.pageY=G.pageY;F.mouseEvent=G.mouseEvent;return F},autoplaceGObj:function(J){var O=this,N,F,G,L=this.sketchRect(),K=J.getAutoplacementMetrics(),I;function E(){var R;var U={};do{R=true;U.left=I.x;U.right=U.left+K.rightIsolation;U.top=I.y;U.bottom=U.top+K.bottomIsolation;if(U.bottom>L.bottom){I.x+=(L.right-L.left)/5;if(I.x+K.rightIsolation>L.right){return false}else{R=false;I.y=L.top+K.sketchTopMargin}}else{var T,S,Q=O.gobjList.constraintList;for(var P=Q.length-1;P>=0;--P){T=Q[P];S=O.getGObjGeomBounds(T);if((T!==J)&&!T.style.hidden&&T.autoplacementType&&y.Geom.isIntersectRects(S,U)){R=false;I.x=Math.max(I.x,S.left);I.y=S.bottom+K.gObjTopMargin;break}}}}while(!R);return true}if(K){I=y.GeometricPoint(L.left,L.top);I.x+=K.sketchLeftMargin;I.y+=K.sketchTopMargin;var M=this.gobjList.constraintList;for(var H=M.length-1;H>=0;--H){N=M[H];if(N===J){continue}G=N.getAutoplacementMetrics();F=this.getGObjGeomBounds(N);if(G&&(N.autoplacementType===J.autoplacementType)&&(N.state&&N.state.exists)&&!N.style.hidden&&y.Geom.isIntersectRects(F,L)){I.x=F.left;I.y=F.bottom+K.gObjTopMargin;break}}if(!E()){I=y.GeometricPoint(L.left,L.top);I.x+=K.sketchLeftMargin;I.y+=K.sketchTopMargin}J.geom={loc:I}}},initGObjects:function(J,N){var H=y.gobjectsFromSpec(J,this.sQuery);var O=this;var K=this.gobjList;var G=N&&N.autoplace;var E=N&&N.speculative;var F=N&&N.relativePosition;var I;var M=this.sketchRect();if(F){I=y.AffineTransform.Identity.translate(M.left,M.top)}function L(P){if(F&&(P.constraint==="Free")){P.transform(O,{geom:P.geom,affine:I})}if(G){O.autoplaceGObj(P);P.invalidateGeom();O.renderPrepare();O.constrainAndRedraw()}if(E){P.setRenderState("speculative")}}K.addGObjects(H,(G||E||F)?L:h);return H},constructGObjects:function(F,E){var G=this.initGObjects(F,E);this.renderPrepare();return G},_clearOutActiveTool:function(){if(this.activeTool){this.activeTool.$element.removeClass("wsp-tool-active");this.activeTool=null}this.canvasNode.toggleClass("wsp-tool-background",false);if(this.$closeBox){this.$closeBox.remove();this.$closeBox=null}if(this.$okBox){this.$okBox.remove();this.$okBox=null}},abortActiveTool:function(){if(this.activeTool){var E=this.currentTouchRegime();if(E.toolplaySession){E.toolplaySession.abortPlayback();this.popTouchRegime()}this._clearOutActiveTool()}},confirmActiveTool:function(){if(this.activeTool){this.activeTool.$element.removeClass("wsp-tool-active");var E=this.currentTouchRegime();if(!E.toolplaySession){y.log("abortActiveTool called when there is no active tool regime");return}E.toolplaySession.confirmPlayback();this._clearOutActiveTool();this.popTouchRegime()}},setActiveTool:function(I){var K;this.activeTool=I;I.$element.addClass("wsp-tool-active");try{var G=this;var E=!this.$closeBox;K=y.ToolRegime.createWithTool(G,I);this.pushTouchRegime(K);if(E){var J=g("<div></div>");var F=this.baseNode.find(".wsp-transform-node");F.append(J);J.addClass("wsp-tool-cancel");J.on("click",function(){G.abortActiveTool()});this.$closeBox=J;var H=g("<div></div>");F.append(H);H.addClass("wsp-tool-ok");H.on("click",function(){G.confirmActiveTool()});this.$okBox=H}this.canvasNode.toggleClass("wsp-tool-background",true)}catch(L){if(this.currentTouchRegime()===K){this.abortActiveTool()}else{this._clearOutActiveTool()}}},constrainDriveChain:function(E){var F,G;for(F=0;F<E.length;F++){G=E[F];if(G.checkParentsExist()){G.constrain(this)}if(G.state){G.state.constraintCache={}}}},getGObjGeomBounds:function(G){var E=this.renderRefCon.gobj[G.id];var F=(G.getGeomBounds&&G.getGeomBounds(E))||y.Geom.kInfiniteRect;if(!y.Geom.isValidRect(F)){y.signalErrorWithCode("GSP.Error.invalidGeomBounds",[G.id,G.kind]);F=y.Geom.kInfiniteRect}return F},getGObjLabelBounds:function(F){var E=this.renderRefCon.dcForGObjLabel||this.dcForGObjLabel(F);return(F.getLabelBounds&&F.getLabelBounds(E))||y.Geom.kInfiniteRect},updateSignificantBoundsWithGObj:function(F){if(F.style.hidden){return}var E=this.renderRefCon.gobj[F.id];this.significantBounds=y.Geom.unionRects(this.significantBounds,F.getSignificantBounds(E))},constrain:function(){this.monitor.stateChange("constrain");function F(G,I,K){var H,J;if(I.parentsList&&I.parentsList.length){for(H=0;H<I.parentsList.length;H++){J=I.parentsList[H];if(J.state.constraintFrame>I.state.constraintFrame){I.state.constraintFrame=J.state.constraintFrame;K.invalidateRect(K.renderRefCon.renderBounds[I.id]);K.invalidateRect(K.renderRefCon.labelBounds[I.id]);K.isDirty=true}}}}function E(H,J,K){var L,G;try{if((J.state.constraintFrame>=K.constraintFrame)&&J.checkParentsExist()){J.constrain(K);if(!J.style.hidden){G=K.dcForGObj(J);if(G&&G.preclear){K.invalidateRect(K.getGObjGeomBounds(J))}G=K.dcForGObjLabel(J);if(G&&G.preclear){K.invalidateRect(K.getGObjLabelBounds(J))}K.isDirty=true}if(J.state){J.state.constraintCache={}}if(J.constrainLabel){J.constrainLabel()}K.document.raiseSketchEvent(K.getCurrentPageId(),J.id,"update")}}catch(I){if(J.id){L=J.id}else{L="#"+H}I.code="GSP.Error.constraintException";I.message=y.Strings.loc("GSP.Error.touchStartException",L)+": "+I.message;y.signalCaughtError(I)}}this.eachGObj(this.gobjList.constraintList,F);this.eachGObj(this.gobjList.constraintList,E);this.constraintFrame++;if(this.isDirty){this.significantBounds=null;this.eachGObj(this.gobjList.constraintList,function(G,H,I){I.updateSignificantBoundsWithGObj(H)})}this.monitor.stateChange("idle")},invalidateRect:function(E){this.dirtyRect=y.Geom.unionRects(this.dirtyRect,E)},invalidateAppearance:function(E){this.invalidateRect(this.renderRefCon.renderBounds[E.id]);this.invalidateRect(this.renderRefCon.labelBounds[E.id]);this.isDirty=true;this.setNeedsDisplay()},invalidateGeom:function(E){if(E){E.state.constraintFrame=this.constraintFrame;this.invalidateAppearance(E)}return this},event:function(G,F,E){F=F||{};E=E||{};F.sketch=this;F.sQuery=this.sQuery;if(F.gobj){E.gObjectId=F.gobj.id}if(F.touch){E.touchIdentifier=F.touch.identifier}if(F.position){E.position={x:F.position.x,y:F.position.y}}if(F.sketch.document.focusPage.metadata.id){E.pageId=F.sketch.document.focusPage.metadata.id}this.document.event(G,F,E)},handleTouchStart:function(H){var F,J,I,G;if(!H||!H.changedTouches){y.signalErrorWithMessage("sketch.handleTouchEnd: missing e.changedTouches");return}for(F=0;F<H.changedTouches.length;F+=1){try{J=H.changedTouches[F];I=this.EventToSketch(J);G=this.currentTouchRegime().createTracker(J,I);if(G){y.TouchManager.registerTouchWithTracker(J.identifier,G);G.touchBegan(I,J);if(G.forwardTouchToSystem){return}}}catch(E){E.code="GSP.Error.touchStartException";E.message=y.Strings.loc("GSP.Error.touchStartException",J.identifier)+E.message;y.signalCaughtError(E)}}return false},handleTouchMove:function(H){var F,J,G,I;if(!H||!H.changedTouches){y.signalErrorWithMessage("sketch.handleTouchMove: missing e.changedTouches");return}for(F=0;F<H.changedTouches.length;F+=1){try{J=H.changedTouches[F];G=y.TouchManager.trackerForTouch(J.identifier);if(G){I=this.EventToSketch(J);G.touchMoved(I,J);if(G.forwardTouchToSystem){return}}}catch(E){E.code="GSP.Error.touchMoveException";E.message=y.Strings.loc("GSP.Error.touchMoveException",J.identifier)+E.message;y.signalCaughtError(E)}}return false},handleTouchEnd:function(H){var F,I,G;if(!H||!H.changedTouches){y.signalErrorWithMessage("sketch.handleTouchEnd: missing e.changedTouches");return}for(F=0;F<H.changedTouches.length;F+=1){try{I=H.changedTouches[F];G=y.TouchManager.trackerForTouch(I.identifier);if(G){G.touchEnded(I);if(G.forwardTouchToSystem){return}}y.TouchManager.deregisterTouch(I.identifier)}catch(E){E.code="GSP.Error.touchEndException";E.message=y.Strings.loc("GSP.Error.touchEndException",I.identifier)+E.message;y.signalCaughtError(E)}}return false},_deferredGObjCalls:null,addDeferredCall:function(F,H){var G=this;if(!G._deferredGObjCalls[F.id]){G._deferredGObjCalls[F.id]=[]}var E=G.jobScheduler.addJob(function(){H.apply(F,[G])},{done:function(){var J,I=G._deferredGObjCalls[F.id];for(J=0;J<I.length;++J){if(I[J]===E){I.splice(J,1);break}}}});G._deferredGObjCalls[F.id].push(E)},cancelDeferredCall:function(E){var F=this;this._deferredGObjCalls[E.id].forEach(function(G){F.jobScheduler.clearJob(G);F._deferredGObjCalls[E.id]=h})},getRenderList:function(){return this.gobjList.renderList},standardGraphicsEngine:function(){var E=this.getOption("graphics-engine");return this.draw.engines[E]||this.draw.engines.canvas},dcForGObj:function(G,H){var F;if("traced"===H){return this.draw.engines.trace}var I=this.renderRefCon.dcForGObj,E=I[G.id];if(E){return E}F=y.layerInfo(G);if(F.engine==="standard"){E=I[G.id]=this.standardGraphicsEngine();return E}E=I[G.id]=this.draw.engines[F.engine];return E},dcForGObjLabel:function(G){if(this.renderRefCon.dcForGObjLabel){return this.renderRefCon.dcForGObjLabel}var F=this.getOption("label-engine"),E=this.draw.engines[F];this.renderRefCon.dcForGObjLabel=E||this.draw.engines.html;return this.renderRefCon.dcForGObjLabel},translateTraceLayer:function(F,E){if(this.traces.saturation>0){if(!this.traces.translate){this.traces.translate={dx:0,dy:0}}this.traces.translate.dx+=F;this.traces.translate.dy+=E}},realizeTraceLayerTranslation:function(){if((this.traces.saturation>0)&&this.traces.translate&&(this.traces.translate.dx||this.traces.translate.dy)){this.draw.translate(this.traces.translate.dx,this.traces.translate.dy);this.traces.translate.dx=0;this.traces.translate.dy=0}},fadeTraces:function(){var E=Number(new Date()),H,F,G;H=(E-this.traces.fadeStartTime)/1000;F=Math.exp(-H*(Math.log(2)/this.preferences.fadeHalfLife));G=F/this.traces.appliedAlpha;G+=(Math.random()*2*0.2-0.2);if(G<0){G=0}if(G<1){this.draw.fade(G);this.traces.saturation*=G;this.traces.appliedAlpha*=G}},clearTraces:function(){this.draw.fade(0);this.traces.saturation=0;this.traces.appliedAlpha=1;this.traces.fadeStartTime=0},renderGObj:function(G,F){var H=F.traced?"traced":"normal",E=this.dcForGObj(G,H);if(E){G.render(E,this.renderRefCon.gobj[G.id],F)}},renderBounds:function(G,J,K){try{var L=K.getGObjGeomBounds(J),I=K.getGObjLabelBounds(J),F={rect:L},E=K.standardGraphicsEngine();if(L&&E.drawRectangle){F={rect:L};E.drawRectangle(K.renderRefCon.geomBounds[J.id]||this,F)}if(I&&E.drawRectangle){F={rect:I};E.drawRectangle(K.renderRefCon.geomBounds[J.id]||this,F)}}catch(H){H.code="GSP.Error.renderBoundsException";H.message=y.Strings.loc("GSP.Error.renderBoundsException",J.id,J.kind)+H.message;y.signalCaughtError(H)}},renderGObjLabel:function(G,F){var H=F.traced?"traced":"normal",E=this.dcForGObjLabel(G,H);if(G.hasLabel){if(E){G.renderLabel(E,this.renderRefCon.label[G.id]||this,F)}}},_fadeTracesJob:null,render:function(){var I=this.getRenderList(),K=false,G=false,J=this;this.monitor.stateChange("render");function H(L,Q,R){var O=R.dcForGObj(Q),N=O&&O.preclear,P;try{if(!G&&Q.style.traced&&(Q.state.traceConstraintFrame!==Q.state.constraintFrame)){R.renderGObj(Q,{traced:true});K=true;Q.state.traceConstraintFrame=Q.state.constraintFrame}if(N&&!Q.style.hidden){P=R.getGObjGeomBounds(Q);R.renderRefCon.renderBounds[Q.id]=P}if(!N||y.Geom.isIntersectValidRects(R.dirtyRect,P)){R.renderGObj(Q,{drag:G})}}catch(M){M.code="GSP.Error.renderObjectException";M.message=y.Strings.loc("GSP.Error.renderObjectException",Q.id,Q.kind,M);y.signalCaughtError(M)}}function E(L,Q,R){var N=R.dcForGObjLabel(Q),M=N&&N.preclear,O;try{if(M&&!Q.style.hidden){O=R.getGObjLabelBounds(Q);R.renderRefCon.labelBounds[Q.id]=O}if(!M||y.Geom.isIntersectValidRects(R.dirtyRect,O)){R.renderGObjLabel(Q,{sketch:R,drag:G})}}catch(P){P.code="GSP.Error.renderLabelException";P.message=y.Strings.loc("GSP.Error.renderLabelException",Q.id,Q.kind,P.message);y.signalCaughtError(P)}}if(this.isDirty){this.realizeTraceLayerTranslation();this.draw.prepareFrame(this.dirtyRect,this.primalToViewTransform());this.eachGObj(I,H);if(K){this.traces.saturation=1;if(this.traces.appliedAlpha<this.preferences.fadeSaturationFloor){this.traces.appliedAlpha=1;this.traces.fadeStartTime=Number(new Date())}var F={repeat:true,done:function(){J._fadeTracesJob=null}};if(this.preferences.fadeTraces&&!y.JobScheduler.isActive(this._fadeTracesJob)){this._fadeTracesJob=this.jobScheduler.addJob(function(){var L=true;J.monitor.stateChange("fade");if(J.traces.saturation>J.preferences.fadeSaturationFloor){J.fadeTraces()}else{J.clearTraces();L=false}J.setNeedsDisplay();J.monitor.stateChange("idle");return L},F)}}this.eachGObj(I,E);G=true;this.eachGObj(I,function(L,M,N){if(M.state.isDragging){H(L,M,N)}});if(this.getOption("debug-geom-bounds")){this.eachGObj(I,this.renderBounds)}this.draw.cleanupFrame(this.dirtyRect);this.dirtyRect=null;this.isDirty=false}this.monitor.stateChange("idle")},renderPrepare:function(){var E=g.grep(this.gobjList.renderList,function(G){return G.needsRenderInit});function F(H,J,K){var G;try{G=K.dcForGObj(J);if(G){K.renderRefCon.gobj[J.id]=J.renderPrepare(G,{})}if(J.hasLabel){G=K.dcForGObjLabel(J);if(G){K.renderRefCon.label[J.id]=J.renderLabelPrepare(G,{})}}J.needsRenderInit=false}catch(I){I.code="GSP.Error.renderPrepareException";I.message=y.Strings.loc("GSP.Error.renderPrepareException",J.id,J.kind,I);y.signalCaughtError(I)}}this.eachGObj(E,F)},renderCleanupGObj:function(G){var H=this;try{var E=H.dcForGObj(G);if(E){G.renderCleanup(E,H.renderRefCon.gobj[G.id])}if(G.hasLabel){E=H.dcForGObjLabel(G);if(E){G.renderLabelCleanup(E,H.renderRefCon.label[G.id])}}if(H.renderRefCon.gobj[G.id]){delete H.renderRefCon.gobj[G.id]}if(H.renderRefCon.label[G.id]){delete H.renderRefCon.label[G.id]}if(H.renderRefCon.dcForGObj[G.id]){delete H.renderRefCon.dcForGObj[G.id]}if(H.renderRefCon.geomBounds[G.id]){delete H.renderRefCon.geomBounds[G.id]}if(H.renderRefCon.renderBounds[G.id]){delete H.renderRefCon.renderBounds[G.id]}if(H.renderRefCon.labelBounds[G.id]){delete H.renderRefCon.labelBounds[G.id]}}catch(F){F.code="GSP.Error.renderCleanupException";F.message=y.Strings.loc("GSP.Error.renderCleanupException",G.id,G.kind,F);y.signalCaughtError(F)}},renderCleanUp:function(){var E=this;this.eachGObj(this.getRenderList(),function(F,G){E.renderCleanupGObj(G)},{direction:"reverse"})},getName:function(){var E=this.spec.metadata;return E.title},toSpecObj:function(){var G={},E=this.gobjList.gobjects;G.metadata=g.extend(true,{},this.metadata);G.preferences=g.extend(true,{},this.spec.preferences);G.objects={};for(var F in E){if(E.hasOwnProperty(F)){G.objects[F]=E[F].toSpecObj()}}return G},cleanUp:function(){if(this.draw===null){return}this.event("UnloadPage",{document:this});this.eachGObj(function(F,G,H){try{if(G.destroy){G.destroy()}}catch(E){E.code="GSP.Error.destroyObjectException";E.message=y.Strings.loc("GSP.Error.destroyObjectException",G&&G.id,G&&G.kind,E);y.signalCaughtError(E)}},{direction:"reverse"});if(this.canvasNode){this.canvasNode.unbind()}this.renderCleanUp();if(this.draw){this.draw.destroy()}this.gobjList=null;this.draw=null;y.logPerf(this.monitor.report(this.getName(),"final"))},constrainAndRedraw:function(){this.constrain();this.render()},_displayJob:null,setNeedsDisplay:function(){var E=this;if(!y.JobScheduler.isActive(E._displayJob)){E._displayJob=this.jobScheduler.addJob(function(){E.constrain();E.render();E._displayJob=null;return false},{priority:"render"})}},onLoad:function(F){var E;if(this.gobjList.constraintList){for(E=0;E<this.gobjList.constraintList.length;E+=1){this.gobjList.constraintList[E].onLoad(this,F)}}},onUnload:function(){var E;if(this.gobjList.constraintList){for(E=0;E<this.gobjList.constraintList.length;E+=1){this.gobjList.constraintList[E].onUnload()}}},start:function(E){var F=this;if(F.state!=="started"){F.state="started";F.constrainAndRedraw();y.logPerf(F.monitor.report(F.getName(),"init"));F.monitor=new y.PerfMonitor();F.onLoad(E);if(F.getOption("perfTestMode")){F.jobScheduler.addJob(function(){F.dirtyRect=y.Geom.kInfiniteRect;F.isDirty=true;F.setNeedsDisplay()},{repeat:true})}}else{y.signalErrorWithCode("GSP.Error.invalidSketchStart")}return this},getCurrentPageId:function(){return this.metadata.id},stop:function(){if(this.state!=="stopped"){this.jobScheduler.clearAllJobs();this._displayJob=null;this.onUnload();this.state="stopped";this.cleanUp()}else{y.signalErrorWithCode("GSP.Error.invalidSketchStop")}return this},pause:function(){this.jobScheduler.clearAllJobs();this._displayJob=null;y.log("Paused sketch.");return this},resume:function(){this.setNeedsDisplay();y.log("Resumed sketch.");return this},cloneGObjects:function(K){var I,G,L,H,J=[],F={},E;for(I=0;I<K.length;I++){L=Object.create(K[I]);F[L.id]=L;J.push(L);L.isClone=true}for(I=0;I<J.length;I++){L=J[I];H=L.parents;L.parents={};for(G in H){E=H[G];L.parents[G]=F[E.id]?F[E.id]:E}H=L.parentsList;L.parentsList=[];for(G=0;G<H.length;G++){E=H[G];L.parentsList.push(F[E.id]?F[E.id]:E)}L.initializeClone(K[I])}return J},hitGObj:function(L,N){N=N||{};var E=false,I=[],J=N.hotSpot,H=N.maxResults||1,M=N.gobjArray||this.gobjList.renderList,G=N.filter,K={};function F(P,Q,R){if(G&&(G(Q)===false)){return}var O=R.renderRefCon.gobj[Q.id];if(Q.isHittable()&&y.Geom.isIntersectRects(Q.getGeomBounds(O),L)){E=Q.hitTest(L,J,O);if(E){I.push(Q);if(I.length===H){return false}}}}this.eachGObj(M,F,{direction:"reverse"});if(N.maxResults===h){K.hitGObj=I[0];if(E!==true){K.customTracker=E}}else{K.hitArray=I}return K},eachGObj:function(F,L,M){var E,G,I,J,H,K=this;if(!g.isArray(F)){M=L;L=F;F=K.gobjList.constraintList}E=g.extend({direction:"forward"},M);H=E.direction==="forward";for(G=0;G<F.length;G++){I=H?F[G]:F[F.length-G-1];J=L.call(I,G,I,K);if(false===J){break}}return this},findExistingCoordSys:function(J){var I=null,E=-1,F=6,G,H;if(J){G=J.xAxisTrig?"trigonometric":"decimal";H=J.yAxisTrig?"trigonometric":"decimal"}this.eachGObj(function(L,M){var K=0;if(M.constraint==="CoordSys"&&M.state.exists){if(M.isVisible()){K+=4}if(M.getParent("axisX").style.tickNumbering===G){K+=1}if(M.getParent("axisY").style.tickNumbering===H){K+=1}if(K===F){I=M;return false}if(K>E){I=M;E=K}}});return I},verifyFromSpec:function(F){var E={success:true,failures:{}},G={};this.eachGObj(function(H,I,L){var K,M;function J(O){try{return I.verificationString(O)}catch(N){return"Verification Failed: "+String(N)}}I.eachParent(function(N,O){if(G[O.id]){G[I.id]=true;return false}});if(!G[I.id]){M=L.spec.objects[I.id].debug;K=M?J(M):"no expected data";if(K==="NO_VERIFICATION"){G[I.id]=true}else{if(K!==""){E.success=false;E.failures[I.id]=K;G[I.id]=true}}}});return E},selector:function(E){return g(E,this.canvasNode)},getOption:function(F){var E=this.options[F];return E!==h?E:y.gOptions[F]},translate:function(Q,P,K){var M,L;if(K){if(this.preferences.limitScrolling){var I=this.metadata.sketchRect,G=this.spec.metadata.sketchRect,O=I.right-I.left,F=I.bottom-I.top,H=G.right-G.left,J=G.bottom-G.top;L=g.extend(true,{},I);if(H>O){L.left=G.left;L.right=G.right}if(J>F){L.top=G.top;L.bottom=G.bottom}}else{L=g.extend(true,{},this.significantBounds);var E=this.metadata.sketchRect.right-this.metadata.sketchRect.left,N=this.metadata.sketchRect.bottom-this.metadata.sketchRect.top;L=y.Geom.insetRect(L,-E/2,-N/2)}if(Q<0){M=L.left-this.metadata.sketchRect.left;Q=(M>Q)?M:Q}else{if(Q>0){M=L.right-this.metadata.sketchRect.right;Q=(M<Q)?M:Q}}if(P<0){M=L.top-this.metadata.sketchRect.top;P=(M>P)?M:P}else{if(P>0){M=L.bottom-this.metadata.sketchRect.bottom;P=(M<P)?M:P}}}this.translateTraceLayer(Q,P);if(!((Q===0)&&(P===0))){this.metadata.sketchRect.left+=Q;this.metadata.sketchRect.right+=Q;this.metadata.sketchRect.top+=P;this.metadata.sketchRect.bottom+=P;this.invalidateRect(this.sketchRect());this.isDirty=true;this.setNeedsDisplay()}},primalToViewTransform:function(){return new y.AffineTransform({m00:1,m01:0,m10:0,m11:1,m20:-this.metadata.sketchRect.left,m21:-this.metadata.sketchRect.top})},viewToPrimalTransform:function(){return new y.AffineTransform({m00:1,m01:0,m10:0,m11:1,m20:this.metadata.sketchRect.left,m21:this.metadata.sketchRect.top})},sketchRect:function(){return g.extend(true,{},this.metadata.sketchRect)},pushTouchRegime:function(E){this._touchRegimes.push(E)},popTouchRegime:function(){this._touchRegimes.pop()},currentTouchRegime:function(){var E=this._touchRegimes.length-1;if(E<0){throw y.createError("currentTouchRegime called with no touch regime active")}return this._touchRegimes[E]},init:function(E,G,H){var F=this;F.document=E;F.state="created";F.Bap=new y.Bap(F);F.MotionManager=new y.MotionManager(F);F.Scroll=y.Scroll(F);F.options=g.extend(true,{},H,G.options);F.metadata=g.extend(true,{},G.metadata);F.preferences=g.extend(true,{},y.Prefs,G.preferences);if(!F.preferences.colorableComponents.Background["composite-mode"]){F.preferences.colorableComponents.Background["composite-mode"]=F.preferences.colorableComponents.Background.color==="white"?"destination":"source-over"}F.config={};if(G.config){g.extend(F.config,G.config)}F.sQuery=y.SQuery(F);F.gobjList=new y.GObjList();F.monitor=new y.PerfMonitor();F.spec=G;F.jobScheduler=y.JobScheduler.create();F._deferredGObjCalls={};y.log("Initializing gobjs");F.initGObjects(F.spec.objects);F.constraintFrame=0},attachToNode:function(G){var M=this,K=M.document,J=K.docSpec.metadata.width,N=K.docSpec.metadata.height,E,L,F,H,I={};M._touchRegimes=[];M.pushTouchRegime(y.DisplayRegime.createInSketch(M));H=g(".wsp-sketch-container",G[0]);H.empty();H.append('<div class="wsp-clip-node"></div>');F=M.canvasNode=g(".wsp-clip-node",G[0]);F.css({width:J,height:N});M.drawRefCon={};M.anchorNode=G;M.baseNode=g(".wsp-base-node",G);I.clip="rect(auto, auto, auto, auto)";E=parseInt(G.css("width"),10);L=parseInt(G.css("height"),10);if(M.metadata.sketchRect===h){M.metadata.sketchRect={top:0,left:0}}else{E=M.metadata.sketchRect.right-M.metadata.sketchRect.left;L=M.metadata.sketchRect.bottom-M.metadata.sketchRect.top}M.metadata.sketchRect.bottom=M.metadata.sketchRect.top+L;M.metadata.sketchRect.right=M.metadata.sketchRect.left+E;if(M.preferences.colorableComponents.Background["composite-mode"]==="source-over"){I["background-color"]=M.preferences.colorableComponents.Background.color}F.css(I);M.draw=y.draw.create({rootNode:F,width:J,height:N});M.traces={saturation:1,appliedAlpha:1,fadeStartTime:0};M.renderRefCon={gobj:{},label:{},dcForGObj:{},geomBounds:{},renderBounds:{},labelBounds:{}};M.isDirty=false;M.dirtyRect=null;if(!K.gobjectEventHandlers[M.getCurrentPageId()]){K.createSketchEventHandlersForPage(this.getCurrentPageId(),this)}M.canvasNode.mousetouch();M.canvasNode.bind("touchstart",function(O){return M.handleTouchStart(O)});M.canvasNode.bind("touchmove",function(O){return M.handleTouchMove(O)});M.canvasNode.bind("touchend touchcancel",function(O){return M.handleTouchEnd(O)});M.renderPrepare();y.registerEditable(M)}};return function(E,F,G){var I=null;if(typeof F==="string"){try{F=JSON.parse(F)}catch(H){y.signalErrorWithCode("GSP.Error.invalidSketch");return null}}I=Object.create(D);I.init(E,F,G);return I}}());y.Sketch.allConstraints=function(){var D,F,E=[];for(D in y.gConstraints){if(y.gConstraints.hasOwnProperty(D)){F=y.gConstraints[D];if(F.doc&&F.doc.usage&&!F.doc.usage["abstract"]){E.push(D)}}}return E};y.Sketch.supportCheck=function(N,L){var K={count:0,supportedCount:0,unsupported:{},constraints:{},support:"full",message:'All Sketch Objects: <span class="expected">Supported</span>'},I=N.objects,F,D;for(F in I){if(I.hasOwnProperty(F)){var M=I[F],G=y.getKindObj(M.kind),E=y.getConstraintObj(M.constraint),J=G&&G.kindSupportsSpecObj(M,I),H=E&&E.constraintSupportsSpecObj(M,I);K.count++;if(!J||!H){D={};if(!J){D.kind=M.kind}if(!H){D.constraint=M.constraint}K.unsupported[F]=D}else{K.constraints[M.constraint]=K.constraints[M.constraint]||0;K.constraints[M.constraint]++;K.supportedCount++}}}if(K.supportedCount!==K.count){K.support="none";K.message='Some Sketch Objects: <span class="error">Not Supported</span>'}return K};y.Tool=(function(){function G(N,O){if(O.genus==="CoordSys"){O.kind="CoordSys";O.constraint="CoordSys"}var J=y.gobjPrototype(O.kind,O.constraint);var Q=J.createDefaultSpec&&J.createDefaultSpec(N,O);if(Q){var K=y.ObjectGraph.getNextFreeIdNumber(N.gobjList.constraintList);var P=y.ObjectGraph.convertObjectSpec(Q);P.forEach(function(R){R.id=""+K;++K});var I=y.ObjectGraph.createSpecFromGraph(P);var M=N.constructGObjects(I,{speculative:true,autoplace:true,relativePosition:true});g.each(M,function(R,S){S.invalidateGeom()});var L=P[P.length-1].id;return{constructedObjects:M,matched:M[L]}}}function E(N,I){var L=N.gobjList.constraintList;var M,J;if(I.genus==="CoordSys"){return N.findExistingCoordSys(I)}for(var K=L.length-1;K>=0;--K){J=L[K];if((J.genus===I.genus)&&(J.label===I.label)){if(!M&&J.style.hidden){M=J}else{return J}}}return M}var F={sketch:null,objectGraph:null,givenArray:null,completion:null,constructedObjects:null,resetPlayback:function(){var I=this;var K=y.ObjectGraph.copy(this.objectGraph);var L=K.filter(function(N){if(N.toolRole==="given"){delete N.toolRole;return true}return false});var J="toolplay"+Date.now();K.forEach(function(N){N.id+=J});if(!L||!L.length){throw y.createError("This tool has no givens")}this.givenArray=L;this.constructedObjects={};this.existingMatches={};var M=K.filter(function(N){if(N.toolRole==="assumed"){delete N.toolRole;return true}return false});M.forEach(function(O){var N=E(I.sketch,O);if(N){I.existingMatches[N.id]=N}else{var P=G(I.sketch,O);if(P){g.extend(I.constructedObjects,P.constructedObjects);N=P.matched}else{y.log("Missing non-constructable assumed");throw y.createError("Missing non-constructable assumed")}}O.id=N.id})},getNextGiven:function(){return this.givenArray.shift()},playGiven:function(R,N,J){var U=g.extend(false,{},this.constructedObjects,this.existingMatches);var Q=y.ObjectGraph.subgraphFromNode(R,U);var P={};var I=this.sketch.gobjList.constraintList;var O=y.ObjectGraph.getNextFreeIdNumber(I);Q.forEach(function(V){V.id=""+O;P[V.id]=V;++O});var M=y.ObjectGraph.createSpecFromGraph(Q);var T=R.id;M[T].geom={loc:{x:N.x,y:N.y}};var S={};S[T]=M[T];delete M[T];var L=this.sketch.constructGObjects(S,{autoplace:true,relativePosition:true});var K=this.sketch.constructGObjects(M,{speculative:J,autoplace:true,relativePosition:true});g.extend(this.constructedObjects,L,K);if(this.completion&&this.isComplete()){this.completion()}return this.sketch.gobjList.gobjects[T]},addCompletionHandler:function(I){this.completion=I},getLegalMatchesForGiven:function(L,J){function I(M,N){if(!M){return false}switch(N){case"Point":return(M.kind==="Point")||M.isOfGenus("Path");case"Expression":if(M.isOfKind("Measure")){if(M.isFunction&&M.isFunction()){return false}return true}if((M.constraint==="Pegged")&&(M.parents.text.isOfKind("Measure"))){return true}return false;default:return false}}var K=J||this.sketch.gobjList.renderList;return K.filter(function(M){return I(M,L.kind)})},isComplete:function(){return this.givenArray.length===0},updateGivenId:function(J,I){if(this.constructedObjects[J]){this.constructedObjects[I]=this.constructedObjects[J];this.constructedObjects[I].id=I;delete this.constructedObjects[J]}},mergeGivenToExisting:function(J,I){if(J.constraint==="Pegged"){J=J.parents.text}this.sketch.gobjList.mergeToGObj(J,I,this.sketch);this.updateGivenId(I.id,J.id);J.invalidateGeom();return J},_mergeGObjToSpecGObj:function(N,J){var L=this.sketch.gobjList;var M={};var K=""+y.ObjectGraph.getNextFreeIdNumber(L.constraintList),I;M[K]=J;this.sketch.constructGObjects(M);I=L.gobjects[K];this.mergeGivenToExisting(I,N);I.invalidateGeom();return I},putGivenOnPath:function(L,J){var K=L.mapPositionToPathValue(J.geom.loc);var I={kind:"Point",genus:"PointOnPath",parents:{path:L.id},value:K,constraint:"PointOnPath",label:J.label,style:J.style};return this._mergeGObjToSpecGObj(J,I,this.sketch)},abortPlayback:function(){this.sketch.gobjList.removeGObjects(this.constructedObjects,this.sketch);this.constructedObjects={}},confirmPlayback:function(){var I=this,J;this.matchedGivens.forEach(function(L){L.finalize(I)});this.matchedGivens=[];for(var K in this.constructedObjects){J=this.constructedObjects[K];J.setRenderState("none")}this.constructedObjects={}},putGivenOnIntersection:function(J,K){function L(O,N){var M={kind:"Point",constraint:O.constraint,genus:"Intersection",label:N.label,style:N.style};switch(O.constraint){case"Intersection":M.parents={line0:O.path1.id,line1:O.path2.id};break;case"Intersection1":case"Intersection2":M.parents={circle:O.path1.id,obj:O.path2.id};break;default:throw y.createError("tool.putGivenOnIntersection() asked to create unsupported intersection constraint")}return M}var I=L(J,K);return this._mergeGObjToSpecGObj(K,I,this.sketch)}};var H={objectGraph:null,$element:null,createSession:function(J){var I=Object.create(F);I.sketch=J;I.objectGraph=this.objectGraph;I.givenArray=[];I.constructedObjects={};I.matchedGivens=[];I.resetPlayback();return I}};var D={given:null,mergeCandidate:null,intersectInfo:null,clearAllExistingMatches:function(){if(this.intersectInfo){this.intersectInfo.path1.setRenderState("none");this.intersectInfo.path2.setRenderState("none");this.intersectInfo=null}if(this.mergeCandidate){this.mergeCandidate.setRenderState("none");this.mergeCandidate=null}},snapGivenValue:function(){this.originalParamValue=this.given.value;if(this.mergeCandidate.isOfKind("Measure")){this.given.updateValue(this.mergeCandidate.value)}else{if(this.mergeCandidate.constraint==="Pegged"){this.given.updateValue(this.mergeCandidate.parents.text.value)}}},unsnapGivenValue:function(){if(this.originalParamValue!==h){this.given.updateValue(this.originalParamValue);this.originalParamValue=h}},setMergeCandidate:function(J){if(J===this.mergeCandidate){return}var I=this.given.isOfKind("Text");this.clearAllExistingMatches();if(J){if(J.isOfGenus("Path")){this.given.setRenderState("matchedGiven")}else{this.given.setRenderState("invisible")}J.setRenderState("targetHighlit");this.mergeCandidate=J;if(I){this.snapGivenValue()}}else{this.given.setRenderState("matchedGiven");if(I){this.unsnapGivenValue()}}},setIntersectInfo:function(I){this.clearAllExistingMatches();I.path1.setRenderState("targetHighlit");I.path2.setRenderState("targetHighlit");this.intersectInfo=I},getSnappedPosition:function(I){if(this.intersectInfo){return this.intersectInfo.location}else{if(this.mergeCandidate){if(this.mergeCandidate.kind==="Point"){return this.mergeCandidate.geom.loc}else{if(this.mergeCandidate.isOfGenus("Path")){return this.mergeCandidate.mapPathValueToPosition(this.mergeCandidate.mapPositionToPathValue(I))}else{if(this.mergeCandidate.isOfKind("Text")){return this.mergeCandidate.geom.loc}}}}}return I},completeMatch:function(){if(this.intersectInfo){this.intersectInfo.path1.setRenderState("none");this.intersectInfo.path2.setRenderState("none")}if(this.mergeCandidate){if(this.mergeCandidate.isOfGenus("Path")){this.mergeCandidate.setRenderState("none")}else{this.mergeCandidate.setRenderState("matchedGiven")}}},finalize:function(J){if(this.intersectInfo){J.putGivenOnIntersection(this.intersectInfo,this.given)}else{if(this.mergeCandidate){var I=this.mergeCandidate;if(I.kind==="Point"||I.isOfKind("Text")){J.mergeGivenToExisting(I,this.given)}else{if(I.isOfGenus("Path")){J.putGivenOnPath(I,this.given)}}}}this.clearAllExistingMatches()}};return{createWithSpec:function(I){var J=Object.create(H);var M=I.objects;J.metadata=g.extend(true,{},I.metadata);var L=false;for(var K in M){if(M.hasOwnProperty(K)&&(M[K].toolRole==="given")){L=true;break}}if(!L){throw new y.createError("Attempting to create a tool with no givens")}J.objectGraph=y.ObjectGraph.convertObjectSpec(g.extend(true,{},M));return J},createMatchedGiven:function(J){var I=Object.create(D);I.given=J;J.setRenderState("matchedGiven");return I}}}());y.ControlList=(function(){var D=["gobj","isController","isDragRoot","isTransformParent","controlIndex"];function E(G){var I="{",F,H;for(F=0;F<D.length;F++){H=G[D[F]];if(D[F]==="gobj"){if(typeof(H)==="object"){H=H.id}}if(F>0){I+=","}I+='"'+D[F]+'":'+H}I+="}";return I}return{fromExternalList:function(G,J){var H=[],F,I;for(F=0;F<G.length;F++){I=g.extend(true,{},G[F]);I.gobj=J.gobjList.gobjects[I.gobj];H.push(I)}return H},toString:function(G){var F,H="";for(F=0;F<G.length;F++){if(F>0){H+=","}H+=E(G[F])}return H}}}());y.BapEdgeInfo={Free:{Default:{edgeType:"dEdge",sortIndex:0}},PictureFree:{Default:{edgeType:"dEdge",sortIndex:0}},Midpoint:{path:{edgeType:"dEdge",sortIndex:0}},Segment:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},CircleFromTwoPoints:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},CircleByRadius:{p0:{edgeType:"dEdge",sortIndex:0},radius:{edgeType:"iEdge",sortIndex:1}},Perpendicular:{p0:{edgeType:"dEdge",sortIndex:0},line:{edgeType:"iEdge",sortIndex:1}},Parallel:{p0:{edgeType:"dEdge",sortIndex:0},line:{edgeType:"iEdge",sortIndex:1}},AngleBisector:{A:{edgeType:"dEdge",sortIndex:0},B:{edgeType:"dEdge",sortIndex:1},C:{edgeType:"dEdge",sortIndex:2}},PolygonFromPoints:{Default:{edgeType:"dEdge",sortIndex:0}},Intersection:{line0:{edgeType:"dEdge",sortIndex:0},line1:{edgeType:"dEdge",sortIndex:1}},CircleInterior:{circle:{edgeType:"dEdge",sortIndex:0}},Intersection1:{obj:{edgeType:"dEdge",sortIndex:0},circle:{edgeType:"dEdge",sortIndex:1}},Intersection2:{obj:{edgeType:"dEdge",sortIndex:0},circle:{edgeType:"dEdge",sortIndex:1}},PointOnPath:{path:{edgeType:"iEdge",sortIndex:0}},PointOnPolygonEdge:{path:{edgeType:"iEdge",sortIndex:0}},IterateMap:{Default:{edgeType:"zEdge",sortIndex:0}},IterateMapByParametricDepth:{parameter:{edgeType:"zEdge",sortIndex:0},Default:{edgeType:"zEdge",sortIndex:1}},IterateImage:{source:{edgeType:"dEdge",sortIndex:0},map:{edgeType:"dEdge",sortIndex:1}},PointTerminalIteration:{image:{edgeType:"dEdge",sortIndex:0}},TranslateVector:{source:{edgeType:"rEdge",sortIndex:0},p0:{edgeType:"iEdge",sortIndex:1},p1:{edgeType:"iEdge",sortIndex:2}},TranslateFixXFixY:{source:{edgeType:"rEdge",sortIndex:0}},TranslateFixXMeasureY:{source:{edgeType:"rEdge",sortIndex:0},measure:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureXFixY:{source:{edgeType:"rEdge",sortIndex:0},measure:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureXMeasureY:{source:{edgeType:"rEdge",sortIndex:0},measureX:{edgeType:"mEdge",sortIndex:1},measureY:{edgeType:"mEdge",sortIndex:2}},TranslateFixDistFixAngle:{source:{edgeType:"rEdge",sortIndex:0}},TranslateFixDist3PtAngle:{source:{edgeType:"rEdge",sortIndex:0},A:{edgeType:"iEdge",sortIndex:1},B:{edgeType:"iEdge",sortIndex:2},C:{edgeType:"iEdge",sortIndex:3}},TranslateFixDistMeasureAngle:{source:{edgeType:"rEdge",sortIndex:0},measure:{edgeType:"mEdge",sortIndex:1}},TranslateFixDistAngleMarker:{source:{edgeType:"rEdge",sortIndex:0},marker:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureDistFixAngle:{source:{edgeType:"rEdge",sortIndex:0},distance:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureDist3PtAngle:{source:{edgeType:"rEdge",sortIndex:0},A:{edgeType:"iEdge",sortIndex:1},B:{edgeType:"iEdge",sortIndex:2},C:{edgeType:"iEdge",sortIndex:3},distance:{edgeType:"mEdge",sortIndex:4}},TranslateMeasureDistMeasureAngle:{source:{edgeType:"rEdge",sortIndex:0},angle:{edgeType:"mEdge",sortIndex:1},distance:{edgeType:"mEdge",sortIndex:2}},TranslateMeasureDistAngleMarker:{source:{edgeType:"rEdge",sortIndex:0},marker:{edgeType:"mEdge",sortIndex:1},distance:{edgeType:"mEdge",sortIndex:2}},Rotate:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1}},Rotate3:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},A:{edgeType:"iEdge",sortIndex:2},B:{edgeType:"iEdge",sortIndex:3},C:{edgeType:"iEdge",sortIndex:4}},RotateMeasureAngle:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},angle:{edgeType:"mEdge",sortIndex:2}},RotateAngleMarker:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},angle:{edgeType:"tEdge",sortIndex:2}},DilateFixFactor:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1}},Dilate2SegRatio:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},seg0:{edgeType:"mEdge",sortIndex:2},seg1:{edgeType:"mEdge",sortIndex:3}},Dilate3PtRatio:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},A:{edgeType:"iEdge",sortIndex:2},B:{edgeType:"iEdge",sortIndex:3},C:{edgeType:"iEdge",sortIndex:4}},DilateMeasureFactor:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},measure:{edgeType:"mEdge",sortIndex:2}},Reflect:{source:{edgeType:"rEdge",sortIndex:0},mirror:{edgeType:"tEdge",sortIndex:1}},GeomLocus:{drivenObject:{edgeType:"dEdge",sortIndex:0},domainObject:{edgeType:"iEdge",sortIndex:1},driverObject:{edgeType:"iEdge",sortIndex:2},Default:{edgeType:"iEdge",sortIndex:3}},MeasurementLength:{path:{edgeType:"zEdge",sortIndex:0}},MeasurementDistance:{p0:{edgeType:"zEdge",sortIndex:0},obj0:{edgeType:"zEdge",sortIndex:1}},MeasurementPerimeter:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementCircumference:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementAngle:{p0:{edgeType:"zEdge",sortIndex:0},p1:{edgeType:"zEdge",sortIndex:1},p2:{edgeType:"zEdge",sortIndex:2}},MeasurementAngleMarker:{marker:{edgeType:"zEdge",sortIndex:0}},MeasurementArea:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementArcAngle:{arc:{edgeType:"zEdge",sortIndex:0}},MeasurementArcOnCircleAngle:{circle:{edgeType:"zEdge",sortIndex:0},p0:{edgeType:"zEdge",sortIndex:1},p1:{edgeType:"zEdge",sortIndex:2},p2:{edgeType:"zEdge",sortIndex:3}},MeasurementArcLength:{arc:{edgeType:"zEdge",sortIndex:0}},MeasurementArcOnCircleLength:{circle:{edgeType:"zEdge",sortIndex:0},p0:{edgeType:"zEdge",sortIndex:1},p1:{edgeType:"zEdge",sortIndex:2},p2:{edgeType:"zEdge",sortIndex:3}},GeometricSlope:{straight:{edgeType:"zEdge",sortIndex:0}},MeasurementRadius:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementRatio:{obj0:{edgeType:"zEdge",sortIndex:0},obj1:{edgeType:"zEdge",sortIndex:1},obj2:{edgeType:"zEdge",sortIndex:2}},Calculation:{Default:{edgeType:"zEdge",sortIndex:0}},MeasurementRectCoordinates:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},LinearEquationM_C:{Default:{edgeType:"zEdge",sortIndex:0}},QuadraticEquationM_C:{Default:{edgeType:"zEdge",sortIndex:0}},HorizontalUnitPoint:{origin:{edgeType:"iEdge",sortIndex:0}},VerticalUnitPoint:{origin:{edgeType:"iEdge",sortIndex:0}},UnitPointInternalSquare:{unitPoint:{edgeType:"rEdge",sortIndex:0}},UnitPointInternalRectangle:{unitPoint:{edgeType:"iEdge",sortIndex:0}},UnitPointExternalSquare:{axis:{edgeType:"dEdge",sortIndex:0}},UnitPointExternalRectangle:{axis:{edgeType:"iEdge",sortIndex:0}},AxisInternalDist:{origin:{edgeType:"dEdge",sortIndex:0},unitPoint:{edgeType:"dEdge",sortIndex:1}},AxisExternalDist:{origin:{edgeType:"dEdge",sortIndex:0},unitDistance:{edgeType:"mEdge",sortIndex:1}},AxisUnitCircle:{circle:{edgeType:"dEdge",sortIndex:0}},CoordSys:{axisX:{edgeType:"dEdge",sortIndex:0},axisY:{edgeType:"dEdge",sortIndex:1}},ActionButton:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonToggleHideShow:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonHide:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonShow:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonAnimate:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonMove:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonScroll:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonLinkPage:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonLinkURL:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonPresentSequentially:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonPresentSimultaneously:{Default:{edgeType:"nEdge",sortIndex:0}},Line:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},Ray:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},MeasurementAbscissa:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},MeasurementOrdinate:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},MeasurementPolarDistance:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},MeasurementPolarDirection:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},PlotFixedXFixedY:{coordSys:{edgeType:"dEdge",sortIndex:0}},PlotFixedXMarkedY:{coordY:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedXFixedY:{coordX:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedXMarkedY:{coordX:{edgeType:"mEdge",sortIndex:0},coordY:{edgeType:"mEdge",sortIndex:1},coordSys:{edgeType:"dEdge",sortIndex:2}},PlotFixedRhoFixedTheta:{coordSys:{edgeType:"dEdge",sortIndex:0}},PlotFixedRhoMarkedTheta:{coordTheta:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedRhoFixedTheta:{coordRho:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedRhoMarkedTheta:{coordRho:{edgeType:"mEdge",sortIndex:0},coordTheta:{edgeType:"mEdge",sortIndex:1},coordSys:{edgeType:"dEdge",sortIndex:2}},Function:{Default:{edgeType:"zEdge",sortIndex:0}},FunctionPlot:{"function":{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},CompositeText:{Default:{edgeType:"zEdge",sortIndex:0}},MeasurementPolarCoordinates:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},ColorizeUnivariate:{source:{edgeType:"dEdge",sortIndex:0},color:{edgeType:"oEdge",sortIndex:1}},ColorizeTrivariate:{source:{edgeType:"dEdge",sortIndex:0},blue:{edgeType:"oEdge",sortIndex:1},green:{edgeType:"oEdge",sortIndex:2},red:{edgeType:"oEdge",sortIndex:3}},Derivative_C:{Default:{edgeType:"zEdge",sortIndex:0}},ArcOnCircle:{circle:{edgeType:"dEdge",sortIndex:0},p0:{edgeType:"dEdge",sortIndex:1},p1:{edgeType:"dEdge",sortIndex:2}},ArcAroundPoint:{center:{edgeType:"dEdge",sortIndex:0},p0:{edgeType:"dEdge",sortIndex:1},p1:{edgeType:"dEdge",sortIndex:2}},Arc3Points:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},ArcSector:{arc:{edgeType:"dEdge",sortIndex:0}},ArcSegment:{arc:{edgeType:"dEdge",sortIndex:0}},PictureHungOnOnePoint:{p0:{edgeType:"dEdge",sortIndex:0}},PictureCenteredOnOnePoint:{p0:{edgeType:"dEdge",sortIndex:0}},PictureBetweenTwoPoints:{p1:{edgeType:"dEdge",sortIndex:0},p0:{edgeType:"dEdge",sortIndex:1}},PictureAcrossThreePoints:{p2:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p0:{edgeType:"dEdge",sortIndex:2}},PictureCroppedByInterior:{source:{edgeType:"dEdge",sortIndex:0},cropInterior:{edgeType:"dEdge",sortIndex:1}},PictureFunction_C:{Default:{edgeType:"zEdge",sortIndex:0}},MeasurementCoordinateDistance:{p0:{edgeType:"zEdge",sortIndex:0},p1:{edgeType:"zEdge",sortIndex:1},coordSys:{edgeType:"zEdge",sortIndex:2}},MeasurementAnalyticSlope:{seg:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},Pegged:{p0:{edgeType:"dEdge",sortIndex:0},text:{edgeType:"iEdge",sortIndex:1}},UserTabulation_C:{Default:{edgeType:"zEdge",sortIndex:0}},IteratedValuesTable_C:{Default:{edgeType:"zEdge",sortIndex:0}},InterRayPolgon_C:{Default:{edgeType:"dEdge",sortIndex:0}},ParametricLocus:{drivenObject:{edgeType:"dEdge",sortIndex:0},driverObject:{edgeType:"iEdge",sortIndex:1},Default:{edgeType:"iEdge",sortIndex:2}},MeasurementValueOfPointOnPath:{point:{edgeType:"zEdge",sortIndex:0},path:{edgeType:"zEdge",sortIndex:1}},PlotValueOnPath:{param:{edgeType:"mEdge",sortIndex:0},path:{edgeType:"dEdge",sortIndex:1}},PlotFixedValueOnPath:{path:{edgeType:"dEdge",sortIndex:0}},InterApproxPathStitchedPath_C:{Default:{edgeType:"dEdge",sortIndex:0}},CustomTransformedPicture_C:{Default:{edgeType:"iEdge",sortIndex:0}},CustomTransformedPoint_C:{Default:{edgeType:"iEdge",sortIndex:0}},CustomTransformedPath:{drivenObject:{edgeType:"iEdge",sortIndex:0},domainObject:{edgeType:"dEdge",sortIndex:1},driverObject:{edgeType:"iEdge",sortIndex:2},Default:{edgeType:"iEdge",sortIndex:3}},AngleMarker_Simple:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},AngleMarker_Reflex:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},AngleMarker_CCW:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},AngleMarker_CW:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},PathMarker_C:{Default:{edgeType:"dEdge",sortIndex:0}},ParametricCartesianCurvePlot_C:{Default:{edgeType:"mEdge",sortIndex:0}},ParametricPolarCurvePlot_C:{Default:{edgeType:"mEdge",sortIndex:0}}};y.Bap=(function(){function E(K,H){var J=y.BapEdgeInfo[K.constraint],I,G;if(!J){y.signalErrorWithMessage("BAP [getEdgeForParentAtIndex] No edge info for constraint: "+K.constraint);return}for(I in J){if(J.hasOwnProperty(I)){if(J[I].sortIndex===H){G=J[I].edgeType;break}}}return G||J.Default.edgeType}function D(S,Y){var M={},U=[],V=[],G=[],O;function T(ae){M[ae.id]={gobj:ae,action:"none",transCode:0}}function W(ak,ag,al,am){var ai=ag,ae,af=E(ak,0);if(h===M[ak.id]){T(ak);if(ai==="selected"){if(("zEdge"!==af)&&("nEdge"!==af)){ai="controller"}else{M[ak.id].isSelectedZ=true}}}ae=M[ak.id].action;if(ae==="selected"){M[ak.id].action=ai;M[ak.id].transCode=al;ae=ai}if((ai===ae)&&(al===M[ak.id].transCode)){return}if((ai==="controller")&&M[ak.id].isController){return}if(ae&&ae!=="none"){if(("constrain"===ai)&&M[ak.id].isLink&&(am&&M[ak.id].transCode===M[am.id].transCode)){if(M[am.id].isLink){return}if(!M[ak.id].isController){ai="link"}}var ah={},aj={none:0,controller:1,link:2,constrained:3,follower:4,selected:5};ah[ae]=true;ah[ai]=true;if(ah.hasOwnProperty("link")&&ah.hasOwnProperty("constrained")&&((-1===al)||al===M[ak.id].transCode)){ai="link"}else{if(ah.hasOwnProperty("constrained")&&(ah.hasOwnProperty("link")||ah.hasOwnProperty("controller"))){ai="follower";al=0}}if(aj[ai]<aj[ae]){return}}else{U.push(ak)}M[ak.id].action=ai;if(0<=al){M[ak.id].transCode=al}}function L(ai,af,ah,ae,aj){var ag=function(am,an){var al=E(ai,am),ak=true;if(!af||af[al]){if(al==="zEdge"){if((!M[an.id]||(an.constraint==="Free"))&&an.kind==="Expression"){ak=false}else{if(!M[an.id]&&(ai.kind==="Expression"||!aj)){ak=false}}}else{if(al==="mEdge"&&!aj){ak=M[an.id]?true:false}}if(ak){if("link"===ah){if(!M[an.id]){T(an)}M[an.id].controller=ai}W(an,ah,ae)}}return true};ai.eachParent(ag,true)}function Z(ag){var ae={},af=function(aj,ak){var ah=M[ak.id],ai=E(ag,aj);if(ah&&!ah.isSelectedZ){switch(ai){case"rEdge":if(M[ak.id].controller!==ag){ae.incompatibleParent=true}break;case"dEdge":case"iEdge":case"tEdge":if(ah.transCode!==M[ag.id].transCode){ae.incompatibleParent=true}break}if(ae[ai]===h){ae[ai]="allAffected"}else{if(ae[ai]==="noneAffected"){ae[ai]="someAffected"}}}else{if(ae[ai]===h){ae[ai]="noneAffected"}else{if(ae[ai]==="allAffected"){ae[ai]="someAffected"}}}return true};ag.eachParent(af,true);return ae}var P=[];function ab(ah){var af,ae;function ai(al,ak){var aj=true;if(al.parents.length!==ak.parents.length){return false}al.eachParent(function(am,an){if("rEdge"!==E(al,am)){if(an!==ak.parentsList[am]){aj=false;return false}}return true},true);return aj}function ag(ao,am){var ak,aj,an,al;ak=ao.getTransformer();aj=am.getTransformer();an=ak.getAffineTransform();al=aj.getAffineTransform();return an.isEqual(al)}for(af=0;af<P.length;af++){ae=P[af];if((ae===ah)&&(M[ae.id].isLink)){return af+1}if((M[ae.id].transCode===M[ah.id].transCode)&&(M[ae.id].isLink)&&(ae.constraint===ah.constraint)&&ai(ae,ah)&&ag(ae,ah)){return af+1}}P.push(ah);return af+1}function I(ah,ae){var ag={zEdge:true,dEdge:true},af=true;if(ae.iEdge&&(ae.iEdge!=="noneAffected")){ag.iEdge=true;ag.rEdge=true;ag.tEdge=true}if((ae.iEdge==="noneAffected")||(ae.mEdge==="noneAffected")||(ae.mEdge==="someAffected")){af=false}if((ae.rEdge&&(ae.rEdge!=="noneAffected")&&ae.incompatibleParent)||(ae.tEdge&&(ae.tEdge!=="noneAffected"))){ag.tEdge=true;ag.rEdge=true}if(ae.tEdge==="noneAffected"){af=false}if(ae.mEdge&&(ae.mEdge!=="noneAffected")){ag.tEdge=true;ag.mEdge=true;ag.rEdge=true}if(af&&((!ae.mEdge)||ae.mEdge==="allAffected")){M[ah.id].completeFollower=true}L(ah,ag,"controller",-1,af)}function H(af,ae){if(M[af.id].isLink&&(M[af.id].controller)){W(M[af.id].controller,"follower",0,af)}M[af.id].transCode=0;M[af.id].controller=h;M[af.id].isConstrained=false;M[af.id].isLink=false;M[af.id].isDragRoot=false;M[af.id].isController=false;M[af.id].isFollower=true;L(af,{zEdge:true,dEdge:true},"controller",0);I(af,ae)}function ad(ag,ae){if(M[ag.id].isLink){var af=function(){var ai=(ae.iEdge==="someAffected")||(ae.iEdge==="allAffected")||(ae.mEdge==="someAffected")||(ae.mEdge==="allAffected")||(ae.tEdge==="someAffected")||(ae.tEdge==="allAffected");if(!ai){if(ae.dEdge){ag.eachParent(function(ak,al){if(("dEdge"===E(ag,ak))&&M[al.id]){if((M[al.id].transCode!==M[ag.id].transCode)||(!M[al.id].isLink)){ai=true;return false}}return true},true)}else{if(ae.rEdge){var ah=ab(ag),aj=ag.parentsList[0];ai=((ah!==0)&&aj&&(ah!==M[aj.id].transCode))}}}return ai};if(af()){H(ag,ae)}}else{if(M[ag.id].isFollower&&!M[ag.id].completeFollower){I(ag,ae)}}if(M[ag.id].isSelectedZ&&!M[ag.id].isConstrained){M[ag.id].kidsAreConstrained=false}M[ag.id].isConstrained=true}function ac(af,ae){if(!ae.incompatibleParent&&!ae.dEdge&&!ae.rEdge&&(!ae.iEdge||ae.iEdge==="noneAffected")&&(!ae.tEdge||ae.tEdge==="noneAffected")&&(!ae.mEdge||ae.mEdge==="noneAffected")){M[af.id].isLink=true;if("zEdge"!==E(af,0)){M[af.id].isDragRoot=true}else{L(af,{zEdge:true},"link",M[af.id].transCode)}}else{if((ae.tEdge&&ae.tEdge!=="noneAffected")||((ae.iEdge&&ae.iEdge!=="noneAffected")&&ae.rEdge)){return H(af,ae)}else{if(ae.incompatibleParent){return H(af,ae)}else{M[af.id].isLink=true;if(!M[af.id].transCode){M[af.id].isFollower=true}L(af,{dEdge:true},"link",M[af.id].transCode);if(ae.rEdge==="noneAffected"){L(af,{rEdge:true},"link",ab(af))}if(ae.iEdge&&ae.iEdge!=="noneAffected"){L(af,{tEdge:true,iEdge:true},"link",M[af.id].transCode);if((0===M[af.id].transCode)&&(!ae.mEdge||ae.mEdge==="allAffected")){M[af.id].completeFollower=true}}else{if(ae.tEdge&&ae.tEdge!=="noneAffected"){L(af,{tEdge:true},"link",M[af.id].transCode);if((0===M[af.id].transCode)&&(!ae.mEdge||ae.mEdge==="allAffected")&&!ae.iEdge){M[af.id].completeFollower=true}}else{if(!ae.iEdge&&!ae.tEdge&&(!ae.mEdge||ae.mEdge==="allAffected")&&(0===M[af.id].transCode)){M[af.id].completeFollower=true}}}if(ae.mEdge&&ae.mEdge!=="noneAffected"){L(af,{mEdge:true},"link",M[af.id].transCode)}}}}}function R(ai,ae){var ah=true,af;if("zEdge"===E(ai,0)){L(ai,{zEdge:true},"controller",0);ah=false}else{if((ae.iEdge&&(ae.iEdge!=="noneAffected"))||(ae.tEdge&&(ae.tEdge!=="noneAffected"))||(ae.mEdge&&(ae.mEdge!=="noneAffected"))){ah=false}else{if(ae.dEdge){L(ai,{dEdge:true},"controller",0);ah=false}else{if(ae.rEdge==="allAffected"){af=ai.parentsList[0];if(af&&(M[af.id].controller!==ai)){ah=false}}}}}if(!ah){return H(ai,ae)}if(M[ai.id].controller){W(M[ai.id].controller,"follower",0,ai);M[ai.id].controller=h}M[ai.id].isController=true;M[ai.id].isLink=true;M[ai.id].isFollower=true;if(!(ae.iEdge||ae.tEdge||ae.mEdge)){M[ai.id].completeFollower=true}M[ai.id].isDragRoot=(!(ae.rEdge)||(ae.dEdge))?true:false;if(ae.rEdge){var ag=ab(ai);af=ai.parentsList[0];if((ae.rEdge==="noneAffected")&&(!M[af.id]||(M[af.id].transCode!==ag))){if(!M[af.id]){T(af)}M[af.id].transCode=ag;M[af.id].controller=ai;L(ai,{rEdge:true},"link",ag)}}}function X(aj){var af;function ak(al,am){am.eachParent(function(ao,an){if(an===al){af=E(am,ao);return false}return true});return af}var ah,ag,ae,ai;for(ah=aj.children.length-1;ah>=0;ah--){ai=-1;ae=aj.children[ah];ag=ak(aj,ae);if("nEdge"!==ag){if("dEdge"===ag){ai=M[aj.id].transCode}W(ae,"constrained",ai,aj)}}M[aj.id].kidsAreConstrained=true}function K(){var ag,af,ae,ah;ag=U.shift();while(ag){af=M[ag.id];if(!af.addedToProcessed){V.push(ag);M[ag.id].addedToProcessed=true;if(af.action!=="selected"){af.isConstrained=true}}ae=Z(ag);ah=af.action;af.action="none";switch(ah){case"constrained":ad(ag,ae);break;case"link":ac(ag,ae);break;case"controller":R(ag,ae);break;case"follower":H(ag,ae);break}if((!af.isSelectedZ)&&(!af.kidsAreConstrained)&&(ag.constraint!=="Free"||ag.kind!=="Expression")){X(ag)}ag=U.shift()}}function Q(){var ai,al=[],am=[],ah,ag,aj;function af(){var ao=0,an,ap;function aq(ar,at){if(M[at.id]&&!M[at.id].hasBeenAddedToOrderedList&&!M[at.id].isSelectedZ){ap=false;return false}return true}while(V.length>0){ap=true;an=V[ao];an.eachParent(aq,true);if(ap){am.push(an);V.splice(ao,1);M[an.id].hasBeenAddedToOrderedList=true}else{ao++}if(ao===V.length){ao=0}}}function ak(ap){var ao,an;for(ao=0;ao<al.length;ao++){if(al[ao].gobj===ap){an=ao}}return an}function ae(){var ap,an,aq,ao;for(ap=0;ap<al.length;ap++){if((al[ap].controlRefs===0)&&!al[ap].isDragRoot){aq=al[ap].controlIndex;for(an=ap+1;an<al.length;an++){if(al[an].controlIndex>ap){al[an].controlIndex--}}ao=al.slice(ap+1);al.splice(ap);al=al.concat(ao);if(aq>=0){al[aq].controlRefs--;ap=aq-1}else{ap--}}}}af();for(ah=am.length-1;ah>=0;ah--){ai=am[ah];ag=M[ai.id];if(ag.isController||ag.isLink||ag.isDragRoot||ag.isSelectedZ){if(ag.isSelectedZ){ag.isController=true;ag.isDragRoot=true}aj={gobj:ai,isController:ag.isController?true:false,isDragRoot:ag.isDragRoot?true:false,controlRefs:0};if(aj.isController){aj.controlIndex=-1;aj.isTransformParent=false}else{aj.controlIndex=ak(ag.controller);aj.isTransformParent=(M[ag.controller.id].transCode!==ag.transCode);al[aj.controlIndex].controlRefs++}al.push(aj)}}ae();return al}function aa(){var af,ae=[];for(O=0;O<S.length;O++){af=S[O].parentsList;if((S[O].constraint==="GeomLocus")&&(af[0]===af[af.length-1])){ae.push({gobj:S[O],parent:S[O].parentsList.pop()})}}return ae}function N(ae){var af;if(ae){for(af=0;af<ae.length;af++){ae[af].gobj.parentsList.push(ae[af].parent)}}}var J=aa();for(O=0;O<S.length;O++){W(S[O],"selected",0)}K();G=Q();N(J);return G}var F={createControlList:function(I){var G,H=I[0];if(this.sketch.getOption("bap-useDebugControlList")&&I.length===1&&H.debug&&H.debug.controlList){G=y.ControlList.fromExternalList(H.debug.controlList,this.sketch)}else{G=D(I,this.sketch)}return G}};return function(H){var G=Object.create(F);G.sketch=H;return G}}());if(typeof l.btoa==="undefined"){var o={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(F){var D="";var M,K,I,L,J,H,G;var E=0;F=o._utf8_encode(F);while(E<F.length){M=F.charCodeAt(E++);K=F.charCodeAt(E++);I=F.charCodeAt(E++);L=M>>2;J=((M&3)<<4)|(K>>4);H=((K&15)<<2)|(I>>6);G=I&63;if(isNaN(K)){H=G=64}else{if(isNaN(I)){G=64}}D=D+this._keyStr.charAt(L)+this._keyStr.charAt(J)+this._keyStr.charAt(H)+this._keyStr.charAt(G)}return D},decode:function(F){var D="";var M,K,I;var L,J,H,G;var E=0;F=F.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(E<F.length){L=this._keyStr.indexOf(F.charAt(E++));J=this._keyStr.indexOf(F.charAt(E++));H=this._keyStr.indexOf(F.charAt(E++));G=this._keyStr.indexOf(F.charAt(E++));M=(L<<2)|(J>>4);K=((J&15)<<4)|(H>>2);I=((H&3)<<6)|G;D=D+String.fromCharCode(M);if(H!=64){D=D+String.fromCharCode(K)}if(G!=64){D=D+String.fromCharCode(I)}}D=o._utf8_decode(D);return D},_utf8_encode:function(E){E=E.replace(/\r\n/g,"\n");var D="";for(var G=0;G<E.length;G++){var F=E.charCodeAt(G);if(F<128){D+=String.fromCharCode(F)}else{if((F>127)&&(F<2048)){D+=String.fromCharCode((F>>6)|192);D+=String.fromCharCode((F&63)|128)}else{D+=String.fromCharCode((F>>12)|224);D+=String.fromCharCode(((F>>6)&63)|128);D+=String.fromCharCode((F&63)|128)}}}return D},_utf8_decode:function(D){var E="";var F=0;var G=c1=c2=0;while(F<D.length){G=D.charCodeAt(F);if(G<128){E+=String.fromCharCode(G);F++}else{if((G>191)&&(G<224)){c2=D.charCodeAt(F+1);E+=String.fromCharCode(((G&31)<<6)|(c2&63));F+=2}else{c2=D.charCodeAt(F+1);c3=D.charCodeAt(F+2);E+=String.fromCharCode(((G&15)<<12)|((c2&63)<<6)|(c3&63));F+=3}}}return E}};y.btoa=function(D){return o.encode(D)}}else{y.btoa=function(D){return l.btoa(D)}}y.Scroll=function(E){var D=y.makeClass(y.TouchTracker,{primalLoc:null,touchBegan:function(G,F){E.event("StartScroll",{touch:F,position:G});this.primalLoc=y.GeometricPoint(G.x,G.y)},touchMoved:function(J,I){var G=y.GeometricPoint(J.x,J.y),H=this.primalLoc.subtract(G),F=this.primalLoc.copy();E.event("MoveScroll",{touch:I,position:J});E.primalToViewTransform().transform(F);E.translate(H.x,H.y,true);this.primalLoc=F.subtract(H);E.viewToPrimalTransform().transform(this.primalLoc)},touchEnded:function(F){E.event("EndScroll",{touch:F});this.primalLoc=null}});return{isScrolling:function(){return !!D.primalLoc},createTracker:function(){if(!this.isScrolling()){return D}},translate:function(H,G){var F,I=this.isScrolling();if(I){F=D.primalLoc.copy();E.primalToViewTransform().transform(F)}E.translate(H,G,false);if(I){E.viewToPrimalTransform().transform(F);D.primalLoc=F}}}};y.MotionManager=(function(){function E(I,G){var J=[],H,F;if(I.isValueChangingMotion!==G.isValueChangingMotion){return false}if(!(I.controlList&&G.controlList)){y.signalErrorWithMessage("motionsConflict finds motion without a control list");return false}for(H=I.controlList.length-1;H>=0;H--){if(I.controlList[H].isDragRoot){J.push(I.controlList[H].gobj)}}for(H=G.controlList.length-1;H>=0;H--){if(G.controlList[H].isDragRoot){for(F=0;F<J.length;F++){if(J[F]===G.controlList[H].gobj){return true}}}}return false}var D={_motionJob:null,StartMotion:function(F,K){var L=this.motionID++,H,G=this;this.motionSet[L]={motion:F,state:"active",refCon:K};for(H=0;H<this.motionList.length;H++){if(E(this.motionSet[this.motionList[H]].motion,F)){y.log("found conflicting motions, canceling "+this.motionList[H]+", keeping "+L);this.EndMotion(this.motionList[H])}}this.motionList.push(L);function J(){return G.ApplyCurrent()}var I={repeat:true,done:function(){G._motionJob=null}};if(!y.JobScheduler.isActive(G._motionJob)){G._motionJob=G.sketch.jobScheduler.addJob(J,I)}return L},UpdateRefCon:function(G,F){this.motionSet[G].refCon=F},GetRefCon:function(F){return this.motionSet[F].refCon},EndMotion:function(F){this.motionSet[F].state="cancelled"},StopAllMotions:function(){var F=this.sketch;F.sQuery("Button").forEach(function(G){if(((G.constraint==="ActionButtonMove")||(G.constraint==="ActionButtonAnimate"))&&G.state.isActive){G.press(F)}})},ApplyCurrent:function(){var G,J,I=this;for(G=0;G<this.motionList.length;G++){J=this.motionSet[this.motionList[G]];if(J.state==="active"){try{J.motion.applyMotion(J.refCon)}catch(F){}}}for(G in this.motionList){J=this.motionSet[this.motionList[G]];if(J.state==="cancelled"){try{J.motion.completeMotion(J.refCon)}catch(H){}delete this.motionSet[this.motionList[G]]}}this.motionList=g.grep(this.motionList,function(K){return h!==I.motionSet[K]});if(this.motionList.length===0){return false}},ApplyTransformToControlList:function(Q,G,T,N){var K,S,M,P=N&&N.snapPoints&&Q.preferences.snapToGrid,L,H;if(P){L=Q.findExistingCoordSys()}for(K=0;K<T.length;K++){S=T[K];M=S.gobj;H=L;if(P&&!H&&M.style.snapToGrid){H=M.getGObjRef(M.style.snapToGrid)}if(S.isController){S.transform=G}else{S.transform=T[S.controlIndex].transform}if(S.isTransformParent){var J=T[S.controlIndex],O=J.gobj.getTransformer(),R=O.getAffineTransform(),F;F=R.inverse();if(null!==F){S.transform=R.compose(J.transform).compose(F)}}if(S.isDragRoot&&M.state.exists){if(N&&N.onPathTracksIdealLoc&&S.gobj.kind==="Point"){if(!S.idealLocation){S.idealLocation={loc:S.gobj.geom.loc.copy()}}S.idealLocation.loc=S.transform.transform(S.idealLocation.loc);M.transform(Q,{geom:(S.idealLocation),affine:y.AffineTransform.Identity})}else{M.transform(Q,{geom:S.gobj.geom,affine:S.transform})}if((M.kind==="Point")&&H){var I=100;if(H.snapPoint&&H.state.exists&&!M.hasDescendant(H)){H.snapPoint(M.geom.loc,I)}}M.sQuery.sketch.invalidateGeom(M)}}}};return function(G){var F=Object.create(D);F.motionList=[];F.sketch=G;F.motionID=0;F.motionSet={};return F}}());y.registerEditable=function(F){function H(){try{if(!r.activeElement&&typeof(r.body.setActive)==="function"){r.body.setActive()}}catch(I){}}var G=F.sQuery;function E(K,M,J){var L=G().get(M),I=K.data("wsp-numfield-ctl");I.click(J,L);H();L.state.selected=true;return false}function D(I){var J=g(this),K=J.parents(".wsp-Expression").attr("wsp-id");return E(J,K,I)}g(F.canvasNode).on("click",".mfs-input",D);g(F.canvasNode).on("keypress",".mfs-input",function(I){var J=I.which;if(J===13){g(this).blur();return false}})};y.GeometricPoint=(function(){var D={transformClass:"GeometricPoint",getX:function(){return this.x},getY:function(){return this.y},toString:function(){return"{ x:"+this.x+", y:"+this.y+"}"},equals:function(E,F){if(typeof F==="undefined"){F=0}if(E){return(Math.abs(this.x-E.x)<=F&&Math.abs(this.y-E.y)<=F)}else{return false}},negate:function(){return y.GeometricPoint(-this.x,-this.y)},round:function(){return y.GeometricPoint(Math.round(this.x),Math.round(this.y))},add:function(E){return y.GeometricPoint(this.x+E.getX(),this.y+E.getY())},subtract:function(E){return y.GeometricPoint(this.x-E.getX(),this.y-E.getY())},multiply:function(E){return y.GeometricPoint(this.x*E,this.y*E)},dot:function(E){return(this.x*E.getX())+(this.y*E.getY())},vLength:function(){return Math.sqrt(this.dot(this))},distance:function(E){return this.subtract(E).vLength()},vLength2:function(){return this.dot(this)},isZeroLength:function(){return(this.x===0&&this.y===0)},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},isDefined:function(){return !isNaN(this.x)&&!isNaN(this.y)},rotate:function(F,J){var I=this.subtract(F);var H=Math.cos(J);var G=Math.sin(J);var E=y.GeometricPoint(H*I.x-G*I.y,G*I.x+H*I.y);return E.add(F)},unit:function(){return this.multiply(1/this.vLength())},scale:function(E,F){return this.subtract(E).multiply(F).add(E)},copy:function(){return this.multiply(1)}};return function(E,G){var F;if(typeof E==="string"){E=Number(E)}if(typeof E!=="number"){E=NaN}if(typeof G==="string"){G=Number(G)}if(typeof G!=="number"){G=NaN}F=Object.create(D);F.x=E;F.y=G;return F}}());y.GeometricPoint.ORIGIN=y.GeometricPoint(0,0);y.GeometricPoint.INFINITY=y.GeometricPoint(Infinity,Infinity);y.GeometricPoint.UNDEFINED=y.GeometricPoint(h,h);y.GeometricPoint.FromCenterRadiusAngle=function(E,D,F){return y.GeometricPoint(E.x+D*Math.cos(F),E.y+D*Math.sin(F))};y.GeometricPoint.threePointAngle=function(F,D,J){var H,E,G,I;H=F.subtract(D);G=J.subtract(D);E=new y.GeometricPoint(G.dot(H),G.y*H.x-G.x*H.y);H=new y.GeometricPoint(H.dot(H),0);if(Math.abs(H.x)<0.0004){return h}if(Math.abs(E.x)<0.0004){if(Math.abs(E.y)<0.0004){return h}else{if(E.y>0){I=Math.PI/2}else{I=-Math.PI/2}}}else{if(Math.abs(E.y)<0.0004){I=(E.x>=0)?0:Math.PI}else{I=Math.atan(E.y/E.x);if(E.x<0){if(E.y>=0){I+=Math.PI}else{I-=Math.PI}}}}return I};y.GeometricPoint.threePointFlippedAngle=function(E,D,G){var F=y.GeometricPoint.threePointAngle(E,D,G);if((Math.abs(F)>0)&&(Math.abs(F)<Math.PI)){F=-F}return F};y.GeometricPoint.expect=function(F,E,D){if((F===h)!==(E===h)){return false}if((F===null)!==(E===null)){return false}return y.math.expect(F.getX(),E.getX(),D,true)&&y.math.expect(F.getY(),E.getY(),D,true)};y.GeometricPoint.mapPointToLine=function(K,J,I,F){var D,G,H,E={};D=I.subtract(K);G=J.subtract(K);H=D.dot(G)/G.dot(G);if(F){if(F.clampP0&&H<0){H=0}if(F.clampP1&&H>1){H=1}if(F.returnPoint){E.point=K.add(G.multiply(H))}}E.param=H;return E};y.GeometricPoint.curryFunction=function(D){var E=Array.prototype.slice.call(arguments,1);return function(F){return F[D].apply(F,E)}};(function(){var H,D,F=["m00","m10","m20","m01","m11","m21"],G=6;function E(K,J){var I=K,L=J;if(L===h){I=K.hasOwnProperty("dx")?K.dx:K.x;L=K.hasOwnProperty("dy")?K.dy:K.y}return{x:I,y:L}}H={transformClass:"AffineTransform",toString:function(){var I="[";I+="[m00: "+this.m00+" m10: "+this.m10+" m20: "+this.m20+"]";I+="[m01: "+this.m01+" m11: "+this.m11+" m21: "+this.m21+"]";I+="]";return I},toStringCSS:function(){return"matrix("+this.m00+","+this.m01+","+this.m10+","+this.m11+","+this.m20+","+this.m21+")"},transform:function(J){var I,K,L;if(J.getX&&J.getY){K=this.m00*J.getX()+this.m10*J.getY()+this.m20;L=this.m01*J.getX()+this.m11*J.getY()+this.m21;J.x=K;J.y=L;return J}else{if(typeof(J)==="object"){for(I in J){this.transform(J[I])}}}},compose:function(I){return new D({m00:I.m00*this.m00+I.m10*this.m01,m10:I.m00*this.m10+I.m10*this.m11,m20:I.m00*this.m20+I.m10*this.m21+I.m20,m01:I.m01*this.m00+I.m11*this.m01,m11:I.m01*this.m10+I.m11*this.m11,m21:I.m01*this.m20+I.m11*this.m21+I.m21})},translate:function(J,I){var K=E(J,I);return new D({m00:this.m00,m10:this.m10,m20:this.m20+K.x,m01:this.m01,m11:this.m11,m21:this.m21+K.y})},scale:function(K,I){var J=E(K,I);return new D({m00:this.m00*J.x,m10:this.m10*J.x,m20:this.m20*J.x,m01:this.m01*J.y,m11:this.m11*J.y,m21:this.m21*J.y})},rotate:function(K){var J=Math.cos(K),I=Math.sin(K);return new D({m00:J*this.m00-I*this.m01,m10:J*this.m10-I*this.m11,m20:J*this.m20-I*this.m21,m01:I*this.m00+J*this.m01,m11:I*this.m10+J*this.m11,m21:I*this.m20+J*this.m21})},inverse:function(){var I=this.m00*this.m11-this.m10*this.m01;if(!I){return null}return new D({m00:this.m11/I,m10:-this.m10/I,m20:(-this.m11*this.m20+this.m10*this.m21)/I,m01:-this.m01/I,m11:this.m00/I,m21:(this.m01*this.m20-this.m00*this.m21)/I})},copy:function(){return new D(this)},isEqual:function(I){return(this.m00===I.m00)&&(this.m10===I.m10)&&(this.m20===I.m20)&&(this.m01===I.m01)&&(this.m11===I.m11)&&(this.m21===I.m21)},isTranslation:function(){return(this.m00===1)&&(this.m10===0)&&(this.m01===0)&&(this.m11===1)},packIntoSampleArray:function(J,I){var K=G*I;J[K]=this.m00;J[K+1]=this.m10;J[K+2]=this.m20;J[K+3]=this.m01;J[K+4]=this.m11;J[K+5]=this.m21}};D=function(J){var L=Object.create(H),I,K;for(I in F){K=F[I];L[K]=J.hasOwnProperty(K)?J[K]:0}return L};D.Identity=new D({m00:1,m11:1});D.KeyNames=F;D.fromPointTransform=function(M){var N=M(y.GeometricPoint(0,0)),K=M(y.GeometricPoint(1,0)),I=M(y.GeometricPoint(0,1)),L=N.getX(),J=N.getY();return new D({m00:K.getX()-L,m01:K.getY()-J,m10:I.getX()-L,m11:I.getY()-J,m20:L,m21:J})};D.fromPointMapping=function(M,O){var I=M[2].subtract(M[1]),L=M[2].subtract(M[0]),K=I.getY()*L.getX()+I.getX()*(-L.getY()),N,J=null;if(K!==0){N=function(Q){var T=Q.subtract(M[2]),S=(-I.getY()*T.getX()+I.getX()*T.getY())/K,R=(L.getY()*T.getX()+-L.getX()*T.getY())/K,P=1-S-R;return O[0].multiply(S).add(O[1].multiply(R)).add(O[2].multiply(P))};J=y.AffineTransform.fromPointTransform(N)}return J};D.fromPackedSampleArray=function(K,I){var L=I*G,J={m00:K[L],m10:K[L+1],m20:K[L+2],m01:K[L+3],m11:K[L+4],m21:K[L+5]};return new D(J)};D.packedSampleSize=G;y.AffineTransform=D}());(function(F){var I=F,E,H,D;E={transformClass:function(G){if(typeof(G)==="number"){return"distance"}return G.transformClass},transformGeometricArc:function(K){var G=this;function J(){var N=G.point?G.point(K.initialPoint):K.initialPoint,M=G.point?G.point(K.finalPoint):K.finalPoint;return y.GeometricArc.FromStraightEndpoints(N,M)}function L(){var Q=G.point?G.point(K.initialPoint):K.initialPoint,P=G.point?G.point(K.middlePoint):K.middlePoint,O=G.point?G.point(K.finalPoint):K.finalPoint,N=y.Geom.ThreePointCollinear(K.initialPoint,K.finalPoint,K.middlePoint),M=y.GeometricArc.FromThreePoints(Q,P,O);if(K.orientation!==N.orientation){M.orientation*=-1}return M}return(K.orientation===0)?J():L()},doOneTransform:function(J,G){if(G===h){G=this.transformClass(J)}switch(G){case"distance":return this.distance?this.distance(J):J;case"GeometricPoint":return this.point?this.point(J):J.copy();case"AffineTransform":return J.compose(this.getAffineTransform());case"GeometricArc":return this.transformGeometricArc(J)}},getAffineTransform:function(){if(this.affineTransform){return this.affineTransform}if(this.point){return y.AffineTransform.fromPointTransform(this.point)}return y.AffineTransform.Identity},transformGeom:function(K,O){var M,L,J,G,N;for(L in K){if(K.hasOwnProperty(L)){N=K[L];M=this.transformClass(N);if(M){O[L]=this.doOneTransform(N,M)}else{if(g.isArray(N)){G=[];for(J=0;J<N.length;J+=1){G.push(this.doOneTransform(N[J]))}O[L]=G}else{O[L]=K[L]}}}}}};H=function(G){var J=Object.create(E);J.distance=null;J.point=h;J.affineTransform=h;if("function"===typeof(G)){J.point=G}else{g.extend(J,G)}return J};D=new H({distance:0});H.copyGeom=function(G,J){D.transformGeom(G,J)};I.GeomTransformer=H}(y));(function(){var D={};D.kInfiniteRect={left:Number.NEGATIVE_INFINITY,top:Number.NEGATIVE_INFINITY,right:Number.POSITIVE_INFINITY,bottom:Number.POSITIVE_INFINITY};D.isFiniteRect=function(F){return F&&(isFinite(F.top)&&isFinite(F.left)&&isFinite(F.bottom)&&isFinite(F.right))};D.isValidRect=function(F){return F&&(F.left!=null)&&(F.left===F.left)&&(F.top!=null)&&(F.top===F.top)&&(F.right!=null)&&(F.right===F.right)&&(F.bottom!=null)&&(F.bottom===F.bottom)&&(F.left<=F.right)&&(F.top<=F.bottom)};D.isEmptyRect=function(F){return !D.isValidRect(F)||(F.left===F.right)||(F.top===F.bottom)};D.containsRect=function(G,F){return D.isValidRect(G)&&D.isValidRect(F)&&(G.left<=F.left)&&(G.top<=F.top)&&(G.right>=F.right)&&(G.bottom>=F.bottom)};D.isIntersectRects=function(G,F){return D.isValidRect(G)&&D.isValidRect(F)&&(G.left<=F.right)&&(F.left<=G.right)&&(G.top<=F.bottom)&&(F.top<=G.bottom)};D.isIntersectValidRects=function(G,F){return G&&F&&(G.left<=F.right)&&(F.left<=G.right)&&(G.top<=F.bottom)&&(F.top<=G.bottom)};D.intersectRects=function(G,F){if(!D.isValidRect(G)||!D.isValidRect(F)){return null}var H={left:Math.max(G.left,F.left),top:Math.max(G.top,F.top),right:Math.min(G.right,F.right),bottom:Math.min(G.bottom,F.bottom)};return D.isValidRect(H)?H:null};D.unionRects=function(H,G){var F=D.isValidRect(H),I=D.isValidRect(G);if(!F&&I){return G}if(F&&!I){return H}if(!F&&!I){return null}return{left:Math.min(H.left,G.left),top:Math.min(H.top,G.top),right:Math.max(H.right,G.right),bottom:Math.max(H.bottom,G.bottom)}};D.insetRect=function(G,I,H){var F=(I!=null?I:1),J=(H!=null?H:F);return{left:G.left+F,top:G.top+J,right:G.right-F,bottom:G.bottom-J}};D.offsetRect=function(H,I,F){var G=I||0,J=F||G;return{left:H.left+G,top:H.top+J,right:H.right+G,bottom:H.bottom+J}};D.PointInRect=function(G,F){return((G.getX()>=F.left)&&(G.getX()<=F.right)&&(G.getY()>=F.top)&&(G.getY()<=F.bottom))};D.OctAngleUtil=function(I,J){var G=J.copy().subtract(I),H=y.GeometricPoint(Math.abs(G.getX()),Math.abs(G.getY())),F;if((G.getX()===0)&&(G.getY()===0)){return h}if(H.getX()>H.getY()){F=H.getY()/H.getX()}else{F=2-H.getX()/H.getY()}if(G.getX()<0){if(G.getY()<=0){F+=4}else{F=4-F}}else{if(G.getY()<0){F=8-F}}return F};D.RectIntersectsCurve=function(Q,I){var X=I.curve.center,J=I.curve.radius,P={top:Q.top-X.getY(),bottom:Q.bottom-X.getY(),left:Q.left-X.getX(),right:Q.right-X.getX()},W=J*J,F=P.left*P.left,U=P.right*P.right,L=P.top*P.top,N=P.bottom*P.bottom,G,H,K,T,R=y.GeometricPoint(0,0);var V=function(){var Z=!((I.type==="circle")||(I.type==="arc")),Y;if(P.right<0){if(P.top>0){Y=(U+L<W)}else{if(P.bottom<0){Y=(U+N<W)}else{Y=((-P.right)<J)}}}else{if(P.left>0){if(P.top>0){Y=(F+L<W)}else{if(P.bottom<0){Y=(F+N<W)}else{Y=(P.left<J)}}}else{if(P.top>0){Y=(P.top<J)}else{if(P.bottom<0){Y=((-P.bottom)<J)}else{Y=true}}}}if(Y&&!Z){Y=(F+L>W)||(F+N>W)||(U+L>W)||(U+N>W)}return Y};var M=function(){var Y=function(){var Z=D.OctAngleUtil(R,T);if(Z<H){Z+=8}if(Z<=K){return true}return false};if(D.PointInRect(I.curve.initialPoint,Q)){return true}if(D.PointInRect(I.curve.finalPoint,Q)){return true}while(H<0){H+=8}while(K<H){K+=8}if(L<=W){T=y.GeometricPoint(Math.sqrt(W-L),P.top);if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}T=y.GeometricPoint(T.getX()*-1,T.getY());if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}}if(N<=W){T=y.GeometricPoint(Math.sqrt(W-N),P.bottom);if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}T=y.GeometricPoint(T.getX()*-1,T.getY());if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}}if(F<=W){T=y.GeometricPoint(P.left,Math.sqrt(W-F));if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}T=y.GeometricPoint(T.getX(),T.getY()*-1);if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}}if(U<=W){T=y.GeometricPoint(P.right,Math.sqrt(W-U));if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}T=y.GeometricPoint(T.getX(),T.getY()*-1);if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}}return false};var O=function(){var ad,ab,Z=I.curve.center,ac=I.curve.initialPoint,Y=I.curve.finalPoint,aa;if(L<=W){ad=y.GeometricPoint(Q.left,Q.top);ab=y.GeometricPoint(Q.right,Q.top);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(N<=W){ad=y.GeometricPoint(Q.left,Q.bottom);ab=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(F<=W){ad=y.GeometricPoint(Q.left,Q.top);ab=y.GeometricPoint(Q.left,Q.bottom);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(U<=W){ad=y.GeometricPoint(Q.right,Q.top);ab=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(L+F<W){T=y.GeometricPoint(P.left,P.top);aa=D.OctAngleUtil(R,T);if(aa<H){aa+=8}return aa<=K}return false};var S=function(){var ac,aa,ab=I.curve.initialPoint,Y=I.curve.finalPoint;if(L<=W){ac=y.GeometricPoint(Q.left,Q.top);aa=y.GeometricPoint(Q.right,Q.top);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}if(N<=W){ac=y.GeometricPoint(Q.left,Q.bottom);aa=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}if(F<=W){ac=y.GeometricPoint(Q.left,Q.top);aa=y.GeometricPoint(Q.left,Q.bottom);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}if(U<=W){ac=y.GeometricPoint(Q.right,Q.top);aa=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}T=y.GeometricPoint(Q.left,Q.top);var Z=(L+F)<=W;return Z&&(D.ThreePointCollinear(ab,Y,T).orientation>0)};if(I.curve.orientation===0){return D.SegmentSectsRect(Q,I.curve.initialPoint,I.curve.finalPoint)}G=V();if(!G){return false}if((I.type==="circle")||(I.type==="circleInterior")){return G}H=D.OctAngleUtil(I.curve.center,I.curve.initialPoint);K=D.OctAngleUtil(I.curve.center,I.curve.finalPoint);if(M()){return true}if(I.type==="arc"){G=false}else{if(I.type==="arcSector"){G=O()}else{if(I.type==="arcSegment"){G=S()}else{y.signalErrorWithMessage("Unexpected curve type: RectIntersectsCurve should only see arcs here.")}}}return G};D.RectsIntersect=function(G,F){var J,K,I,H;J=(G.left>F.left)?G.left:F.left;H=(G.top>F.top)?G.top:F.top;K=(G.right>F.right)?G.right:F.right;I=(G.bottom>F.bottom)?G.bottom:F.bottom;return((J<=K)&&(H<=I))};D.SegmentSectsSegment=function(Q,O,N,M){var K=Q.getX(),I=Q.getY(),T=O.getX(),S=O.getY(),H=N.getX(),G=N.getY(),L=M.getX(),J=M.getY(),W=T-K,V=S-I,U=J-G,R,P=K*U,F=P+T*(-U)+H*(-V)+L*V;if((0===F)||isNaN(F)){return null}P=(P+H*(I-J)+L*(G-I))/F;if((P<0)||(P>1)){return null}R=-(K*(G-S)+T*(I-G)+H*V)/F;if((R<0)||(R>1)){return null}return y.GeometricPoint(K+(W*P),I+(V*P))};D.SegmentSectsRect=function(F,H,G){var K=D.PointInRect(H,F)||D.PointInRect(G,F),M,I,N,L;function J(){var P=H.x,O=H.y,R=G.x,Q=G.y;if((P<F.left)&&(R<F.left)){return false}if((P>F.right)&&(R>F.right)){return false}if((O<F.top)&&(Q<F.top)){return false}if((O>F.bottom)&&(Q>F.bottom)){return false}return true}if(!K&&J()){M=y.GeometricPoint(F.left,F.top);I=y.GeometricPoint(F.right,F.top);N=y.GeometricPoint(F.left,F.bottom);L=y.GeometricPoint(F.right,F.bottom);K=D.SegmentSectsSegment(H,G,M,I)||D.SegmentSectsSegment(H,G,M,N)||D.SegmentSectsSegment(H,G,I,L)||D.SegmentSectsSegment(H,G,N,L)}return(!!K)};D.IntersectionsOfRectAndSegment=function(F,I,H){var O=y.GeometricPoint(F.left,F.top),J=y.GeometricPoint(F.right,F.top),P=y.GeometricPoint(F.left,F.bottom),L=y.GeometricPoint(F.right,F.bottom),M=y.Geom.SegmentSectsSegment(I,H,O,J),G=y.Geom.SegmentSectsSegment(I,H,P,L),Q=y.Geom.SegmentSectsSegment(I,H,O,P),N=y.Geom.SegmentSectsSegment(I,H,J,L),K=[];if(M){K.push(M)}if(G){K.push(G)}if(Q){K.push(Q)}if(N){K.push(N)}return K};D.PointInParallelogram=function(H,I,G,F){function L(Q,P){return Q.getX()*P.getY()-Q.getY()*P.getX()}var K=I.subtract(G),J=F.subtract(G),N=H.subtract(G),M=L(K,J),O;if(M===0){return false}O=-L(N,K)/M;if((O<0)||(1<O)){return false}O=L(N,J)/M;if((O<0)||(1<O)){return false}return true};D.ParallelogramSectsRect=function(G,F,J,I){var H;if(D.PointInParallelogram(y.GeometricPoint(G.left,G.top),F,J,I)){return true}if(D.SegmentSectsRect(G,J,F)){return true}if(D.SegmentSectsRect(G,J,I)){return true}H=J.add(F.subtract(J)).add(I.subtract(J));if(D.SegmentSectsRect(G,F,H)){return true}if(D.SegmentSectsRect(G,I,H)){return true}return false};D.ThreePointCollinear=function(N,M,L){var H=N.subtract(M),O=L.subtract(M),F=y.GeometricPoint(O.x*H.x+O.y*H.y,O.y*H.x-O.x*H.y),K=H.vLength(),G,J;function I(P){var Q=0.0004;return((P>-Q)&&(P<Q))}G=(I(F.y)?0:y.math.sign(F.y));if(G===0){J=(H.dot(O)>0)?"fullCircle":"halfCircle"}return{exists:!I(K),orientation:G,isStraight:J}};D.AngleFromPoint=function(G){var F=Math.atan2(G.y,G.x);if(F<=-Math.PI){F+=(2*Math.PI)}return F};D.CenterFromThreePoints=function(X,Q,O){var J=Q.subtract(X),I=O.subtract(X),H=O.subtract(Q),K=X.add(Q),L=X.add(O);var Y=J.dot(K),T=I.dot(L),P=2*(J.x*H.y-J.y*H.x),N=(I.y*Y-J.y*T)/P,M=(J.x*T-I.x*Y)/P;return y.GeometricPoint(N,M)};function E(K,I){var G,F,J,H;G=I.y-K.y;F=K.x-I.x;J=G*I.x+F*I.y;H=function(){return"["+this.a+"x + "+this.b+"y = "+J+"]"};return{a:G,b:F,c:J,p0:K,p1:I,toString:H}}D.LineLineIntersection=function(G,F,M){var I=E(G.getZeroPoint(),G.getUnitPoint());var H=E(F.getZeroPoint(),F.getUnitPoint());var N=y.GeometricPoint(null,null),L,K;var J=(I.a*H.b-H.a*I.b);if(h===M){M=1e-8}if(Math.abs(J)>M){L=(H.b*I.c-I.b*H.c)/J;K=(I.a*H.c-H.a*I.c)/J;N=y.GeometricPoint(L,K)}if(N.isDefined()&&(!G.pointIsInBounds(N)||!F.pointIsInBounds(N))){N=y.GeometricPoint(NaN,NaN)}return N};D.CircleStraightIntersection=function(H,N){var X=N.getP0();var K=N.getP1();var T=H.center;var G=H.radius;var Q,F,Z,Y,V,U,S=0.001,ab,aa,W,R=0.0002,P=1e-9,O=G-R,I=G+R,M,L,J;Q=[];F=K.subtract(X);Z=F.dot(F);if(Math.abs(Z)<S){return Q}Y=2*F.dot(X.subtract(T));J=Y*Y;W=T.dot(T)+X.dot(X)-(2*T.dot(X));L=W-(I*I);U=J-4*Z*L;if(U<0){return Q}M=W-(O*O);U=J-4*Z*M;if(U<0){U=0}else{V=W-(G*G);U=J-4*Z*V}ab=X.add(F.multiply((-Y-Math.sqrt(U))/(2*Z)));if(ab.isDefined()&&N.pointIsInBounds(ab,P)){Q.push(ab)}aa=X.add(F.multiply((-Y+Math.sqrt(U))/(2*Z)));if(aa.isDefined()&&N.pointIsInBounds(aa,P)){Q.push(aa)}if(Q.length===1){Q.push(Q[0])}return Q};D.CircleCircleIntersection=function(K,I){var L=K.center;var O=K.radius;var G=I.center;var N=I.radius;var Q,H,P,M,R,J,F;Q=[];H=G.subtract(L);P=H.vLength();if(P>O+N){return Q}if(P<Math.abs(O-N)){return Q}M=((O*O)-(N*N)+(P*P))/(2*P);R=L.add(H.multiply(M/P));J=Math.sqrt((O*O)-(M*M));F=y.GeometricPoint(-H.y,H.x).multiply(J/P);Q.push(R.add(F));Q.push(R.add(F.negate()));return Q};D.RectSectsPolygon=function(K,J){var I,H,F;function G(M,Q){var L=M.x,S=M.y,R=-1,P,O,N=Q.length;P=Q[0];O=Q[Q.length-1];while(N--){if((((P.y<=S)&&(S<O.y))||((O.y<=S)&&(S<P.y)))&&((L-P.x<(O.x-P.x)*(S-P.y)/(O.y-P.y)))){R*=-1}O=P;P=Q[Q.length-N]}return(1===R)}if(G(y.GeometricPoint(K.left,K.top),J)){return true}for(F=0;F<J.length;F+=1){H=J[F];I=J[(F+1)%J.length];if(y.Geom.SegmentSectsRect(K,I,H)){return true}}return false};D.unionRectPoint=function(H,F){var G={};if(!H){G.left=G.right=F.x;G.top=G.bottom=F.y}else{G.left=Math.min(H.left,F.x);G.right=Math.max(H.right,F.x);G.top=Math.min(H.top,F.y);G.bottom=Math.max(H.bottom,F.y)}return G};y.Geom=D}());y.GeometricArc=(function(){var F=30000,E=7,G={transformClass:"GeometricArc",center:y.GeometricPoint.UNDEFINED,radius:h,initialAngle:h,finalAngle:h,initialPoint:y.GeometricPoint.UNDEFINED,middlePoint:y.GeometricPoint.UNDEFINED,finalPoint:y.GeometricPoint.UNDEFINED,orientation:h,exists:false,arcAngle:h,getZeroPoint:function(){return this.initialPoint},getUnitPoint:function(){return this.finalPoint},getP0:function(){return this.initialPoint},getP1:function(){return this.finalPoint},updateSecondaryGeometery:function(){var H=[],I=this;this.arcAngle=this.finalAngle-this.initialAngle;if(this.arcAngle<0){this.arcAngle+=2*Math.PI}if(0===this.orientation){this.arcLength=this.finalPoint.subtract(this.initialPoint).vLength()}else{this.arcLength=this.radius*this.arcAngle}H.push(this.initialPoint.x,this.initialPoint.y,this.finalPoint.x,this.finalPoint.y);if(this.orientation!==0){H.push(this.radius,this.center.x,this.center.y)}g.each(H,function(K,J){if(Math.abs(J)>F){I.exists=false;return false}})},getCache:function(I){var H;if(!this.cache){this.cache={}}if(this.cache[I]){return this.cache[I]}H={halfChordLength:0,perimeterLength:0,initialParam:0,finalParam:0};if(0===this.orientation){H.arcLength=this.finalPoint.subtract(this.initialPoint).vLength();H.perimeterLength=H.arcLength}else{if("ArcSegment"===I){H.halfChordLength=this.finalPoint.subtract(this.initialPoint).vLength()/2}else{if("ArcSector"===I){H.halfChordLength=this.radius}}H.perimeterLength=this.arcLength+2*H.halfChordLength}if(0!==H.perimeterLength){H.initialParam=H.halfChordLength/H.perimeterLength}H.finalParam=1-H.initialParam;this.cache[I]=H;return H},pointIsInBounds:function(H){var I,J=1e-7;if(this.orientation===0){var K=y.GeometricPoint.mapPointToLine(this.initialPoint,this.finalPoint,H).param;return(K>=-J&&K<=1+J)}if(this.arcAngle===2*Math.PI){return true}I=y.Geom.AngleFromPoint(H.subtract(this.center));if(I<(this.initialAngle-J)){I+=2*Math.PI}return((I>=(this.initialAngle-J))&&(I<=(this.initialAngle+this.arcAngle)+J))},mapPointToArc:function(I,N,L){var J=this.getCache(N),M=y.Geom.AngleFromPoint(I.subtract(this.center)),H=this.initialAngle+this.arcAngle,K={};if(M<this.initialAngle){M+=2*Math.PI}K.param=J.initialParam;if(L.returnPoint){K.point=this.initialPoint}if(M<=H){K.param=(M-this.initialAngle)/(H-this.initialAngle);K.param=J.initialParam+K.param*(J.finalParam-J.initialParam);if(L.returnPoint){K.point=y.GeometricPoint.FromCenterRadiusAngle(this.center,this.radius,M)}}else{if(M-H<this.initialAngle-(M-2*Math.PI)){K.param=J.finalParam;if(L.returnPoint){K.point=this.finalPoint}}}return K},mapPositionToPathValue:function(I,M){var K,L,N=[],O,H;function J(S,P){var U,T,Q=Infinity,R;if(S.length===1){return S[0]}for(R=0;R<S.length;R++){T=S[R].point.subtract(P).vLength2();if(T<Q){Q=T;U=S[R]}}return U}if(0===this.orientation){K=y.GeometricPoint.mapPointToLine(this.initialPoint,this.finalPoint,I,{clampP0:true,clampP1:true});return K.param}N.push(this.mapPointToArc(I,M,{returnPoint:M!=="SimpleArc"}));if("SimpleArc"!==M){L=this.getCache(M);H=("ArcSector"===M)?this.center:this.initialPoint.add(this.finalPoint).multiply(0.5);K=y.GeometricPoint.mapPointToLine(H,this.initialPoint,I,{clampP0:true,clampP1:true,returnPoint:true});K.param*=L.initialParam;N.push(K);K=y.GeometricPoint.mapPointToLine(H,this.finalPoint,I,{clampP0:true,clampP1:true,returnPoint:true});K.param=1-K.param*L.initialParam;N.push(K)}O=J(N,I);return(this.orientation===1)?O.param:1-O.param},mapPathValueToPosition:function(M,O){var N,L=1e-10,H,K,P,I,J;if(0===this.orientation){N=this.finalPoint.subtract(this.initialPoint);return this.initialPoint.add(N.multiply(M))}if(-1===this.orientation){M=1-M}H=this.getCache(O);if(M>=H.initialParam-L&&M<=H.finalParam+L){if(M<=H.initialParam){J=this.initialPoint}else{if(M>=H.finalParam){J=this.finalPoint}else{I=this.initialAngle+this.arcAngle*(M-H.initialParam)/(H.finalParam-H.initialParam);J=y.GeometricPoint(this.center.x+this.radius*Math.cos(I),this.center.y+this.radius*Math.sin(I))}}}else{if("ArcSector"===O){K=this.center}else{K=this.initialPoint.add(this.finalPoint).multiply(0.5)}if(M<H.initialParam){P=this.initialPoint}else{P=this.finalPoint;M=1-M}M/=H.initialParam;J=K.add(P.subtract(K).multiply(M))}return J},packIntoSampleArray:function(I,H){var J=E*H;I[J]=this.orientation;I[J+1]=this.initialPoint.x;I[J+2]=this.initialPoint.y;I[J+3]=this.finalPoint.x;I[J+4]=this.finalPoint.y;I[J+5]=this.center.x;I[J+6]=this.center.y}};function D(){var H=Object.create(G);return H}return{FromStraightEndpoints:function(J,I){var H=new D();H.orientation=0;H.initialPoint=J;H.middlePoint=y.GeometricPoint((J.getX()+I.getX())/2,(J.getY()+I.getY())/2);H.finalPoint=I;H.exists=true;H.updateSecondaryGeometery();return H},FromThreePoints:function(O,N,M){var H,J=y.Geom.ThreePointCollinear(O,M,N),L,I,K;if(!J.exists||N.equals(O)||N.equals(M)){return new D()}if(J.orientation===0){return y.GeometricArc.FromStraightEndpoints(O,M)}K=(J.orientation===-1);H=new D();H.center=y.Geom.CenterFromThreePoints(O,N,M);L=O.subtract(H.center);I=M.subtract(H.center);H.radius=L.vLength();H.initialAngle=y.Geom.AngleFromPoint(K?I:L);H.finalAngle=y.Geom.AngleFromPoint(K?L:I);H.orientation=J.orientation;H.initialPoint=K?M:O;H.middlePoint=N;H.finalPoint=K?O:M;H.exists=true;if(H.radius>F||Math.abs(H.center.x)>F||Math.abs(H.center.y)>F){return y.GeometricArc.FromStraightEndpoints(O,M)}H.updateSecondaryGeometery();return H},FromCenterAndEndpoints:function(N,P,O,I){var H=new D(),M=P.subtract(N),L=O.subtract(N),J,K,Q=1e-7;if(P.equals(O,Q)||P.equals(N,Q)||O.equals(N,Q)){H.exists=false;return H}if(h===I){I=1}K=(-1===I);H.center=N;H.radius=M.vLength();H.initialAngle=y.Geom.AngleFromPoint(K?L:M);H.finalAngle=y.Geom.AngleFromPoint(K?M:L);H.orientation=I;H.initialPoint=K?O:P;J=(H.initialAngle+H.finalAngle)/2;if(H.initialAngle>H.finalAngle){J+=Math.PI}H.middlePoint=y.GeometricPoint(Math.cos(J),Math.sin(J)).multiply(H.radius).add(H.center);H.finalPoint=K?P:O;H.exists=true;H.updateSecondaryGeometery();return H},FromCenterAndRadius:function(K,I){var H=new D(),J=K.add(y.GeometricPoint(K.x+I,K.y));H.center=K;H.radius=I;H.initialAngle=0;H.finalAngle=2*Math.PI;H.orientation=1;H.initialPoint=J;H.middlePoint=J;H.finalPoint=J;H.exists=true;H.updateSecondaryGeometery();return H},FromPackedSampleArray:function(O,R){var H=R*E,I=O[H],Q=O[H+1],P=O[H+2],K=O[H+3],J=O[H+4],M=O[H+5],L=O[H+6],T=y.GeometricPoint(Q,P),S=y.GeometricPoint(K,J),N;if(I===0){return y.GeometricArc.FromStraightEndpoints(T,S)}else{N=y.GeometricPoint(M,L);return y.GeometricArc.FromCenterAndEndpoints(N,T,S,1)}},packedSampleSize:E}}());y.labels={};y.labels.parseLabelExpression=function(I,G){var E=G||(G===h);function J(O){var M=0,N=O.length,K=N,P,L={before:"",inside:"",after:""};while(M<O.length){if(O[M]==="["){break}M+=1}K=M+1;P=1;while(K<N){if(O[K]==="]"){P-=1}else{if(O[K]==="["){P+=1}}if(P===0){break}K+=1}if(K===N||(K-M===1)||((M===0)&&(K+1===N))){M=N}else{N=K}L.before=O.substr(0,M);L.inside=O.substr(M+1,N-M-1);L.after=O.substr(N+1);return L}function D(P){if(!P){P=""}var M=/([()\[\]|<>{},\s.\/\-]+)/,O=P.split(M),K,L=[];for(K=0;K<O.length;K+=1){var N=O[K];L.push(y.mfs.makeTextMFS(N,E&&/[a-zA-Zα-ω]/.test(N[0])))}if(O.length>1){return y.mfs.makeHorizontalMFS.apply(this,L)}else{return L[0]}}function H(M){var K=[],L;if(M){L=J(M);if(L.inside){K.push({type:"sub",value:[H(L.before),H(L.inside)]});if(L.after){K.push(H(L.after))}}else{K.push(D(L.before))}}return K.length===1?K[0]:y.mfs.makeHorizontalMFS.apply(this,K)}try{return H(I)}catch(F){throw y.createError('Error parsing label "'+I+'": '+F)}};(function(){var ac={};y.mfs={};y.mfs.binaryOperatorPrecedence={"^":3,"*":2,"/":2,"+":1,"-":1};y.mfs.symMap={"20":"\u0020","21":"\u0021","22":"\u2200","23":"\u0023","24":"\u2203","25":"\u0025","26":"\u0026","27":"\u220B","28":"\u0028","29":"\u0029","2A":"\u2217","2B":"\u002B","2C":"\u002C","2D":"\u2212","2E":"\u002E","2F":"\u002F","30":"\u0030","31":"\u0031","32":"\u0032","33":"\u0033","34":"\u0034","35":"\u0035","36":"\u0036","37":"\u0037","38":"\u0038","39":"\u0039","3A":"\u003A","3B":"\u003B","3C":"\u003C","3D":"\u003D","3E":"\u003E","3F":"\u003F","40":"\u2245","41":"\u0391","42":"\u0392","43":"\u03A7","44":"\u0394","45":"\u0395","46":"\u03A6","47":"\u0393","48":"\u0397","49":"\u0399","4A":"\u03D1","4B":"\u039A","4C":"\u039B","4D":"\u039C","4E":"\u039D","4F":"\u039F","50":"\u03A0","51":"\u0398","52":"\u03A1","53":"\u03A3","54":"\u03A4","55":"\u03A5","56":"\u03C2","57":"\u03A9","58":"\u039E","59":"\u03A8","5A":"\u0396","5B":"\u005B","5C":"\u2234","5D":"\u005D","5E":"\u22A5","5F":"\u005F","61":"\u03B1","62":"\u03B2","63":"\u03C7","64":"\u03B4","65":"\u03B5","66":"\u03C6","67":"\u03B3","68":"\u03B7","69":"\u03B9","6A":"\u03D5","6B":"\u03BA","6C":"\u03BB","6D":"\u00B5","6E":"\u03BD","6F":"\u03BF","70":"\u03C0","71":"\u03B8","72":"\u03C1","73":"\u03C3","74":"\u03C4","75":"\u03C5","76":"\u03D6","77":"\u03C9","78":"\u03BE","79":"\u03C8","7A":"\u03B6","7B":"\u007B","7C":"\u007C","7D":"\u007D","7E":"\u223C",A0:"\u20AC",A1:"\u03D2",A2:"\u2032",A3:"\u2264",A4:"\u2044",A5:"\u221E",A6:"\u0192",A7:"\u2663",A8:"\u2666",A9:"\u2665",AA:"\u2660",AB:"\u2194",AC:"\u2190",AD:"\u2191",AE:"\u2192",AF:"\u2193",B0:"\u00B0",B1:"\u00B1",B2:"\u2033",B3:"\u2265",B4:"\u00D7",B5:"\u221D",B6:"\u2202",B7:"\u2022",B8:"\u00F7",B9:"\u2260",BA:"\u2261",BB:"\u2248",BC:"\u2026",BF:"\u21B5",C0:"\u2135",C1:"\u2111",C2:"\u211C",C3:"\u2118",C4:"\u2297",C5:"\u2295",C6:"\u2205",C7:"\u2229",C8:"\u222A",C9:"\u2283",CA:"\u2287",CB:"\u2284",CC:"\u2282",CD:"\u2286",CE:"\u2208",CF:"\u2209",D0:"\u2220",D1:"\u2207",D5:"\u220F",D6:"\u221A",D7:"\u22C5",D8:"\u00AC",D9:"\u2227",DA:"\u2228",DB:"\u21D4",DC:"\u21D0",DD:"\u21D1",DE:"\u21D2",DF:"\u21D3",E0:"\u25CA",E1:"\u2329",E5:"\u2211",F1:"\u232A",F2:"\u222B",F3:"\u2320",F5:"\u2321","100":"\u2299","101":"\u2225","102":"\u25B3","103":"\u2212","176":"\u00B0","177":"\u00B1"};y.mfs.makeFunctionFromParsedInfix=function(at){var au,av,ao,af={};function ak(aB){var az=""+aB.index,aA=au[aB.type],ay;if(aB.refCount===1){return aA(aB)}if(af[az]){return af[az]}ay="m["+az+"]";af[az]=ay;return"("+ay+"="+aA(aB)+")"}var ah={pi:"Math.PI",e:"Math.E"};var ap={sin:"GSP.math.sin",cos:"GSP.math.cos",tan:"GSP.math.tan",Arcsin:"GSP.math.asin",Arccos:"GSP.math.acos",Arctan:"GSP.math.atan",abs:"GSP.math.abs",sqrt:"GSP.math.sqrt",ln:"GSP.math.ln",log:"GSP.math.log",sgn:"GSP.math.sign",round:"GSP.math.round",trunc:"GSP.math.trunc",isDefined:"GSP.math.isDefined"};function ai(az){var aA=ak(az.children.left);if(az.children.left.type==="binary-expr"){aA="("+aA+")"}var ay=ak(az.children.right);if(az.operator==="^"){return"GSP.math.pow("+aA+","+ay+")"}else{if(az.children.right.type==="binary-expr"){ay="("+ay+")"}return aA+az.operator+ay}}function al(ay){var az=ak(ay.children.child);if((ay.children.child.type==="unary-expr")||(ay.children.child.type==="binary-expr")){az="("+az+")"}return"("+ay.operator+az+")"}function aq(az){var ay;if(az.subtype==="sys"){ay=ap[az.name];return ay+"("+ak(az.children.arg)+", unitMap)"}else{return ak(az.children.name)+"("+ak(az.children.arg)+")"}}function ag(az){var aA=az.children.value,ay=az.children.unit;if(typeof ay!=="undefined"){return"GSP.units.convertToDocUnits(unitMap, "+ak(aA)+", "+ak(ay)+")"}else{return ak(aA)}}function am(ay){var az=ay.value;if(ay.subtype==="numeric"){return az.replace(/^0+(?=[^0])/,"")}else{return ah[az]}}function ax(ay){return'"'+ay.name+'"'}function ar(ay){return'parentArray["'+ay.name+'"].uValue'}function aw(ay){return'parentArray["'+ay.name+'"]'}function an(ay){return ak(ay.children.expr)}function aj(ay){return NaN}au={blank:aj,equation:an,"binary-expr":ai,"unary-expr":al,"function":aq,constant:am,primary:ag,unit:ax,variable:aw,reference:ar};av="";ao=ak(at);if(!g.isEmptyObject(af)){av+="var m={};"}av+="return "+ao+";";return new Function("parentArray","unitMap",av)};y.mfs.getParsedInfixAndFunction=function I(ag){var af=ac[ag]||{};if(!af.parsedInfix){af.parsedInfix=y.infixExpressionParser.parse(ag);af.func=y.mfs.makeFunctionFromParsedInfix(af.parsedInfix);ac[ag]=af}return af};y.mfs.getParsedInfix=function V(ag){var af=ac[ag]||{};if(!af.parsedInfix){af.parsedInfix=y.infixExpressionParser.parse(this.expression);ac[ag]=af}return af.parsedInfix};y.mfs.makeMathMLFromParseTree=function(at){var au={"+":"+","-":"&minus;","*":"&#x22c5;"};var ah={pi:"&pi;",e:"e"};var ao,av;function ak(aA){var az=av[aA.type];return az(aA)}function aj(aA){var aB=ak(aA.children.left);if(aA.children.left.type==="binary-expr"){aB='<mfenced separators="">'+aB+"</mfenced>"}else{if(aA.children.left.type==="unary-expr"||aA.children.left.type==="function"){aB="<mrow>"+aB+"</mrow>"}}var az=ak(aA.children.right);if(aA.children.right.type==="binary-expr"){az='<mfenced separators="">'+az+"</mfenced>"}else{if(aA.children.right.type==="unary-expr"||aA.children.right.type==="function"){az="<mrow>"+az+"</mrow>"}}if(aA.operator==="^"){return"<msup>"+aB+az+"</msup>"}if(aA.operator==="/"){return"<mfrac>"+aB+az+"</mfrac>"}else{return aB+"<mo>"+au[aA.operator]+"</mo>"+az}}function al(az){var aA=ak(az.children.child);if(az.children.child.type==="binary-expr"){aA="<mrow>"+aA+"</mrow>"}return"<mo>"+au[az.operator]+"</mo>"+aA}function aw(aA,az){return"<mi>"+aA+"</mi><mfenced><mrow>"+az+"</mrow></mfenced>"}function aq(aA,az){return'<mfenced open="|" close="|" separators=""><mrow>'+az+"</mrow></mfenced>"}function ai(aA,az){return"<msqrt><mrow>"+az+"</mrow></msqrt>"}function ap(aA){var az=ao[aA.name];if(az===h){az=aw}if(aA.subtype==="sys"){return az(aA.name,ak(aA.children.arg))}else{return az(ak(aA.children.name),ak(aA.children.arg))}}function af(az){return ak(az.children.value)}function am(az){var aA;if(az.subtype==="numeric"){aA=az.value}else{aA=ah[az.value]}return"<mn>"+aA+"</mn>"}function ay(az){return"<mi>"+az.name+"</mi>"}function ar(az){return"<mi>"+az.name+"</mi>"}function ax(az){return"<mi>"+az.name+"</mi>"}function an(az){if(az.children.expr){return ak(az.children.expr)}else{return ak(az.children.expr)}}ao={sin:aw,cos:aw,tan:aw,Arcsin:aw,Arccos:aw,Arctan:aw,abs:aq,sqrt:ai,ln:aw,log:aw,sgn:aw,round:aw,trunc:aw};av={equation:an,"binary-expr":aj,"unary-expr":al,"function":ap,constant:am,primary:af,unit:ay,variable:ax,reference:ar};function ag(az){return"<math>"+ak(az)+"</math>"}return ag(at)};function Y(af){return(af.type==="unary-expr")||((af.type==="primary")&&af.children.unit)}function ad(aj){var am,ag=aj.length,al,ai=0,ak=" +-*/()\u2212\u22c5",ah=false,af=false;for(am=0;am<ag;++am){al=aj[am];ah=ah||(ak.indexOf(al)>=0);if(al==="("){++ai}else{if(ai&&(al===")")){--ai}else{if(!ai){af=true}}}if(ah&&af){return true}}return ai>0}function F(ag,af){var ah;if(ag.type!=="reference"){return false}if(af){ah=af[ag.name];if((ah.kind==="Expression")&&(ah.genus==="ScalarParameter")){return ah.label?ad(ah.label):false}if(ah.parsedInfix){return !y.mfs.isAtomicExpression(ah.parsedInfix)}}return true}function P(ag,af){return Y(ag)||F(ag,af)}function H(ag,af){return(ag.operator==="^")&&P(ag.children.left,af)}function N(ag){var af=ag.operator==="/";return !af&&ag.children.left.type==="binary-expr"}function O(ag){var af=ag.operator==="/";return !af&&ag.children.right.type==="binary-expr"}function E(ag){var af=ag.operator==="/";return af&&ag.children.right.operator==="/"}function ab(ag){var af=y.mfs.binaryOperatorPrecedence[ag.operator],ah=y.mfs.binaryOperatorPrecedence[ag.children.left.operator];return(ah<af)||((ah===af)&&(ag.operator==="^"))}function L(ag){var af=y.mfs.binaryOperatorPrecedence[ag.operator],ah=y.mfs.binaryOperatorPrecedence[ag.children.right.operator];return(ah<=af)&&(ag.operator!=="^")}var S={pi:"\u03C0",e:"e"};function T(ag,af){var ah;if(ag.subtype==="numeric"){ah=ag.value}else{ah=S[ag.value]}return af(ah)}function U(ag,af,ah){if(ag.children.declaration&&!ah){return af(ag.children.declaration)}else{return af(ag.children.expr)}}function Z(ah,ag){var af=y.units.findUnit(ah.name);return ag(af.symbol)}y.mfs.makeMFSFromParsedInfix=function(at,aq,az,aw){var au={"+":"+","-":"\u2212","*":"\u22c5"};var an,av;function al(aB){var aA=av[aB.type];return aA(aB)}function ag(aB){var aC=al(aB.children.left),aA=al(aB.children.right);if(aB.children.left.type==="unary-expr"||aB.children.left.type==="function"){aC=y.mfs.makeHorizontalMFS(aC)}if(aB.children.right.operator==="/"){aA=y.mfs.makeParenthesisMFS(aA)}if(aB.children.right.type==="unary-expr"||aB.children.right.type==="function"){aA=y.mfs.makeHorizontalMFS(aA)}return{type:"fraction",value:[y.mfs.makeHorizontalMFS(aC),y.mfs.makeHorizontalMFS(aA)]}}function aj(aB){var aC;if(aB.operator==="/"){return ag(aB)}aC=al(aB.children.left);if(H(aB,aq)){aC=y.mfs.makeParenthesisMFS(aC)}else{if(N(aB)){aC=ab(aB)?y.mfs.makeParenthesisMFS(aC):y.mfs.makeHorizontalMFS(aC)}else{if(aB.children.left.type==="unary-expr"||aB.children.left.type==="function"){aC=y.mfs.makeHorizontalMFS(aC)}else{if(aB.children.left.type==="reference"){if(F(aB.children.left,aq)){aC=y.mfs.makeParenthesisMFS(aC)}}}}}var aA=al(aB.children.right);if(O(aB)){aA=L(aB)?y.mfs.makeParenthesisMFS(aA):y.mfs.makeHorizontalMFS(aA)}else{if(aB.children.right.type==="unary-expr"||aB.children.right.type==="function"){aA=y.mfs.makeHorizontalMFS(aA)}else{if(F(aB.children.right,aq)){aA=y.mfs.makeParenthesisMFS(aA)}}}if(aB.operator==="^"){return{type:"super",value:[aC,aA]}}else{if(aB.operator==="*"){return y.mfs.makeHorizontalMFS(aC,y.mfs.makeTextMFS(au[aB.operator]),aA)}else{return y.mfs.makeHorizontalMFS(aC,y.mfs.makeTextMFS(" "+au[aB.operator]+" "),aA)}}}function am(aA){var aB=al(aA.children.child);if((aA.children.child.type==="unary-expr")||(aA.children.child.type==="binary-expr")){aB=(aA.children.child.operator==="^")?y.mfs.makeHorizontalMFS(aB):{type:"paren",value:[aB]}}return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(au[aA.operator]),aB)}function ax(aB,aA){return y.mfs.makeHorizontalMFS(aB,{type:"paren",value:[aA]})}function ap(aB,aA){return{type:"abs",value:[aA]}}function ai(aB,aA){return{type:"root",value:[aA]}}function ao(aC){var aB=an[aC.name];if(aB===h){aB=ax}var aA=aC.subtype==="sys"?y.mfs.makeTextMFS(aC.name):al(aC.children.name);return aB(aA,al(aC.children.arg))}function af(aA){var aB=[al(aA.children.value)];if(aA.children.unit){aB.push(al(aA.children.unit))}return y.mfs.makeHorizontalMFS.apply(this,aB)}function ar(aA){var aB;if(aq){aB=aq[aA.name];if(aB.kind==="Expression"&&aB.isFunction()){return y.mfs.makeTextMFS(aB.label,true)}else{return aB.getNameMFS()}}else{return y.mfs.makeTextMFS(aA.name)}}function ay(aA){return y.mfs.makeTextMFS(aA.name,aw)}function ah(aB){var aA=y.mfs.makeTextMFS(aB.argument,true);if(aB.name){return ax(y.mfs.makeTextMFS(aB.name,true),aA)}else{return aA}}function ak(aA){y.log("visitBlank not expected.  See comment");return y.mfs.makeTextMFS(" ")}an={abs:ap,sqrt:ai};av={blank:ak,equation:function(aA){return U(aA,al,az)},declaration:ah,"binary-expr":aj,"unary-expr":am,"function":ao,constant:function(aA){return T(aA,y.mfs.makeTextMFS)},primary:af,unit:function(aA){return Z(aA,y.mfs.makeTextMFS)},variable:ay,reference:ar};return al(at)};y.mfs.renderMathquillFromParsedInfix=function(aw,ah,at,aA){var ax={"-":"\u2212","*":"\u22c5"};function ai(aB){au("(");am(aB);ah.ascendTwo()}var ap,ay;function am(aC){var aB=ay[aC.type];return aB(aC)}function au(aB){ah.insertAtCursor(aB,true)}function ao(aC){for(var aB=0;aB<aC.length;aB++){ah.insertAtCursor(aC.charAt(aB),true)}}function ak(aB){if(H(aB,at)){ai(aB.children.left)}else{if(N(aB)){if(ab(aB)){ai(aB.children.left)}else{am(aB.children.left)}}else{if(aB.operator==="/"){ah.renderAndSelect(function(){am(aB.children.left)})}else{if(F(aB.children.left,at)){ai(aB.children.left)}else{am(aB.children.left)}}}}au(ax[aB.operator]||aB.operator);if(E(aB)){ai(aB.children.right)}else{if(O(aB)){if(L(aB)){ai(aB.children.right)}else{am(aB.children.right)}}else{if(F(aB.children.right,at)){ai(aB.children.right)}else{am(aB.children.right)}}}if(aB.operator==="^"||aB.operator==="/"){ah.ascendTwo()}}function an(aC){var aB=(aC.children.child.type==="unary-expr")||(aC.children.child.type==="binary-expr");au(ax[aC.operator]);if(aB&&(aC.children.child.operator!=="^")){ai(aC.children.child)}else{am(aC.children.child)}}function ar(aB){ah.renderAndSelect(function(){am(aB)});au("|");ah.moveRight()}function aj(aB){au("\\sqrt");am(aB);ah.ascendTwo()}function aq(aC){var aB=ap[aC.name];if(aB===h){aB=ai;if(aC.name){au(aC.name)}}if(aC.subtype!=="sys"){am(aC.children.name)}aB(aC.children.arg)}function af(aB){am(aB.children.value);if(aB.children.unit){am(aB.children.unit)}}function av(aC){var aD,aB=y.mfs.renderMathquillFromParsedInfix;if(at){aD=at[aC.name];if(aD.kind==="Expression"&&aD.isFunction()){au(aD.label);ah.registerReference("function",aC.name,false)}else{au("(");if(!aD.parsedInfix||aD.isParameter()){y.mfs.renderMathquillFromParsedMFS(aD.getNameMFS(),ah)}else{aB(aD.parsedInfix,ah,aD.parentsList)}ah.registerReference("non-function",aC.name,true)}}else{au(aC.name)}}function az(aB){au(aB.name);ah.registerIndependentVariable()}function ag(aC){var aB=aC.argument;if(aC.name){au(aC.name);ai(aB)}else{au(aB)}}function al(aB){y.signalErrorWithMessage("visitBlank not expected.")}ap={abs:ar,sqrt:aj};ay={blank:al,equation:function(aB){return U(aB,am,aA)},declaration:ag,"binary-expr":ak,"unary-expr":an,"function":aq,constant:function(aB){return T(aB,ao)},primary:af,unit:function(aB){return Z(aB,au)},variable:az,reference:av};return am(aw)};y.mfs.makeItalicMFS=function J(af){return{type:"style",value:[{code:"fontStyle",value:"2"},af]}};y.mfs.makeTextMFS=function aa(ah,ag){if(typeof ah==="object"){throw y.createError("Can't make text from objects")}var af={type:"text",value:String(ah)};return ag?y.mfs.makeItalicMFS(af):af};y.mfs.isEmptyTextMFS=function D(af){return af.type==="text"&&af.value===""};y.mfs.makeParenthesisMFS=function(af){return{type:"paren",value:[af]}};y.mfs.makeHorizontalMFS=function K(){return{type:"horizontal",value:Array.prototype.slice.call(arguments,0)}};y.mfs.parentsHorizontalOverbar=function(af,ah){var ag={type:"horizontal",value:[]};g.each(ah,function(aj,ai){var ak=af.getParent(ai);if(ak){ag.value.push(ak.getNameMFS())}});return{type:"overbar",variant:5,value:ag}};y.mfs.isSimpleExpression=function(ag){var ah={};function af(ak){var aj=ah[ak.type],ai=g.type(aj);if(ai==="boolean"){return aj}else{if(ai==="function"){return aj(ak)}else{return false}}}ah.equation=function(ai){return(typeof ai.children.declaration!=="undefined")||af(ai.children.expr)};ah["unary-expr"]=function(ai){return af(ai.children.child)};ah.primary=function(ai){return af(ai.children.value)};ah.constant=true;ah.blank=true;return af(ag)};y.mfs.isAtomicExpression=function(ag){var ah={};function af(ak){var aj=ah[ak.type],ai=g.type(aj);if(ai==="boolean"){return aj}else{if(ai==="function"){return aj(ak)}else{return false}}}ah.equation=function(ai){return(typeof ai.children.declaration!=="undefined")||af(ai.children.expr)};ah["binary-expr"]=function(ai){return ai.subtype==="power"&&af(ai.children.left)};ah.primary=true;ah.constant=true;ah.blank=true;return af(ag)};y.mfs.determineUnit=function(ah,ag,ak){var af={},ai=y.units,aj={};function al(aq){var ao=aq.index,ap=af[aq.type];if(ap){if(!aj[ao]){aj[ao]=ap(aq)}return aj[ao]}else{y.signalErrorWithMessage("GSP.mfs.determineUnit: missing typeMap: "+aq.type)}}function an(aq,ap){var ao=true;y.units.eachUnitDimension(aq,function(at,ar){if(ar!==ap[at]){ao=false;return false}});y.units.eachUnitDimension(ap,function(at,ar){if(ar!==aq[at]){ao=false;return false}});return ao}function am(ao){var ap=al(ao);y.units.eachUnitDimension(ap,function(ar,aq){if(aq%2===0){ap[ar]*=0.5}else{ap={};return false}});return ap}af.equation=function(ao){return al(ao.children.expr)};af["binary-expr"]=function(av){var au=al(av.children.left),aw=al(av.children.right),at,ar,aq,ap,ao={};if(av.subtype==="power"){au=al(av.children.left);if(av.children.right.type==="primary"){ap=Number(av.children.right.children.value.value);if(ap%1===0){for(ar in au){if(au.hasOwnProperty(ar)){ao[ar]=au[ar]*ap}}}}return ao}else{if(av.subtype==="multiplicative"){at=1;if(av.operator==="/"){at=-1}au=g.extend({},au);for(ar in aw){if(aw.hasOwnProperty(ar)){aq=au[ar];if(aq===h){au[ar]=0}au[ar]+=(at*aw[ar])}}return au}else{if(av.subtype==="additive"){if(an(au,aw)){return au}else{return{}}}}}};af["unary-expr"]=function(ao){return al(ao.children.child)};af["function"]=function(ao){if(ao.name==="Arcsin"||ao.name==="Arccos"||ao.name==="Arctan"){return{angle:1}}else{if(ao.name==="abs"||ao.name==="round"||ao.name==="trunc"){return al(ao.children.arg)}else{if(ao.name==="sqrt"){return am(ao.children.arg)}else{if(ao.subtype==="custom"){var ap=ag[ao.children.name.name];return ap.getUnitPowers(al(ao.children.arg))}else{return{}}}}}};af.primary=function(ao){if(ao.children.unit){return al(ao.children.unit)}else{return{}}};af.constant=function(ao){return{}};af.unit=function(ap){var aq={};var ao=ai.getUnitFamily(ap.name);if(ao&&ao!=="scalar"){aq[ai.getUnitFamily(ap.name)]=1}return aq};af.reference=function(ap){var aq,ao;if(ag){aq=ag[ap.name];if(aq){ao=g.extend(true,{},aq.unitPowers)}}return ao};af.variable=function(ap){var ao=ak?ak:{};return ao};af.blank=function(ao){return{}};return al(ah)};y.mfs.findByType=function(ai,ag){function af(am,aj,al){var ak;if(am.children){for(ak in am.children){if(am.children.hasOwnProperty(ak)){af(am.children[ak],aj,al)}}}if(am.type===aj){al.push(am)}}var ah=[];af(ai,ag,ah);return ah};y.mfs.replaceNodes=function G(aj,ah,al){var ag,ak,af=(aj.type===ah)?al(aj):aj,ai=(g.isArray(af.value))?af.value.length:0;for(ag=0;ag<ai;++ag){ak=af.value[ag];af.value[ag]=G(ak,ah,al)}return af};y.mfs.realizeParamNodes=function(af,ag){y.mfs.replaceNodes(af,"parameter",function(ah){return ag[ah.value]})};y.mfs.walkNode=function M(ag,af,ah){y.mfs.replaceNodes(ag,af,function(ai){ah(ai);return ai})};y.mfs.flattenVerticalNode=function Q(ai){if(ai.type!=="vertical"){y.signalErrorWithMessage("GSP.mfs.flattenVerticalNode should only be called on vertical nodes");return ai}ai.type="horizontal";var ag=ai.value;var ah;for(var af=ag.length-1;af>0;--af){ah=y.mfs.makeTextMFS(" ");ag.splice(af,0,ah)}return ai};var X={Times:{"default":"1"},"Times New Roman":{"16px":"1.1","24px":"1.1","36px":"1.1","default":"normal"},Arial:{"16px":"1.1","24px":"1.1","36px":"1.1","default":"normal"},Geneva:{"16px":"1.3","24px":"1.35","36px":"1.35","default":"normal"},"ReportSchoolRg-Regular":{"16px":"1.15","24px":"1.15","36px":"1.15","default":"normal"},"Report School":{"16px":"1.15","24px":"1.15","36px":"1.15","default":"normal"},"Proxima Nova":{"16px":"1.2","24px":"1.2","36px":"1.2","default":"normal"}};y.mfs.extractFirstFontFamily=function(ag){var af=ag||"";af=af.split(",")[0];af=af.replace(/'/g,'"');return af.replace(/^"(.*)"$/,"$1")};y.mfs.getLineHeight=function(af,ai){var ah=y.mfs.extractFirstFontFamily(af);var ag=X[ah];if(ag){return ag[ai]||ag[ai+"px"]||ag["default"]}else{return null}};var W={"Proxima Nova Bold":{fallbackFamilies:["Proxima Nova"],sets:{"font-weight":"bold"}},"Proxima Nova Italic":{fallbackFamilies:["Proxima Nova"],sets:{"font-style":"italic"}},"Proxima Nova Bold It":{fallbackFamilies:["Proxima Nova"],sets:{"font-weight":"bold","font-style":"italic"}},"ReportSchoolRg-Bold":{fallbackFamilies:["Report School Rg","ReportSchoolRg-Regular"],sets:{"font-weight":"bold"}},"ReportSchoolRg-Italic":{fallbackFamilies:["Report School Rg","ReportSchoolRg-Regular"],sets:{"font-style":"italic"}},"ReportSchoolRg-BoldItalic":{fallbackFamilies:["Report School Rg","ReportSchoolRg-Regular"],sets:{"font-weight":"bold","font-style":"italic"}},"Report School Rg":{fallbackFamilies:["ReportSchoolRg-Regular"]},"ReportSchoolRg-Regular":{fallbackFamilies:["Report School Rg"]}};y.mfs.normalizeFont=function(ag,am){var al=y.mfs.extractFirstFontFamily(ag);var ah=W[al];if(!ah){return}var af=ah.fallbackFamilies;var ai;var ak=ah.sets;if(ak){for(ai in ak){if(ak.hasOwnProperty(ai)){am(ai,ak[ai])}}}var aj=ag.split(",");aj.splice(1,0,af.join(","));am("font-family",aj.join(","))};var ae=[{type:"",cssClass:"",template:""},{type:"",cssClass:"",template:""},{type:"segment",cssClass:"mfs-overbar-seg",template:'<svg version="1.1" viewBox="0 0 128 50" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 0 7 L 128 7 " stroke="@@color@@" fill="@@color@@" stroke-width="3"/></svg>'},{type:"ray",cssClass:"mfs-overbar-ray",template:'<svg version="1.1" viewBox="0 0 128 40" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 7 20 l 114 0M 121 20l -21 -20L 121 20l -21 20" stroke="@@color@@" fill="none" stroke-width="10"/></svg>'},{type:"line",cssClass:"mfs-overbar-line",template:'<svg version="1.1" viewBox="0 0 128 40" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 7 20 l 21 -20 L 7 20 l 21 20 M 7 20 l 114 0M 121 20l -21 -20L 121 20l -21 20" stroke="@@color@@" fill="none" stroke-width="8"/></svg>'},{type:"arc",cssClass:"mfs-overbar-arc",template:'<svg version="1.1" viewBox="0 0 128 50" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 12 50 Q 70 0 128 50 M 128 50 Q 70 9 12 50 " stroke="@@color@@" fill="@@color@@" stroke-width="1"/></svg>'}];function R(ag){if(typeof ag==="number"){return ae[ag]}var af;for(af=0;af<ae.length;af++){if(ag===ae[af].type){return ae[af]}}return null}y.mfs.createOverbarDOM=function(af,ag){var ah=R(af),ai;ai=g("<div>");ai.addClass("mfs-overbar");if(ah.cssClass){ai.addClass(ah.cssClass)}if(ah.factory){ai.css("background-image",ah.factory(ag))}return ai};y.mfs.makeHTMLFromMFSParseTree=(function(){function aj(al){return function(an){var am=y.btoa(al.replace(/@@color@@/g,an));return'url("data:image/svg+xml;base64,'+am+'")'}}for(var ag=0;ag<ae.length;ag++){var ai=ae[ag].template;ae[ag].factory=ai?aj(ai):null}function af(am,av,aq){var au="",ar,an,at;for(var ap=0;ap<aq.length;ap++){an=aq[ap];ar=an[0];at=an[1];au+=ar+" ";for(var ao=0;ao<at.length;ao++){au+=Math.round(at[ao]*10)/10+" "}}var al='<svg version="1.1" viewBox="0 0 '+am+" "+av+'" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="'+au+'" stroke="@@color@@" fill="@@color@@" stroke-width="1"/></svg>';return al}var ak=(function(){var an=40,av=70;var al=av*0.9;var ar=av-al;var at=ar+(al-ar)/2;var ao=0.5;var am=0.2;var au=an*0.17;function aq(){var aw=0;var az=aw+au;var ay=an*(1+am);var ax=an*(1+ao);return af(an,av,[["M",[aw,ar]],["L",[az,ar]],["Q",[ax,at,az,al]],["M",[az,al]],["L",[aw,al]],["Q",[ay,at,aw,ar]]])}function ap(){var ax=an;var aw=ax-au;var az=-(an*am);var ay=-(an*ao);return af(an,av,[["M",[ax,ar]],["L",[aw,ar]],["Q",[ay,at,aw,al]],["M",[aw,al]],["L",[ax,al]],["Q",[az,at,ax,ar]]])}return{left:aj(ap()),right:aj(aq())}})();var ah=(function(){var an=40,al=70;function am(){var ap=0,at=0;var ar=an,aq=al*0.03;return af(an,al,[["M",[ap,at]],["L",[ar,at]],["L",[ar,aq]],["L",[ap,aq]],["L",[ap,at]]])}function ao(){var at=0;var aw=al*0.06;var ax=an*0.05;var ap=al*0.55;var aA=ap+aw/3;var aC=an*0.25;var ar=aC+(an*0.2);var aq=al*0.87;var az=an-(ax*3);var aB=an;var ay=0;var au=ay+aw/2;var av=aq+aw;return af(an,al,[["M",[at,ap]],["L",[aC,ap]],["L",[ar,aq]],["L",[az,ay]],["L",[aB,ay]],["L",[aB,au]],["L",[az+(ax/2),au]],["L",[ar,av]],["L",[aC-ax,aA]],["L",[at,aA]],["L",[at,ap]]])}return{left:aj(ao()),right:aj(am())}})();return function(aC,ap,au,ao){var aA={},an={},am=[];g.each(ao,function(aH,aI){if(aH!=="font-size"&&aH!=="fontSize"){aq(aH,aI)}});function az(){am.push({type:"marker"})}function aq(aH,aI){am.push({type:"style",name:aH,value:aI})}function aE(){var aH=am.pop();while(aH.type!=="marker"){aH=am.pop()}}function aD(aI){var aJ={};g.each(am,function(aL,aK){if(aK.type==="style"){aJ[aK.name]=aK.value}});var aH=y.mfs.getLineHeight(aJ.fontFamily||aI.css("font-family"),aJ.fontSize||aI.css("font-size"));if(aH){aJ.lineHeight=aH}return aJ}function aG(){var aH=[];g.each(am,function(aJ,aI){if(aI.type==="class"){aH.push(aI.name)}});return aH.join(" ")}function ar(aI,aH){aI.append(aH);var aJ=aI[0].lastChild;return g(aJ)}function av(aJ,aI){var aK,aH;aH=an[aJ.type];if(aH){aK=aH(aJ,aI);return aK}else{y.signalErrorWithMessage("GSP.mfs.makeHTMLFromMFSParseTree: No handler for node:"+aJ.type);return aI}}function ax(aH){return String(aH).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#47;")}function aw(aH){return(aH.type==="text")||(aH.type==="symbol")}function ay(aI){var aH=aI.value,aJ="\xA0";if(aI.type==="symbol"){return y.mfs.symMap[aH.toUpperCase()]||"x"}if((aI.type==="text")&&aH.match(/ $/)){aH=aH.substring(0,aH.length-1)+aJ}return aH}function aF(aH,aJ){var aI=aD(aH);return ar(aH,'<div class="mfs-text"/>').css(aI).addClass(aG).append(ax(aJ))}function al(aJ){var aI,aH=[];g.each(aJ,function(aK,aL){if(aI&&aw(aI)&&aw(aL)){aI.value+=ay(aL)}else{if(aL.type==="symbol"){aL.value=ay(aL);aL.type="text"}aH.push(aL);aI=aL}});return aH}function aB(aI,aJ){var aH;if(aJ.value.length>0){aJ.value=al(aJ.value)}for(aH=0;aH<aJ.value.length;aH+=1){av(aJ.value[aH],aI)}}function at(aI,aJ,aH){var aK=ar(aH,'<div class="'+aI+'"/>');aB(aK,aJ);return aK}an.abs=function(aI,aH){return at("mfs-abs",aI,aH)};an.bracket=function(aI,aH){return at("mfs-bracket",aI,aH)};an.curly=function(aI,aH){return at("mfs-curly",aI,aH)};an.fraction=function(aI,aH){var aJ=ar(aH,'<div class="mfs-frac"/>');av(aI.value[0],aJ).addClass("mfs-numr mfs-responsive-borderwidth");av(aI.value[1],aJ).addClass("mfs-denm");return aJ};an.horizontal=function(aI,aH){if(aI.value.length>0){aI.value=al(aI.value)}if(aI.value.length===1){return av(aI.value[0],aH)}return at("mfs-horizontal",aI,aH)};an.input=function(aJ,aI){var aK=g("<div>").addClass("mfs-input mfs-responsive-borderwidth"),aL;aK.append("%"+aJ.value);aI.append(aK);aL=aA[aJ.value];if(!aL){aL=[];aA[aJ.value]=aL}aL.push(aK);var aH=y.getConfigValue("NumberpadManager.delegates.registerElement");aH(aK);return aK};an.parameter=function(aI,aH){var aJ,aK;aJ=ar(aH,'<div class="mfs-param">');aJ.css(aD(aH));aJ.append("%"+aI.value);aK=aA[aI.value];if(!aK){aK=[];aA[aI.value]=aK}aK.push(aJ);return aJ};an.paren=function(aK,aI){var aL=g('<td class="mfs-left-paren"></td>').append("<span>"),aJ=ar(aI,g('<table class="mfs-paren"><tbody><tr><td></td></tr></tbody></table>')),aM=g('<td class="mfs-right-paren"></td>').append("<span>");aB(g(">tbody >tr >td",aJ),aK);var aH=aD(aI).color||aI.css("color");aL.css("background-image",ak.left(aH));aM.css("background-image",ak.right(aH));g(">tbody >tr",aJ).prepend(aL).append(aM);return aJ};an.root=function(aM,aK){var aO=g('<td class="mfs-left-root"></td>').append("<span>"),aH='<table class="mfs-root"><tbody><tr><td class="mfs-right-root"></td></tr></tbody></table>',aL=ar(aK,g(aH)),aN=g(">tbody >tr",aL),aJ=g(">td",aN);aB(aJ,aM);var aI=aD(aK).color||aK.css("color");aO.css("background-image",ah.left(aI));aJ.css("background-image",ah.right(aI));aN.prepend(aO);aK.append(aL);return aL};an.style=function(aN,aK){var aO,aM=aK,aH,aP,aQ,aJ,aR={},aI=[];for(aO=0;aO<aN.value.length;aO+=1){if(aN.value[aO].code){aR[aN.value[aO].code]=aN.value[aO].value}else{if(aN.value[aO].type){aI.push(aN.value[aO])}}}az();if(aR.fontFamily){if(au){aJ=au[parseInt(aR.fontFamily,16)];var aL=function(aS,aV){switch(aS){case"font-family":aJ=aV;break;case"font-weight":var aT={normal:1,bold:2};aR.fontWeight=aT[aV];break;case"font-style":var aU={normal:1,italic:2};aR.fontStyle=aU[aV];break;default:break}};y.mfs.normalizeFont(aJ,aL);if(aJ){aq("fontFamily",aJ)}}}if(Number(aR.fontWeight)===1){aq("fontWeight","normal")}if(Number(aR.fontWeight)===2){aq("fontWeight","bold")}if(Number(aR.fontStyle)===1){aq("fontStyle","normal")}if(Number(aR.fontStyle)===2){aq("fontStyle","italic")}if(aR.red||aR.green||aR.blue){aH=aR.red?parseInt(aR.red,16)-1:0;aP=aR.green?parseInt(aR.green,16)-1:0;aQ=aR.blue?parseInt(aR.blue,16)-1:0;aq("color","rgb("+aH+","+aP+","+aQ+")")}if(Number(aR.underbar)===1){aq("text-decoration","none")}if(Number(aR.underbar)===2){aq("text-decoration","underline")}if(Number(aR.tightness)===1){aq("letter-spacing","normal")}if(Number(aR.tightness)===2){aq("letter-spacing","-1px")}if(Number(aR.tightness)===3){aq("letter-spacing","1px")}if(aI.length===1){aM=av(aI[0],aM);if(aR.fontSize){aM.css("fontSize",parseInt(aR.fontSize,16)+"px")}}else{throw y.createError("Malformed Style Node: Too many children")}aE();return aM};an.sub=function(aI,aH){var aJ=ar(aH,'<div class="mfs-sub-group"/>');av(aI.value[0],aJ);av(aI.value[1],aJ).addClass("mfs-subscript");return aJ};an["super"]=function(aI,aH){var aJ=ar(aH,'<div class="mfs-super-group"/>');av(aI.value[0],aJ);av(aI.value[1],aJ).addClass("mfs-exponent");return aJ};an.symbol=function(aI,aH){return aF(aH,ay(aI))};an["switch"]=function(aJ,aI){var aH=aJ.visibleNode;if(aH&&(aH>0)){return av(aJ.value[aH-1],aI)}};an.text=function(aI,aH){return aF(aH,ay(aI))};an.vertical=function(aL,aI){var aH,aN,aK={L:"left",C:"center",R:"right"},aM=aL.alignment&&aK[aL.alignment],aJ=aM?'style="text-align:'+aM+';"':"";if(aL.value.length>1){aN=ar(aI,'<div class="mfs-vertical-group" '+aJ+"/>");for(aH=0;aH<aL.value.length;aH+=1){if(aL.value[aH].type!=="future"){if(y.mfs.isEmptyTextMFS(aL.value[aH])){ar(aN,"<br>")}else{av(aL.value[aH],aN)}}}return aN}else{return av(aL.value[0],aI)}};an.future=function(aI,aH){return aH};an.overbar=function(aJ,aI){var aH=aD(aI).color||aI.css("color");var aK=ar(aI,y.mfs.createOverbarDOM(Number(aJ.variant),aH));av(aJ.value,aK);return aK};av(aC,ap);return aA}})();y.mfs.renderMathquillFromParsedMFS=function(ak,aj){var al={};function ah(am){aj.insertAtCursor(am,true)}function ag(am){ah("\\text");ah(am);aj.ascendTwo()}function ai(ap){var an;an=al[ap.type];if(an){an(ap)}else{if(g.isArray(ap.value)){var am,aq,ao=ap.value.length;for(am=0;am<ao;++am){aq=ap.value[am];ai(aq)}}else{if(typeof ap.value==="object"){ai(ap.value)}}}}function af(an){var am=an.value,ao="\xA0";if(an.type==="symbol"){return y.mfs.symMap[am.toUpperCase()]||"x"}if((an.type==="text")&&am.match(/ $/)){am=am.substring(0,am.length-1)+ao}return am}al.sub=function(am){ai(am.value[0]);ah("_");ai(am.value[1]);aj.moveRight()};al.symbol=function(am){ag(af(am))};al.text=function(am){ag(af(am))};ai(ak)};y.mfs.makeMFSFromMFSParseTree=function(ah){var ai={};function ag(ak){var aj;aj=ai[ak.type];if(aj){return aj(ak)}else{y.signalErrorWithMessage("GSP.mfs.makeMFSFromMFSParseTree: No handler for node:"+ak.type);return""}}function af(aj){var al,am=aj.length,ak="";for(al=0;al<am;al++){ak+=ag(aj[al])}return ak}ai.abs=function(aj){return"<|"+ag(aj.value[0])+">"};ai.bracket=function(aj){return"<["+ag(aj.value[0])+">"};ai.curly=function(aj){return"<{"+ag(aj.value[0])+">"};ai.fraction=function(aj){return"</"+ag(aj.value[0])+ag(aj.value[1])+">"};ai.horizontal=function(aj){return"<H"+af(aj.value)+">"};ai.parameter=function(aj){return"<%"+aj.value+">"};ai.paren=function(aj){return"<("+ag(aj.value[0])+">"};ai.root=function(aj){return"<R"+ag(aj.value[0])+">"};ai.style=function(ao){var ak="",aj,al={green:"G",blue:"L",fontFamily:"P",red:"R",fontStyle:"S",tightness:"T",underbar:"U",fontWeight:"W",fontSize:"#","diminish-size":"+"};for(var am=0,an=ao.value.length-1;am<an;++am){aj=ao.value[am];ak+=al[aj.code];ak+=aj.value}return"<S"+ak+ag(ao.value[ao.value.length-1])+">"};ai.sub=function(aj){return"<-"+ag(aj.value[0])+ag(aj.value[1])+">"};ai["super"]=function(aj){return"<+"+ag(aj.value[0])+ag(aj.value[1])+">"};ai.symbol=function(aj){return"<!"+aj.value+">"};ai["switch"]=function(aj){var ak=aj.visibleNode?aj.visibleNode.toString(16):"";return"<?"+ak+"x"+aj.refCon+af(aj.value)+">"};ai.text=function(aj){return"<T'"+aj.value.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'>"};ai.vertical=function(aj){var ak=aj.alignment?aj.alignment:"";return"<V"+ak+af(aj.value)+">"};ai.future=function(aj){return"<F"+aj.value+">"};ai.overbar=function(ak,aj){return"<O"+ak.variant+ag(ak.value)+">"};return ag(ah)}}());y.units={};y.units.unitFamilies={length:{baseUnit:"pixels"},angle:{baseUnit:"radians"},scalar:{baseUnit:"scalar"}};y.units.units=[{unitFamily:"scalar",conversionFromBase:1,pluralName:"",singularName:"",symbol:""},{unitFamily:"length",conversionFromBase:1,pluralName:"pixels",singularName:"pixel",shortName:"pix",digraph:"px",symbol:" pixels"},{unitFamily:"length",conversionFromBase:1/72,pluralName:"inches",singularName:"inch",shortName:"in.",digraph:"in",symbol:" in."},{unitFamily:"length",conversionFromBase:1/(72*0.393700787401575),pluralName:"centimeter",singularName:"centimeter",shortName:"cm",digraph:"cm",symbol:" cm"},{unitFamily:"angle",conversionFromBase:1,pluralName:"radians",singularName:"radian",shortName:"rad",digraph:"rd",symbol:" radians"},{unitFamily:"angle",conversionFromBase:180/Math.PI,pluralName:"degrees",singularName:"degree",shortName:"deg",digraph:"dg",symbol:"\u00B0"},{unitFamily:"angle",conversionFromBase:180/Math.PI,pluralName:"degrees",singularName:"degree",shortName:"signed deg",digraph:"dg",symbol:"\u00B0"}];y.units.makeUnitMap=function(F){var D,G,E={};for(D=0;D<F.length;D+=1){G=F[D];if(G.pluralName!==h){E[G.pluralName]=G}if(G.singularName!==h){E[G.singularName]=G}if(G.shortName!==h){E[G.shortName]=G}if(G.digraph!==h){E[G.digraph]=G}if(G.symbol!==h){E[G.symbol]=G}if(G.unitFamily==="scalar"){E.scalar=G}}return E};y.units.unitMap=y.units.makeUnitMap(y.units.units);y.units.findUnit=function(D,E){if(typeof D==="undefined"){D="scalar"}return this.unitMap[D]};y.units.convert=function(J,F,K,H){var I=this.findUnit(F),G=this.findUnit(K),D=I.unitFamily,E;if(H===h){H=1}if(!I){y.signalErrorWithMessage("GSP.units.convert: unknown fromUnit: "+F);return J}if(!G){y.signalErrorWithMessage("GSP.units.convert: unknown toUnit: "+K);return J}D=I.unitFamily;if(G.unitFamily!==D){y.signalErrorWithMessage("GSP.units.convert: can't convert between unit families: "+F+"/"+K);return J}E=(I.pluralName===D.baseUnit)?J:J/Math.pow(I.conversionFromBase,H);return E*Math.pow(G.conversionFromBase,H)};y.units.eachUnitDimension=function(D,F){var E;for(E in D){if(D.hasOwnProperty(E)&&D[E]&&(E!=="scalar")){if(false===F(E,D[E])){return}}}};y.units.makeUnitObjectFromUnitsAndPowers=function(E,D){var F={};y.units.eachUnitDimension(D,function(H,G){F[H]={unit:E[H],power:G}});return F};y.units.convertFromBaseToUnitObject=function(E,D){var F=E;y.units.eachUnitDimension(D,function(G,H){F=y.units.convertFromBaseValue(F,H.unit,H.power)});return F};y.units.convertToBaseFromUnitObject=function(E,D){var F=E;y.units.eachUnitDimension(D,function(G,H){F=y.units.convertToBaseValue(F,H.unit,H.power)});return F};y.units.convertFromBaseValue=function(G,H,F){var E=this.findUnit(H),D;if(E===h){y.signalErrorWithMessage("GSP.units.convert: unknown toUnit: "+H);return G}D=E.unitFamily;return this.convert(G,this.unitFamilies[D].baseUnit,H,F)};y.units.convertToBaseValue=function(H,E,F){var G=this.findUnit(E),D;if(G===h){y.signalErrorWithMessage("GSP.units.convert: unknown toUnit: "+G);return H}D=G.unitFamily;return this.convert(H,E,this.unitFamilies[D].baseUnit,F)};y.units.getMFSForUnitObject=function(E){var D=null;y.units.eachUnitDimension(E,function(F,G){if(G.power!==0){if(D){return null}else{if(G.power===1){D=y.mfs.makeTextMFS(y.units.findUnit(G.unit).symbol)}else{D={type:"super",value:[y.mfs.makeTextMFS(y.units.findUnit(G.unit).symbol),y.mfs.makeTextMFS(G.power)]}}}}});return D};y.units.getUnitFamily=function(D){var E=this.findUnit(D);if(E===h){E=this.findUnit("scalar")}return E.unitFamily};y.units.convertToDocUnits=function(F,H,G){if(typeof G==="undefined"){return H}var E=this.findUnit(G);var D=F[E.unitFamily];return this.convert(H,G,D,1)};y.math={angleToRadians:function(D,E){return y.units.convert(E,D,"radians",1)},sin:function(E,D){return Math.sin(this.angleToRadians(D.angle,E))},cos:function(E,D){return Math.cos(this.angleToRadians(D.angle,E))},tan:function(E,D){return Math.tan(this.angleToRadians(D.angle,E))},asin:function(E,D){return y.units.convertToDocUnits(D,Math.asin(E),"radians")},acos:function(E,D){return y.units.convertToDocUnits(D,Math.acos(E),"radians")},atan:function(E,D){return y.units.convertToDocUnits(D,Math.atan(E),"radians")},abs:Math.abs,sqrt:Math.sqrt,ln:Math.log,log:function(D){return D>=1?Math.log(D)*Math.LOG10E:Math.log(10*D)*Math.LOG10E-1},pow:function(E,D){return E<0?y.math.powerOfNegativeBase(E,D):Math.pow(E,D)},sign:function(D){return D===D?(D===0?0:(D<0?-1:1)):NaN},isDefined:function(D){return isNaN(D)?0:1},round:Math.round,trunc:function(D){return Math[D>0?"floor":"ceil"](D)},mod:function(D,E){return((D%E)+E)%E},powerOfNegativeBase:function(J,G){var F=1e-13,D=3,H,I,K,E;for(K=0;K<5;++K){H=G*D;I=Math.round(H);if(Math.abs(H-I)<=(2*F)){E=(I%2!==0)?-1:1;return E*Math.pow(-J,G)}D+=2}return Math.pow(J,G)},expect:function(K,H,L,J){var G=isNaN(K)||(K===h),F=isNaN(H)||(H===h),D=!isFinite(K)&&!isNaN(K)&&((K>0)?"posInfinity":"negInfinity"),I=((H==="inf")&&"posInfinity")||((H==="-inf")&&"negInfinity"),E;if(h===L){L=0.00001}if(K===H){return true}if(D||I){return D===I}if(G||F){return G===F}E=Math.abs(K-H);if(J&&((K+L)!==K)){return E<L}if(Math.abs(K)+Math.abs(H)<2*1e-12){return true}return(E<=L*Math.abs(K))&&(E<=L*Math.abs(H))},isFiniteScalar:function(D){return(D!=null)&&isFinite(D)},gcd:function(E,D){if((E!==~~E)||(D!==~~D)){return 0}if((0===E)||(0===D)){return 0}var F;while(D){F=E%D;E=D;D=F}return E},reduceFraction:function(D,F){var E=this.gcd(D,F);if(E>1){return{numerator:D/E,denominator:F/E}}return{numerator:D,denominator:F}},getSimplePiFraction:function(H){if(H===Math.floor(H)){return false}var F=12*H/Math.PI,E=Math.round(F),G=Math.abs(F-E);if((0!==E)&&(G<0.001)){var D=y.math.reduceFraction(Math.abs(E),12);if(E<0){D.numerator=-D.numerator}return D}return false}};y.math.PI=Math.PI;y.math.TWO_PI=2*Math.PI;y.math.SIMPLE_PI_THRESHOLD=(Math.PI*0.9999999999);y.infixExpressionParser=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(bw){var cb=arguments.length>1?arguments[1]:{},aZ={},L={start:cA},b7=cA,aR=[],aQ=function(){return a5(J({kind:"blank",type:"blank",children:{}}))},aP=aZ,aO=null,aM="=",aL={type:"literal",value:"=",description:'"="'},aK=function(cN,cM){var cL={kind:"equation",type:"equation",children:{expr:cM}};if(cN){cL.children.declaration=cN[0]}return a5(J(cL))},aJ=/^[a-z]/,aH={type:"class",value:"[a-z]",description:"[a-z]"},aG="(",cx={type:"literal",value:"(",description:'"("'},cw=/^[xyr\u03B8]/,cu={type:"class",value:"[xyr\\u03B8]",description:"[xyr\\u03B8]"},ct=")",cs={type:"literal",value:")",description:'")"'},cr=function(cO,cN){var cM=cO.join(""),cL={kind:"declaration:"+cM,type:"declaration",children:{},name:cM,argument:cN};return J(cL)},cq=function(cM){var cL={kind:"declaration:"+cM,type:"declaration",children:{},argument:cM};return J(cL)},cp="+",co={type:"literal",value:"+",description:'"+"'},cn="-",cl={type:"literal",value:"-",description:'"-"'},cj=function(cO,cM){var cL,cN,cP;cL=cO;for(cN=0;cN<cM.length;cN++){cP=cM[cN][0];cL=J({kind:"binary-expr:"+cP,type:"binary-expr",children:{left:cL,right:cM[cN][1]},subtype:"additive",operator:cP})}return cL},ci="/",ch={type:"literal",value:"/",description:'"/"'},cg="*",cf={type:"literal",value:"*",description:'"*"'},ce=function(cO,cM){var cL,cN,cP;cL=cO;for(cN=0;cN<cM.length;cN++){cP=cM[cN][0];cL=J({kind:"binary-expr:"+cP,type:"binary-expr",children:{left:cL,right:cM[cN][1]},subtype:"multiplicative",operator:cP})}return cL},cd="^",cc={type:"literal",value:"^",description:'"^"'},ca=function(cN,cO){if(cO){var cM=cO[1];var cL;cL={kind:"binary-expr:^",type:"binary-expr",children:{left:cN,right:cM},subtype:"power",operator:"^"};return J(cL)}else{return cN}},b8=function(cL){return cL},b6=function(cL){return J({kind:"unary-expr:-",type:"unary-expr",children:{child:cL},operator:"-"})},b5=function(cL){return J({kind:"unary-expr:-",type:"unary-expr",children:{child:cL},operator:"-"})},b4=function(cL,cM){return J({kind:"function:"+cL,type:"function",children:{arg:cM},subtype:"sys",name:cL})},b2=function(cL,cM){return J({kind:"function:custom",type:"function",children:{name:cL,arg:cM},subtype:"custom"})},b1="sin",b0={type:"literal",value:"sin",description:'"sin"'},bZ="cos",bY={type:"literal",value:"cos",description:'"cos"'},bX="tan",bS={type:"literal",value:"tan",description:'"tan"'},bR="Arcsin",bQ={type:"literal",value:"Arcsin",description:'"Arcsin"'},bP="Arccos",bO={type:"literal",value:"Arccos",description:'"Arccos"'},bN="Arctan",bM={type:"literal",value:"Arctan",description:'"Arctan"'},bL="abs",bK={type:"literal",value:"abs",description:'"abs"'},bJ="sqrt",bH={type:"literal",value:"sqrt",description:'"sqrt"'},bF="ln",bE={type:"literal",value:"ln",description:'"ln"'},bD="log",bC={type:"literal",value:"log",description:'"log"'},bB="sgn",bA={type:"literal",value:"sgn",description:'"sgn"'},bz="round",by={type:"literal",value:"round",description:'"round"'},bx="trunc",bt={type:"literal",value:"trunc",description:'"trunc"'},bs="isDefined",br={type:"literal",value:"isDefined",description:'"isDefined"'},bq=function(cL,cM){return J({kind:"primary",type:"primary",children:{value:cL,unit:cM}})},bn=function(cL){return J({kind:"primary",type:"primary",children:{value:cL},unit:h})},bm=".",bl={type:"literal",value:".",description:'"."'},bk="e",bj={type:"literal",value:"e",description:'"e"'},bi=function(cM){var cL=cM.join("");return J({kind:"constant:numeric:"+cL,type:"constant",children:{},subtype:"numeric",value:cL})},bf="pi",be={type:"literal",value:"pi",description:'"pi"'},bd="\u03C0",bc={type:"literal",value:"\u03C0",description:'"\\u03C0"'},bb=function(cN){var cL={pi:"pi","π":"pi",e:"e"},cM=cL[cN]?cL[cN]:cN;return J({kind:"constant:symbolic:"+cM,type:"constant",children:{},subtype:"symbolic",value:cM})},ba=/^[0-9]/,a9={type:"class",value:"[0-9]",description:"[0-9]"},a8=function(cL){return cL.join("")},a7="pixels",a6={type:"literal",value:"pixels",description:'"pixels"'},aF="pixel",aE={type:"literal",value:"pixel",description:'"pixel"'},aD="px",aC={type:"literal",value:"px",description:'"px"'},aB="pix",az={type:"literal",value:"pix",description:'"pix"'},ay="cm",ax={type:"literal",value:"cm",description:'"cm"'},aw="centimeter",av={type:"literal",value:"centimeter",description:'"centimeter"'},ah="inches",ag={type:"literal",value:"inches",description:'"inches"'},af="inch",ae={type:"literal",value:"inch",description:'"inch"'},ad="in.",ac={type:"literal",value:"in.",description:'"in."'},aa="in",Z={type:"literal",value:"in",description:'"in"'},Y=function(cL){return J({kind:"unit:"+cL,type:"unit",children:{},subtype:"distance",name:cL})},W="radians",a4={type:"literal",value:"radians",description:'"radians"'},a3="radian",a2={type:"literal",value:"radian",description:'"radian"'},a1="rad",a0={type:"literal",value:"rad",description:'"rad"'},aY="rd",aX={type:"literal",value:"rd",description:'"rd"'},aW="degrees",aU={type:"literal",value:"degrees",description:'"degrees"'},aS="deg",au={type:"literal",value:"deg",description:'"deg"'},at="\xB0",aq={type:"literal",value:"\xB0",description:'"\\xB0"'},ap="signed deg",ao={type:"literal",value:"signed deg",description:'"signed deg"'},an=function(cL){return J({kind:"unit:"+cL,type:"unit",children:{},subtype:"angle",name:cL})},am="@",al={type:"literal",value:"@",description:'"@"'},ak=/^[0-9a-zA-Z_]/,aj={type:"class",value:"[0-9a-zA-Z_]",description:"[0-9a-zA-Z_]"},V=function(cL){var cM=cL.join("");return J({kind:"reference:"+cM,type:"reference",children:{},name:cM})},U="x",T={type:"literal",value:"x",description:'"x"'},S="y",R={type:"literal",value:"y",description:'"y"'},Q="\u03B8",P={type:"literal",value:"\u03B8",description:'"\\u03B8"'},O="r",N={type:"literal",value:"r",description:'"r"'},M=function(cL){return J({kind:"variable:"+cL,type:"variable",children:{},name:cL})},K={type:"other",description:"whitespace"},I=/^[ \t\n\r]/,H={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},bI=0,cK=0,cC=0,aN={line:1,column:1,seenCR:false},bg=0,bh=[],cy=0,bv;if("startRule" in cb){if(!(cb.startRule in L)){throw new Error("Can't start parsing from rule \""+cb.startRule+'".')}b7=L[cb.startRule]}function ck(){return bw.substring(cK,bI)}function cG(){return cK}function cv(){return ab(cK).line}function cH(){return ab(cK).column}function cJ(cL){throw cF(null,[{type:"other",description:cL}],cK)}function cE(cL){throw cF(cL,null,cK)}function ab(cM){function cL(cP,cO,cN){var cR,cQ;for(cR=cO;cR<cN;cR++){cQ=bw.charAt(cR);if(cQ==="\n"){if(!cP.seenCR){cP.line++}cP.column=1;cP.seenCR=false}else{if(cQ==="\r"||cQ==="\u2028"||cQ==="\u2029"){cP.line++;cP.column=1;cP.seenCR=true}else{cP.column++;cP.seenCR=false}}}}if(cC!==cM){if(cC>cM){cC=0;aN={line:1,column:1,seenCR:false}}cL(aN,cC,cM);cC=cM}return aN}function cm(cL){if(bI<bg){return}if(bI>bg){bg=bI;bh=[]}bh.push(cL)}function cF(cN,cM,cR){function cQ(cT){var cS=1;cT.sort(function(cV,cU){if(cV.description<cU.description){return -1}else{if(cV.description>cU.description){return 1}else{return 0}}});while(cS<cT.length){if(cT[cS-1]===cT[cS]){cT.splice(cS,1)}else{cS++}}}function cL(cW,cX){function cS(cZ){function c0(c4){return c4.charCodeAt(0).toString(16).toUpperCase()}return cZ.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(c4){return"\\x0"+c0(c4)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(c4){return"\\x"+c0(c4)}).replace(/[\u0180-\u0FFF]/g,function(c4){return"\\u0"+c0(c4)}).replace(/[\u1080-\uFFFF]/g,function(c4){return"\\u"+c0(c4)})}var cT=new Array(cW.length),cY,cU,cV;for(cV=0;cV<cW.length;cV++){cT[cV]=cW[cV].description}cY=cW.length>1?cT.slice(0,-1).join(", ")+" or "+cT[cW.length-1]:cT[0];cU=cX?'"'+cS(cX)+'"':"end of input";return"Expected "+cY+" but "+cU+" found."}var cP=ab(cR),cO=cR<bw.length?bw.charAt(cR):null;if(cM!==null){cQ(cM)}return new D(cN!==null?cN:cL(cM,cO),cM,cO,cR,cP.line,cP.column)}function cA(){var cL;cL=bp();if(cL===aZ){cL=aI()}return cL}function aI(){var cM,cL;cM=bI;cL=[];if(cL!==aZ){cK=cM;cL=aQ()}cM=cL;return cM}function bp(){var cQ,cP,cO,cN,cM,cL;cQ=bI;cP=bI;cO=b9();if(cO!==aZ){cN=bG();if(cN!==aZ){if(bw.charCodeAt(bI)===61){cM=aM;bI++}else{cM=aZ;if(cy===0){cm(aL)}}if(cM!==aZ){cL=bG();if(cL!==aZ){cO=[cO,cN,cM,cL];cP=cO}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}if(cP===aZ){cP=aO}if(cP!==aZ){cO=bo();if(cO!==aZ){cK=cQ;cP=aK(cP,cO);cQ=cP}else{bI=cQ;cQ=aP}}else{bI=cQ;cQ=aP}return cQ}function b9(){var cP,cO,cN,cM,cL;cP=bI;cO=[];if(aJ.test(bw.charAt(bI))){cN=bw.charAt(bI);bI++}else{cN=aZ;if(cy===0){cm(aH)}}if(cN!==aZ){while(cN!==aZ){cO.push(cN);if(aJ.test(bw.charAt(bI))){cN=bw.charAt(bI);bI++}else{cN=aZ;if(cy===0){cm(aH)}}}}else{cO=aP}if(cO!==aZ){if(bw.charCodeAt(bI)===40){cN=aG;bI++}else{cN=aZ;if(cy===0){cm(cx)}}if(cN!==aZ){if(cw.test(bw.charAt(bI))){cM=bw.charAt(bI);bI++}else{cM=aZ;if(cy===0){cm(cu)}}if(cM!==aZ){if(bw.charCodeAt(bI)===41){cL=ct;bI++}else{cL=aZ;if(cy===0){cm(cs)}}if(cL!==aZ){cK=cP;cO=cr(cO,cM);cP=cO}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}if(cP===aZ){cP=bI;if(cw.test(bw.charAt(bI))){cO=bw.charAt(bI);bI++}else{cO=aZ;if(cy===0){cm(cu)}}if(cO!==aZ){cK=cP;cO=cq(cO)}cP=cO}return cP}function bo(){var cQ,cP,cO,cN,cM,cL;cQ=bI;cP=ai();if(cP!==aZ){cO=[];cN=bI;if(bw.charCodeAt(bI)===43){cM=cp;bI++}else{cM=aZ;if(cy===0){cm(co)}}if(cM===aZ){if(bw.charCodeAt(bI)===45){cM=cn;bI++}else{cM=aZ;if(cy===0){cm(cl)}}}if(cM!==aZ){cL=ai();if(cL!==aZ){cM=[cM,cL];cN=cM}else{bI=cN;cN=aP}}else{bI=cN;cN=aP}while(cN!==aZ){cO.push(cN);cN=bI;if(bw.charCodeAt(bI)===43){cM=cp;bI++}else{cM=aZ;if(cy===0){cm(co)}}if(cM===aZ){if(bw.charCodeAt(bI)===45){cM=cn;bI++}else{cM=aZ;if(cy===0){cm(cl)}}}if(cM!==aZ){cL=ai();if(cL!==aZ){cM=[cM,cL];cN=cM}else{bI=cN;cN=aP}}else{bI=cN;cN=aP}}if(cO!==aZ){cK=cQ;cP=cj(cP,cO);cQ=cP}else{bI=cQ;cQ=aP}}else{bI=cQ;cQ=aP}return cQ}function ai(){var cQ,cP,cO,cN,cM,cL;cQ=bI;cP=bu();if(cP!==aZ){cO=[];cN=bI;if(bw.charCodeAt(bI)===47){cM=ci;bI++}else{cM=aZ;if(cy===0){cm(ch)}}if(cM===aZ){if(bw.charCodeAt(bI)===42){cM=cg;bI++}else{cM=aZ;if(cy===0){cm(cf)}}}if(cM!==aZ){cL=bu();if(cL!==aZ){cM=[cM,cL];cN=cM}else{bI=cN;cN=aP}}else{bI=cN;cN=aP}while(cN!==aZ){cO.push(cN);cN=bI;if(bw.charCodeAt(bI)===47){cM=ci;bI++}else{cM=aZ;if(cy===0){cm(ch)}}if(cM===aZ){if(bw.charCodeAt(bI)===42){cM=cg;bI++}else{cM=aZ;if(cy===0){cm(cf)}}}if(cM!==aZ){cL=bu();if(cL!==aZ){cM=[cM,cL];cN=cM}else{bI=cN;cN=aP}}else{bI=cN;cN=aP}}if(cO!==aZ){cK=cQ;cP=ce(cP,cO);cQ=cP}else{bI=cQ;cQ=aP}}else{bI=cQ;cQ=aP}return cQ}function bu(){var cP,cO,cN,cM,cL;cP=bI;cO=bW();if(cO!==aZ){cN=bI;if(bw.charCodeAt(bI)===94){cM=cd;bI++}else{cM=aZ;if(cy===0){cm(cc)}}if(cM!==aZ){cL=bu();if(cL!==aZ){cM=[cM,cL];cN=cM}else{bI=cN;cN=aP}}else{bI=cN;cN=aP}if(cN===aZ){cN=aO}if(cN!==aZ){cK=cP;cO=ca(cO,cN);cP=cO}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}return cP}function bW(){var cO,cN,cM,cL;cO=b3();if(cO===aZ){cO=bI;if(bw.charCodeAt(bI)===40){cN=aG;bI++}else{cN=aZ;if(cy===0){cm(cx)}}if(cN!==aZ){cM=bo();if(cM!==aZ){if(bw.charCodeAt(bI)===41){cL=ct;bI++}else{cL=aZ;if(cy===0){cm(cs)}}if(cL!==aZ){cK=cO;cN=b8(cM);cO=cN}else{bI=cO;cO=aP}}else{bI=cO;cO=aP}}else{bI=cO;cO=aP}if(cO===aZ){cO=ar()}}return cO}function b3(){var cN,cM,cL;cN=aT();if(cN===aZ){cN=bI;if(bw.charCodeAt(bI)===45){cM=cn;bI++}else{cM=aZ;if(cy===0){cm(cl)}}if(cM!==aZ){cL=b3();if(cL!==aZ){cK=cN;cM=b6(cL);cN=cM}else{bI=cN;cN=aP}}else{bI=cN;cN=aP}if(cN===aZ){cN=bI;if(bw.charCodeAt(bI)===45){cM=cn;bI++}else{cM=aZ;if(cy===0){cm(cl)}}if(cM!==aZ){cL=bu();if(cL!==aZ){cK=cN;cM=b5(cL);cN=cM}else{bI=cN;cN=aP}}else{bI=cN;cN=aP}}}return cN}function aT(){var cP,cO,cN,cM,cL;cP=bI;cO=aA();if(cO!==aZ){if(bw.charCodeAt(bI)===40){cN=aG;bI++}else{cN=aZ;if(cy===0){cm(cx)}}if(cN!==aZ){cM=bo();if(cM!==aZ){if(bw.charCodeAt(bI)===41){cL=ct;bI++}else{cL=aZ;if(cy===0){cm(cs)}}if(cL!==aZ){cK=cP;cO=b4(cO,cM);cP=cO}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}if(cP===aZ){cP=bI;cO=bV();if(cO!==aZ){if(bw.charCodeAt(bI)===40){cN=aG;bI++}else{cN=aZ;if(cy===0){cm(cx)}}if(cN!==aZ){cM=bo();if(cM!==aZ){if(bw.charCodeAt(bI)===41){cL=ct;bI++}else{cL=aZ;if(cy===0){cm(cs)}}if(cL!==aZ){cK=cP;cO=b2(cO,cM);cP=cO}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}else{bI=cP;cP=aP}}return cP}function aA(){var cL;if(bw.substr(bI,3)===b1){cL=b1;bI+=3}else{cL=aZ;if(cy===0){cm(b0)}}if(cL===aZ){if(bw.substr(bI,3)===bZ){cL=bZ;bI+=3}else{cL=aZ;if(cy===0){cm(bY)}}if(cL===aZ){if(bw.substr(bI,3)===bX){cL=bX;bI+=3}else{cL=aZ;if(cy===0){cm(bS)}}if(cL===aZ){if(bw.substr(bI,6)===bR){cL=bR;bI+=6}else{cL=aZ;if(cy===0){cm(bQ)}}if(cL===aZ){if(bw.substr(bI,6)===bP){cL=bP;bI+=6}else{cL=aZ;if(cy===0){cm(bO)}}if(cL===aZ){if(bw.substr(bI,6)===bN){cL=bN;bI+=6}else{cL=aZ;if(cy===0){cm(bM)}}if(cL===aZ){if(bw.substr(bI,3)===bL){cL=bL;bI+=3}else{cL=aZ;if(cy===0){cm(bK)}}if(cL===aZ){if(bw.substr(bI,4)===bJ){cL=bJ;bI+=4}else{cL=aZ;if(cy===0){cm(bH)}}if(cL===aZ){if(bw.substr(bI,2)===bF){cL=bF;bI+=2}else{cL=aZ;if(cy===0){cm(bE)}}if(cL===aZ){if(bw.substr(bI,3)===bD){cL=bD;bI+=3}else{cL=aZ;if(cy===0){cm(bC)}}if(cL===aZ){if(bw.substr(bI,3)===bB){cL=bB;bI+=3}else{cL=aZ;if(cy===0){cm(bA)}}if(cL===aZ){if(bw.substr(bI,5)===bz){cL=bz;bI+=5}else{cL=aZ;if(cy===0){cm(by)}}if(cL===aZ){if(bw.substr(bI,5)===bx){cL=bx;bI+=5}else{cL=aZ;if(cy===0){cm(bt)}}if(cL===aZ){if(bw.substr(bI,9)===bs){cL=bs;bI+=9}else{cL=aZ;if(cy===0){cm(br)}}}}}}}}}}}}}}}return cL}function ar(){var cO,cN,cM,cL;cO=bI;cN=X();if(cN!==aZ){cM=bG();if(cM!==aZ){cL=cz();if(cL!==aZ){cK=cO;cN=bq(cN,cL);cO=cN}else{bI=cO;cO=aP}}else{bI=cO;cO=aP}}else{bI=cO;cO=aP}if(cO===aZ){cO=bI;cN=X();if(cN!==aZ){cK=cO;cN=bn(cN)}cO=cN;if(cO===aZ){cO=bV();if(cO===aZ){cO=bT()}}}return cO}function X(){var cT,cS,cR,cQ,cP,cO,cN,cM,cL;cT=bI;cS=bI;if(bw.charCodeAt(bI)===45){cR=cn;bI++}else{cR=aZ;if(cy===0){cm(cl)}}if(cR===aZ){cR=aO}if(cR!==aZ){cQ=cD();if(cQ!==aZ){if(bw.charCodeAt(bI)===46){cP=bm;bI++}else{cP=aZ;if(cy===0){cm(bl)}}if(cP!==aZ){cO=cD();if(cO!==aZ){if(bw.charCodeAt(bI)===101){cN=bk;bI++}else{cN=aZ;if(cy===0){cm(bj)}}if(cN!==aZ){if(bw.charCodeAt(bI)===45){cM=cn;bI++}else{cM=aZ;if(cy===0){cm(cl)}}if(cM===aZ){cM=aO}if(cM!==aZ){cL=cD();if(cL!==aZ){cR=[cR,cQ,cP,cO,cN,cM,cL];cS=cR}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}if(cS===aZ){cS=bI;if(bw.charCodeAt(bI)===45){cR=cn;bI++}else{cR=aZ;if(cy===0){cm(cl)}}if(cR===aZ){cR=aO}if(cR!==aZ){cQ=cD();if(cQ!==aZ){if(bw.charCodeAt(bI)===46){cP=bm;bI++}else{cP=aZ;if(cy===0){cm(bl)}}if(cP!==aZ){cO=cD();if(cO!==aZ){cR=[cR,cQ,cP,cO];cS=cR}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}if(cS===aZ){cS=bI;if(bw.charCodeAt(bI)===45){cR=cn;bI++}else{cR=aZ;if(cy===0){cm(cl)}}if(cR===aZ){cR=aO}if(cR!==aZ){cQ=cD();if(cQ!==aZ){if(bw.charCodeAt(bI)===46){cP=bm;bI++}else{cP=aZ;if(cy===0){cm(bl)}}if(cP!==aZ){cR=[cR,cQ,cP];cS=cR}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}if(cS===aZ){cS=bI;if(bw.charCodeAt(bI)===45){cR=cn;bI++}else{cR=aZ;if(cy===0){cm(cl)}}if(cR===aZ){cR=aO}if(cR!==aZ){if(bw.charCodeAt(bI)===46){cQ=bm;bI++}else{cQ=aZ;if(cy===0){cm(bl)}}if(cQ!==aZ){cP=cD();if(cP!==aZ){cR=[cR,cQ,cP];cS=cR}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}if(cS===aZ){cS=bI;if(bw.charCodeAt(bI)===45){cR=cn;bI++}else{cR=aZ;if(cy===0){cm(cl)}}if(cR===aZ){cR=aO}if(cR!==aZ){cQ=cD();if(cQ!==aZ){cR=[cR,cQ];cS=cR}else{bI=cS;cS=aP}}else{bI=cS;cS=aP}}}}}if(cS!==aZ){cK=cT;cS=bi(cS)}cT=cS;if(cT===aZ){cT=bI;if(bw.substr(bI,2)===bf){cS=bf;bI+=2}else{cS=aZ;if(cy===0){cm(be)}}if(cS===aZ){if(bw.charCodeAt(bI)===960){cS=bd;bI++}else{cS=aZ;if(cy===0){cm(bc)}}if(cS===aZ){if(bw.charCodeAt(bI)===101){cS=bk;bI++}else{cS=aZ;if(cy===0){cm(bj)}}}}if(cS!==aZ){cK=cT;cS=bb(cS)}cT=cS}return cT}function cD(){var cN,cM,cL;cN=bI;cM=[];if(ba.test(bw.charAt(bI))){cL=bw.charAt(bI);bI++}else{cL=aZ;if(cy===0){cm(a9)}}if(cL!==aZ){while(cL!==aZ){cM.push(cL);if(ba.test(bw.charAt(bI))){cL=bw.charAt(bI);bI++}else{cL=aZ;if(cy===0){cm(a9)}}}}else{cM=aP}if(cM!==aZ){cK=cN;cM=a8(cM)}cN=cM;return cN}function cz(){var cL;cL=aV();if(cL===aZ){cL=cI()}return cL}function aV(){var cM,cL;cM=bI;if(bw.substr(bI,6)===a7){cL=a7;bI+=6}else{cL=aZ;if(cy===0){cm(a6)}}if(cL===aZ){if(bw.substr(bI,5)===aF){cL=aF;bI+=5}else{cL=aZ;if(cy===0){cm(aE)}}if(cL===aZ){if(bw.substr(bI,2)===aD){cL=aD;bI+=2}else{cL=aZ;if(cy===0){cm(aC)}}if(cL===aZ){if(bw.substr(bI,3)===aB){cL=aB;bI+=3}else{cL=aZ;if(cy===0){cm(az)}}if(cL===aZ){if(bw.substr(bI,2)===ay){cL=ay;bI+=2}else{cL=aZ;if(cy===0){cm(ax)}}if(cL===aZ){if(bw.substr(bI,10)===aw){cL=aw;bI+=10}else{cL=aZ;if(cy===0){cm(av)}}if(cL===aZ){if(bw.substr(bI,6)===ah){cL=ah;bI+=6}else{cL=aZ;if(cy===0){cm(ag)}}if(cL===aZ){if(bw.substr(bI,4)===af){cL=af;bI+=4}else{cL=aZ;if(cy===0){cm(ae)}}if(cL===aZ){if(bw.substr(bI,3)===ad){cL=ad;bI+=3}else{cL=aZ;if(cy===0){cm(ac)}}if(cL===aZ){if(bw.substr(bI,2)===aa){cL=aa;bI+=2}else{cL=aZ;if(cy===0){cm(Z)}}}}}}}}}}}if(cL!==aZ){cK=cM;cL=Y(cL)}cM=cL;return cM}function cI(){var cM,cL;cM=bI;if(bw.substr(bI,7)===W){cL=W;bI+=7}else{cL=aZ;if(cy===0){cm(a4)}}if(cL===aZ){if(bw.substr(bI,6)===a3){cL=a3;bI+=6}else{cL=aZ;if(cy===0){cm(a2)}}if(cL===aZ){if(bw.substr(bI,3)===a1){cL=a1;bI+=3}else{cL=aZ;if(cy===0){cm(a0)}}if(cL===aZ){if(bw.substr(bI,2)===aY){cL=aY;bI+=2}else{cL=aZ;if(cy===0){cm(aX)}}if(cL===aZ){if(bw.substr(bI,7)===aW){cL=aW;bI+=7}else{cL=aZ;if(cy===0){cm(aU)}}if(cL===aZ){if(bw.substr(bI,3)===aS){cL=aS;bI+=3}else{cL=aZ;if(cy===0){cm(au)}}if(cL===aZ){if(bw.charCodeAt(bI)===176){cL=at;bI++}else{cL=aZ;if(cy===0){cm(aq)}}if(cL===aZ){if(bw.substr(bI,10)===ap){cL=ap;bI+=10}else{cL=aZ;if(cy===0){cm(ao)}}}}}}}}}if(cL!==aZ){cK=cM;cL=an(cL)}cM=cL;return cM}function bV(){var cO,cN,cM,cL;cO=bI;if(bw.charCodeAt(bI)===64){cN=am;bI++}else{cN=aZ;if(cy===0){cm(al)}}if(cN!==aZ){cM=[];if(ak.test(bw.charAt(bI))){cL=bw.charAt(bI);bI++}else{cL=aZ;if(cy===0){cm(aj)}}if(cL!==aZ){while(cL!==aZ){cM.push(cL);if(ak.test(bw.charAt(bI))){cL=bw.charAt(bI);bI++}else{cL=aZ;if(cy===0){cm(aj)}}}}else{cM=aP}if(cM!==aZ){cK=cO;cN=V(cM);cO=cN}else{bI=cO;cO=aP}}else{bI=cO;cO=aP}return cO}function bT(){var cM,cL;cM=bI;if(bw.charCodeAt(bI)===120){cL=U;bI++}else{cL=aZ;if(cy===0){cm(T)}}if(cL===aZ){if(bw.charCodeAt(bI)===121){cL=S;bI++}else{cL=aZ;if(cy===0){cm(R)}}if(cL===aZ){if(bw.charCodeAt(bI)===952){cL=Q;bI++}else{cL=aZ;if(cy===0){cm(P)}}if(cL===aZ){if(bw.charCodeAt(bI)===114){cL=O;bI++}else{cL=aZ;if(cy===0){cm(N)}}}}}if(cL!==aZ){cK=cM;cL=M(cL)}cM=cL;return cM}function bG(){var cM,cL;cy++;cM=[];cL=bU();while(cL!==aZ){cM.push(cL);cL=bU()}cy--;if(cM===aZ){cL=aZ;if(cy===0){cm(K)}}return cM}function bU(){var cL;if(I.test(bw.charAt(bI))){cL=bw.charAt(bI);bI++}else{cL=aZ;if(cy===0){cm(H)}}return cL}var cB=0,G={};function J(cO){var cM=cO.kind,cL;for(var cN in cO.children){if(cO.children.hasOwnProperty(cN)){cM+=":"+cN+":"+cO.children[cN].index}}cL=G[cM];if(cL){return cL}cO.index=cB;cO.refCount=0;G[cM]=cO;cB++;return cO}function a5(cL){var cM;for(cM in cL.children){a5(cL.children[cM])}cL.refCount++;return cL}bv=b7();if(bv!==aZ&&bI===bw.length){return bv}else{if(bv!==aZ&&bI<bw.length){cm({type:"end",description:"end of input"})}throw cF(null,bh,bg)}}return{SyntaxError:D,parse:E}})();y.jskParser=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(T){var b3=arguments.length>1?arguments[1]:{},cR={},eb={start:fo},aw=fo,dy=[],dx=cR,dv=null,du=";",dt={type:"literal",value:";",description:'";"'},ds=function(fM,fL,fN){var fO=++dw;return{id:fO,type:fM,argGroups:fL,opts:fN?fN:[]}},dq=function(fL){return fL},dp="[",dn={type:"literal",value:"[",description:'"["'},dm=",",fB={type:"literal",value:",",description:'","'},fz="]",fw={type:"literal",value:"]",description:'"]"'},fv=function(fO,fM){var fL,fN=[];fN.push(fO);for(fL=0;fL<fM.length;fL+=1){fN.push(fM[fL][3])}return fN},fu="(",ft={type:"literal",value:"(",description:'"("'},fs=")",fr={type:"literal",value:")",description:'")"'},fq=function(){return[]},fp=function(fN,fL){var fM,fO=[];fO.push(fN);for(fM=0;fM<fL.length;fM+=1){fO.push(fL[fM][3])}return fO},fe="Point on object",fc={type:"literal",value:"Point on object",description:'"Point on object"'},fa="Point",e9={type:"literal",value:"Point",description:'"Point"'},e8="FixedPoint",e7={type:"literal",value:"FixedPoint",description:'"FixedPoint"'},e5="Midpoint",e4={type:"literal",value:"Midpoint",description:'"Midpoint"'},e3="Intersect1",e2={type:"literal",value:"Intersect1",description:'"Intersect1"'},eX="Intersect2",eW={type:"literal",value:"Intersect2",description:'"Intersect2"'},eV="Intersect",eU={type:"literal",value:"Intersect",description:'"Intersect"'},eT="PlotXY",eR={type:"literal",value:"PlotXY",description:'"PlotXY"'},eQ="PlotFixedXY",eP={type:"literal",value:"PlotFixedXY",description:'"PlotFixedXY"'},eO="UnitPoint",eN={type:"literal",value:"UnitPoint",description:'"UnitPoint"'},eL="SquareUnitPoint",eJ={type:"literal",value:"SquareUnitPoint",description:'"SquareUnitPoint"'},eI="RectangularUnitPoint",eH={type:"literal",value:"RectangularUnitPoint",description:'"RectangularUnitPoint"'},eG="DriverPoint",eF={type:"literal",value:"DriverPoint",description:'"DriverPoint"'},eE="Segment",eD={type:"literal",value:"Segment",description:'"Segment"'},eC="Ray",eB={type:"literal",value:"Ray",description:'"Ray"'},ey="Line",ex={type:"literal",value:"Line",description:'"Line"'},ew="Perpendicular",ev={type:"literal",value:"Perpendicular",description:'"Perpendicular"'},eu="Parallel",et={type:"literal",value:"Parallel",description:'"Parallel"'},es="AxisX",er={type:"literal",value:"AxisX",description:'"AxisX"'},eq="AxisY",ep={type:"literal",value:"AxisY",description:'"AxisY"'},en="Bisector",el={type:"literal",value:"Bisector",description:'"Bisector"'},ek="HorizontalAxis",ej={type:"literal",value:"HorizontalAxis",description:'"HorizontalAxis"'},ei="VerticalAxis",eh={type:"literal",value:"VerticalAxis",description:'"VerticalAxis"'},ef="Polygon",ee={type:"literal",value:"Polygon",description:'"Polygon"'},ed="Circle interior",ec={type:"literal",value:"Circle interior",description:'"Circle interior"'},ea="Circle by radius",d9={type:"literal",value:"Circle by radius",description:'"Circle by radius"'},d8="Circle",d7={type:"literal",value:"Circle",description:'"Circle"'},d6="Reflection",d5={type:"literal",value:"Reflection",description:'"Reflection"'},d4="Dilation/SegmentRatio",d3={type:"literal",value:"Dilation/SegmentRatio",description:'"Dilation/SegmentRatio"'},d2="Dilation/3PtRatio",d1={type:"literal",value:"Dilation/3PtRatio",description:'"Dilation/3PtRatio"'},dZ="Dilation/MarkedRatio",dX={type:"literal",value:"Dilation/MarkedRatio",description:'"Dilation/MarkedRatio"'},dV="Dilation",dU={type:"literal",value:"Dilation",description:'"Dilation"'},dT="Rotation/MarkedAngle",dS={type:"literal",value:"Rotation/MarkedAngle",description:'"Rotation/MarkedAngle"'},dR="Rotation/MeasuredAngle",dP={type:"literal",value:"Rotation/MeasuredAngle",description:'"Rotation/MeasuredAngle"'},dO="Rotation",dN={type:"literal",value:"Rotation",description:'"Rotation"'},dK="VectorTranslation",dJ={type:"literal",value:"VectorTranslation",description:'"VectorTranslation"'},dI="Translation/FixedAngle/MarkedDistance",dH={type:"literal",value:"Translation/FixedAngle/MarkedDistance",description:'"Translation/FixedAngle/MarkedDistance"'},dF="PolarTranslation",dE={type:"literal",value:"PolarTranslation",description:'"PolarTranslation"'},dD="Translation/MarkedAngle/FixedDistance",dC={type:"literal",value:"Translation/MarkedAngle/FixedDistance",description:'"Translation/MarkedAngle/FixedDistance"'},dB="Translation/MarkedAngle/MarkedDistance",dA={type:"literal",value:"Translation/MarkedAngle/MarkedDistance",description:'"Translation/MarkedAngle/MarkedDistance"'},dh="Translation",dg={type:"literal",value:"Translation",description:'"Translation"'},df="Colorized_Spectrum",de={type:"literal",value:"Colorized_Spectrum",description:'"Colorized_Spectrum"'},dd="Colorized_Grayscale",dc={type:"literal",value:"Colorized_Grayscale",description:'"Colorized_Grayscale"'},da="Colorized_RGB",c9={type:"literal",value:"Colorized_RGB",description:'"Colorized_RGB"'},c8="Colorized_HSV",c7={type:"literal",value:"Colorized_HSV",description:'"Colorized_HSV"'},c6="Image",c5={type:"literal",value:"Image",description:'"Image"'},c4="ImageOnPoint",c0={type:"literal",value:"ImageOnPoint",description:'"ImageOnPoint"'},cZ="ImageBetweenPoints",cX={type:"literal",value:"ImageBetweenPoints",description:'"ImageBetweenPoints"'},cW="Length",cV={type:"literal",value:"Length",description:'"Length"'},cT="Angle",cS={type:"literal",value:"Angle",description:'"Angle"'},cP="Perimeter",cO={type:"literal",value:"Perimeter",description:'"Perimeter"'},cN="Circumference",cM={type:"literal",value:"Circumference",description:'"Circumference"'},cK="Radius",cJ={type:"literal",value:"Radius",description:'"Radius"'},cI="Area",cH={type:"literal",value:"Area",description:'"Area"'},cG="Slope",cF={type:"literal",value:"Slope",description:'"Slope"'},cA="Distance",cz={type:"literal",value:"Distance",description:'"Distance"'},cy="Ratio/Segments",cx={type:"literal",value:"Ratio/Segments",description:'"Ratio/Segments"'},cv="Ratio/Points",cu={type:"literal",value:"Ratio/Points",description:'"Ratio/Points"'},ct="Coordinates",cs={type:"literal",value:"Coordinates",description:'"Coordinates"'},cr="Abscissa",cq={type:"literal",value:"Abscissa",description:'"Abscissa"'},co="Ordinate",cn={type:"literal",value:"Ordinate",description:'"Ordinate"'},cm="CoordinateDistance",cl={type:"literal",value:"CoordinateDistance",description:'"CoordinateDistance"'},ck="Calculate",cj={type:"literal",value:"Calculate",description:'"Calculate"'},ci="Parameter",ch={type:"literal",value:"Parameter",description:'"Parameter"'},cg="ToggleVisibilityButton",cf={type:"literal",value:"ToggleVisibilityButton",description:'"ToggleVisibilityButton"'},cd="ShowButton",cc={type:"literal",value:"ShowButton",description:'"ShowButton"'},cb="HideButton",ca={type:"literal",value:"HideButton",description:'"HideButton"'},b9="MoveButton",b8={type:"literal",value:"MoveButton",description:'"MoveButton"'},b7="AnimateButton",b6={type:"literal",value:"AnimateButton",description:'"AnimateButton"'},b5="SimultaneousButton",b4={type:"literal",value:"SimultaneousButton",description:'"SimultaneousButton"'},b1="CoordSysByAxes",b0={type:"literal",value:"CoordSysByAxes",description:'"CoordSysByAxes"'},bZ="Origin&Unit",bY={type:"literal",value:"Origin&Unit",description:'"Origin&Unit"'},bX="UnitCircle",bW={type:"literal",value:"UnitCircle",description:'"UnitCircle"'},bV="Locus",bU={type:"literal",value:"Locus",description:'"Locus"'},bS="FunctionPlot",bQ={type:"literal",value:"FunctionPlot",description:'"FunctionPlot"'},bE="Function",bD={type:"literal",value:"Function",description:'"Function"'},bC="FixedText",bB={type:"literal",value:"FixedText",description:'"FixedText"'},bA="PeggedText",bz={type:"literal",value:"PeggedText",description:'"PeggedText"'},by="ConcatText",bw={type:"literal",value:"ConcatText",description:'"ConcatText"'},bu="red",bs={type:"literal",value:"red",description:'"red"'},bh="green",bg={type:"literal",value:"green",description:'"green"'},bf="blue",be={type:"literal",value:"blue",description:'"blue"'},bd="black",bc={type:"literal",value:"black",description:'"black"'},ba="magenta",a9={type:"literal",value:"magenta",description:'"magenta"'},a7="white",a5={type:"literal",value:"white",description:'"white"'},aU="cyan",aT={type:"literal",value:"cyan",description:'"cyan"'},aS="yellow",aR={type:"literal",value:"yellow",description:'"yellow"'},aQ="color(",aP={type:"literal",value:"color(",description:'"color("'},aN=function(fN,fM,fL){return"color("+[fN,fM,fL].join()+")"},aM="hairline",aJ={type:"literal",value:"hairline",description:'"hairline"'},aH="thin",bT={type:"literal",value:"thin",description:'"thin"'},bR="mediumLine",bP={type:"literal",value:"mediumLine",description:'"mediumLine"'},bN="thick",bM={type:"literal",value:"thick",description:'"thick"'},bK="dashed",bJ={type:"literal",value:"dashed",description:'"dashed"'},bI="dotted",bH={type:"literal",value:"dotted",description:'"dotted"'},bG="solid",bv={type:"literal",value:"solid",description:'"solid"'},bt="dot",br={type:"literal",value:"dot",description:'"dot"'},bq="small",bo={type:"literal",value:"small",description:'"small"'},bn="mediumPoint",bm={type:"literal",value:"mediumPoint",description:'"mediumPoint"'},bl="large",bk={type:"literal",value:"large",description:'"large"'},bj="hidden",a8={type:"literal",value:"hidden",description:'"hidden"'},a6="suffix(",a4={type:"literal",value:"suffix(",description:'"suffix("'},a3=function(fL){return"suffix('"+fL+"')"},a2="auto",a1={type:"literal",value:"auto",description:'"auto"'},a0="label(",aX={type:"literal",value:"label(",description:'"label("'},aW=function(fL){return"label('"+fL+"')"},aV="layer(",aK={type:"literal",value:"layer(",description:'"layer("'},aI=function(fL){return"layer("+fL+")"},aG="traced",aF={type:"literal",value:"traced",description:'"traced"'},aE="image(",aC={type:"literal",value:"image(",description:'"image("'},aB=function(fL){return"image('"+fL+"')"},aA="bold",az={type:"literal",value:"bold",description:'"bold"'},ay="italic",av={type:"literal",value:"italic",description:'"italic"'},au="plain",at={type:"literal",value:"plain",description:'"plain"'},ar="justifyLeft",aq={type:"literal",value:"justifyLeft",description:'"justifyLeft"'},ap="justifyRight",ao={type:"literal",value:"justifyRight",description:'"justifyRight"'},an="justifyCenter",am={type:"literal",value:"justifyCenter",description:'"justifyCenter"'},al="font(",aj={type:"literal",value:"font(",description:'"font("'},ai=function(fL){return"font('"+fL+"')"},ah="size(",ag={type:"literal",value:"size(",description:'"size("'},af=function(fL){return"size("+fL+")"},ad="digits(",ac={type:"literal",value:"digits(",description:'"digits("'},ab=function(fL){return"digits('"+fL+"')"},aa="medium",Y={type:"literal",value:"medium",description:'"medium"'},S="-",R={type:"literal",value:"-",description:'"-"'},Q=".",P={type:"literal",value:".",description:'"."'},O="e",N={type:"literal",value:"e",description:'"e"'},M=function(fO,fM,fP,fQ){var fN="",fL="";if(fQ){fN=fQ.join("")}if(fP){fL="."+(fP[1]?fP[1]:"")}fO=fO?fO:"";return fO+fM+fL+fN},L=function(fN,fO,fP){var fM="",fL="";if(fP){fM=fP.join("")}fL="."+fO[1];fN=fN?fN:"";return fN+fL+fM},K="'",J={type:"literal",value:"'",description:'"\'"'},fK=function(fL){return fL[1].join("")},fJ=/^[^']/,fI={type:"class",value:"[^']",description:"[^']"},fH="''",fG={type:"literal",value:"''",description:"\"''\""},fF=function(){return"&apos;"},fE=function(){return""},fD="{",fC={type:"literal",value:"{",description:'"{"'},fA=/^[^}]/,fm={type:"class",value:"[^}]",description:"[^}]"},fl="}",fk={type:"literal",value:"}",description:'"}"'},fj=" ",fi={type:"literal",value:" ",description:'" "'},fh="\t",fg={type:"literal",value:"\t",description:'"\\t"'},ff="\n",fd={type:"literal",value:"\n",description:'"\\n"'},fb=/^[0-9]/,e0={type:"class",value:"[0-9]",description:"[0-9]"},eZ=function(fL){return fL.join("")},bO=0,dY=0,fy=0,ae={line:1,column:1,seenCR:false},W=0,cD=[],cC=0,cw;if("startRule" in b3){if(!(b3.startRule in eb)){throw new Error("Can't start parsing from rule \""+b3.startRule+'".')}aw=eb[b3.startRule]}function eY(){return T.substring(dY,bO)}function cp(){return dY}function V(){return H(dY).line}function dl(){return H(dY).column}function e6(fL){throw I(null,[{type:"other",description:fL}],dY)}function dQ(fL){throw I(fL,null,dY)}function H(fM){function fL(fP,fO,fN){var fR,fQ;for(fR=fO;fR<fN;fR++){fQ=T.charAt(fR);if(fQ==="\n"){if(!fP.seenCR){fP.line++}fP.column=1;fP.seenCR=false}else{if(fQ==="\r"||fQ==="\u2028"||fQ==="\u2029"){fP.line++;fP.column=1;fP.seenCR=true}else{fP.column++;fP.seenCR=false}}}}if(fy!==fM){if(fy>fM){fy=0;ae={line:1,column:1,seenCR:false}}fL(ae,fy,fM);fy=fM}return ae}function cY(fL){if(bO<W){return}if(bO>W){W=bO;cD=[]}cD.push(fL)}function I(fN,fM,fR){function fQ(fT){var fS=1;fT.sort(function(fV,fU){if(fV.description<fU.description){return -1}else{if(fV.description>fU.description){return 1}else{return 0}}});while(fS<fT.length){if(fT[fS-1]===fT[fS]){fT.splice(fS,1)}else{fS++}}}function fL(fW,fX){function fS(fZ){function f0(f1){return f1.charCodeAt(0).toString(16).toUpperCase()}return fZ.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(f1){return"\\x0"+f0(f1)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(f1){return"\\x"+f0(f1)}).replace(/[\u0180-\u0FFF]/g,function(f1){return"\\u0"+f0(f1)}).replace(/[\u1080-\uFFFF]/g,function(f1){return"\\u"+f0(f1)})}var fT=new Array(fW.length),fY,fU,fV;for(fV=0;fV<fW.length;fV++){fT[fV]=fW[fV].description}fY=fW.length>1?fT.slice(0,-1).join(", ")+" or "+fT[fW.length-1]:fT[0];fU=fX?'"'+fS(fX)+'"':"end of input";return"Expected "+fY+" but "+fU+" found."}var fP=H(fR),fO=fR<T.length?T.charAt(fR):null;if(fM!==null){fQ(fM)}return new D(fN!==null?fN:fL(fM,fO),fM,fO,fR,fP.line,fP.column)}function fo(){var fL;fL=cB();return fL}function cB(){var fM,fL;fM=[];fL=bx();while(fL!==cR){fM.push(fL);fL=bx()}return fM}function bx(){var fT,fS,fR,fQ,fP,fO,fN,fM,fL;fT=bO;fS=dr();if(fS!==cR){fR=ez();if(fR!==cR){fQ=dr();if(fQ!==cR){fP=dz();if(fP!==cR){fO=dr();if(fO!==cR){fN=db();if(fN===cR){fN=dv}if(fN!==cR){if(T.charCodeAt(bO)===59){fM=du;bO++}else{fM=cR;if(cC===0){cY(dt)}}if(fM!==cR){fL=dr();if(fL!==cR){dY=fT;fS=ds(fR,fP,fN);fT=fS}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}return fT}function ez(){var fM,fL;fM=bO;fL=bL();if(fL===cR){fL=G();if(fL===cR){fL=cQ();if(fL===cR){fL=di();if(fL===cR){fL=eS();if(fL===cR){fL=ce();if(fL===cR){fL=X();if(fL===cR){fL=dj();if(fL===cR){fL=Z();if(fL===cR){fL=aD();if(fL===cR){fL=eK();if(fL===cR){fL=cU();if(fL===cR){fL=bF()}}}}}}}}}}}}if(fL!==cR){dY=fM;fL=dq(fL)}fM=fL;return fM}function dz(){var fM,fL;fM=[];fL=dG();if(fL!==cR){while(fL!==cR){fM.push(fL);fL=dG()}}else{fM=dx}return fM}function db(){var fV,fU,fS,fR,fQ,fP,fO,fN,fM,fL,fT;fV=bO;fU=dr();if(fU!==cR){if(T.charCodeAt(bO)===91){fS=dp;bO++}else{fS=cR;if(cC===0){cY(dn)}}if(fS!==cR){fR=dr();if(fR!==cR){fQ=cE();if(fQ!==cR){fP=[];fO=bO;fN=dr();if(fN!==cR){if(T.charCodeAt(bO)===44){fM=dm;bO++}else{fM=cR;if(cC===0){cY(fB)}}if(fM!==cR){fL=dr();if(fL!==cR){fT=cE();if(fT!==cR){fN=[fN,fM,fL,fT];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}while(fO!==cR){fP.push(fO);fO=bO;fN=dr();if(fN!==cR){if(T.charCodeAt(bO)===44){fM=dm;bO++}else{fM=cR;if(cC===0){cY(fB)}}if(fM!==cR){fL=dr();if(fL!==cR){fT=cE();if(fT!==cR){fN=[fN,fM,fL,fT];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}if(fP!==cR){if(T.charCodeAt(bO)===93){fO=fz;bO++}else{fO=cR;if(cC===0){cY(fw)}}if(fO!==cR){dY=fV;fU=fv(fQ,fP);fV=fU}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}return fV}function dG(){var fT,fS,fR,fQ,fP,fO,fN,fM,fL;fT=bO;if(T.charCodeAt(bO)===40){fS=fu;bO++}else{fS=cR;if(cC===0){cY(ft)}}if(fS!==cR){fR=dr();if(fR!==cR){if(T.charCodeAt(bO)===41){fQ=fs;bO++}else{fQ=cR;if(cC===0){cY(fr)}}if(fQ!==cR){dY=fT;fS=fq();fT=fS}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}if(fT===cR){fT=bO;if(T.charCodeAt(bO)===40){fS=fu;bO++}else{fS=cR;if(cC===0){cY(ft)}}if(fS!==cR){fR=ak();if(fR!==cR){fQ=[];fP=bO;fO=dr();if(fO!==cR){if(T.charCodeAt(bO)===44){fN=dm;bO++}else{fN=cR;if(cC===0){cY(fB)}}if(fN!==cR){fM=dr();if(fM!==cR){fL=ak();if(fL!==cR){fO=[fO,fN,fM,fL];fP=fO}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}while(fP!==cR){fQ.push(fP);fP=bO;fO=dr();if(fO!==cR){if(T.charCodeAt(bO)===44){fN=dm;bO++}else{fN=cR;if(cC===0){cY(fB)}}if(fN!==cR){fM=dr();if(fM!==cR){fL=ak();if(fL!==cR){fO=[fO,fN,fM,fL];fP=fO}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}if(fQ!==cR){if(T.charCodeAt(bO)===41){fP=fs;bO++}else{fP=cR;if(cC===0){cY(fr)}}if(fP!==cR){dY=fT;fS=fp(fR,fQ);fT=fS}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}return fT}function ak(){var fL;fL=eM();if(fL===cR){fL=bb()}return fL}function bL(){var fL;if(T.substr(bO,15)===fe){fL=fe;bO+=15}else{fL=cR;if(cC===0){cY(fc)}}if(fL===cR){if(T.substr(bO,5)===fa){fL=fa;bO+=5}else{fL=cR;if(cC===0){cY(e9)}}if(fL===cR){if(T.substr(bO,10)===e8){fL=e8;bO+=10}else{fL=cR;if(cC===0){cY(e7)}}if(fL===cR){if(T.substr(bO,8)===e5){fL=e5;bO+=8}else{fL=cR;if(cC===0){cY(e4)}}if(fL===cR){if(T.substr(bO,10)===e3){fL=e3;bO+=10}else{fL=cR;if(cC===0){cY(e2)}}if(fL===cR){if(T.substr(bO,10)===eX){fL=eX;bO+=10}else{fL=cR;if(cC===0){cY(eW)}}if(fL===cR){if(T.substr(bO,9)===eV){fL=eV;bO+=9}else{fL=cR;if(cC===0){cY(eU)}}if(fL===cR){if(T.substr(bO,6)===eT){fL=eT;bO+=6}else{fL=cR;if(cC===0){cY(eR)}}if(fL===cR){if(T.substr(bO,11)===eQ){fL=eQ;bO+=11}else{fL=cR;if(cC===0){cY(eP)}}if(fL===cR){if(T.substr(bO,9)===eO){fL=eO;bO+=9}else{fL=cR;if(cC===0){cY(eN)}}if(fL===cR){if(T.substr(bO,15)===eL){fL=eL;bO+=15}else{fL=cR;if(cC===0){cY(eJ)}}if(fL===cR){if(T.substr(bO,20)===eI){fL=eI;bO+=20}else{fL=cR;if(cC===0){cY(eH)}}if(fL===cR){if(T.substr(bO,11)===eG){fL=eG;bO+=11}else{fL=cR;if(cC===0){cY(eF)}}}}}}}}}}}}}}return fL}function G(){var fL;if(T.substr(bO,7)===eE){fL=eE;bO+=7}else{fL=cR;if(cC===0){cY(eD)}}if(fL===cR){if(T.substr(bO,3)===eC){fL=eC;bO+=3}else{fL=cR;if(cC===0){cY(eB)}}if(fL===cR){if(T.substr(bO,4)===ey){fL=ey;bO+=4}else{fL=cR;if(cC===0){cY(ex)}}if(fL===cR){if(T.substr(bO,13)===ew){fL=ew;bO+=13}else{fL=cR;if(cC===0){cY(ev)}}if(fL===cR){if(T.substr(bO,8)===eu){fL=eu;bO+=8}else{fL=cR;if(cC===0){cY(et)}}if(fL===cR){if(T.substr(bO,5)===es){fL=es;bO+=5}else{fL=cR;if(cC===0){cY(er)}}if(fL===cR){if(T.substr(bO,5)===eq){fL=eq;bO+=5}else{fL=cR;if(cC===0){cY(ep)}}if(fL===cR){if(T.substr(bO,8)===en){fL=en;bO+=8}else{fL=cR;if(cC===0){cY(el)}}if(fL===cR){if(T.substr(bO,14)===ek){fL=ek;bO+=14}else{fL=cR;if(cC===0){cY(ej)}}if(fL===cR){if(T.substr(bO,12)===ei){fL=ei;bO+=12}else{fL=cR;if(cC===0){cY(eh)}}}}}}}}}}}return fL}function cQ(){var fL;if(T.substr(bO,7)===ef){fL=ef;bO+=7}else{fL=cR;if(cC===0){cY(ee)}}if(fL===cR){if(T.substr(bO,15)===ed){fL=ed;bO+=15}else{fL=cR;if(cC===0){cY(ec)}}}return fL}function di(){var fL;if(T.substr(bO,16)===ea){fL=ea;bO+=16}else{fL=cR;if(cC===0){cY(d9)}}if(fL===cR){if(T.substr(bO,6)===d8){fL=d8;bO+=6}else{fL=cR;if(cC===0){cY(d7)}}}return fL}function eS(){var fL;if(T.substr(bO,10)===d6){fL=d6;bO+=10}else{fL=cR;if(cC===0){cY(d5)}}if(fL===cR){if(T.substr(bO,21)===d4){fL=d4;bO+=21}else{fL=cR;if(cC===0){cY(d3)}}if(fL===cR){if(T.substr(bO,17)===d2){fL=d2;bO+=17}else{fL=cR;if(cC===0){cY(d1)}}if(fL===cR){if(T.substr(bO,20)===dZ){fL=dZ;bO+=20}else{fL=cR;if(cC===0){cY(dX)}}if(fL===cR){if(T.substr(bO,8)===dV){fL=dV;bO+=8}else{fL=cR;if(cC===0){cY(dU)}}if(fL===cR){if(T.substr(bO,20)===dT){fL=dT;bO+=20}else{fL=cR;if(cC===0){cY(dS)}}if(fL===cR){if(T.substr(bO,22)===dR){fL=dR;bO+=22}else{fL=cR;if(cC===0){cY(dP)}}if(fL===cR){if(T.substr(bO,8)===dO){fL=dO;bO+=8}else{fL=cR;if(cC===0){cY(dN)}}if(fL===cR){if(T.substr(bO,17)===dK){fL=dK;bO+=17}else{fL=cR;if(cC===0){cY(dJ)}}if(fL===cR){if(T.substr(bO,37)===dI){fL=dI;bO+=37}else{fL=cR;if(cC===0){cY(dH)}}if(fL===cR){if(T.substr(bO,16)===dF){fL=dF;bO+=16}else{fL=cR;if(cC===0){cY(dE)}}if(fL===cR){if(T.substr(bO,37)===dD){fL=dD;bO+=37}else{fL=cR;if(cC===0){cY(dC)}}if(fL===cR){if(T.substr(bO,38)===dB){fL=dB;bO+=38}else{fL=cR;if(cC===0){cY(dA)}}if(fL===cR){if(T.substr(bO,11)===dh){fL=dh;bO+=11}else{fL=cR;if(cC===0){cY(dg)}}}}}}}}}}}}}}}return fL}function ce(){var fL;if(T.substr(bO,18)===df){fL=df;bO+=18}else{fL=cR;if(cC===0){cY(de)}}if(fL===cR){if(T.substr(bO,19)===dd){fL=dd;bO+=19}else{fL=cR;if(cC===0){cY(dc)}}if(fL===cR){if(T.substr(bO,13)===da){fL=da;bO+=13}else{fL=cR;if(cC===0){cY(c9)}}if(fL===cR){if(T.substr(bO,13)===c8){fL=c8;bO+=13}else{fL=cR;if(cC===0){cY(c7)}}}}}return fL}function X(){var fL;if(T.substr(bO,5)===c6){fL=c6;bO+=5}else{fL=cR;if(cC===0){cY(c5)}}if(fL===cR){if(T.substr(bO,12)===c4){fL=c4;bO+=12}else{fL=cR;if(cC===0){cY(c0)}}if(fL===cR){if(T.substr(bO,18)===cZ){fL=cZ;bO+=18}else{fL=cR;if(cC===0){cY(cX)}}}}return fL}function dj(){var fL;if(T.substr(bO,6)===cW){fL=cW;bO+=6}else{fL=cR;if(cC===0){cY(cV)}}if(fL===cR){if(T.substr(bO,5)===cT){fL=cT;bO+=5}else{fL=cR;if(cC===0){cY(cS)}}if(fL===cR){if(T.substr(bO,9)===cP){fL=cP;bO+=9}else{fL=cR;if(cC===0){cY(cO)}}if(fL===cR){if(T.substr(bO,13)===cN){fL=cN;bO+=13}else{fL=cR;if(cC===0){cY(cM)}}if(fL===cR){if(T.substr(bO,6)===cK){fL=cK;bO+=6}else{fL=cR;if(cC===0){cY(cJ)}}if(fL===cR){if(T.substr(bO,4)===cI){fL=cI;bO+=4}else{fL=cR;if(cC===0){cY(cH)}}if(fL===cR){if(T.substr(bO,5)===cG){fL=cG;bO+=5}else{fL=cR;if(cC===0){cY(cF)}}if(fL===cR){if(T.substr(bO,8)===cA){fL=cA;bO+=8}else{fL=cR;if(cC===0){cY(cz)}}if(fL===cR){if(T.substr(bO,14)===cy){fL=cy;bO+=14}else{fL=cR;if(cC===0){cY(cx)}}if(fL===cR){if(T.substr(bO,12)===cv){fL=cv;bO+=12}else{fL=cR;if(cC===0){cY(cu)}}if(fL===cR){if(T.substr(bO,11)===ct){fL=ct;bO+=11}else{fL=cR;if(cC===0){cY(cs)}}if(fL===cR){if(T.substr(bO,8)===cr){fL=cr;bO+=8}else{fL=cR;if(cC===0){cY(cq)}}if(fL===cR){if(T.substr(bO,8)===co){fL=co;bO+=8}else{fL=cR;if(cC===0){cY(cn)}}if(fL===cR){if(T.substr(bO,18)===cm){fL=cm;bO+=18}else{fL=cR;if(cC===0){cY(cl)}}if(fL===cR){if(T.substr(bO,9)===ck){fL=ck;bO+=9}else{fL=cR;if(cC===0){cY(cj)}}if(fL===cR){if(T.substr(bO,9)===ci){fL=ci;bO+=9}else{fL=cR;if(cC===0){cY(ch)}}}}}}}}}}}}}}}}}return fL}function Z(){var fL;if(T.substr(bO,22)===cg){fL=cg;bO+=22}else{fL=cR;if(cC===0){cY(cf)}}if(fL===cR){if(T.substr(bO,10)===cd){fL=cd;bO+=10}else{fL=cR;if(cC===0){cY(cc)}}if(fL===cR){if(T.substr(bO,10)===cb){fL=cb;bO+=10}else{fL=cR;if(cC===0){cY(ca)}}if(fL===cR){if(T.substr(bO,10)===b9){fL=b9;bO+=10}else{fL=cR;if(cC===0){cY(b8)}}if(fL===cR){if(T.substr(bO,13)===b7){fL=b7;bO+=13}else{fL=cR;if(cC===0){cY(b6)}}if(fL===cR){if(T.substr(bO,18)===b5){fL=b5;bO+=18}else{fL=cR;if(cC===0){cY(b4)}}}}}}}return fL}function aD(){var fL;if(T.substr(bO,14)===b1){fL=b1;bO+=14}else{fL=cR;if(cC===0){cY(b0)}}if(fL===cR){if(T.substr(bO,11)===bZ){fL=bZ;bO+=11}else{fL=cR;if(cC===0){cY(bY)}}if(fL===cR){if(T.substr(bO,10)===bX){fL=bX;bO+=10}else{fL=cR;if(cC===0){cY(bW)}}}}return fL}function eK(){var fL;if(T.substr(bO,5)===bV){fL=bV;bO+=5}else{fL=cR;if(cC===0){cY(bU)}}if(fL===cR){if(T.substr(bO,12)===bS){fL=bS;bO+=12}else{fL=cR;if(cC===0){cY(bQ)}}}return fL}function cU(){var fL;if(T.substr(bO,8)===bE){fL=bE;bO+=8}else{fL=cR;if(cC===0){cY(bD)}}return fL}function bF(){var fL;if(T.substr(bO,9)===bC){fL=bC;bO+=9}else{fL=cR;if(cC===0){cY(bB)}}if(fL===cR){if(T.substr(bO,10)===bA){fL=bA;bO+=10}else{fL=cR;if(cC===0){cY(bz)}}if(fL===cR){if(T.substr(bO,10)===by){fL=by;bO+=10}else{fL=cR;if(cC===0){cY(bw)}}}}return fL}function cE(){var fL;fL=bp();if(fL===cR){fL=fn();if(fL===cR){fL=ax();if(fL===cR){fL=fx();if(fL===cR){fL=dW();if(fL===cR){fL=aO();if(fL===cR){fL=dL();if(fL===cR){fL=eg();if(fL===cR){fL=eA();if(fL===cR){fL=dM();if(fL===cR){fL=aZ();if(fL===cR){fL=cL();if(fL===cR){fL=U();if(fL===cR){fL=eo()}}}}}}}}}}}}}return fL}function bp(){var fL;if(T.substr(bO,3)===bu){fL=bu;bO+=3}else{fL=cR;if(cC===0){cY(bs)}}if(fL===cR){if(T.substr(bO,5)===bh){fL=bh;bO+=5}else{fL=cR;if(cC===0){cY(bg)}}if(fL===cR){if(T.substr(bO,4)===bf){fL=bf;bO+=4}else{fL=cR;if(cC===0){cY(be)}}if(fL===cR){if(T.substr(bO,5)===bd){fL=bd;bO+=5}else{fL=cR;if(cC===0){cY(bc)}}if(fL===cR){if(T.substr(bO,7)===ba){fL=ba;bO+=7}else{fL=cR;if(cC===0){cY(a9)}}if(fL===cR){if(T.substr(bO,5)===a7){fL=a7;bO+=5}else{fL=cR;if(cC===0){cY(a5)}}if(fL===cR){if(T.substr(bO,4)===aU){fL=aU;bO+=4}else{fL=cR;if(cC===0){cY(aT)}}if(fL===cR){if(T.substr(bO,6)===aS){fL=aS;bO+=6}else{fL=cR;if(cC===0){cY(aR)}}}}}}}}}return fL}function fn(){var fY,fX,fV,fT,fR,fP,fO,fN,fM,fL,fW,fU,fS,fQ;fY=bO;if(T.substr(bO,6)===aQ){fX=aQ;bO+=6}else{fX=cR;if(cC===0){cY(aP)}}if(fX!==cR){fV=dr();if(fV!==cR){fT=eM();if(fT!==cR){fR=dr();if(fR!==cR){if(T.charCodeAt(bO)===44){fP=dm;bO++}else{fP=cR;if(cC===0){cY(fB)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=eM();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===44){fL=dm;bO++}else{fL=cR;if(cC===0){cY(fB)}}if(fL!==cR){fW=dr();if(fW!==cR){fU=eM();if(fU!==cR){fS=dr();if(fS!==cR){if(T.charCodeAt(bO)===41){fQ=fs;bO++}else{fQ=cR;if(cC===0){cY(fr)}}if(fQ!==cR){dY=fY;fX=aN(fT,fN,fU);fY=fX}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}return fY}function ax(){var fL;if(T.substr(bO,8)===aM){fL=aM;bO+=8}else{fL=cR;if(cC===0){cY(aJ)}}if(fL===cR){if(T.substr(bO,4)===aH){fL=aH;bO+=4}else{fL=cR;if(cC===0){cY(bT)}}if(fL===cR){if(T.substr(bO,10)===bR){fL=bR;bO+=10}else{fL=cR;if(cC===0){cY(bP)}}if(fL===cR){if(T.substr(bO,5)===bN){fL=bN;bO+=5}else{fL=cR;if(cC===0){cY(bM)}}if(fL===cR){if(T.substr(bO,6)===bK){fL=bK;bO+=6}else{fL=cR;if(cC===0){cY(bJ)}}if(fL===cR){if(T.substr(bO,6)===bI){fL=bI;bO+=6}else{fL=cR;if(cC===0){cY(bH)}}if(fL===cR){if(T.substr(bO,5)===bG){fL=bG;bO+=5}else{fL=cR;if(cC===0){cY(bv)}}}}}}}}return fL}function fx(){var fL;if(T.substr(bO,3)===bt){fL=bt;bO+=3}else{fL=cR;if(cC===0){cY(br)}}if(fL===cR){if(T.substr(bO,5)===bq){fL=bq;bO+=5}else{fL=cR;if(cC===0){cY(bo)}}if(fL===cR){if(T.substr(bO,11)===bn){fL=bn;bO+=11}else{fL=cR;if(cC===0){cY(bm)}}if(fL===cR){if(T.substr(bO,5)===bl){fL=bl;bO+=5}else{fL=cR;if(cC===0){cY(bk)}}}}}return fL}function dW(){var fL;if(T.substr(bO,6)===bj){fL=bj;bO+=6}else{fL=cR;if(cC===0){cY(a8)}}return fL}function aO(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,7)===a6){fP=a6;bO+=7}else{fP=cR;if(cC===0){cY(a4)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=a3(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function dL(){var fL;if(T.substr(bO,4)===a2){fL=a2;bO+=4}else{fL=cR;if(cC===0){cY(a1)}}return fL}function eg(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,6)===a0){fP=a0;bO+=6}else{fP=cR;if(cC===0){cY(aX)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=aW(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function eA(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,6)===aV){fP=aV;bO+=6}else{fP=cR;if(cC===0){cY(aK)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=em();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=aI(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function dM(){var fL;if(T.substr(bO,6)===aG){fL=aG;bO+=6}else{fL=cR;if(cC===0){cY(aF)}}return fL}function aZ(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,6)===aE){fP=aE;bO+=6}else{fP=cR;if(cC===0){cY(aC)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=aB(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function cL(){var fL;if(T.substr(bO,4)===aA){fL=aA;bO+=4}else{fL=cR;if(cC===0){cY(az)}}if(fL===cR){if(T.substr(bO,6)===ay){fL=ay;bO+=6}else{fL=cR;if(cC===0){cY(av)}}if(fL===cR){if(T.substr(bO,5)===au){fL=au;bO+=5}else{fL=cR;if(cC===0){cY(at)}}if(fL===cR){fL=bi();if(fL===cR){fL=e1();if(fL===cR){if(T.substr(bO,11)===ar){fL=ar;bO+=11}else{fL=cR;if(cC===0){cY(aq)}}if(fL===cR){if(T.substr(bO,12)===ap){fL=ap;bO+=12}else{fL=cR;if(cC===0){cY(ao)}}if(fL===cR){if(T.substr(bO,13)===an){fL=an;bO+=13}else{fL=cR;if(cC===0){cY(am)}}}}}}}}}return fL}function e1(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,5)===al){fP=al;bO+=5}else{fP=cR;if(cC===0){cY(aj)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=ai(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function bi(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,5)===ah){fP=ah;bO+=5}else{fP=cR;if(cC===0){cY(ag)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=eM();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=af(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function U(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,7)===ad){fP=ad;bO+=7}else{fP=cR;if(cC===0){cY(ac)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=eM();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=ab(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function eo(){var fL;if(T.substr(bO,6)===aa){fL=aa;bO+=6}else{fL=cR;if(cC===0){cY(Y)}}return fL}function eM(){var fL;fL=aY();if(fL===cR){fL=b2()}return fL}function aY(){var fQ,fP,fO,fN,fM,fL,fS,fR;fQ=bO;if(T.charCodeAt(bO)===45){fP=S;bO++}else{fP=cR;if(cC===0){cY(R)}}if(fP===cR){fP=dv}if(fP!==cR){fO=em();if(fO!==cR){fN=bO;if(T.charCodeAt(bO)===46){fM=Q;bO++}else{fM=cR;if(cC===0){cY(P)}}if(fM!==cR){fL=em();if(fL===cR){fL=dv}if(fL!==cR){fM=[fM,fL];fN=fM}else{bO=fN;fN=dx}}else{bO=fN;fN=dx}if(fN===cR){fN=dv}if(fN!==cR){fM=bO;if(T.charCodeAt(bO)===101){fL=O;bO++}else{fL=cR;if(cC===0){cY(N)}}if(fL!==cR){if(T.charCodeAt(bO)===45){fS=S;bO++}else{fS=cR;if(cC===0){cY(R)}}if(fS===cR){fS=dv}if(fS!==cR){fR=em();if(fR!==cR){fL=[fL,fS,fR];fM=fL}else{bO=fM;fM=dx}}else{bO=fM;fM=dx}}else{bO=fM;fM=dx}if(fM===cR){fM=dv}if(fM!==cR){dY=fQ;fP=M(fP,fO,fN,fM);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function b2(){var fQ,fP,fO,fN,fM,fL,fR;fQ=bO;if(T.charCodeAt(bO)===45){fP=S;bO++}else{fP=cR;if(cC===0){cY(R)}}if(fP===cR){fP=dv}if(fP!==cR){fO=bO;if(T.charCodeAt(bO)===46){fN=Q;bO++}else{fN=cR;if(cC===0){cY(P)}}if(fN!==cR){fM=em();if(fM!==cR){fN=[fN,fM];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}if(fO!==cR){fN=bO;if(T.charCodeAt(bO)===101){fM=O;bO++}else{fM=cR;if(cC===0){cY(N)}}if(fM!==cR){if(T.charCodeAt(bO)===45){fL=S;bO++}else{fL=cR;if(cC===0){cY(R)}}if(fL===cR){fL=dv}if(fL!==cR){fR=em();if(fR!==cR){fM=[fM,fL,fR];fN=fM}else{bO=fN;fN=dx}}else{bO=fN;fN=dx}}else{bO=fN;fN=dx}if(fN===cR){fN=dv}if(fN!==cR){dY=fQ;fP=L(fP,fO,fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function bb(){var fP,fO,fN,fM,fL;fP=bO;fO=bO;if(T.charCodeAt(bO)===39){fN=K;bO++}else{fN=cR;if(cC===0){cY(J)}}if(fN!==cR){fM=[];fL=dk();while(fL!==cR){fM.push(fL);fL=dk()}if(fM!==cR){if(T.charCodeAt(bO)===39){fL=K;bO++}else{fL=cR;if(cC===0){cY(J)}}if(fL!==cR){fN=[fN,fM,fL];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}if(fO!==cR){dY=fP;fO=fK(fO)}fP=fO;return fP}function dk(){var fM,fL;if(fJ.test(T.charAt(bO))){fM=T.charAt(bO);bO++}else{fM=cR;if(cC===0){cY(fI)}}if(fM===cR){fM=bO;if(T.substr(bO,2)===fH){fL=fH;bO+=2}else{fL=cR;if(cC===0){cY(fG)}}if(fL!==cR){dY=fM;fL=fF()}fM=fL}return fM}function dr(){var fN,fM,fL;fN=bO;fM=[];fL=aL();if(fL===cR){fL=d0()}while(fL!==cR){fM.push(fL);fL=aL();if(fL===cR){fL=d0()}}if(fM!==cR){dY=fN;fM=fE()}fN=fM;return fN}function aL(){var fO,fN,fM,fL;fO=bO;if(T.charCodeAt(bO)===123){fN=fD;bO++}else{fN=cR;if(cC===0){cY(fC)}}if(fN!==cR){fM=[];if(fA.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(fm)}}while(fL!==cR){fM.push(fL);if(fA.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(fm)}}}if(fM!==cR){if(T.charCodeAt(bO)===125){fL=fl;bO++}else{fL=cR;if(cC===0){cY(fk)}}if(fL!==cR){fN=[fN,fM,fL];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}return fO}function d0(){var fL;if(T.charCodeAt(bO)===32){fL=fj;bO++}else{fL=cR;if(cC===0){cY(fi)}}if(fL===cR){if(T.charCodeAt(bO)===9){fL=fh;bO++}else{fL=cR;if(cC===0){cY(fg)}}if(fL===cR){if(T.charCodeAt(bO)===10){fL=ff;bO++}else{fL=cR;if(cC===0){cY(fd)}}}}return fL}function em(){var fN,fM,fL;fN=bO;fM=[];if(fb.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(e0)}}if(fL!==cR){while(fL!==cR){fM.push(fL);if(fb.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(e0)}}}}else{fM=dx}if(fM!==cR){dY=fN;fM=eZ(fM)}fN=fM;return fN}var dw=0;cw=aw();if(cw!==cR&&bO===T.length){return cw}else{if(cw!==cR&&bO<T.length){cY({type:"end",description:"end of input"})}throw I(null,cD,W)}}return{SyntaxError:D,parse:E}})();y.mfsParser=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(a2){var bH=arguments.length>1?arguments[1]:{},au={},H={start:b6},bD=b6,ap=function(cm){return cm},an=au,am="<|",al={type:"literal",value:"<|",description:'"<|"'},aj=[],ai=">",ah={type:"literal",value:">",description:'">"'},ag=function(cm){return{type:"abs",value:cm}},af="<[",ae={type:"literal",value:"<[",description:'"<["'},b3=function(cm){return{type:"bracket",value:cm}},b1="<{",b0={type:"literal",value:"<{",description:'"<{"'},bZ=function(cm){return{type:"curly",value:cm}},bY="</",bX={type:"literal",value:"</",description:'"</"'},bW=function(cn,cm){return{type:"fraction",value:[cn,cm]}},bV="<H",bU={type:"literal",value:"<H",description:'"<H"'},bT=function(cm){return{type:"horizontal",value:cm}},bQ="<%",bP={type:"literal",value:"<%",description:'"<%"'},bO=/^[a-zA-Z0-9_\-]/,bN={type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},bM=function(cm){return{type:"parameter",value:cm.join("")}},bL="<I",bK={type:"literal",value:"<I",description:'"<I"'},bJ=function(cm){return{type:"input",value:cm.join("")}},bI="<(",bG={type:"literal",value:"<(",description:'"<("'},bE=function(cm){return{type:"paren",value:cm}},bC="<R",bB={type:"literal",value:"<R",description:'"<R"'},bA=function(cm){return{type:"root",value:cm}},bz="<S",by={type:"literal",value:"<S",description:'"<S"'},bx=function(cn,cm){if(cn){cn.push(cm)}return{type:"style",value:cn}},bw=/^[GLPRSTUW#+]/,bv={type:"class",value:"[GLPRSTUW#+]",description:"[GLPRSTUW#+]"},bu=/^[0-9a-fA-F]/,br={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},bq=function(cn,cm){var co={G:"green",L:"blue",P:"fontFamily",R:"red",S:"fontStyle",T:"tightness",U:"underbar",W:"fontWeight","#":"fontSize","+":"diminish-size"};if(!cm||cm.length===0){return{code:co[cn],value:"0"}}else{return{code:co[cn],value:cm.length===1?cm[0]:cm.join("")}}},bp="<-",bo={type:"literal",value:"<-",description:'"<-"'},bn=function(cn,cm){return{type:"sub",value:[cn,cm]}},bm="<+",bl={type:"literal",value:"<+",description:'"<+"'},bk=function(cn,cm){return{type:"super",value:[cn,cm]}},bj="<!",bi={type:"literal",value:"<!",description:'"<!"'},be=/^[0-9A-Fa-f]/,bd={type:"class",value:"[0-9A-Fa-f]",description:"[0-9A-Fa-f]"},bc=function(cm){return{type:"symbol",value:cm.join("")}},ba="<?",a8={type:"literal",value:"<?",description:'"<?"'},a7="x",a6={type:"literal",value:"x",description:'"x"'},a5=function(cn,cm,co){return{type:"switch",visibleNode:parseInt(cn,16),value:co,refCon:cm.join("")}},a4="<T''>",a3={type:"literal",value:"<T''>",description:"\"<T''>\""},aX=function(){return{type:"text",value:""}},aW='<T"">',aV={type:"literal",value:'<T"">',description:'"<T\\"\\">"'},aU="<T'",aS={type:"literal",value:"<T'",description:'"<T\'"'},aR="'>",aQ={type:"literal",value:"'>",description:'"\'>"'},aP=function(cm){return{type:"text",value:cm}},aN='<T"',aM={type:"literal",value:'<T"',description:'"<T\\""'},aJ='">',aI={type:"literal",value:'">',description:'"\\">"'},aH=function(cm){return cm.join("")},aG=/^[^'\\]/,aF={type:"class",value:"[^'\\\\]",description:"[^'\\\\]"},aE="\\\\",aD={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},aC=function(){return"\\"},aB="\\'",aA={type:"literal",value:"\\'",description:'"\\\\\'"'},ad=function(){return"'"},ac='\\"',ab={type:"literal",value:'\\"',description:'"\\\\\\""'},aa=function(){return'"'},Z=/^[^"\\]/,Y={type:"class",value:'[^"\\\\]',description:'[^"\\\\]'},X="<V",W={type:"literal",value:"<V",description:'"<V"'},V=null,U="L",T={type:"literal",value:"L",description:'"L"'},S="R",R={type:"literal",value:"R",description:'"R"'},Q="C",P={type:"literal",value:"C",description:'"C"'},O=function(cn,cm){return{type:"vertical",alignment:cn,value:cm}},L="<0>",K={type:"literal",value:"<0>",description:'"<0>"'},J=function(){return{type:"text",value:""}},I="<F",az={type:"literal",value:"<F",description:'"<F"'},ay=/^[^>]/,ax={type:"class",value:"[^>]",description:"[^>]"},aw=function(cm){return{type:"future",value:cm.join("")}},av="<O",at={type:"literal",value:"<O",description:'"<O"'},ar=function(cm,cn){return{type:"overbar",variant:parseInt(cm.join(""),16),value:cn}},bf=0,cl=0,b8=0,ak={line:1,column:1,seenCR:false},aK=0,aL=[],b5=0,a0;if("startRule" in bH){if(!(bH.startRule in H)){throw new Error("Can't start parsing from rule \""+bH.startRule+'".')}bD=H[bH.startRule]}function bR(){return a2.substring(cl,bf)}function cf(){return cl}function b2(){return N(cl).line}function cg(){return N(cl).column}function ck(cm){throw cd(null,[{type:"other",description:cm}],cl)}function cc(cm){throw cd(cm,null,cl)}function N(cn){function cm(cq,cp,co){var cs,cr;for(cs=cp;cs<co;cs++){cr=a2.charAt(cs);if(cr==="\n"){if(!cq.seenCR){cq.line++}cq.column=1;cq.seenCR=false}else{if(cr==="\r"||cr==="\u2028"||cr==="\u2029"){cq.line++;cq.column=1;cq.seenCR=true}else{cq.column++;cq.seenCR=false}}}}if(b8!==cn){if(b8>cn){b8=0;ak={line:1,column:1,seenCR:false}}cm(ak,b8,cn);b8=cn}return ak}function bS(cm){if(bf<aK){return}if(bf>aK){aK=bf;aL=[]}aL.push(cm)}function cd(co,cn,cs){function cr(cu){var ct=1;cu.sort(function(cw,cv){if(cw.description<cv.description){return -1}else{if(cw.description>cv.description){return 1}else{return 0}}});while(ct<cu.length){if(cu[ct-1]===cu[ct]){cu.splice(ct,1)}else{ct++}}}function cm(cx,cy){function ct(cA){function cB(cC){return cC.charCodeAt(0).toString(16).toUpperCase()}return cA.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(cC){return"\\x0"+cB(cC)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(cC){return"\\x"+cB(cC)}).replace(/[\u0180-\u0FFF]/g,function(cC){return"\\u0"+cB(cC)}).replace(/[\u1080-\uFFFF]/g,function(cC){return"\\u"+cB(cC)})}var cu=new Array(cx.length),cz,cv,cw;for(cw=0;cw<cx.length;cw++){cu[cw]=cx[cw].description}cz=cx.length>1?cu.slice(0,-1).join(", ")+" or "+cu[cx.length-1]:cu[0];cv=cy?'"'+ct(cy)+'"':"end of input";return"Expected "+cz+" but "+cv+" found."}var cq=N(cs),cp=cs<a2.length?a2.charAt(cs):null;if(cn!==null){cr(cn)}return new D(co!==null?co:cm(cn,cp),cn,cp,cs,cq.line,cq.column)}function b6(){var cn,cm;cn=bf;cm=aT();if(cm!==au){cl=cn;cm=ap(cm)}cn=cm;return cn}function aT(){var cm;cm=bF();if(cm===au){cm=ce();if(cm===au){cm=M();if(cm===au){cm=aq();if(cm===au){cm=a9();if(cm===au){cm=cj();if(cm===au){cm=bh();if(cm===au){cm=cb();if(cm===au){cm=G();if(cm===au){cm=bt();if(cm===au){cm=aO();if(cm===au){cm=ch();if(cm===au){cm=ca();if(cm===au){cm=bb();if(cm===au){cm=b9();if(cm===au){cm=a1();if(cm===au){cm=ci();if(cm===au){cm=aZ();if(cm===au){cm=aY()}}}}}}}}}}}}}}}}}}return cm}function cb(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===am){co=am;bf+=2}else{co=au;if(b5===0){bS(al)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=ag(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function bt(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===af){co=af;bf+=2}else{co=au;if(b5===0){bS(ae)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=b3(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function aO(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===b1){co=b1;bf+=2}else{co=au;if(b5===0){bS(b0)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bZ(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function ch(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bY){cp=bY;bf+=2}else{cp=au;if(b5===0){bS(bX)}}if(cp!==au){co=aT();if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bW(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function ce(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bV){co=bV;bf+=2}else{co=au;if(b5===0){bS(bU)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bT(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function bh(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bQ){co=bQ;bf+=2}else{co=au;if(b5===0){bS(bP)}}if(co!==au){cn=[];if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}while(cm!==au){cn.push(cm);if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bM(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function bb(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bL){co=bL;bf+=2}else{co=au;if(b5===0){bS(bK)}}if(co!==au){cn=[];if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}while(cm!==au){cn.push(cm);if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bJ(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function cj(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bI){co=bI;bf+=2}else{co=au;if(b5===0){bS(bG)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bE(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function b9(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bC){co=bC;bf+=2}else{co=au;if(b5===0){bS(bB)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bA(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function M(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bz){cp=bz;bf+=2}else{cp=au;if(b5===0){bS(by)}}if(cp!==au){co=[];cn=ao();while(cn!==au){co.push(cn);cn=ao()}if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bx(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function ao(){var cp,co,cn,cm;cp=bf;if(bw.test(a2.charAt(bf))){co=a2.charAt(bf);bf++}else{co=au;if(b5===0){bS(bv)}}if(co!==au){cn=[];if(bu.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(br)}}while(cm!==au){cn.push(cm);if(bu.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(br)}}}if(cn!==au){cl=cp;co=bq(co,cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function aq(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bp){cp=bp;bf+=2}else{cp=au;if(b5===0){bS(bo)}}if(cp!==au){co=aT();if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bn(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function a9(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bm){cp=bm;bf+=2}else{cp=au;if(b5===0){bS(bl)}}if(cp!==au){co=aT();if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bk(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function a1(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bj){co=bj;bf+=2}else{co=au;if(b5===0){bS(bi)}}if(co!==au){cn=[];if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}if(cm!==au){while(cm!==au){cn.push(cm);if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}}}else{cn=an}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bc(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function ci(){var cr,cq,cp,co,cn,cm,cs;cr=bf;if(a2.substr(bf,2)===ba){cq=ba;bf+=2}else{cq=au;if(b5===0){bS(a8)}}if(cq!==au){cp=[];if(be.test(a2.charAt(bf))){co=a2.charAt(bf);bf++}else{co=au;if(b5===0){bS(bd)}}while(co!==au){cp.push(co);if(be.test(a2.charAt(bf))){co=a2.charAt(bf);bf++}else{co=au;if(b5===0){bS(bd)}}}if(cp!==au){if(a2.charCodeAt(bf)===120){co=a7;bf++}else{co=au;if(b5===0){bS(a6)}}if(co!==au){cn=[];if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}while(cm!==au){cn.push(cm);if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}}if(cn!==au){cm=[];cs=aT();while(cs!==au){cm.push(cs);cs=aT()}if(cm!==au){if(a2.charCodeAt(bf)===62){cs=ai;bf++}else{cs=au;if(b5===0){bS(ah)}}if(cs!==au){cl=cr;cq=a5(cp,cn,cm);cr=cq}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}return cr}function bF(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,5)===a4){co=a4;bf+=5}else{co=au;if(b5===0){bS(a3)}}if(co!==au){cl=cp;co=aX()}cp=co;if(cp===au){cp=bf;if(a2.substr(bf,5)===aW){co=aW;bf+=5}else{co=au;if(b5===0){bS(aV)}}if(co!==au){cl=cp;co=aX()}cp=co;if(cp===au){cp=bf;if(a2.substr(bf,3)===aU){co=aU;bf+=3}else{co=au;if(b5===0){bS(aS)}}if(co!==au){cn=bg();if(cn!==au){if(a2.substr(bf,2)===aR){cm=aR;bf+=2}else{cm=au;if(b5===0){bS(aQ)}}if(cm!==au){cl=cp;co=aP(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}if(cp===au){cp=bf;if(a2.substr(bf,3)===aN){co=aN;bf+=3}else{co=au;if(b5===0){bS(aM)}}if(co!==au){cn=b7();if(cn!==au){if(a2.substr(bf,2)===aJ){cm=aJ;bf+=2}else{cm=au;if(b5===0){bS(aI)}}if(cm!==au){cl=cp;co=aP(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}}}}return cp}function bg(){var co,cn,cm;co=bf;cn=[];cm=bs();if(cm!==au){while(cm!==au){cn.push(cm);cm=bs()}}else{cn=an}if(cn!==au){cl=co;cn=aH(cn)}co=cn;return co}function bs(){var cn,cm;if(aG.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(aF)}}if(cn===au){cn=bf;if(a2.substr(bf,2)===aE){cm=aE;bf+=2}else{cm=au;if(b5===0){bS(aD)}}if(cm!==au){cl=cn;cm=aC()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===aB){cm=aB;bf+=2}else{cm=au;if(b5===0){bS(aA)}}if(cm!==au){cl=cn;cm=ad()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===ac){cm=ac;bf+=2}else{cm=au;if(b5===0){bS(ab)}}if(cm!==au){cl=cn;cm=aa()}cn=cm}}}return cn}function b7(){var co,cn,cm;co=bf;cn=[];cm=b4();if(cm!==au){while(cm!==au){cn.push(cm);cm=b4()}}else{cn=an}if(cn!==au){cl=co;cn=aH(cn)}co=cn;return co}function b4(){var cn,cm;if(Z.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(Y)}}if(cn===au){cn=bf;if(a2.substr(bf,2)===aE){cm=aE;bf+=2}else{cm=au;if(b5===0){bS(aD)}}if(cm!==au){cl=cn;cm=aC()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===ac){cm=ac;bf+=2}else{cm=au;if(b5===0){bS(ab)}}if(cm!==au){cl=cn;cm=aa()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===aB){cm=aB;bf+=2}else{cm=au;if(b5===0){bS(aA)}}if(cm!==au){cl=cn;cm=ad()}cn=cm}}}return cn}function aZ(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===X){cp=X;bf+=2}else{cp=au;if(b5===0){bS(W)}}if(cp!==au){if(a2.charCodeAt(bf)===76){co=U;bf++}else{co=au;if(b5===0){bS(T)}}if(co===au){if(a2.charCodeAt(bf)===82){co=S;bf++}else{co=au;if(b5===0){bS(R)}}if(co===au){if(a2.charCodeAt(bf)===67){co=Q;bf++}else{co=au;if(b5===0){bS(P)}}}}if(co===au){co=V}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=O(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function G(){var cn,cm;cn=bf;if(a2.substr(bf,3)===L){cm=L;bf+=3}else{cm=au;if(b5===0){bS(K)}}if(cm!==au){cl=cn;cm=J()}cn=cm;return cn}function ca(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===I){co=I;bf+=2}else{co=au;if(b5===0){bS(az)}}if(co!==au){cn=[];if(ay.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(ax)}}while(cm!==au){cn.push(cm);if(ay.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(ax)}}}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=aw(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function aY(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===av){cp=av;bf+=2}else{cp=au;if(b5===0){bS(at)}}if(cp!==au){co=[];if(be.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(bd)}}if(cn!==au){while(cn!==au){co.push(cn);if(be.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(bd)}}}}else{co=an}if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=ar(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}a0=bD();if(a0!==au&&bf===a2.length){return a0}else{if(a0!==au&&bf<a2.length){bS({type:"end",description:"end of input"})}throw cd(null,aL,aK)}}return{SyntaxError:D,parse:E}})();y.squerySelector=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(a9){var ao=arguments.length>1?arguments[1]:{},a0={},R={start:M},aP=M,aK=a0,aI=[],aG=",",aE={type:"literal",value:",",description:'","'},aC=function(bj,bh){var bi=[],bg;if(bj){bi.push(bj)}for(bg=0;bg<bh.length;bg+=1){bi.push(bh[bg][1])}return bi},aA=null,ay=function(bi,bh){var bg={type:"selectorAnd"},bj=[];if(bi){bj.push(bi)}bj=bj.concat(bh);if(bj.length===1){return bj[0]}else{bg.parts=bj;return bg}},aw="*",au={type:"literal",value:"*",description:'"*"'},ar=function(){return{type:"global"}},G=function(bg){return{type:"kind",name:bg}},bf="#",bd={type:"literal",value:"#",description:'"#"'},bc=function(bg){return{type:"id",name:bg}},bb=".",ba={type:"literal",value:".",description:'"."'},a7=function(bg){return{type:"class",name:bg}},a6="[",a5={type:"literal",value:"[",description:'"["'},a4="]",a2={type:"literal",value:"]",description:'"]"'},a1=function(bg,bi,bh){return{type:"attr",name:bg,oper:bi,value:bh}},aZ="=",aY={type:"literal",value:"=",description:'"="'},aX=/^[0-9a-zA-Z_]/,aW={type:"class",value:"[0-9a-zA-Z_]",description:"[0-9a-zA-Z_]"},aV=function(bg){return bg.join("")},aT='"',aS={type:"literal",value:'"',description:'"\\""'},aR=/^[^\n\r\f\\"]/,aJ={type:"class",value:'[^\\n\\r\\f\\\\"]',description:'[^\\n\\r\\f\\\\"]'},aH="\\",aF={type:"literal",value:"\\",description:'"\\\\"'},aD=function(bg){return bg},aB=function(bg){return bg.join("")},az="'",ax={type:"literal",value:"'",description:'"\'"'},av=/^[^\n\r\f\\']/,at={type:"class",value:"[^\\n\\r\\f\\\\']",description:"[^\\n\\r\\f\\\\']"},aq="\n",am={type:"literal",value:"\n",description:'"\\n"'},al="\r\n",aj={type:"literal",value:"\r\n",description:'"\\r\\n"'},ah="\r",ag={type:"literal",value:"\r",description:'"\\r"'},ad="\f",ac={type:"literal",value:"\f",description:'"\\f"'},ab=/^[^\r\n\f0-9a-fA-F]/,aa={type:"class",value:"[^\\r\\n\\f0-9a-fA-F]",description:"[^\\r\\n\\f0-9a-fA-F]"},Z=function(bg){return bg},ap=0,ae=0,aU=0,H={line:1,column:1,seenCR:false},ai=0,a8=[],an=0,T;if("startRule" in ao){if(!(ao.startRule in R)){throw new Error("Can't start parsing from rule \""+ao.startRule+'".')}aP=R[ao.startRule]}function aQ(){return a9.substring(ae,ap)}function Q(){return ae}function P(){return aN(ae).line}function U(){return aN(ae).column}function N(bg){throw aO(null,[{type:"other",description:bg}],ae)}function aM(bg){throw aO(bg,null,ae)}function aN(bh){function bg(bk,bj,bi){var bm,bl;for(bm=bj;bm<bi;bm++){bl=a9.charAt(bm);if(bl==="\n"){if(!bk.seenCR){bk.line++}bk.column=1;bk.seenCR=false}else{if(bl==="\r"||bl==="\u2028"||bl==="\u2029"){bk.line++;bk.column=1;bk.seenCR=true}else{bk.column++;bk.seenCR=false}}}}if(aU!==bh){if(aU>bh){aU=0;H={line:1,column:1,seenCR:false}}bg(H,aU,bh);aU=bh}return H}function af(bg){if(ap<ai){return}if(ap>ai){ai=ap;a8=[]}a8.push(bg)}function aO(bi,bh,bm){function bl(bo){var bn=1;bo.sort(function(bq,bp){if(bq.description<bp.description){return -1}else{if(bq.description>bp.description){return 1}else{return 0}}});while(bn<bo.length){if(bo[bn-1]===bo[bn]){bo.splice(bn,1)}else{bn++}}}function bg(br,bs){function bn(bu){function bv(bw){return bw.charCodeAt(0).toString(16).toUpperCase()}return bu.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(bw){return"\\x0"+bv(bw)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(bw){return"\\x"+bv(bw)}).replace(/[\u0180-\u0FFF]/g,function(bw){return"\\u0"+bv(bw)}).replace(/[\u1080-\uFFFF]/g,function(bw){return"\\u"+bv(bw)})}var bo=new Array(br.length),bt,bp,bq;for(bq=0;bq<br.length;bq++){bo[bq]=br[bq].description}bt=br.length>1?bo.slice(0,-1).join(", ")+" or "+bo[br.length-1]:bo[0];bp=bs?'"'+bn(bs)+'"':"end of input";return"Expected "+bt+" but "+bp+" found."}var bk=aN(bm),bj=bm<a9.length?a9.charAt(bm):null;if(bh!==null){bl(bh)}return new D(bi!==null?bi:bg(bh,bj),bh,bj,bm,bk.line,bk.column)}function M(){var bg;bg=V();return bg}function V(){var bl,bk,bj,bi,bh,bg;bl=ap;bk=O();if(bk!==a0){bj=[];bi=ap;if(a9.charCodeAt(ap)===44){bh=aG;ap++}else{bh=a0;if(an===0){af(aE)}}if(bh!==a0){bg=O();if(bg!==a0){bh=[bh,bg];bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}while(bi!==a0){bj.push(bi);bi=ap;if(a9.charCodeAt(ap)===44){bh=aG;ap++}else{bh=a0;if(an===0){af(aE)}}if(bh!==a0){bg=O();if(bg!==a0){bh=[bh,bg];bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}}if(bj!==a0){ae=bl;bk=aC(bk,bj);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function O(){var bj,bi,bh,bg;bj=ap;bi=I();if(bi===a0){bi=S()}if(bi===a0){bi=aA}if(bi!==a0){bh=[];bg=ak();if(bg===a0){bg=L();if(bg===a0){bg=be()}}while(bg!==a0){bh.push(bg);bg=ak();if(bg===a0){bg=L();if(bg===a0){bg=be()}}}if(bh!==a0){ae=bj;bi=ay(bi,bh);bj=bi}else{ap=bj;bj=aK}}else{ap=bj;bj=aK}return bj}function I(){var bh,bg;bh=ap;if(a9.charCodeAt(ap)===42){bg=aw;ap++}else{bg=a0;if(an===0){af(au)}}if(bg!==a0){ae=bh;bg=ar()}bh=bg;return bh}function S(){var bh,bg;bh=ap;bg=K();if(bg!==a0){ae=bh;bg=G(bg)}bh=bg;return bh}function L(){var bi,bh,bg;bi=ap;if(a9.charCodeAt(ap)===35){bh=bf;ap++}else{bh=a0;if(an===0){af(bd)}}if(bh!==a0){bg=K();if(bg!==a0){ae=bi;bh=bc(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}return bi}function be(){var bi,bh,bg;bi=ap;if(a9.charCodeAt(ap)===46){bh=bb;ap++}else{bh=a0;if(an===0){af(ba)}}if(bh!==a0){bg=K();if(bg!==a0){ae=bi;bh=a7(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}return bi}function ak(){var bl,bk,bj,bi,bh,bg;bl=ap;if(a9.charCodeAt(ap)===91){bk=a6;ap++}else{bk=a0;if(an===0){af(a5)}}if(bk!==a0){bj=K();if(bj!==a0){bi=a3();if(bi!==a0){bh=Y();if(bh!==a0){if(a9.charCodeAt(ap)===93){bg=a4;ap++}else{bg=a0;if(an===0){af(a2)}}if(bg!==a0){ae=bl;bk=a1(bj,bi,bh);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function a3(){var bg;if(a9.charCodeAt(ap)===61){bg=aZ;ap++}else{bg=a0;if(an===0){af(aY)}}return bg}function K(){var bi,bh,bg;bi=ap;bh=[];if(aX.test(a9.charAt(ap))){bg=a9.charAt(ap);ap++}else{bg=a0;if(an===0){af(aW)}}if(bg!==a0){while(bg!==a0){bh.push(bg);if(aX.test(a9.charAt(ap))){bg=a9.charAt(ap);ap++}else{bg=a0;if(an===0){af(aW)}}}}else{bh=aK}if(bh!==a0){ae=bi;bh=aV(bh)}bi=bh;return bi}function Y(){var bg;bg=X();if(bg===a0){bg=W()}return bg}function X(){var bl,bk,bj,bi,bh,bg;bl=ap;if(a9.charCodeAt(ap)===34){bk=aT;ap++}else{bk=a0;if(an===0){af(aS)}}if(bk!==a0){bj=[];if(aR.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(aJ)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}while(bi!==a0){bj.push(bi);if(aR.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(aJ)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}}if(bj!==a0){if(a9.charCodeAt(ap)===34){bi=aT;ap++}else{bi=a0;if(an===0){af(aS)}}if(bi!==a0){ae=bl;bk=aB(bj);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function W(){var bl,bk,bj,bi,bh,bg;bl=ap;if(a9.charCodeAt(ap)===39){bk=az;ap++}else{bk=a0;if(an===0){af(ax)}}if(bk!==a0){bj=[];if(av.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(at)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}while(bi!==a0){bj.push(bi);if(av.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(at)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}}if(bj!==a0){if(a9.charCodeAt(ap)===39){bi=az;ap++}else{bi=a0;if(an===0){af(ax)}}if(bi!==a0){ae=bl;bk=aB(bj);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function aL(){var bg;if(a9.charCodeAt(ap)===10){bg=aq;ap++}else{bg=a0;if(an===0){af(am)}}if(bg===a0){if(a9.substr(ap,2)===al){bg=al;ap+=2}else{bg=a0;if(an===0){af(aj)}}if(bg===a0){if(a9.charCodeAt(ap)===13){bg=ah;ap++}else{bg=a0;if(an===0){af(ag)}}if(bg===a0){if(a9.charCodeAt(ap)===12){bg=ad;ap++}else{bg=a0;if(an===0){af(ac)}}}}}return bg}function J(){var bi,bh,bg;bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){if(ab.test(a9.charAt(ap))){bg=a9.charAt(ap);ap++}else{bg=a0;if(an===0){af(aa)}}if(bg!==a0){ae=bi;bh=Z(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}return bi}T=aP();if(T!==a0&&ap===a9.length){return T}else{if(T!==a0&&ap<a9.length){af({type:"end",description:"end of input"})}throw aO(null,a8,ai)}}return{SyntaxError:D,parse:E}})();(function(){var G={_forward:function(H){g.each(this.engines,function(I,J){if(J.engine[H]){J.engine[H](J.draw)}})},prepareFrame:function(I,H){g.each(this.engines,function(J,K){if(K.engine.prepareFrame){K.engine.prepareFrame(K.draw,I,K.preclear,H)}})},cleanupFrame:function(H){g.each(this.engines,function(I,J){if(J.engine.cleanupFrame){J.engine.cleanupFrame(J.draw,H)}})},translate:function(I,H){g.each(this.engines,function(J,K){if(K.trace){K.engine.translate(K.draw,I,H)}})},fade:function(H){g.each(this.engines,function(I,J){if(J.trace){J.engine.fade(J.draw,H)}})},destroy:function(){this._forward("destroy")}};function F(I,H){return function(J,K){return I(H,J,K)}}function D(){return function(H,I){}}function E(I,H){var J={},K,L;if(!I||!H){return null}J.engine=I;J.draw=H;for(K in I.primitives){if("function"===typeof I.primitives[K]){J["prepare"+K]=D();J["draw"+K]=F(I.primitives[K],J.draw);J["cleanup"+K]=D()}else{for(L in I.primitives[K]){J[L+K]=F(I.primitives[K][L],J.draw)}}}return J}y.draw={availableEngines:{},create:function(K){var N=y.draw,I=K.rootNode,L={},M,J;K.width=K.width||I.width();K.height=K.height||I.height();if(N.availableEngines.canvas){var H=function(P){var O=E(N.availableEngines.canvas,N.availableEngines.canvas.create(K));if(O){if(P){O.trace=true}else{O.preclear=true}}return O};L.trace=H(true);L.canvas=H(false)}if(N.availableEngines.html){M=E(N.availableEngines.html,N.availableEngines.html.create(K));if(M){L.html=M}}J=Object.create(G);for(M in L){if(L.hasOwnProperty(M)&&!L[M]){delete L[M]}}J.engines=L;return J}}}());(function(){var D=function(W,X){var V=new Image();V.src=W.src;if(X){V.onload=X}return V};function P(X,W,V){X.beginPath();X.moveTo(W.x,W.y);X.lineTo(V.x,V.y);X.stroke()}function G(al,aj,ak,Y,ad){var ae,Z,af=aj.length/2,V=false,ab,ah,ag,X,W,ac;al.beginPath();var aa=10000000;function ai(am){return Math.abs(am)<aa}for(ae=0,Z=0;ae<af;++ae,Z+=2){ah=aj[Z];ag=aj[Z+1];if(ai(ah)&&ai(ag)){if((ah===X)&&(ag===W)){ab=true;continue}if(ak&&ak[ae]){if(ab){al.stroke();al.fillStyle=al.strokeStyle;L(al,{x:X,y:W},al.lineWidth/2);al.beginPath()}V=false}ab=false;if(!V){al.moveTo(ah,ag);V=true}else{ac=Y&&Y[ae];if(ac&&ac!==""){al.strokeStyle=ac}al.lineTo(ah,ag);if(ac){al.stroke();al.beginPath();al.moveTo(ah,ag)}}}else{if(ab){al.stroke();al.fillStyle=al.strokeStyle;L(al,{x:X,y:W},al.lineWidth/2);al.beginPath()}V=false}X=ah;W=ag}if(ad&&V){if(!(ak&&ak[ae])){ah=aj[0];ag=aj[1];if(ai(ah)&&ai(ag)){al.lineTo(ah,ag)}}}al.stroke()}function L(V,X,W){V.beginPath();V.arc(X.x,X.y,W,0,Math.PI*2,true);V.fill()}function J(V,W){V.beginPath();if(W.orientation!==0){V.arc(W.center.x,W.center.y,W.radius,W.initialAngle,W.finalAngle,false)}else{V.moveTo(W.initialPoint.x,W.initialPoint.y);V.lineTo(W.finalPoint.x,W.finalPoint.y)}}function H(X,Y,aa,ab,ac){var Z,W,V;for(Z=0,W=0;Z<aa;++Z,W+=2){if(ac){X.fillStyle=ac[Z]}V={x:Y[W],y:Y[W+1]};L(X,V,ab)}}function E(W,ac,ab){if(ab.x===ab.y){W.beginPath();W.arc(ac.x,ac.y,ab.x,0,Math.PI*2,true);W.stroke();return}var Z=0.551784,Y=ab.x*Z,X=ab.y*Z,V=ac.x+ab.x,aa=ac.y+ab.y;W.beginPath();W.moveTo(ac.x-ab.x,ac.y);W.bezierCurveTo(ac.x-ab.x,ac.y-X,ac.x-Y,ac.y-ab.y,ac.x,ac.y-ab.y);W.bezierCurveTo(ac.x+Y,ac.y-ab.y,V,ac.y-X,V,ac.y);W.bezierCurveTo(V,ac.y+X,ac.x+Y,aa,ac.x,aa);W.bezierCurveTo(ac.x-Y,aa,ac.x-ab.x,ac.y+X,ac.x-ab.x,ac.y);W.stroke()}function K(V,W,X){V.beginPath();V.moveTo(W[0].x,W[0].y);V.lineTo(W[1].x,W[1].y);V.lineTo(W[2].x,W[2].y);V.closePath();V.fill();if(X){V.stroke()}}function T(ac,ab,Z){var X=10,aa=X,W=ab.subtract(ac),V=W.vLength(),Y=V-aa;if(V>X){return W.multiply(Y/V).add(ac)}else{return}}function M(Y,W,V,X){var Z;Z=Y-(W*X)/V;return Z}function R(ac,X,W){var aa=2,ab=((W/2)+aa)||aa,Z=[],V=X.subtract(ac).unit(),Y=new y.GeometricPoint(-V.y,V.x);Z.push(ac.add(Y.multiply(ab)));Z.push(X);Z.push(ac.add(Y.multiply(-ab)));return Z}function S(aj,aa,ab,V,ad,ah,an){if(aa.orientation===0){aj.beginPath();aj.moveTo(aa.initialPoint.x,aa.initialPoint.y);aj.lineTo(aa.finalPoint.x,aa.finalPoint.y);aj.closePath();return}var aq=10,ae=aa,ar=ae.center,Y=aa.orientation,am=aa.arcAngle,af=aa.initialAngle,al=aa.finalAngle,ai=af,at=al,ak=((ad==="tail")||(ad==="both")),ag=((ad==="head")||(ad==="both")),ap=0,ao=false,W=false,Z,au,ac,X;if(ag){ap+=aq;if(Y>0){W=true}else{ao=true}}if(ak){ap+=aq;if(Y<0){W=true}else{ao=true}}if(Math.abs(am*ab)<=ap){ao=W=false}if(ao){Z=new y.GeometricPoint(Math.cos(af),Math.sin(af)).multiply(ab).add(ar);ai=M(af,Y,ab,aq)}if(W){au=new y.GeometricPoint(Math.cos(al),Math.sin(al)).multiply(ab).add(ar);at=M(al,Y,ab,aq)}aj.beginPath();aj.arc(ar.x,ar.y,ab,ai,at,false);aj.stroke();if(ah){aj.beginPath();aj.arc(ar.x,ar.y,ab,af,al,false);aj.lineTo(ar.x,ar.y);aj.closePath();X=aj.globalAlpha;aj.globalAlpha*=an;aj.fill();aj.globalAlpha=X}if(ao){ac=new y.GeometricPoint(Math.cos(ai),Math.sin(ai)).multiply(ab).add(ar);K(aj,R(ac,Z,V))}if(W){ac=new y.GeometricPoint(Math.cos(at),Math.sin(at)).multiply(ab).add(ar);K(aj,R(ac,au,V))}}function Q(ao,ac,ad,V,ae,am,ap){var at=10,ai=ac,av=ai.center,ab=ai.orientation,aj=ai.initialAngle,au=y.GeometricPoint(Math.cos(aj),Math.sin(aj)).multiply(ad),af=y.GeometricPoint(-au.y,au.x),aq=au.add(af),Z=au.add(av),X=af.add(av),ah=Z,aw=X,ag=aq.add(av),an=((ae==="tail")||(ae==="both")),al=((ae==="head")||(ae==="both")),ar=false,W=false,ak,Y,aa;if(al){if(ab>0){W=true}else{ar=true}}if(an){if(ab<0){W=true}else{ar=true}}if(ad<=at){ar=W=false}if(W){Y=T(ag,X,V);if(Y){X=Y}}if(ar){ak=T(ag,Z,V);if(ak){Z=ak}}ao.beginPath();ao.moveTo(Z.x,Z.y);ao.lineTo(ag.x,ag.y);ao.lineTo(X.x,X.y);ao.stroke();if(am){ao.beginPath();ao.moveTo(ah.x,ah.y);ao.lineTo(ag.x,ag.y);ao.lineTo(aw.x,aw.y);ao.lineTo(av.x,av.y);ao.closePath();aa=ao.globalAlpha;ao.globalAlpha*=ap;ao.fill();ao.globalAlpha=aa}if(Y){K(ao,R(X,aw,V))}if(ak){K(ao,R(Z,ah,V))}}function I(X,V){var W={state:"error",id:V.id,onStateChange:V.onStateChange};W.imageSpec=V.image;if(V.image){W.state="loading";W.img=D(W.imageSpec,function(){W.state="ready";if(W.onStateChange){W.onStateChange()}})}return W}function N(V,Y,aa){var ad=V.context,ac=aa.transform,W=Y.imageSpec?Y.imageSpec.width:200,ab=Y.imageSpec?Y.imageSpec.height:100,X=aa.clipPolygon,Z;if(!aa.renderable){return}ad.save();ad.globalAlpha*=aa.opacity;if(X&&X.length>0){ad.beginPath();ad.moveTo(X[0].getX(),X[0].getY());for(Z=1;Z<X.length;Z++){ad.lineTo(X[Z].getX(),X[Z].getY())}ad.closePath();ad.clip()}ad.globalAlpha*=aa.opacity;ad.transform(ac.m00,ac.m01,ac.m10,ac.m11,ac.m20,ac.m21);if(Y.state==="ready"){ad.drawImage(Y.img,0,0)}else{if(Y.state==="loading"){ad.strokeStyle="black";ad.strokeRect(0,0,W,ab)}else{ad.strokeStyle="red";ad.strokeRect(0,0,W,ab);ad.beginPath();ad.moveTo(0,0);ad.lineTo(W,ab);ad.moveTo(W,0);ad.lineTo(0,ab);ad.closePath();ad.stroke()}}ad.restore()}function F(X,V,W){V.onStateChange=null}function U(ab,X){var W=ab,Y=X,aa,Z,V;V=l.devicePixelRatio;if(V){W*=V;Y*=V}aa=g("<canvas width="+W+" height="+Y+"></canvas>");Z=aa[0].getContext&&aa[0].getContext("2d");if(!Z){return null}if(!Z.setLineDash){Z.setLineDash=function(ac){};Z.getLineDash=function(){return([])}}if(V){Z.scale(V,V)}return{canvas:aa,context:Z,width:W,height:Y}}function O(V){V.backbuffer=U(V.canvas.width(),V.canvas.height())}y.draw.availableEngines.canvas={create:function(W){var V=U(W.width,W.height);if(!V){return V}V.canvas.css({position:"absolute",top:0,left:0,width:W.width,height:W.height,overflow:"hidden"});V.canvas.appendTo(W.rootNode);return V},destroy:function(V){if(V.canvas){V.canvas.remove()}},prepareFrame:function(ac,aa,Y,X){var W,ad,Z,ab,V;ac.context.save();ac.context.transform(X.m00,X.m01,X.m10,X.m11,X.m20,X.m21);if(!Y){return}if(!y.Geom.isValidRect(aa)){return}ad=y.GeometricPoint(0,0);Z=y.GeometricPoint(ac.canvas.width(),ac.canvas.height());V=X.inverse();V.transform(ad);V.transform(Z);ab={left:ad.x,top:ad.y,right:Z.x,bottom:Z.y};W=y.Geom.insetRect(aa,-1);W.left=Math.round(W.left);W.top=Math.round(W.top);W.right=Math.round(W.right);W.bottom=Math.round(W.bottom);W=y.Geom.intersectRects(W,ab);if(y.Geom.isEmptyRect(W)){W={left:-1,top:-1,right:-1,bottom:-1}}ac.context.beginPath();ac.context.rect(W.left,W.top,W.right-W.left,W.bottom-W.top);ac.context.clip();ac.context.clearRect(ad.x,ad.y,Z.x-ad.x,Z.y-ad.y)},cleanupFrame:function(W,V){W.context.restore()},clear:function(V){V.context.clearRect(0,0,V.canvas.width(),V.canvas.height())},translate:function(W,Y,X){var Z=W.canvas.width(),V=W.canvas.height();if(!W.backbuffer){O(W)}W.backbuffer.context.clearRect(0,0,Z,V);W.backbuffer.context.drawImage(W.canvas[0],-Y,-X,Z,V);W.context.clearRect(0,0,Z,V);W.context.drawImage(W.backbuffer.canvas[0],0,0,Z,V)},fade:function(V,W){if(!V.backbuffer){O(V)}V.backbuffer.context.save();V.backbuffer.context.clearRect(0,0,V.canvas.width(),V.canvas.height());V.backbuffer.context.globalAlpha=W;V.backbuffer.context.drawImage(V.canvas[0],0,0,V.canvas.width(),V.canvas.height());V.context.clearRect(0,0,V.canvas.width(),V.canvas.height());V.context.drawImage(V.backbuffer.canvas[0],0,0,V.canvas.width(),V.canvas.height());V.backbuffer.context.restore()},primitives:{Point:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.fillStyle=X.color;V.strokeStyle="black";V.lineWidth=X.lineWidth;if(X.dropShadow){V.shadowColor="black";V.shadowBlur=7;V.shadowOffsetX=3;V.shadowOffsetY=3}V.setLineDash([]);V.beginPath();V.arc(X.cx,X.cy,X.radius,0,Math.PI*2,true);V.fill();if(X.lineWidth>0){V.stroke()}V.closePath();V.restore()},String:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.fillStyle="black";V.strokeStyle="black";V.lineWidth=1;V.textAlign="center";V.textBaseline="middle";V.fillText(X.text,X.x,X.y);V.restore()},Circle:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.strokeStyle=X.color;V.lineWidth=X.width;V.setLineDash(X.lineDash||[]);V.beginPath();V.arc(X.cx,X.cy,X.r,0,Math.PI*2,true);V.stroke();V.restore()},Arc:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.strokeStyle=X.color;V.lineWidth=X.width;V.setLineDash(X.lineDash||[]);J(V,X.arc);V.stroke();V.restore()},CircleInterior:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.fillStyle=X.color;if(X.drawBorder){V.strokeStyle=X.borderColor;V.lineWidth=X.borderWidth;V.setLineDash(X.lineDash||[])}V.beginPath();V.arc(X.cx,X.cy,X.r,0,Math.PI*2,true);V.fill();if(X.drawBorder){V.stroke()}V.restore()},ArcInterior:function(Z,W,Y){var V=Z.context,X;if(!Y.renderable){return}V.save();V.globalAlpha*=Y.opacity;V.fillStyle=Y.color;if(Y.drawBorder){V.strokeStyle=Y.borderColor;V.lineWidth=Y.borderWidth;V.setLineDash(Y.lineDash||[])}X=Y.arc;J(V,Y.arc);if(Y.genus==="ArcSegment"){V.closePath()}else{V.lineTo(X.center.x,X.center.y);V.closePath()}V.fill();if(Y.drawBorder){V.stroke()}V.restore()},Polygon:function(Z,W,Y){var V=Z.context,X;if(!Y.renderable){return}V.save();V.globalAlpha*=Y.opacity;V.fillStyle=Y.color;if(Y.drawBorder){V.strokeStyle=Y.borderColor;V.lineWidth=Y.borderWidth;V.setLineDash(Y.lineDash||[])}V.beginPath();V.moveTo(Y.points[0].x,Y.points[0].y);for(X=1;X<Y.points.length;X++){V.lineTo(Y.points[X].x,Y.points[X].y)}V.closePath();V.fill("evenodd");if(Y.drawBorder){V.stroke()}V.restore()},Rectangle:function(ac,W,Z){function aa(af,ae,ad){return Math.max(Math.min(af,ad),ae)}var V=ac.context,ab=Z.rect,Y={left:-1,top:-1,right:ac.width+1,bottom:ac.height+1},X;X={left:Math.round(aa(ab.left,Y.left,Y.right))-0.5,top:Math.round(aa(ab.top,Y.top,Y.bottom))-0.5,right:Math.round(aa(ab.right,Y.left,Y.right))+0.5,bottom:Math.round(aa(ab.bottom,Y.top,Y.bottom))+0.5};V.save();V.globalAlpha*=Z.opacity;V.lineWidth=1;V.lineCap="butt";V.lineJoin="miter";V.strokeStyle=Z.color||"#999";V.beginPath();V.moveTo(X.left,X.top);V.lineTo(X.right,X.top);V.lineTo(X.right,X.bottom);V.lineTo(X.left,X.bottom);V.closePath();V.stroke();V.restore()},Segment:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.lineWidth=X.width;V.strokeStyle=X.color;V.setLineDash(X.lineDash||[]);V.beginPath();V.moveTo(X.p0x,X.p0y);V.lineTo(X.p1x,X.p1y);V.lineCap="round";V.stroke();V.closePath();V.setLineDash([]);V.restore()},Text:{prepare:function(W,V){return g.extend({},V)},draw:function(X,au,aa){var aj=X.context,al=18,an=0.7,ai=0.2,ag=Math.round(aa.x),ar=Math.round(aa.y)-4,ad=ag,ac=ar;if(!aa.renderable){return}function ab(av,aw){var ay="";function ax(aB,az,aA){if((h!==aB)&&(aB!==az)){if(ay.length>0){ay+=" "}ay+=aB;if(aA){ay+=aA}}}ax(aw["font-weight"],"normal");ax(aw["font-style"],"normal");ax(aw["font-size"],"","px");ax(aw["font-family"]);if(ay.length>0){av.font=ay}if(h!==aw.color){av.fillStyle=aw.color}}function ae(aA){var aw={ascent:0.1,descent:0.2,left:0,right:0},ax={zapfino:{ascent:1.2,descent:2.6,left:0.2,right:0.4}},av=aA["font-family"],ay=av&&av.toLowerCase(),az;g.each(ax,function(aC,aB){if(ay.indexOf(aC)>=0){az=aB;return false}});return az||aw}function at(av,aC,ax){var aA=aC["font-size"]||al,aB=ae(aC),az=aq(ax),ay,aw;av.save();ab(av,aC);ay=av.measureText(az.text);av.restore();aw=(az.maxSubscript+az.maxSuperscript)*ai;return{width:Math.round(ay.width*(1+aB.left+aB.right)),height:Math.round(aA*(1+aB.ascent+aB.descent+aw))}}function V(av,aA,ax,az){var aw=az["font-size"]||al,ay=ae(az);return{top:aA-Math.round((1+ay.ascent)*aw),bottom:aA+Math.round(ay.descent*aw),left:av-Math.round(ay.left*aw)-1,right:av+ax+Math.round(ay.right*aw)+2}}function af(aw,ax){var av=aw.value;if(aw.type==="symbol"){return y.mfs.symMap[av.toUpperCase()]||"x"}return av}function aq(az){var aA={},aC=0,ay=0,ax=0,av=0,aB="";function aw(aE){var aD;aD=aA[aE.type];if(aD){aD(aE)}}aA.horizontal=function(aE){for(var aD=0;aD<aE.value.length;++aD){aw(aE.value[aD])}};aA.style=function(aE){for(var aD=0;aD<aE.value.length;aD+=1){if(!aE.value[aD].code&&aE.value[aD].type){aw(aE.value[aD])}}};aA.sub=function(aD){if(av<++ax){av=ax}aw(aD.value[0]);aw(aD.value[1]);--ax};aA["super"]=function(aD){if(ay<++aC){ay=aC}aw(aD.value[0]);aw(aD.value[1]);--aC};aA.text=function(aD){aB+=af(aD)};aA.symbol=aA.text;aw(az);return{maxSubscript:av,maxSuperscript:ay,text:aB}}function ah(av,ay,aA){var az={},ax={left:ad,top:ac,right:ad,bottom:ac};function aw(aC,aD){var aB;aB=az[aC.type];if(aB){aB(aC,aD)}else{y.log("MFS-Canvas-Render does not support "+aC.type)}}az.horizontal=function(aC,aD){for(var aB=0;aB<aC.value.length;++aB){aw(aC.value[aB],aD)}};az.style=function(aE,aI){var aF,aD,aB,aG,aH,aJ=g.extend({},aI),aK={},aC=[];for(aF=0;aF<aE.value.length;aF+=1){if(aE.value[aF].code){aK[aE.value[aF].code]=aE.value[aF].value}else{if(aE.value[aF].type){aC.push(aE.value[aF])}}}if(aK.fontFamily){if(aI.fontTable){aD=aI.fontTable[parseInt(aK.fontFamily,16)];if(aD){aJ["font-family"]=aD}}}if(aK.fontSize){aJ["font-size"]=parseInt(aK.fontSize,16)+"px"}else{if(Number(aK.fontWeight)===2){aJ["font-weight"]="bold"}}if(Number(aK.fontStyle)===2){aJ["font-style"]="italic"}if(Number(aK.underbar)===2){aJ["text-decoration"]="underline"}if(aK.red||aK.green||aK.blue){aB=aK.red?parseInt(aK.red,16)-1:0;aG=aK.green?parseInt(aK.green,16)-1:0;aH=aK.blue?parseInt(aK.blue,16)-1:0;aJ.color="rgb("+aB+","+aG+","+aH+")"}av.save();ab(av,aJ);aw(aC[0],aJ);av.restore()};az.sub=function(aC,aE){var aB=g.extend({},aE),aD=Math.round(ai*aB["font-size"]);aw(aC.value[0],aB);ac+=aD;av.save();aB["font-size"]=Math.round(an*aB["font-size"]);ab(av,aB);aw(aC.value[1],aB);av.restore();ac-=aD};az["super"]=function(aC,aE){var aB=g.extend({},aE),aD=Math.round(ai*aB["font-size"]);aw(aC.value[0],aB);ac-=aD;av.save();aB["font-size"]=Math.round(an*aB["font-size"]);ab(av,aB);aw(aC.value[1],aB);av.restore();ac+=aD};az.text=function(aE,aG){var aD=af(aE),aC=av.measureText(aD),aB=V(ad,ac,aC.width,aG);av.fillText(aD,ad,ac);if(aG["text-decoration"]==="underline"){var aF=Math.round(ac+2)+0.5;P(av,{x:ad,y:aF},{x:ad+aC.width,y:aF});aB.bottom=Math.max(aB.bottom,aF+1)}ax=y.Geom.unionRects(ax,aB);ad+=aC.width};az.symbol=az.text;aw(ay,aA);return ax}function ao(){return{fontTable:au.fontTable,"font-weight":au["font-weight"],"font-style":au["font-style"],"text-decoration":au["text-decoration"],"font-size":au["font-size"],"font-family":au["font-family"],color:au.color}}var Y=aa.useDrawImage?null:aj,am=l.devicePixelRatio||1,W=au["font-size"]||al,ap,ak;if(aa.constraintFrame!==au.constraintFrame){if(aa.parsedMFS!==au.parsedMFS){au.parsedMFS=aa.parsedMFS;if(aa.useDrawImage){if(!au.mfsImage){au.mfsImage=r.createElement("canvas")}ap=ao();ak=at(aj,ap,au.parsedMFS);au.mfsImage.width=ak.width*am;au.mfsImage.height=ak.height*am;Y=au.mfsImage.getContext("2d");Y.scale(am,am)}}au.constraintFrame=aa.constraintFrame}if(au.parsedMFS&&Y){if(!ap){ap=ao()}var Z=ae(ap);if(aa.useDrawImage){au.imageOffset={x:Math.round(W*Z.left),y:Math.round(W*Z.ascent)};ad=au.imageOffset.x;ac=au.imageOffset.y}if(!aa.useDrawImage){aj.save();aj.globalAlpha*=aa.opacity}ab(Y,ap);Y.textBaseline="alphabetic";ac+=W;au.baseRenderBounds=ah(Y,au.parsedMFS,ap);if(!aa.useDrawImage){aj.restore()}}if(aa.useDrawImage&&au.mfsImage){ag-=au.imageOffset.x;ar-=au.imageOffset.y;aj.save();if(am!==1){aj.scale(1/am,1/am)}aj.drawImage(au.mfsImage,ag*am,ar*am);au.renderBounds=y.Geom.offsetRect(au.baseRenderBounds,ag,ar);aj.restore()}else{au.renderBounds=au.baseRenderBounds}},cleanup:function(X,V,W){}},Picture:{prepare:I,draw:N,cleanup:F},Axis:{prepare:function(W,V){},draw:function(Y,ay,ag){function ad(aE,aD){if(aD<=0){return aE}var aF=aE,aH=18,aB=0.8,aG=0.8,aC=6;if(aE>=aH){aF*=aB}for(;aD>0;--aD){aF*=aG}return Math.max(Math.round(aF),aC)}var ao=Y.context,ax,aA,ar,am,ap,at,aq=ag.tickSpacing.pixelsBetweenTicks*ag.tickSpacing.largeTickInterval,ah=Math.PI*ag.unitPixels,V=Math.round(ah/aq),ac=ad(ag["font-size"],1),W=ac+"px "+ag["font-family"],X=ac,au,aw="π",ab,ak,ai="−",af;if(ag.orientation==="horizontal"){ax=ag.sketchRect.left;aA=ag.sketchRect.right;ar=ag.origin.x;am=ag.origin.y}else{ax=ag.sketchRect.top;aA=ag.sketchRect.bottom;ar=ag.origin.y;am=ag.origin.x}ap=ax-1;at=aA+1;if(!ag.renderable){return}function Z(){ao.save();ao.setLineDash(ag.lineDash||[]);if(ag.orientation==="horizontal"){P(ao,{x:ap,y:am},{x:at,y:am})}else{P(ao,{x:am,y:ap},{x:am,y:at})}ao.restore()}function an(){var aC=ag.majorTickLength,aD,aF,aE,aB;aE=~~((ap-ar)/aq);aB=~~((at-ar)/aq);for(aF=aE;aF<=aB;++aF){aD=ar+aF*aq;if(aF!==0){if(ag.orientation==="horizontal"){P(ao,{x:aD,y:am-aC},{x:aD,y:am+aC})}else{P(ao,{x:am-aC,y:aD},{x:am+aC,y:aD})}}}}function az(aD,aC){if(aD!==~~aD){var aB=Math.pow(10,aC);return Math.round(aD*aB)/aB}return aD}function aa(aG){var aF=aG.toExponential(ag.precisionInfo.precision),aE=aF.indexOf("e"),aC=(+aF.substr(0,aE)).toString(),aB=aF[aE+1]==="+"?aE+2:aE+1,aD=aF.substr(aB);return{type:"exponential",primary:aC+"●10",secondary:aD.toString()}}function av(aI,aH){var aE=72,aJ=y.math.reduceFraction(Math.abs(aI),V),aD,aF,aB,aG;if((aJ.denominator>1)&&(aJ.denominator<=aE)){var aC="";if(aJ.numerator!==1){aC+=aJ.numerator}aG={type:"fraction",negative:aI<0,primary:aC,secondary:aJ.denominator.toString(),pi:true}}else{if(aJ.denominator<72){aD=az(aH/Math.PI,ag.precisionInfo.precision);aF=aD<0?"-":"";aD=Math.abs(aD);aB=aF;if(aD!==1){aB+=aD}aG={type:"simple",primary:aB,pi:true}}else{aD=az(aH,ag.precisionInfo.precision);aG={type:"simple",primary:aD.toString()}}}return aG}function aj(aF,aB){var aC=aB,aE=Math.abs(aC),aD;if((aE<ag.precisionInfo.smallExponentBound)||(aE>ag.precisionInfo.largeExponentBound)){aD=aa(aC)}else{if(ag.tickNumbering==="trigonometric"){aD=av(aF,aB)}else{aC=az(aC,ag.precisionInfo.precision);aD={type:"simple",primary:aC.toString()}}}if(aD.primary){aD.primary=aD.primary.replace("-",ai)}return aD}function ae(aF,aY,aP){var aE=aF.primary&&ao.measureText(aF.primary),aJ,aO=1,aD=2,aG,aW,aH=ao.textBaseline,aM,aK,aX={};if(aF.pi){if(!ab){ab=ac+"px Symbol"}if(!ak){ao.font=ab;ak=ao.measureText(aw);ao.font=W}}aG=aE?aE.width:0;if(aF.pi){if(aG){aG+=aO}aG+=ak.width}if(aF.type==="simple"){aW=ac;if(ag.orientation==="horizontal"){aX.x=aY;aX.y=Math.round(am+aP+aW/2)-0.5}else{aX.x=am-aP-aG/2;aX.y=Math.round(aY)-1.5}aM=aX.x-aG/2;aK=aX.y+ac/2+2;ao.textBaseline="bottom";if(aF.primary){ao.fillText(aF.primary,aM,aK);aM+=aE.width+aO}if(aF.pi){ao.font=ab;ao.fillText(aw,aM,aK);ao.font=W}}else{if(aF.type==="exponential"){var aC=ad(ag["font-size"],2),aN=1,aS={};if(!au){au=aC+"px "+ag["font-family"]}ao.font=au;aJ=ao.measureText(aF.secondary);aG+=aN+aJ.width;aW=ac+aC;if(ag.orientation==="horizontal"){aX.x=aY;aX.y=Math.round(am+aP+aW/2)+0.5}else{aX.x=am-aP-aG/2;aX.y=Math.round(aY)+0.5}ao.textBaseline="middle";aM=aX.x-aG/2;aS.x=aM+aE.width+aN;aS.y=aX.y-ac/2;ao.fillText(aF.secondary,aS.x,aS.y);ao.font=W;ao.fillText(aF.primary,aM,aX.y)}else{if(aF.type==="fraction"){if(!af&&aF.negative){af=ao.measureText(ai)}aJ=ao.measureText(aF.secondary);var aR=aG,aQ=aJ.width,aU=Math.max(aR,aQ)+2,aT,aB,aV,aZ=5,aL=(aU-aR)/2,aI=(aU-aQ)/2;aG=Math.max(aR,aQ)+2;if(aF.negative){aG+=af.width+aD}aW=2*(X+4);if(ag.orientation==="horizontal"){aX.x=aY;aX.y=Math.round(am+aP+aW/2)-1.5}else{aX.x=am-aP-aG/2-1;aX.y=Math.round(aY)+0.5}if(aF.negative){ao.textBaseline="middle";ao.fillText(ai,aX.x-aG/2,aX.y-1);aT=aX.x-aG/2+af.width+aD}else{aT=aX.x-aG/2}aB=aT+aU;aV=(aT+aB)/2;ao.lineWidth=1;P(ao,{x:aT,y:aX.y},{x:aB,y:aX.y});aM=aT+aL;aK=aX.y-aZ-1;ao.textBaseline="alphabetic";if(aF.primary){ao.fillText(aF.primary,aM,aK);aM+=aE.width+aO}if(aF.pi){ao.font=ab;ao.fillText(aw,aM,aK);ao.font=W}aM=aT+aI;aK=aX.y+aZ-Math.round(ac/6);ao.textBaseline="top";ao.fillText(aF.secondary,aM,aK)}}}ao.textBaseline=aH}function al(){var aJ=aq*ag.tickSpacing.largeIntervalsPerText,aC,aB,aD,aF,aE,aH,aI=ag.majorTickLength+3;aD=~~((ap-ar)/aJ)-1;aF=~~((at-ar)/aJ)+1;ao.font=W;ao.textAlign="left";for(aB=aD;aB<=aF;++aB){if(aB!==0){var aG=aB*ag.tickSpacing.largeIntervalsPerText;aC=ar+aB*aJ;aE=aB*aJ/ag.unitPixels;if(ag.isPolar){aG=Math.abs(aG);aE=Math.abs(aE)}else{if(ag.orientation==="vertical"){aG=-aG;aE=-aE}}aH=aj(aG,aE);ae(aH,aC,aI)}}}ao.save();if(h!==ag.width){ao.lineWidth=ag.width}if(h!==ag.color){ao.fillStyle=ag.color;ao.strokeStyle=ag.color}if(h!==ag.opacity){ao.globalAlpha*=ag.opacity}Z();an();if(ag.tickNumberStyle==="auto"){al()}ao.restore()},cleanup:function(X,V,W){}},CoordSys:{prepare:function(W,V){},draw:function(X,at,Y){var ao=X.context,aa=Y.sketchRect.left,ae=Y.sketchRect.right,ag=Y.sketchRect.top,aj=Y.sketchRect.bottom,af=aa-1,ah=ae+1,ak=ag-1,ap=aj+1,ac,W,Z,ad,ab,al,aq,ar;if(!Y.renderable){return}Z=~~((af-Y.origin.x)/Y.gridSpacing.x);ad=~~((ah-Y.origin.x)/Y.gridSpacing.x);aq=~~((ak-Y.origin.y)/Y.gridSpacing.y);ar=~~((ap-Y.origin.y)/Y.gridSpacing.y);ao.save();if(h!==Y.width){ao.lineWidth=Y.width}if(h!==Y.color){ao.strokeStyle=Y.color}if(h!==Y.opacity){ao.globalAlpha*=Y.opacity}function an(au){P(ao,{x:af,y:au},{x:ah,y:au})}function ai(au){for(W=Z;W<=ad;++W){ac=Y.origin.x+W*Y.gridSpacing.x;L(ao,{x:ac,y:au},Y.radius)}}function am(){if(Y.grid==="gridlines"){for(W=Z;W<=ad;++W){ac=Y.origin.x+W*Y.gridSpacing.x;P(ao,{x:ac,y:ak},{x:ac,y:ap})}}var au=an;if(Y.grid==="dotted"){au=ai;ao.fillStyle=Y.color}for(al=aq;al<=ar;++al){ab=Y.origin.y+al*Y.gridSpacing.y;au(ab)}}function V(){var aP=Math.max(Math.abs(Z),Math.abs(ad)),aF=Math.max(Math.abs(aq),Math.abs(ar)),aA=1,aE=aP+aF,aQ=aP*aP+aF*aF,aK=Y.gridSpacing.y/Y.gridSpacing.x,ax=(Z*ad<=0),av=(aq*ar<=0);while(aE*aE>aQ){--aE}++aE;if(!ax||!av){var aM=Math.min(Math.abs(Z),Math.abs(ad)),aD=Math.min(Math.abs(aq),Math.abs(ar));if(ax){aA=aD}else{if(av){aA=aM}else{var aw=aM*aM+aD*aD;while(aA*aA<=aw){++aA}--aA}}}function aO(aS,aR,aW){var aX,aU={x:0,y:0},aV=Y.radius,aT=[{cos:1,sin:0},{cos:0.96592582628907,sin:0.25881904510252},{cos:0.86602540378444,sin:0.5},{cos:0.70710678118655,sin:0.70710678118655},{cos:0.5,sin:0.86602540378444},{cos:0.25881904510252,sin:0.96592582628907},{cos:0,sin:1}];aS.fillStyle=Y.color;for(aX=0;aX<7;++aX){aU.x=aW.x*aT[aX].cos;aU.y=aW.y*aT[aX].sin;L(aS,{x:aR.x+aU.x,y:aR.y-aU.y},aV);if((aX>0)&&(aX<6)){L(aS,{x:aR.x-aU.x,y:aR.y-aU.y},aV)}L(aS,{x:aR.x-aU.x,y:aR.y+aU.y},aV);if((aX>0)&&(aX<6)){L(aS,{x:aR.x+aU.x,y:aR.y+aU.y},aV)}}}var aB=Y.grid==="dotted"?aO:E,aN;for(aN=1;aN<=aE;++aN){var aC={x:aN*Y.gridSpacing.x,y:aN*Y.gridSpacing.y};aB(ao,Y.origin,aC)}function au(aS,aT,aU,aR){if(aS===0){return(aR.min<=aT[0][aU])&&(aT[0][aU]<=aR.max)}else{if(aS>0){return aT[0][aU]>aR.max?aT[1][aU]<=aR.max:aT[0][aU]>=aR.min}else{if(aS<0){return aT[0][aU]<aR.min?aT[1][aU]>=aR.min:aT[0][aU]<=aR.max}}}}if(Y.grid==="gridlines"){var aI=Math.PI/12,aL=-2*aI,az={x:Y.origin.x,y:Y.origin.y},ay={x:Y.origin.x,y:Y.origin.y},aJ=[{x:az.x,y:az.y},{x:ay.x,y:ay.y}],aG,aH;az={x:af-Y.origin.x,y:Y.origin.y};aJ[0].x=af;ay.x=ah-Y.origin.x;aJ[1].x=ah;for(aN=0;aN<5;++aN){aG=aL+aN*aI;aH=-Math.tan(aG)*aK;aJ[0].y=Y.origin.y+az.x*aH;aJ[1].y=Y.origin.y+ay.x*aH;if(au(aG,aJ,"y",{min:ak,max:ap})){P(ao,aJ[0],aJ[1])}}aK=1/aK;az.y=ak-Y.origin.y;aJ[0].y=ak;ay.y=ap-Y.origin.y;aJ[1].y=ap;aL=3*aI;for(aN=0;aN<7;++aN){aG=aL-aN*aI;aH=-Math.tan(aG)*aK;aJ[0].x=Y.origin.x+az.y*aH;aJ[1].x=Y.origin.x+ay.y*aH;if(au(aG,aJ,"x",{min:af,max:ah})){P(ao,aJ[0],aJ[1])}}}}if(Y.shape==="polar"){V()}else{am()}ao.restore()},cleanup:function(X,V,W){}},AngleMarker:function(X,Z,ag){if(!ag.renderable){return}var ah=X.context,ae=ag.firstArc,W=ae.radius,af=ag.isRight,aa=af?Q:S,V=0.7071067811865475,ac=af?V:1,Y,ab,ad;ah.save();ah.globalAlpha*=ag.fadeOpacity;ah.strokeStyle=ag.color;ah.fillStyle=ag.color;ah.lineWidth=ag.width;ah.setLineDash(ag.lineDash||[]);for(Y=0;Y<ag.strokes;Y+=1){ab=W*ac+Y*(ag.radialSpacing+ag.width);ad="none";if(Y+1===ag.strokes&&ag["show-angle-direction"]){ad="head"}aa(ah,ae,ab,ag.width,ad,Y===0,ag.opacity)}ah.restore()},ContinuousPointVector:function(V,X,ab){if(!ab.renderable){return}var ad=V.context,aa=ab.samples,ac=aa.length,ae,Y,Z=ac/2;function W(ag,af,am,al,aj,ah){var an=y.GeometricPoint(ag,af),ai=y.GeometricPoint(am,al),ak=ai.subtract(an).unit().multiply(aj);return R(an.add(ak),an,ah)}ad.save();ad.globalAlpha*=ab.opacity;ad.lineWidth=ab.width;if(ab.color){ad.strokeStyle=ab.color}G(ad,aa,ab.discontinuities,ab.colors,ab.closedPath);if(ab.leftEndpoint==="endpoint"){ae=y.GeometricPoint(aa[0],aa[1]);ad.fillStyle=ab.colors?ab.colors[0]:ab.color;L(ad,ae,ab.endpointRadius)}else{if(ab.leftEndpoint==="arrowhead"){ad.fillStyle=ab.colors?ab.colors[0]:ab.color;ad.strokeStyle=ab.colors?ab.colors[0]:ab.color;K(ad,W(aa[0],aa[1],aa[2],aa[3],ab.arrowheadRadius,ab.width),true)}}if(ab.rightEndpoint==="endpoint"){Y=y.GeometricPoint(aa[ac-2],aa[ac-1]);ad.fillStyle=ab.colors?ab.colors[Z-1]:ab.color;L(ad,Y,ab.endpointRadius)}else{if(ab.rightEndpoint==="arrowhead"){ad.fillStyle=ab.colors?ab.colors[Z-1]:ab.color;ad.strokeStyle=ab.colors?ab.colors[Z-1]:ab.color;K(ad,W(aa[ac-2],aa[ac-1],aa[ac-4],aa[ac-3],ab.arrowheadRadius,ab.width),true)}}ad.restore()},DiscretePointVector:function(Y,W,X){if(!X.renderable){return}var V=Y.context;V.save();V.globalAlpha*=X.opacity;if(X.color){V.fillStyle=X.color}H(V,X.samples,X.numSamples,X.radius,X.colors);V.restore()},SegmentVector:function(Y,Z,ae){if(!ae.renderable){return}var af=Y.context,ab,X=4,ad=ae.numSamples,ac,aa,W,V;af.save();af.globalAlpha*=ae.opacity;af.lineWidth=ae.width;af.strokeStyle=ae.color;af.setLineDash(ae.lineDash||[]);for(ab=0;ab<ad;ab++){ac=ae.samples[ab*X];aa=ae.samples[ab*X+1];W=ae.samples[ab*X+2];V=ae.samples[ab*X+3];if(ae.colors){af.strokeStyle=ae.colors[ab]}af.beginPath();af.moveTo(ac,aa);af.lineTo(W,V);af.lineCap="round";af.stroke()}af.setLineDash([]);af.restore()},ArcVector:function(V,X,ac){if(!ac.renderable){return}var ad=V.context,Y,W,Z=ac.numSamples,ab=ac.arcType,aa=(ab!=="arc");ad.save();ad.globalAlpha*=ac.opacity;if(aa){ad.fillStyle=ac.color;ad.globalAlpha*=ac.opacity}else{ad.lineWidth=ac.width;ad.strokeStyle=ac.color;ad.setLineDash(ac.lineDash||[])}for(Y=0;Y<Z;Y++){W=y.GeometricArc.FromPackedSampleArray(ac.samples,Y);if(ac.colors){if(aa){ad.fillStyle=ac.colors[Y]}else{ad.strokeStyle=ac.colors[Y]}}J(ad,W);if(ab==="arcSegment"){ad.closePath()}else{if(ab==="arcSector"){ad.lineTo(W.center.x,W.center.y);ad.closePath()}}if(aa){ad.fill()}else{ad.stroke()}}ad.setLineDash([]);ad.restore()},CircleVector:function(X,Z,af){if(!af.renderable){return}var ag=X.context,ab,V=3,ad=af.numSamples,ae=af.isInterior,W,aa,Y,ac;ag.save();ag.globalAlpha*=af.opacity;if(ae){ag.fillStyle=af.color;ag.globalAlpha*=af.opacity}else{ag.lineWidth=af.width;ag.strokeStyle=af.color}ag.setLineDash(af.lineDash||[]);for(ab=0;ab<ad;ab++){W=ab*V;aa=af.samples[W];Y=af.samples[W+1];ac=af.samples[W+2];if(af.colors){if(ae){ag.fillStyle=af.colors[ab]}else{ag.strokeStyle=af.colors[ab]}}ag.beginPath();ag.arc(aa,Y,ac,0,Math.PI*2,true);if(ae){ag.fill()}else{ag.stroke()}}ag.setLineDash([]);ag.restore()},PolygonVector:function(W,X,ac){var ae=W.context,ab=ac.samples,ad,Z=ac.numVertices,aa=ac.numSamples,Y=0,V;if(!ac.renderable){return}ae.save();ae.fillStyle=ac.color;ae.globalAlpha*=ac.opacity;for(ad=0;ad<aa;ad++){if(ac.colors){ae.fillStyle=ac.colors[ad]}ae.beginPath();ae.moveTo(ab[Y],ab[Y+1]);Y+=2;for(V=1;V<Z;V++){ae.lineTo(ab[Y],ab[Y+1]);Y+=2}ae.closePath();ae.fill("evenodd")}ae.restore()},PictureVector:{prepare:I,draw:function(aa,V,Y){var Z=Y.transformSamples,W=Y.numSamples;for(var X=0;X<W;++X){Y.transform=y.AffineTransform.fromPackedSampleArray(Z,X);Y.clipPolygon=Y.clipPolygons&&Y.clipPolygons[X];N(aa,V,Y)}},cleanup:F}}}}());(function(){var J=b.userAgent.toLowerCase().indexOf("firefox")>-1,G={width:function(){return g(this.element).outerWidth()},height:function(){return g(this.element).outerHeight()},createAndAddElement:function(P,L){var N=I(P.layer,this.index);var O=L?' type="button"':"";var M=g('<div wsp-id="'+this.id+'" class="wsp-'+this.kind+'" data-index="'+this.index+'"'+O+"/>");var Q=M;if(L){Q=g('<div class="wsp-Button-label"></div>');Q.wrap('<div class="wsp-Button-label-frame"></div>');M.append(g('<span class="wsp-Button-row"><span class="wsp-Button-drag-handle"></span></span>').append(Q.parent()))}this.element=M;this.mfsElement=Q;M.css(this.css);M.hide();this.visible=false;M.appendTo(N);if(this.isEditableByCalculator){var K=y.getConfigValue("NumberpadManager.delegates.registerCalculatorElement");K(M)}return M},updateModelToViewTransform:function(K){var M=this.element,L;if(J&&K.isTranslation()){M.css({left:this.left+K.m20,top:this.top+K.m21})}else{L=K.toStringCSS();M.css({left:this.left,top:this.top,"-webkit-transform":L,"-ms-transform":L,transform:L})}},updateFromModel:function(L){var M,Q,P,K;if(L.parsedMFS&&(this.parsedMFS!==L.parsedMFS)){this.parsedMFS=L.parsedMFS;if(!g(".wsp-target",this.mfsElement).length&&L.isEditableByCalculator){K=g("<span/>").addClass("wsp-target");K.css({"z-index":1000,opacity:0,position:"absolute",left:0,top:0});this.mfsElement.append(K)}K=g(".wsp-target",this.mfsElement);K.width(0).height(0);this.mfsElement.children().not(".wsp-target").remove();this.valueMap=E(this.parsedMFS,this.mfsElement,this.fontTable,this.baseStyles)}if(L.MFSValues){H(this.valueMap,L.MFSValues,this.fontTable,this.baseStyles)}if(this.attrs["text-align"]==="center"){M=this.width()/2;P=L.x-M}else{P=L.x}if(this.attrs["vertical-align"]==="middle"){M=this.height()/2;Q=L.y-M}else{Q=L.y}if(this.attrs["vertical-align"]==="bottom"){var O=parseInt(g(this.element).css("padding-bottom"),10);var N=g(this.element).height();Q=L.y-(N-O)}this.left=P;this.top=Q}},F=Object.create(G);F.dragHandleWidth=function(){return g(".wsp-Button-drag-handle",this.element).outerWidth()};var D={createWithAttrs:function(N,M,K){var L=Object.create(K?F:G);L.id=N.id;L.index=M;L.kind=N.kind;L.isEditableByCalculator=N.isEditableByCalculator;L.fontTable=N.fontTable;L.attrs={"text-align":N["text-align"],"vertical-align":N["vertical-align"]};L.baseStyles={color:N.color,"font-family":N["font-family"],"line-height":N["line-height"],"font-style":N["font-style"],"font-weight":N["font-weight"],"font-size":N["font-size"],"text-decoration":N["text-decoration"],opacity:N.opacity};L.css={padding:N.padding};g.extend(L.css,L.baseStyles);if(K){L.attrs["highlight-color"]=N["highlight-color"];L.attrs["handle-color"]=N["background-color"]||"white"}return L}};function E(K,N,P,O){var L;try{L=y.mfs.makeHTMLFromMFSParseTree(K,N,P,O);return L}catch(M){y.signalCaughtError(M)}}function I(P,L){var N=g("*",P),K,M,O=P;for(K=0;K<N;K+=1){M=g(N[K]).data("index");if(M<L){O=N[K]}}return O}function H(M,K,N,P){var U,T,O,S=K.lastRealizedFrame,R=false,Q;if(M&&K){for(U in K){if(K.hasOwnProperty(U)&&M.hasOwnProperty(U)){T=M[U];for(O=0;O<T.length;O+=1){if(S&&S.hasOwnProperty(U)&&S[U]===K[U]){continue}if(K[U].type==="text"){Q=K[U].value;g(T[O]).text(Q)}else{T[O].empty();E(K[U],T[O],N,P)}R=true}}}}if(R){K.lastRealizedFrame=h;var L=g.extend(true,{},K);K.lastRealizedFrame=L}return R}y.draw.availableEngines.html={create:function(L){var K=L.rootNode,M=g('<div class="wsp-text-layer">').appendTo(g(K));M.css({width:"100%",height:"100%"});return{layer:M,textCt:0,modelToViewTransform:null}},destroy:function(K){},prepareFrame:function(M,L,N,K){M.modelToViewTransform=K},cleanupFrame:function(K){},clear:function(K){K.layer.remove()},primitives:{Text:{prepare:function(L,K){return D.createWithAttrs(K,L.textCt++)},draw:function(O,L,N){var M=L.element,K;if(!M&&(N.visibility==="visible")){M=L.createAndAddElement(O)}if(M){if(N.visibility==="visible"){if(N.constraintFrame!==L.constraintFrame){L.updateFromModel(N);L.constraintFrame=N.constraintFrame}L.updateModelToViewTransform(O.modelToViewTransform);M.toggleClass("wsp-text-target-highlight",N.targetHighlight===true);M.toggleClass("wsp-text-unmatched-given",N.pulse===true);M.css({opacity:N.opacity});if(!L.visible){M.show();L.visible=true}K=g(".wsp-target",M);K.width(M.width());K.height(M.height())}else{M.hide();L.visible=false}}},cleanup:function(M,K,L){g(K.element).remove()}},Button:{prepare:function(L,K){return D.createWithAttrs(K,L.textCt++,true)},draw:function(O,K,M){var L=K.element;if(!L&&(M.visibility==="visible")){L=K.createAndAddElement(O,true)}if(L){if(M.visibility==="visible"){if(M.constraintFrame!==K.constraintFrame){K.updateFromModel(M);K.constraintFrame=M.constraintFrame}K.updateModelToViewTransform(O.modelToViewTransform);L.toggleClass("wsp-appearance-active",!!M.isHighlight);L.toggleClass("wsp-appearance-pressed",!!M.inClick);L.toggleClass("wsp-appearance-drag",!!M.isDragging&&M.selectable);L.toggleClass("wsp-appearance-short",L.outerHeight()<28);L.toggleClass("wsp-appearance-unselectable",!M.selectable);L.css("opacity","");var N=L.css("opacity");N=N?parseFloat(N):1;N=isNaN(N)?1:N;L.css({opacity:M.opacity*N});g(".wsp-Button-drag-handle",L).css({"background-color":M["handle-color"]});if(!K.visible){L.show();K.visible=true}}else{L.hide();K.visible=false}}},cleanup:function(M,K,L){g(K.element).remove()}},Point:{prepare:function(M,L){var K={rendered:false,element:g('<div class="wsp-'+L.kind+'" id="'+L.id+'">&#x2b24;</div>')};K.element.css({visibility:"hidden"});return K},draw:function(R,M,O){var N=M.element,L=O.renderable?"visible":"hidden",Q,K,P;if(!M.rendered&&(L==="visible")){P=R.layer;M.rendered=true;g(P).append(N)}if(M.rendered){N.css({visibility:L})}if(O.renderable){Q=N.width();K=N.height();N.css({left:O.cx-(Q/2),top:O.cy-(K/2),color:O.color})}},cleanup:function(M,K,L){K.element.remove()}}}}}());y.Locale=(function(){return{current:null,locales:{}}})();y.Strings=(function(){return{format:function(D,G){var H=D,E,F=G.length;if(H&&F){for(E=0;E<F;++E){H=H.replace("%@",G[E])}}return H},fmt:function(D){var E=Array.prototype.slice.call(arguments,1);return y.Strings.format(D,E)},loc:function(E){var D=Array.prototype.slice.call(arguments,1),F=y.Locale.current&&y.Locale.current[E];if(F){F=y.Strings.format(F,D)}else{if(F==null){y.signalErrorWithMessage("Localized string "+E+" not found.","GSP.Error.localeStringNotFound");F=E}}return F}}})();y.Locale.locales.en={"GSP.Error.incompatibleSketchVersion":"Web Sketchpad version '%@' cannot load a document created for version '%@'.","GSP.Error.invalidSketchVersion":"Cannot compare WSP version '%@' with sketch version '%@'.","GSP.Error.invalidSketch":"The specified sketch appears to be empty or invalid.","GSP.Error.invalidSwitchPage":"The page requested doesn't exist.","GSP.Error.loadSketchFailed":"An error occurred when loading the sketch.","GSP.Error.invalidDocDelta":"The document delta could not be applied.","GSP.Error.invalidSketchDelta":"The sketch delta could not be applied.","GSP.Error.invalidGeomBounds":"Invalid geom bounds for object: %@ (%@)","GSP.Error.constraintException":"Error constraining object: %@ (%@)","GSP.Error.destroyObjectException":"Exception destroying object ('%@' (%@)): %@","GSP.Error.touchStartException":"Exception in Sketch.handleTouchStart (touch.identifier='%@')","GSP.Error.touchMoveException":"Exception in Sketch.handleTouchMove (touch.identifier='%@')","GSP.Error.touchEndException":"Exception in Sketch.handleTouchEnd (touch.identifier='%@')","GSP.Error.renderBoundsException":"Exception rendering object bounds ('%@' (%@))","GSP.Error.renderObjectException":"Exception rendering object ('%@' (%@)): %@","GSP.Error.renderLabelException":"Exception rendering object label ('%@' (%@)): %@","GSP.Error.renderPrepareException":"Exception in renderPrepare ('%@' (%@)): %@","GSP.Error.renderCleanupException":"Exception in renderCleanup ('%@' (%@)): %@","GSP.Error.invalidSketchStart":"Sketch.start called for running sketch","GSP.Error.invalidSketchResume":"Sketch.resume called for running sketch","GSP.Error.invalidSketchStop":"Sketch.stop called for stopped sketch","GSP.Measure.arcLength":"Length"};y.Locale.current=y.Locale.locales.en;y.Genus=(function(){return{}}());y.genera.Path=y.makeClass(y.Genus,{genus:"Path",mapPositionToPathValue:function(D){throw y.createError("mapPositionToPathValue not Implemented")},mapPathValueToPosition:function(D){throw y.createError("mapPathValueToPosition not Implemented")},mapVectorPathValuesToPositions:function(E){var G,D=E.length,F=[];for(G=0;G<D;G++){F[G]=this.mapPathValueToPosition(E[G])}return F},getAnimationRange:function(){return{min:0,max:1}},unitLength:function(){return this.pathLength()},constrainRange:function(D){return D},isValueInBounds:function(D){return y.math.isFiniteScalar(D)},pathLength:function(){throw y.createError("pathLength not Implemented")},constrainLabel:function(){var D=this.style.label,E=this.state,F=D.labelParam;if(typeof F==="undefined"){F=0.5}if(E.exists&&D.showLabel){this.labelSpec.location=this.mapPathValueToPosition(F);this.labelSpec.text=this.label||this.text||this.id}},setLineDash:function(D){var F,E=D.width||1;switch(this.style["line-style"]){case"dashed":F=Math.round(8*(1+(E-1)/4));D.lineDash=[F,6];break;case"dotted":D.lineDash=[E,Math.max(2,Math.round(1.2*E))];break;default:D.lineDash=[]}return D},openMotionPathProto:{advance:function(F){var E=this.start,D=this.path.unitLength(),G=F/D;if(this.start<this.end){E=Math.min(this.end,this.start+G)}else{if(this.end<this.start){E=Math.max(this.end,this.start-G)}}return E},getDistance:function(){return Math.abs(this.end-this.start)*this.path.pathLength()}},closedMotionPathProto:{getArcLength:function(){var D=this.end-this.start;if(D>0.5){D-=1}if(D<-0.5){D+=1}return D},advance:function(G){var E=this.start,D=this.path.pathLength(),H=G/D,F=this.getArcLength();if(Math.abs(F)<H){E=this.end}else{if(F<0){E=E-H}else{E=E+H}}E-=Math.floor(E);return E},getDistance:function(){return Math.abs(this.getArcLength())*this.path.pathLength()}},makeMotionPath:function(F,D){var E=Object.create(this.closedPath?this.closedMotionPathProto:this.openMotionPathProto);E.path=this;E.start=F;E.end=D;return E},pathValidationString:function(D){var K="",J,I,H=D.zeroPosition,G=D.middlePosition,E=D.onePosition;J=this.mapPathValueToPosition(0);function F(O,M){var L=(O&&O.isDefined()&&O.isFinite()),N=(M&&M.isDefined()&&M.isFinite());if(L&&N){return y.GeometricPoint.expect(O,M)}else{return L===N}}I=H?y.GeometricPoint(H.x,H.y):y.GeometricPoint.UNDEFINED;if(!F(J,I)){K+='Zero Path Position: <span class="error">'+J+'</span>(<span class="expected">'+I+"</span>)"}J=this.mapPathValueToPosition(0.5);I=G?y.GeometricPoint(G.x,G.y):y.GeometricPoint.UNDEFINED;if(!F(J,I)){K+='Middle Path Position: <span class="error">'+J+'</span>(<span class="expected">'+I+"</span>)"}J=this.mapPathValueToPosition(1);I=E?y.GeometricPoint(E.x,E.y):y.GeometricPoint.UNDEFINED;if(!F(J,I)){K+='One Path Position: <span class="error">'+J+'</span>(<span class="expected">'+I+"</span>)"}return K}});y.genera.Point=(function(){var D=Object.create(y.Genus);return D}());y.genera.Interior=y.makeClass(y.Genus,{genus:"Interior",modifyRenderAttrsForInterior:function(D){switch(this.state.renderState){case"speculative":D.color=y.speculativeColor;break;case"targetHighlit":D.drawBorder=true;D.borderColor=y.targetHighlightColor;D.borderWidth=3+y.targetHighlightPathBolding;break;default:break}}});y.mixins.labelBase={doc:{properties:{label:{description:"Text for the label, if any.",type:"String"},style:{properties:{label:{description:"Properties that influence the appearance of a Label. Overrides of the GObject style, and as follows.",properties:{color:{description:"The color of label text",type:"Color"},"font-family":{description:"The basis font family for text in this GObject. See GSP.getFontFamilyFromStyle() for supported formats.",type:"FontFamily"},"font-size":{description:"The basis font size for text in this GObject",type:"FontSize"},"font-style":{description:"The basis font style (slant) for text in this GObject",type:"FontStyle"},"font-weight":{description:"The basis font weight (boldness) for text in this GObject",type:"FontWeight"},labelOffsetX:{description:"Horizontal offset of the upper left corner of the label, in pixels.",type:"Number",required:false},labelOffsetY:{description:"Vertical offset of the upper left corner of the label, in pixels.",type:"Number",required:false},labelParam:{description:"Position on the path where a label will be placed.",type:"Number",required:false},"letter-spacing":{description:"The basis font letter spacing for text in this GObject",type:"LetterSpacing"},showLabel:{description:"Whether or not a label should accompany the gObject.",type:"Boolean"},"text-decoration":{description:"line-through, underlines, and other variations on the label text",type:"TextDecoration"}}}}}}},style:{label:{}}};y.mixins.label=y.makeClass(y.mixins.labelBase,{getLabelSpec:function(){return !g.isEmptyObject(this.labelSpec)?this.labelSpec:h},getLabelBounds:function(D){return this.labelRenderBounds||y.Geom.kInfiniteRect},renderLabelPrepare:function(G,F){if(!this.hasLabel){return}var E=y.getFontFamilyFromStyle(this.style.label,this.sQuery()),D=this.style.label;F.id=String(this.id)+"-label";F.kind="Label";F.color=D.color;F["font-family"]=E;F["font-style"]=D["font-style"];F["font-weight"]=D["font-weight"];F["font-size"]=D["font-size"];F["text-decoration"]=D["text-decoration"];F["text-align"]="left";return G.prepareText(F)},renderLabel:function(F,H,D){if(!this.hasLabel){return}var J=this.style.label,I=this.labelSpec.location||this.geom.loc,G=this.isRenderable()&&this.style.label.showLabel,E=G?"visible":"hidden",N=this.getMathItalicization(),M,L;if(G){M=I.x+J.labelOffsetX;L=I.y+J.labelOffsetY}if(G&&!this.parsedMFS){try{if(this.label){this.parsedMFS=y.labels.parseLabelExpression(this.label,N)}else{this.parsedMFS=this.getNameMFSForLabel()}}catch(K){K.message='Error parsing label: "'+this.label+'": '+K.message;y.signalCaughtError(K)}}F.drawText(H,{x:M,y:L,renderable:G,visibility:E,opacity:this.calculateFadeOpacity(),parsedMFS:this.parsedMFS,label:this.label,useDrawImage:false,constraintFrame:this.state.constraintFrame});if(G){this.labelRenderBounds=H.renderBounds}},renderLabelCleanup:function(E,D){E.cleanupText(D)}});y.mixins.transformable={doc:{},getTransform:function(){return function(D){return D.copy()}},getScalarTransform:function(){return function(D){return D}},getTransformer:function(){if(!this.state.transformer){this.state.transformer=this.getParent("source").createTransformer(this)}return this.state.transformer}};y.createFloatVector=function(D){if(D>0){return l.Float64Array?new Float64Array(D):new Array(D)}else{return[]}};y.mixins.vector={doc:{},createVectorContext:function(E,D,F){throw y.createError("createVectorContext not Implemented")},resetVectorSamples:function(D){D.geomBounds=null;D.filledSampleCount=0},fillSingleSample:function(E,D){throw y.createError("fillSingleSample not Implemented")},getGeomBoundsVector:function(D){return{left:Number.NEGATIVE_INFINITY,top:Number.NEGATIVE_INFINITY,right:Number.POSITIVE_INFINITY,bottom:Number.POSITIVE_INFINITY}},hitTestVector:function(E,D){throw y.createError("hitTestVector not Implemented")},getVectorRenderingLayer:function(D){throw y.createError("getVectorRenderingLayer not Implemented")},renderVector:function(H,D,E,G,F){throw y.createError("renderVector not Implemented")},prepareVectorRendering:function(F,E,D){throw y.createError("prepareVectorRendering not Implemented")},cleanupVectorRendering:function(E,D){throw y.createError("cleanupVectorRendering not Implemented")},positionToPathValueForVector:function(E,D){y.signalErrorWithMessage("path API called on a non-path object vector")},pathLengthForVector:function(D){y.signalErrorWithMessage("path API called on a non-path object vector")}};y.mixins.pointVector=y.makeClass(y.mixins.vector,{doc:{},createVectorContext:function(E,D,F){return{numSamples:E,samples:y.createFloatVector(E*2),colors:F?[]:null,lineWidth:D.style.width,radius:D.style.radius||4,endpointRadius:D.style.endpointRadius,arrowheadRadius:D.style.arrowheadRadius,closedPath:D.closedPath,isContinuous:true,isDiscrete:(D.kind==="IterateImage")?true:D.isDiscrete,discontinuities:[]}},fillSingleSample:function(F,D){var E=2*D;F.filledSampleCount++;if(this.state.exists){F.samples[E]=this.geom.loc.x;F.samples[E+1]=this.geom.loc.y;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRectPoint(F.geomBounds,this.geom.loc)}else{F.samples[E]=h;F.samples[E+1]=h}},getGeomForSample:function(F,D){var E=2*D;return{loc:y.GeometricPoint(F.samples[E],F.samples[E+1])}},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=Math.max(D,E.lineWidth/2)}if(E.radius){D=Math.max(D,E.radius)}if(E.endpointRadius){D=Math.max(D,E.endpointRadius)}if(E.arrowheadRadius){D=Math.max(D,E.arrowheadRadius)}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(G,F){function E(){var L,K=G.filledSampleCount,I=2,J=G.samples,H=G.radius||G.lineWidth/2;for(L=0;L<K;L++){var M={left:J[L*I]-H,right:J[L*I]+H,top:J[L*I+1]-H,bottom:J[L*I+1]+H};if(!(M.right<F.left||M.left>F.right||M.bottom<F.top||M.top>F.bottom)){return true}}return false}function D(){var M,L=G.filledSampleCount*2,O,J=G.samples,N=y.GeometricPoint(J[0],J[1]),I=G.discontinuities,K,H;K=N;if(y.Geom.PointInRect(K,F)){return true}for(M=2,O=1;M<L;M+=2,O++){H=y.GeometricPoint(J[M],J[M+1]);if(y.Geom.PointInRect(H,F)){return true}if(!I[O]&&K.isFinite()&&H.isFinite()&&y.Geom.SegmentSectsRect(F,K,H)){return true}K=H}if(G.closedPath&&!I[O]&&K.isFinite()&&N.isFinite()&&y.Geom.SegmentSectsRect(F,K,N)){return true}}if(G.isDiscrete){return E()}else{return D()}},getVectorRenderingLayer:function(D){if(D.isDiscrete){return"DiscretePointVectors"}else{return"LinesCurves"}},prepareVectorRendering:function(F,E,D){if(E.isDiscrete){return F.prepareDiscretePointVector(D)}else{return F.prepareContinuousPointVector(D)}},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.numSamples=H.filledSampleCount;G.radius=H.radius;if(H.isDiscrete){return I.drawDiscretePointVector(D,G)}else{G.discontinuities=H.discontinuities;G.closedPath=H.closedPath;G.width=F.width||1;return I.drawContinuousPointVector(D,G)}},cleanupVectorRendering:function(F,D,E){if(E.isDiscrete){return F.cleanupDiscretePointVector(D)}else{return F.cleanupContinuousPointVector(D)}},positionToPathValueForVector:function(G,M){var L=G.samples,K=G.numSamples,I=G.closedPath,N=I?K:K-1,E,J;function D(){var R,O,Q,T,S,P;for(R=0;R<K;R++){if(!(y.math.isFiniteScalar(L[R*2])&&y.math.isFiniteScalar(L[R*2+1]))){continue}T=L[R*2]-M.x;S=L[R*2+1]-M.y;O=T*T+S*S;if((Q===h)||(O<Q)){Q=O;P=R}}return{point:y.GeometricPoint(L[P*2],L[P*2+1]),index:P}}function F(R,Q){var P=R.getX()-Q.getX(),O=R.getY()-Q.getY();return P*P+O*O}function H(aa){var R=E.point,U=E.index,S=G.discontinuities,Q=1/N,Z,ac,Y,ab,X,T,O,W,P,V;O=M.subtract(aa);if(U>0){Z=(U-1)*2;P=U}else{if(I){Z=(K-1)*2;P=G.numSamples}}if((Z!==h)&&(!S[P])){Y=y.GeometricPoint(L[Z],L[Z+1]);if(Y.isFinite()){Y=Y.subtract(R)}else{Y=h}}if(U<(K-1)){ac=(U+1)*2;P=U+1}else{if(I){ac=0;P=K}}if((ac!==h)&&(!S[P])){ab=y.GeometricPoint(L[ac],L[ac+1]);if(ab.isFinite()){ab=ab.subtract(R)}else{ab=h}}if(ab&&Y){if(F(ab,O)<F(Y,O)){X=true}else{T=true}}else{if(ab){X=true}else{if(Y){T=true}}}if(X){W=ab.vLength2();if(W){V=ab.dot(O)/ab.vLength2();V=Math.min(Math.max(0,V),1)}}else{if(T){W=Y.vLength2();if(W){V=-Y.dot(O)/Y.vLength2();V=Math.min(Math.max(-1,V),0)}}}V=V?V:0;return V*Q}E=D();J=(E.index/N)+H(E.point);if(J<0){J+=1}return J},pathLengthForVector:function(D){var J=0,E,I=D.samples,G=D.numSamples,L,K,H=I[0],F=I[1],N,M;for(E=1;E<G;E++){L=I[2*E];K=I[2*E+1];if(!(y.math.isFiniteScalar(L)&&y.math.isFiniteScalar(K))){continue}N=L-H;M=K-F;J+=Math.sqrt(N*N+M*M);H=L;F=K}return J},isDiscontinuous:function(N,L,K,J){var E=N<0?-N:N,D=L<0?-L:L,H=K<0?-K:K,F=J<0?-J:J,M=25;if(!(((E>M)&&((N>0&&K<=0)||(N<0&&K>=0)||(H>0&&(H*8)<E)))||((D>M)&&((L>0&&J<=0)||(L<0&&J>=0)||(F>0&&(F*8)<D))))){return false}if(((H!==0)&&(E>10*H))||((F!==0)&&(D>10*F))){return true}if((H===0)&&(F===0)){return true}var I=N*K+L*J,G=L*K-N*J;G=G<0?-G:G;return(I<0)||(3*G>5*I)},recomputeDiscontinuities:function(G){if(G.isDiscrete){return}var J=G.samples,I=G.numSamples,H=[],L,K,R,Q,E,D,P,O,F,N,M=false;for(F=0;F<I;++F){L=J[2*F];K=J[2*F+1];N=!(isNaN(L)||isNaN(K));if(N){if(M){R=L-E;Q=K-D;if(this.isDiscontinuous(R,Q,P,O)){H[F]="discontinuous"}else{H[F]=false;if((H[F-1]!=="nonexisting")&&!this.isDiscontinuous(P,O,R,Q)){H[F-1]=false}else{H[F-1]="discontinuous"}}P=R;O=Q}else{P=0;O=0}M=true;E=L;D=K}else{H[F]="nonexisting";M=false;P=0;O=0}}if(G.closedPath){L=J[0];K=J[1];if(!(isNaN(L)||isNaN(K))&&M){R=L-E;Q=K-D;H[F]=this.isDiscontinuous(R,Q,P,O)}}G.discontinuities=H}});y.mixins.circleVector=y.makeClass(y.mixins.vector,{doc:{},createVectorContext:function(E,D,G){var F=(this.kind==="CircleInterior");return{numSamples:E,samples:y.createFloatVector(E*3),colors:G?[]:null,isInterior:F,lineWidth:F?h:D.style.width}},fillSingleSample:function(F,D){var E=3*D;F.filledSampleCount++;F.samples[E]=this.geom.c.x;F.samples[E+1]=this.geom.c.y;F.samples[E+2]=this.geom.r;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRects(F.geomBounds,y.Geom.insetRect({left:this.geom.c.x,top:this.geom.c.y,right:this.geom.c.x,bottom:this.geom.c.y},-this.geom.r))},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(J,O){var H,D=3,N=J.samples,K=J.filledSampleCount,M=J.isInterior,E,L,G,F,I;for(H=0;H<K;H++){E=H*D;G=N[E];F=N[E+1];I=N[E+2];L=y.GeometricPoint(G,F);if(y.Geom.RectIntersectsCurve(O,{type:M?"circleInterior":"circle",curve:y.GeometricArc.FromCenterAndRadius(L,I)})){return true}}return false},getVectorRenderingLayer:function(D){return D.isInterior?"ExternalImagesAndInteriors":"LineLoci"},prepareVectorRendering:function(F,E,D){return F.prepareCircleVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.isInterior=H.isInterior;G.numSamples=H.filledSampleCount;return I.drawCircleVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupCircleVector(D)}});y.mixins.arcVector=y.makeClass(y.mixins.vector,{doc:{},createVectorContext:function(E,D,G){var F;switch(this.genus){case"SimpleArc":F="arc";break;case"ArcSector":F="arcSector";break;case"ArcSegment":F="arcSegment";break}return{numSamples:E,samples:y.createFloatVector(E*y.GeometricArc.packedSampleSize),colors:G?[]:null,lineWidth:D.style.width,isInterior:(this.genus!=="SimpleArc"),type:F}},fillSingleSample:function(F,D){var E=this.geom.arc;E.packIntoSampleArray(F.samples,D);F.filledSampleCount++;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRects(F.geomBounds,this.getGeomBounds())},getGeomBoundsVector:function(E){var D=1.5;if(E.geomBounds){if(E.lineWidth){D+=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(J,I){var G,F,E=J.samples,D=J.filledSampleCount,H=J.type;for(G=0;G<D;G++){F=y.GeometricArc.FromPackedSampleArray(E,G);if(y.Geom.RectIntersectsCurve(I,{type:H,curve:F})){return true}}return false},getVectorRenderingLayer:function(D){return D.isInterior?"ExternalImagesAndInteriors":"LineLoci"},prepareVectorRendering:function(F,E,D){return F.prepareArcVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.arcType=H.type;G.numSamples=H.filledSampleCount;return I.drawArcVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupArcVector(D)}});y.TouchManager=(function(){var D={};return{registerTouchWithTracker:function(F,E){D[F]=E},trackerForTouch:function(E){return D[E]},deregisterTouch:function(E){D[E]=h}}}());y.TouchRegime=(function(){return{createTracker:function(E,D){throw y.createError("Unimplemented required method: createTracker")},hitSlopForTouch:function(D){return(D.mouseEvent!==h)?5:15}}}());y.TouchTracker={forwardTouchToSystem:false,touchBegan:function(D){},touchMoved:function(D){},touchEnded:function(){},touchCancelled:function(D){}};y.DisplayRegime=(function(){function D(H){try{if(r.activeElement){if(r.activeElement.nodeName.toLowerCase()!=="body"){g(r.activeElement).blur()}var G=y.getConfigValue("NumberpadManager.delegates.blurAllNumberpads");G(H)}}catch(F){}}var E=y.makeClass(y.TouchRegime,{sketch:null,createTracker:function(K,J){var H,F,G,I=true;H=this.hitSlopForTouch(K);F=this.sketch.hitGObj({left:J.x-H,top:J.y-H,bottom:J.y+H,right:J.x+H},{hotSpot:J});if(F.customTracker&&F.customTracker.forwardTouchToSystem){I=false}if(I){D(this.sketch.baseNode)}G=F.hitGObj;if(G){return F.customTracker||y.DragTracker.create(G)}else{return this.sketch.Scroll.createTracker()}}});return{createInSketch:function(G){var F=Object.create(E);F.sketch=G;return F}}}());y.DragTracker=(function(){var F=null;function D(L){var I,H=this.controlList,K=this.tracker.sketch,J=this.tracker.motionId;if(L){I=new y.AffineTransform({m00:1,m11:1,m20:L.transform.dx,m21:L.transform.dy});K.MotionManager.ApplyTransformToControlList(K,I,H,{snapPoints:true,onPathTracksIdealLoc:true});K.MotionManager.UpdateRefCon(J,null)}}function E(){var H=this;g.each(this.controlList,function(I,J){if(J.isController){J.gobj.transformComplete(J.gobj.sQuery.sketch,H.tracker);J.gobj.sQuery.sketch.invalidateGeom(J.gobj)}})}var G=y.makeClass(y.TouchTracker,{gobj:null,origX:null,origY:null,lastX:null,lastY:null,sketch:null,startTime:null,motionId:null,touchBegan:function(K,J){this.origX=this.lastX=K.x;this.origY=this.lastY=K.y;this.startTime=new Date().getTime();if(F&&F.endTime&&!F.maybeDouble&&(F.endTime-F.startTime<500)&&(this.startTime-F.endTime<500)){this.maybeDouble=true}F=this;var I=this.bap.createControlList([this.gobj]);var H={applyMotion:D,completeMotion:E,controlList:I,tracker:this};this.motionId=this.motionManager.StartMotion(H);this.sketch.event("StartDrag",{gobj:this.gobj,position:K,touch:J});this.sketch.invalidateGeom(this.gobj);this.gobj.dragDidStart()},touchMoved:function(L,K){var J={transform:{dx:L.x-this.lastX,dy:L.y-this.lastY},x:L.x,y:L.y},I=this.motionId,H=this.motionManager.GetRefCon(I);if(H){J.transform.dx+=H.transform.dx;J.transform.dy+=H.transform.dy}this.motionManager.UpdateRefCon(I,J);this.sketch.event("MoveDrag",{gobj:this.gobj,position:L,touch:K});this.lastX=L.x;this.lastY=L.y},touchEnded:function(H){this.sketch.event("EndDrag",{gobj:this.gobj,touch:H});this.motionManager.EndMotion(this.motionId);this.sketch.invalidateGeom(this.gobj);this.gobj.dragDidEnd();this.endTime=new Date().getTime();if(this.maybeDouble&&(this.endTime-this.startTime<500)){this.gobj.doubleClicked(this.element,H);F=null}}});return{create:function(J,I){var H=Object.create(G);var K=J.sQuery.sketch;H.gobj=J;H.sketch=K;H.bap=K.Bap;H.motionManager=K.MotionManager;H.element=I;return H}}}());y.ToolRegime=(function(){function H(M,L,N,K){var J,I={hotSpot:N,gobjArray:L};J=M.hitGObj({left:N.x-K,top:N.y-K,bottom:N.y+K,right:N.x+K},I);return J?J.hitGObj:null}function G(I){return I.isOfKind("Circle")||I.isOfKind("Straight")||I.isOfKind("Arc")}function D(Z,L,O,Q,X){if(!G(L)){return}var P,M={hotSpot:Q,gobjArray:O.filter(function(ab){return ab!==L}),filter:G};P=Z.hitGObj({left:Q.x-X,top:Q.y-X,bottom:Q.y+X,right:Q.x+X},M);var K=P.hitGObj;if(K){var S=L.isOfKind("Straight");var T=K.isOfKind("Straight");var W=S?L:L.getGeometricArc();var N=T?K:K.getGeometricArc();var V=S||(W.orientation===0);var aa=T||(N.orientation===0);var J,U,R,Y,I;if(V){if(aa){J=y.Geom.LineLineIntersection(W,N)}else{Y=true;U=y.Geom.CircleStraightIntersection(N,W)}}else{if(aa){U=y.Geom.CircleStraightIntersection(W,N)}else{U=y.Geom.CircleCircleIntersection(W,N)}}if(U){if(U[0]&&(Q.distance(U[0])<=X)){J=U[0]}else{if(U[1]&&(Q.distance(U[1])<=X)){J=U[1];R=true}}}if(J&&J.isFinite()){if(S&&T){I="Intersection"}else{if(R){I="Intersection2"}else{I="Intersection1"}}return{path1:Y?K:L,path2:Y?L:K,location:J,constraint:I}}}}var F=y.makeClass(y.TouchTracker,{touchBegan:function(N){var M=this.session.sketch,L,I,J,K;L=H(M,this.unmatchedGivens,N,this.hitSlop);if(L){this.unmatchedGivens.splice(this.unmatchedGivens.indexOf(L),1);J=y.Tool.createMatchedGiven(L);this.session.matchedGivens.push(J)}else{K=this.session.matchedGivens.map(function(O){return O.given});I=H(M,K,N,this.hitSlop);if(I){J=this.session.matchedGivens[K.indexOf(I)]}}if(!J){return}this.matchedGiven=J;this.mergeCandidateList=this.session.getLegalMatchesForGiven(J.given,this.mergeCandidateList);this.dragTracker=y.DragTracker.create(J.given);this.dragTracker.touchBegan(J.given.geom.loc);this.touchMoved(N)},touchMoved:function(N){if(!this.matchedGiven){return}var M=this.session.sketch,I,L,J,K=y.GeometricPoint(N.x,N.y);I=H(M,this.mergeCandidateList,N,this.hitSlop);if(I&&I.isOfGenus("Path")){L=D(M,I,this.mergeCandidateList,K,this.hitSlop)}if(L){this.matchedGiven.setIntersectInfo(L)}else{this.matchedGiven.setMergeCandidate(I)}J=this.matchedGiven.getSnappedPosition(K);if(J){this.dragTracker.touchMoved(J)}},touchEnded:function(){if(!this.matchedGiven){return}if(this.dragTracker){this.dragTracker.touchEnded()}this.matchedGiven.completeMatch();if(this.unmatchedGivens.length===0){this.session.sketch.confirmActiveTool()}}});var E=y.makeClass(y.TouchRegime,{createTracker:function(J){var I=Object.create(F);I.session=this.toolplaySession;I.unmatchedGivens=this.sharedUnmatchedGivens;I.mergeCandidateList=this.sharedMergeCandidateList;I.hitSlop=this.hitSlopForTouch(J);return I}});return{createWithTool:function(O,K){var N=K.createSession(O),L=O.gobjList.renderList.slice(),P,I,M=[];do{P=N.getNextGiven();if(P){I=N.playGiven(P,P.geom.loc,true);M.push(I);I.setRenderState("unmatchedGiven");I.invalidateGeom()}}while(P);var J=Object.create(E);J.toolplaySession=N;J.sharedUnmatchedGivens=M;J.sharedMergeCandidateList=L;return J}}}());y.BackClickRegime=(function(){function G(H){return H.isOfKind("Expression")||H.isOfKind("Measure")}function F(M,O,N,L){var I,K,H={hotSpot:N,filter:function J(Q){function P(R){if(Q===R){return false}if(R.children===h||R.children.length===0){return true}for(K=0;K<R.children.length;K++){if(!P(R.children[K])){return false}}return true}if(!G(Q)){return false}return P(O)}};I=M.hitGObj({left:N.x-L,top:N.y-L,bottom:N.y+L,right:N.x+L},H);return I?I.hitGObj:null}var E=y.makeClass(y.TouchTracker,{touchBegan:function(K){var I=this.regime.sketch,J=this.regime.editor.gobj,H=F(I,J,K,this.hitSlop);if(H){this.regime.editor.insertParent(H)}else{this.forwardTouchToSystem=true}},touchMoved:function(H){},touchEnded:function(){}});var D=y.makeClass(y.TouchRegime,{createTracker:function(I){var H=Object.create(E);H.regime=this;H.hitSlop=this.hitSlopForTouch(I);return H}});return{createWithEditor:function(I){var H=Object.create(D);H.editor=I;H.sketch=I.gobj.sQuery.sketch;return H}}}());y.gObjects.Kind={doc:{description:"All Kinds have the following properties.",refspec:{},supported:true,properties:{kind:{description:"Kind of GObject.",required:true,type:"Name"},constraint:{description:"Name of constraint governing geometry of the GObject.",required:true,type:"Name"},genus:{description:"Genus of GObject",required:true,type:"Name"},toolRole:{description:"If this object is part of a tool, it may have a special role during playback(such as 'given' or 'assumed').",required:false,type:"String"},label:{description:"Text that may be used to name an object. Not required to be unique.",required:false,type:"String"},style:{description:"Properties that influence the appearance of a GObject. Generally, these properties do not affect the placement of the object in the plane, nor the placement of other, dependent, objects.",properties:{color:{description:"Foreground color of the GObject.",type:"Color",required:false},hidden:{description:"Whether the GObject is hidden.",type:"Boolean"},selectable:{description:"Whether the GObject is draggable.",type:"Boolean"},"text-align":{description:"The basis alignment (left, center, right) with respect to the text's bounding box for the text in this GObject.",type:"TextAlign"},traced:{description:"Whether the GObject should be traced.",type:"Boolean",required:false}}},description:{description:"a description of the role of the gobject in the sketch.",required:false,type:"String"}}},prepareToSerialize:function(){},toSpecObj:function(){var F=this;function E(J){var I={};g.each(J,function(L,K){I[L]=K.id});return I}function D(J,K){var I={};g.each(J,function(L,M){if(K[L]!==M){if(typeof M==="object"){I[L]=g.extend(true,{},M)}else{I[L]=M}}});return I}function G(K,J){var L=F.createDefaultStyle(),I;I=D(K,L);g.each(I,function(M){var N;if(J.hasOwnProperty(M)){N=J[M];if(N.suppressed){delete I[M]}}});if(K.label){I.label=D(K.label,L.label);if(g.isEmptyObject(I.label)){delete I.label}}if(g.isEmptyObject(I)){return}return I}function H(K,J){var I={};g.each(K,function(L,M){var N;if(J.hasOwnProperty(L)){N=J[L];if(N.suppressed){return}if((N["default"]!==h)&&(N["default"]===M)){return}if(L==="parents"){I[L]=E(M)}else{if(L==="style"){I[L]=G(M,N.properties)}else{if(L==="autostart"){I[L]=false}else{if(N.properties){I[L]=H(M,N.properties)}else{if(typeof M==="string"){I[L]=M}else{if(typeof M==="number"){I[L]=M}else{if(typeof M==="boolean"){I[L]=M}else{if(N.type==="Array"){I[L]=M.slice()}else{y.log("Omitted "+L)}}}}}}}}}});return I}return H(this,this.doc.properties)},toString:function(){function D(J,H){var E=[],G,F,I,K;for(G in J){if(J.hasOwnProperty(G)){K=H[G];I=J[G];if(typeof K!=="undefined"){F='"'+G+'":';if(K.properties){E.push(F+D(I,K.properties))}else{if(typeof I==="string"){E.push(F+'"'+I+'"')}else{if(typeof I==="number"){E.push(F+I)}else{if(typeof I==="boolean"){E.push(F+I)}}}}}}}return"{"+E.join()+"}"}return D(this,this.doc.properties)},kind:"kind",constraint:"constraint",genus:"genus",style:{hidden:false,selectable:true,"text-align":"center"},state:{exists:true,selectable:true,constraintFrame:0,supported:true},hasLabel:false,children:[],geom:{},labelSpec:{},getMathItalicization:function(){var E=this.sQuery.sketch.preferences,F=E&&E.text,D=F&&F.mathItalicization;return D},createDefaultStyle:function(){var G=this.getColorableComponent(),F=this.getTextType(),D=this.sQuery.sketch.preferences,E;E=g.extend(true,{},y.gobjPrototype(this.kind,this.constraint).style);if(G){g.extend(true,E,D.colorableComponents[G])}if(this.hasLabel){if(!E.label){E.label={}}g.extend(true,E.label,D.text.textTypes.Label)}if(F){g.extend(true,E,D.text.textTypes[F])}return E},doPostReadFromSpec:function m(){var D=this.createDefaultStyle();this.style=g.extend(true,D,this.style)},kindSupportsSpecObj:function(){return true},init:function x(){this.initKind();this.initConstraint();this.updateConstraintAncestry();this.updateLabel()},initKind:function j(){this.needsRenderInit=true},updateLabel:function(){this.updateLabelForKind();this.updateLabelForConstraint()},updateLabelForKind:function e(){},graphHasChanged:function(){this.updateConstraintAncestry();this.updateLabel();this.invalidateGeom()},descendentGraphHasChanged:function(){this.graphHasChanged();this.eachDescendant(function(){this.graphHasChanged()})},onLoad:function(E,D){},onUnload:function(D){},doubleClicked:function(){},isOfKind:function(D){return(D===this.kind)||(this.baseKinds&&(this.baseKinds.indexOf(D)>=0))},isOfGenus:function(D){return(D===this.genus)||(this.baseGenera&&(this.baseGenera.indexOf(D)>=0))},eachParent:function(H,E){var F,G,D;if(!this.parentsList||!this.parentsList.length){return this}if(E){for(F=this.parentsList.length-1;F>=0;F--){G=this.parentsList[F];D=H.call(G,F,G);if(D===false){break}}}else{for(F=0;F<this.parentsList.length;F++){G=this.parentsList[F];D=H.call(G,F,G);if(D===false){break}}}return this},eachChild:function(H,E){var F,G,D;if(!this.children||!this.children.length){return this}if(E){for(F=this.children.length-1;F>=0;F--){G=this.children[F];D=H.call(G,F,G);if(D===false){break}}}else{for(F=0;F<this.children.length;F++){G=this.children[F];D=H.call(G,F,G);if(D===false){break}}}return this},eachDescendant:function(J){var I={},G=this.sQuery.sketch.gobjList.constraintList,H,F,E;function D(){I[this.id]=true}this.eachChild(D);for(F=0;F<G.length;F++){H=G[F];if(I[H.id]){E=J.call(H,F,H);if(E===false){break}H.eachChild(D)}}return this},hasDescendant:function(D){var E=false;this.eachDescendant(function(F){if(F===D){E=true;return false}});return E},checkParentsExist:function(){var E,F,D=true;for(E=0;E<this.parentsList.length;E++){F=this.parentsList[E];if(F.state&&!F.state.exists){D=false;break}}this.state.exists=D;return D},initializeClone:function(D){if(!D){D=this.sQuery().get(this.id)}if(D.geom){this.geom={};y.GeomTransformer.copyGeom(D.geom,this.geom)}if(D.style){this.style=Object.create(D.style)}this.state={};this.state.exists=D.state.exists;this.state.supported=D.state.supported},invalidateAppearance:function(){this.sQuery.sketch.invalidateAppearance(this)},invalidateGeom:function(){this.sQuery.sketch.invalidateGeom(this)},getColorableComponent:function(){return h},getTextType:function(){return h},isRenderable:function(){return !this.style.hidden&&this.state.exists},isHittable:function(){return this.style.selectable&&this.isRenderable()},renderPrepare:function(E,D){return h},render:function(F,D,E){throw y.createError("Capability not implemented(render): id="+this.id)},renderCleanup:function(E,D){},calculateFadeOpacity:function(){var D=1;if(this.state.fade!==h){D*=(1-this.state.fade)}return D},calculateOpacity:function(){var D=this.style.opacity;if(h===D){D=1}D*=this.calculateFadeOpacity();return D},getGeomBounds:function(D){if(this.state.exists){return{left:Number.NEGATIVE_INFINITY,top:Number.NEGATIVE_INFINITY,right:Number.POSITIVE_INFINITY,bottom:Number.POSITIVE_INFINITY}}},getSignificantBounds:function(E){var D=this.getGeomBounds(E);if(!y.Geom.isFiniteRect(D)){D=null}return D},hitTest:function(E,D){throw y.createError("Capability not implemented(hitTest): id="+this.id)},dragDidStart:function(){this.state.isDragging=true},dragDidEnd:function(){this.state.isDragging=false},transform:function(E,D){throw y.createError("Capability not implemented(transform): id="+this.id)},transformComplete:function(E,D){},createTransformer:function(D){return new y.GeomTransformer({distance:D.getScalarTransform(),point:D.getTransform()})},destroy:function(){},hide:function(){this.style.hidden=true;this.invalidateGeom()},show:function(){this.style.hidden=false;this.invalidateGeom()},toggleDisplay:function(){this.style.hidden=!this.style.hidden;this.invalidateGeom()},beginPulsing:function(){},stopPulsing:function(){},setRenderState:function(D){if(this.state.renderState==="unmatchedGiven"){this.stopPulsing()}this.state.renderState=D;if(D==="unmatchedGiven"){this.beginPulsing()}this.invalidateAppearance()},modifyRenderAttrsForCurrentState:function(D){switch(this.state.renderState){case"speculative":D.color=y.speculativeColor;break;case"targetHighlit":D.color=y.targetHighlightColor;if(this.isOfGenus("Path")){D.width+=y.targetHighlightPathBolding}break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},getAutoplacementMetrics:function(){if(this.autoplacementType){return y.AutoplacementMetrics[this.autoplacementType]}},getMFSAppearanceForVariant:function(D){return D==="byLabel"?this.getNameMFSForLabel():this.getNameMFS()},getNameMFSForLabel:function(){return this.getNameMFS()},getStrippedMFSAppearanceForVariant:function(D){var F=this.getMFSAppearanceForVariant(D);if(F===null){return null}y.mfs.walkNode(F,"style",function E(G){G.value=G.value.filter(function(H){return(H.code!=="fontFamily"&&H.code!=="fontSize")})});return F},getLabelMFS:function(){var D=this.getMathItalicization();if(this.label){return y.labels.parseLabelExpression(this.label,D)}else{if(this.style&&this.style.label&&(this.style.label.text!==h)){return y.labels.parseLabelExpression(this.style.label.text,D)}}return null},getNameMFS:function(){return this.getLabelMFS()||this.getParentalNameMFS()},getGObjRef:function(D){return this.sQuery.sketch.gobjList.gobjects[D]},getParent:function(D){return this.parents[D]},testConsistency:function(E,G,D){var F=(G===D)||(G==null&&D==null);if(!F&&((typeof G==="number")&&(typeof D==="number"))){F=y.math.expect(G,D)}return !F?E+': <span class="error">'+G+'</span> (<span class="expected">'+D+"</span>)":""},verificationString:function(E,D){var G="";G+=this.testConsistency("exists",this.state.exists,E.exists);if(this.constraintVerificationString){G+=this.constraintVerificationString(E)}function F(K){var H,I="",J="",L="";if(K.debug&&K.debug.controlList){H=K.sQuery.sketch.Bap.createControlList([K]);J=y.ControlList.toString(K.debug.controlList);L=y.ControlList.toString(H)}if(J!==L){I+='bapCheck: <div class="error">'+L+'</div>(<div class="expected">'+J+"</div>)"}return I}if(this.debug&&this.debug.pathPositions){if(this.pathValidationString){G+=this.pathValidationString(this.debug.pathPositions)}else{y.signalErrorWithMessage("GObj verification expects a path object")}}G+=F(this);return G}};y.gObjects.Unknown=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"An unknown object generated as a result of some translation process. Will not be displayed.",inherits:"Kind",refspec:{msg:"A convenience of the design. No reference specification."},properties:{kind:{description:"Kind of GObject.",required:true,type:"Name"}}},kind:"Unknown",hitTest:function(E,D){return false},render:function(F,D,E){},transform:function(E,D){}});y.gObjects.Sampler=(function(){var E=(function(){var J=y.makeClass(y.TouchTracker,{functionPlot:null,dragWhichPoint:"",updateDriverDomain:function(K){this.functionPlot.driverDomain[this.dragWhichPoint]=K;this.functionPlot.rawSamples=null;this.functionPlot.invalidateGeom()},swap:function(){var K=this.functionPlot.driverDomain,L=K.low;K.low=K.high;K.high=L;this.dragWhichPoint=(this.dragWhichPoint==="low")?"high":"low"},shouldSwap:function(L){var K=this.functionPlot.driverDomain;return(this.dragWhichPoint==="low"&&L>K.high)||(this.dragWhichPoint==="high"&&L<K.low)},getAnchorNode:function(){return this.functionPlot.sQuery.sketch.anchorNode},touchBegan:function(){if(this.functionPlot.getFunctionType()==="XofY_FunctionExprType"){this.getAnchorNode().css({cursor:"ns-resize"})}else{this.getAnchorNode().css({cursor:"ew-resize"})}},touchEnded:function(){this.getAnchorNode().css({cursor:"default"})},touchMoved:function(N){var L=this.functionPlot.getParent("coordSys");var M=L.locatePoint(y.GeometricPoint(N.x,N.y));var K=(this.functionPlot.getFunctionType()==="XofY_FunctionExprType")?"y":"x";if(this.shouldSwap(M[K])){this.swap()}this.updateDriverDomain(M[K])}});return{create:function(M,L){var K=Object.create(J);K.functionPlot=M;K.dragWhichPoint=L;return K}}}());return y.makeClass([y.gObjects.Kind,y.mixins.label,y.genera.Path],{doc:{description:"A collection made by sampling some geometric or numeric function",inherits:"Kind",refspec:{gspKindRef:"SamplerKind"},usage:{},supported:true,properties:{numSamples:{description:"The number of samples of the underlying object",type:"Number"},driverDomain:{description:"The lower bound when sampling with a numeric driver",properties:{low:{description:"The lower bound of the domain when sampling",type:"Number"},high:{description:"The upper bound of the domain when sampling",type:"Number"}}},isDiscrete:{description:"For a point-based sampler, whether or not to connect the samples as a continuous path.",type:"Boolean"},showEndpoints:{description:"Whether to display endpoints/arrowheads of the locus",type:"Boolean"},style:{description:"Properties that influence the appearance of a GObject. Accepts style properties appropriate for the 'drivenObject' as well.",properties:{endpointRadius:{description:"",type:"Number",required:false},arrowheadRadius:{description:"",type:"Number",required:false}},regex:/^[a-zA-Z0-9-_]+$/}}},kind:"Sampler",hasLabel:true,state:{},renderPrepare:function(K,J){J.kind=this.kind;J.id=this.id;if(this.sampleGObj().prepareVectorRendering){return this.sampleGObj().prepareVectorRendering(K,this.vectorContext,J)}},renderCleanup:function(K,J){if(this.sampleGObj().cleanupVectorRendering){return this.sampleGObj().cleanupVectorRendering(K,J,this.vectorContext)}},render:function(N,J,K){var M,L={leftEndpoint:null,rightEndpoint:null,radius:this.style.radius,renderable:this.isRenderable(),opacity:this.calculateOpacity()};if(this.state.mergeTarget){L.width=this.style.width+y.targetHighlightPathBolding;L.color=y.targetHighlightColor}else{if(this.state.speculative){L.width=this.style.width;L.color=y.speculativeColor}else{L.width=this.style.width;L.color=this.style.color}}if(this.showEndpoints){M=this.getParent("domainObject");if(M&&!M.closedPath){switch(M.genus){case"Segment":case"SimpleArc":L.leftEndpoint="endpoint";L.rightEndpoint="endpoint";L.endpointRadius=this.style.endpointRadius;break;case"Ray":case"Bisector":L.leftEndpoint="endpoint";L.rightEndpoint="arrowhead";L.endpointRadius=this.style.endpointRadius;L.arrowheadRadius=this.style.arrowheadRadius;break;default:L.leftEndpoint="arrowhead";L.rightEndpoint="arrowhead";L.arrowheadRadius=this.style.arrowheadRadius}}if(!M){L.leftEndpoint="arrowhead";L.rightEndpoint="arrowhead";L.arrowheadRadius=this.style.arrowheadRadius}}L=this.setLineDash(L,L.width);if(this.sampleGObj().renderVector){return this.sampleGObj().renderVector(N,J,K,this.vectorContext,L)}},getColorableComponent:function(){if(this.constraint==="FunctionPlot"){return"Plot"}else{return"PointLocus"}},getGeomBounds:function(J){if(this.sampleGObj().getGeomBoundsVector){return this.sampleGObj().getGeomBoundsVector(this.vectorContext,J)}},hitTest:function(N,L,O){var K=this;function J(){var P=K;function Q(S){var R=P.samplerPathValueToPosition(P.driverDomain[S]);if(y.Geom.PointInRect(R,N)){return E.create(P,S)}else{return false}}if(P.plottingInfo.polar){return false}else{return Q("high")||Q("low")||false}}function M(){if(K.sampleGObj().hitTestVector){return K.sampleGObj().hitTestVector(K.vectorContext,N,O)}}if(this.constraint==="FunctionPlot"){return J()||M()}else{return M()}},transform:function(K,J){},getRenderingLayer:function(){var J=this.sampleGObj&&this.sampleGObj();return J&&J.getVectorRenderingLayer?J.getVectorRenderingLayer(this.vectorContext):"NeverVisible"},initializeClone:function D(J){(D.base||arguments.callee.base).call(this,J);this.init()},mapPathValueToPosition:function I(J){if(this.samplerPathValueToPosition){return this.samplerPathValueToPosition(J)}y.signalErrorWithMessage("This sampler constraint does not implement the path API")},mapPositionToPathValue:function F(J){if(this.samplerPositionToPathValue){return this.samplerPositionToPathValue(J)}y.signalErrorWithMessage("This sampler constraint does not implement the path API")},constrainRange:function(L){if(this.samplerConstrainRange){return this.samplerConstrainRange(L)}var K=L,J=0,M=1;if(L>M){K=M}if(L<J){K=J}return K},isValueInBounds:function(J){if(this.samplerIsValueInBounds){return this.samplerIsValueInBounds(J)}return((J>=0)&&(J<=1))},constrainLabel:function G(){(G.base||arguments.callee.base).call(this)},pathLength:function(){if(this.samplerPathLength){return this.samplerPathLength()}},verificationString:function H(M,L){var Q=H.base.call(this,M,L),K=this.sampleGObj();if(this.state.exists&&M.exists&&K.getGeomForSample){var P=K.getGeomForSample(this.vectorContext,0),N=K.getGeomForSample(this.vectorContext,this.numSamples-1),O,J;if(M.firstSamplePoint!=="nonexisting"){O=y.GeometricPoint(M.firstSamplePoint.x,M.firstSamplePoint.y);if(!y.GeometricPoint.expect(P.loc,O)){Q+='firstSample: <span class="error">'+P.loc+'</span>(<span class="expected">'+O+"</span>)"}}if(M.lastSamplePoint!=="nonexisting"){J=y.GeometricPoint(M.lastSamplePoint.x,M.lastSamplePoint.y);if(!y.GeometricPoint.expect(N.loc,J)){Q+='lastSample: <span class="error">'+N.loc+'</span>(<span class="expected">'+J+"</span>)"}}}return Q}})}());y.gObjects.Map=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"A Map.",inherits:"Kind",refspec:{gspKindRef:"MapKind"},supported:true,usage:{},properties:{rerandomizePointsOnPaths:{description:"",required:false,type:"Boolean"},finalIterationOnly:{description:"",required:false,type:"Boolean"}}},kind:"Map",style:{},state:{},hasLabel:false,initializeClone:function v(D){(v.base||arguments.callee.base).call(this,D);this.init()},geom:{},getGeomBounds:function(){return},getColorableComponent:function(){return""},isHittable:function(){return false},hitTest:function(E,D){},render:function(F,D,E){},getRenderingLayer:function(){return"NeverVisible"},testConsistency:function t(E,F,D){return(E==="exists")?"":(t.base||arguments.callee.base).call(this)}});y.gObjects.IterateImage=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"",refspec:{gspRef:"IterateImageKind"},supported:true,properties:{description:{description:"a description of the role of the gobject in the sketch.",required:false,type:"String"},style:{description:"Properties that influence the appearance of a GObject. Accepts style properties appropriate for the 'source' as well.",regex:/^[a-zA-Z0-9-_]+$/}}},kind:"IterateImage",clonedGObj:h,initializeSampleBuffer:function(){var H=this.getParent("map"),G=this.clonedGObj,F=0;function E(L,M){var J,K,I;if(M===1){return L}else{I=0;J=M;for(K=0;K<L;K++){I+=J;J*=M}}return I}if(H.currentDepth){F=H.finalIterationOnly?Math.pow(H.numMaps,H.currentDepth):E(H.currentDepth,H.numMaps)}try{this.vectorContext=G.createVectorContext(F,this,G.constraintChangesColor)}catch(D){y.log("Object "+G.id+" failed to create vector context: "+D);this.state.exists=false}this.numSamples=F},getNameMFS:function A(){var D=(A.base||arguments.callee.base).call(this);return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Iterated Image "),D)},initializeClone:function v(D){(v.base||arguments.callee.base).call(this,D);this.init()},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;if(this.clonedGObj.prepareVectorRendering){return this.clonedGObj.prepareVectorRendering(E,this.vectorContext,D)}},renderCleanup:function(E,D){if(this.clonedGObj.cleanupVectorRendering){return this.clonedGObj.cleanupVectorRendering(E,D,this.vectorContext)}},render:function(G,D,E){var F={hidden:this.style.hidden,width:this.style.width,color:this.style.color,radius:this.style.radius,opacity:this.calculateOpacity(),renderable:true,constraintFrame:this.state.constraintFrame};this.modifyRenderAttrsForCurrentState(F);if(this.clonedGObj.renderVector){return this.clonedGObj.renderVector(G,D,E,this.vectorContext,F)}},getGeomBounds:function(D){if(this.clonedGObj.getGeomBoundsVector){return this.clonedGObj.getGeomBoundsVector(this.vectorContext,D)}},hitTest:function(E,D,F){if(this.clonedGObj.hitTestVector){return this.clonedGObj.hitTestVector(this.vectorContext,E,F)}},transform:function(E,D){},curSampleNum:0,clearSamples:function(){this.curSampleNum=0;this.terminalSampleIndex=h;if(this.clonedGObj.resetVectorSamples){this.clonedGObj.resetVectorSamples(this.vectorContext)}},sampleCountChanged:function(){this.initializeSampleBuffer()},collectSample:function(){if(this.clonedGObj.fillSingleSample&&this.clonedGObj.state.exists){this.clonedGObj.fillSingleSample(this.vectorContext,this.curSampleNum);this.curSampleNum++}},stampTerminalSample:function(){this.terminalSampleIndex=this.curSampleNum-1},getRenderingLayer:function(){var D=this.clonedGObj;return D.getVectorRenderingLayer?D.getVectorRenderingLayer(this.vectorContext):"NeverVisible"},getTerminalGeom:function(){var E=this.curSampleNum-1;var F=this.getParent("source");var D={};if(F.state.exists&&(this.terminalSampleIndex===-1)){y.GeomTransformer.copyGeom(F.geom,D);return D}if(this.clonedGObj.getGeomForSample&&(this.terminalSampleIndex===E)){return this.clonedGObj.getGeomForSample(this.vectorContext,this.terminalSampleIndex)}return null},verificationString:function(E,D){var F="";return F}});y.gObjects.Button=y.makeClass([y.gObjects.Kind,y.mixins.labelBase],(function(){var E=y.makeClass(y.TouchTracker,{sketch:null,button:null,touchBegan:function(){this.button.state.inClick=++this.button.state.inClick||1;this.sketch.invalidateGeom(this.button)},touchEnded:function(){this.button.state.inClick=--this.button.state.inClick;this.sketch.invalidateGeom(this.button);if(this.button.state.inClick<0){throw y.createError("ButtonPressTracker: press count went negative!  Should be impossible")}if(this.button.state.inClick===0){this.sketch.event("PressButton",{gobj:this.button},{buttonType:this.button.constraint});this.button.press(this.sketch)}}});function G(I){var H=Object.create(E);H.sketch=I.sQuery.sketch;H.button=I;return H}return{doc:{description:"A control that initiates some action.",inherits:"Kind",refspec:{gspKindRef:"ActionKind",msg:"Buttons have the appearance defined by their host browser. The appearance of buttons is meant to be familiar to browser users."},defaultConstraint:"ActionButton",existenceRule:"Exists regardless of existence of parent.",usage:{},properties:{geom:{description:"The basic geometry of the GObject",properties:{loc:{description:"The position of the GObject",properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"}}}}},style:{description:"",properties:{autostart:{description:"Whether the button should be executed at sketch start time.",type:"Boolean"},color:{description:"The background color. Text color is described by the label.color property.",type:"Color"},"highlight-color":{description:"",type:"Color",required:false},label:{properties:{showLabel:{description:"The label for a button is the text on the button. It's always shown, so the value of showLabel is ignored.",required:false}}}}}}},kind:"Button",style:{autostart:false},state:{isActive:false},autoplacementType:"Button",createDefaultStyle:function D(){var J=this.getColorableComponent(),H=this.sQuery.sketch.preferences,I=(D.base||arguments.callee.base).call(this);if(J&&H.colorableComponents[J].color){I.color=H.colorableComponents[J].color}return I},doPostReadFromSpec:function F(){(F.base||arguments.callee.base).call(this);this.geom.loc=y.GeometricPoint(this.geom.loc.x,this.geom.loc.y)},onLoad:function(I,H){if(this.style.autostart&&!H){this.press(I)}this.state.firstTime=false},getColorableComponent:function(){return"ActionButton"},getTextType:function(){return"Action"},modifyRenderAttrsForCurrentState:function(H){switch(this.state.renderState){case"speculative":H.opacity=y.speculativeOpacity;break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},renderPrepare:function(K,J){var I=this.style.label||{},H=y.getFontFamilyFromStyle(I,this.sQuery());J.id=this.id;J.kind=this.kind;J.color=I.color||this.style.color;J["background-color"]=this.style.color;J["font-family"]=H;J["font-style"]=I["font-style"];J["font-weight"]=I["font-weight"];J["font-size"]=I["font-size"];J["text-decoration"]=I["text-decoration"];J["text-align"]="left";J["vertical-align"]="top";J["highlight-color"]=this.style["highlight-color"];return K.prepareButton(J)},renderCleanup:function(I,H){I.cleanupButton(H)},render:function(J,L,H){var P=0,O=0,K=this.isRenderable(),I=K?"visible":"hidden",N=L,Q={visibility:I,constraintFrame:this.state.constraintFrame};if(K){P=this.geom.loc.getX();if(isNaN(P)){P=0}O=this.geom.loc.getY();if(isNaN(O)){O=0}Q.x=P;Q.y=O;if(this.oldText!==this.label){try{this.parsedMFS=y.labels.parseLabelExpression(this.label,false)}catch(M){M.message="On Button "+this.id+": "+M.message;y.signalCaughtError(M)}Q.text=this.label;Q.parsedMFS=this.parsedMFS;this.oldText=this.label}Q.isHighlight=this.state.isActive;Q.inClick=this.state.inClick;Q.isDragging=this.state.isDragging;Q.selectable=this.style.selectable;Q["handle-color"]=this.style.color;Q.opacity=this.calculateOpacity()}this.modifyRenderAttrsForCurrentState(Q);J.drawButton(N,Q)},checkParentsExist:function(){return true},isHittable:function(){return this.isRenderable()},hitTest:function(N,J,L){var I=L,P,O,H,K=false,M=false;if(I){P={left:this.geom.loc.getX(),top:this.geom.loc.getY(),width:I.width(),height:I.height()};O={left:P.left,right:P.left+P.width,top:P.top,bottom:P.top+P.height};if(J){K=(J.x>=O.left)&&(J.x<=O.right)&&(J.y>=O.top)&&(J.y<=O.bottom);if(K){O.right=P.left+I.dragHandleWidth();M=(J.x<=O.right)}}else{H={left:Math.max(N.left,O.left),right:Math.min(N.right,O.right),top:Math.max(N.top,O.top),bottom:Math.min(N.bottom,O.bottom)};K=(H.left<H.right&&H.top<H.bottom)}}if(M&&this.style.selectable){return true}if(K){return G(this)}return false},getGeomBounds:function(I){function H(J,L){var K={left:J.getX(),top:J.getY(),width:L.width(),height:L.height()};if(L.attrs&&(L.attrs["text-align"]==="center")){K.left-=K.width/2}if(L.attrs&&(L.attrs["vertical-align"]==="middle")){K.top-=K.height/2}return{left:K.left,right:K.left+K.width,top:K.top,bottom:K.top+K.height}}return I&&H(this.geom.loc,I)},transform:function(I,H){this.geom.loc=H.geom.loc.copy();H.affine.transform(this.geom.loc)},updateLabel:function(){}}}()));y.gObjects.Circle=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.circleVector,y.genera.Path],{doc:{description:"The curve describing the limits of a circle.",inherits:"Kind",refspec:{gspKindRef:"CircleKind"},usage:{},properties:{style:{description:"",properties:{"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false},width:{description:"The width of the curve line in pixels.",type:"Number"}}}}},kind:"Circle",style:{hidden:false,width:3,selectable:true},hasLabel:true,geom:{},getGeometricArc:function(){if(!this.state.constraintCache){this.state.constraintCache={}}if(!this.state.constraintCache.arc){this.state.constraintCache.arc=y.GeometricArc.FromCenterAndRadius(this.geom.c,this.geom.r)}return this.state.constraintCache.arc},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.c=y.GeometricPoint.ORIGIN;this.geom.r=0},getColorableComponent:function(){return"Curves"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareCircle(D)},renderCleanup:function(E,D){return E.cleanupCircle(D)},render:function(J,E,G){var I=this.isRenderable();var D=-100,K=-100,H=-100;if(I){D=Number(this.geom.c.x);if(isNaN(D)){D=0}K=Number(this.geom.c.y);if(isNaN(K)){K=0}H=Number(this.geom.r);if(isNaN(H)){H=0}}var F={renderable:I,cx:D,cy:K,r:H,color:this.style.color,width:this.style.width,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(F);this.setLineDash(F);J.drawCircle(E,F)},getGeomBounds:function(){var D,E=this.style.width/2||1.5;if(this.state.exists){D=y.Geom.insetRect({left:this.geom.c.x,top:this.geom.c.y,right:this.geom.c.x,bottom:this.geom.c.y},-this.geom.r-E)}return D},hitTest:function(E,D){return y.Geom.RectIntersectsCurve(E,{type:"circle",curve:y.GeometricArc.FromCenterAndRadius(this.geom.c,this.geom.r)})},transform:function(E,D){},createTransformer:function(D){var E=D.getTransform(),F=D.getScalarTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(G,H){H.c=E(G.c);H.r=F(G.r)}}},mapPositionToPathValue:function(F){var G=F.subtract(this.geom.c);var E=Math.atan2(-G.getY(),G.getX());var D=(E/(2*Math.PI));if(D<0){D+=1}return D},mapPathValueToPosition:function(F){var E=F*2*Math.PI,D=y.GeometricPoint(Math.cos(E),-Math.sin(E));return this.geom.c.add(D.multiply(this.geom.r))},getAnimationRange:function(){return{min:0,max:1-(1e-7)}},area:function(){return Math.PI*this.geom.r*this.geom.r},circumference:function(){return 2*Math.PI*this.geom.r},pathLength:function(){return this.circumference()},radius:function(){return this.geom.r},closedPath:true,verificationString:function f(F,D){var G=(f.base||arguments.callee.base).call(this,F,D),H,E;if(G===""&&this.state.exists){H=y.GeometricPoint(F.c.x,F.c.y);E=F.r;if(!y.GeometricPoint.expect(H,this.geom.c)){G+='center: <span class="error">'+this.geom.c+'</span>(<span class="expected">'+H+"</span>)"}if(!y.math.expect(E,this.geom.r)){G+='radius: <span class="error">'+this.geom.r+'</span>(<span class="expected">'+E+"</span>)"}}return G}});y.gObjects.Picture=y.makeClass([y.gObjects.Kind,y.Genus,y.mixins.vector],(function(){function D(N,M,L,J){var I,H,O,K;I=L.transform(y.GeometricPoint(0,M.height));H=L.transform(y.GeometricPoint(0,0));O=L.transform(y.GeometricPoint(M.width,0));K=y.Geom.ParallelogramSectsRect(N,I,H,O);if(K&&J){K=y.Geom.RectSectsPolygon(N,J)}return K}return{doc:{description:"An Image.",inherits:"Kind",refspec:{gspKindRef:"PictureKind",msg:"An embedded picture"},usage:{},properties:{image:{description:"The source image of the picture",required:false,type:"Image"},style:{description:"",properties:{layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)","default":"0.5",type:"Number"}}}}},kind:"Picture",style:{opacity:0.5},state:{},doPostReadFromSpec:function G(){(G.base||arguments.callee.base).call(this);if(this.geom.transform){this.geom.transform=y.AffineTransform(this.geom.transform)}},getColorableComponent:function(){return"Picture"},modifyRenderAttrsForCurrentState:function(H){switch(this.state.renderState){case"speculative":H.opacity=y.speculativeOpacity;break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},renderPrepare:function(I,H){H.kind=this.kind;H.id=this.id;H.image=this.getImage();H.onStateChange=(function(J){return function(){J.sQuery().invalidateGeom(J)}}(this));return I.preparePicture(H)},renderCleanup:function(I,H){return I.cleanupPicture(H)},render:function(K,H,J){var I={renderable:this.isRenderable(),transform:this.geom.transform,opacity:this.calculateOpacity(),clipPolygon:this.geom.clipVertices};this.modifyRenderAttrsForCurrentState(I);K.drawPicture(H,I)},getGeomBounds:function(){var H,K=[],I,J={};if(!this.state.exists){return}H=this.getImage();if(!H){return}I=this.geom.transform;K.push(I.transform(y.GeometricPoint(0,H.height)));K.push(I.transform(y.GeometricPoint(0,0)));K.push(I.transform(y.GeometricPoint(H.width,0)));K.push(I.transform(y.GeometricPoint(H.width,H.height)));g.each(K,function(M,L){if((J.left===h)||L.x<J.left){J.left=L.x}if((J.right===h)||L.x>J.right){J.right=L.x}if((J.top===h)||L.y<J.top){J.top=L.y}if((J.bottom===h)||L.y>J.bottom){J.bottom=L.y}});return y.Geom.insetRect(J,-1)},hitTest:function(J,I,K){var H=this.getImage();return D(J,H,this.geom.transform,this.geom.clipVertices)},transform:function(I,H){this.geom.transform=H.geom.transform.compose(H.affine)},constrainLabel:function(){},getImage:function(){if((this.image==null)&&this.parents&&this.parents.source){return this.getParent("source").getImage()}return(typeof(this.image)==="number")?this.sQuery().getResource("pictures",this.image):this.image},verificationString:function F(J,I){var K=(F.base||arguments.callee.base).call(this,J,I),H=this;if(K===""&&this.state.exists){g.each(y.AffineTransform.KeyNames,function(){if(h!==J[this]&&!y.math.expect(H.geom.transform[this],J[this])){K+=this+': <span class="error">'+H.geom.transform[this]+'</span>(<span class="expected">'+J[this]+"</span>)"}})}return K},createVectorContext:function(J,I,K){var H={numSamples:J,parentSampler:I,samples:y.createFloatVector(J*y.AffineTransform.packedSampleSize)};if(this.geom.clipVertices){H.clipVerticesArray=[]}return H},fillSingleSample:function(J,H){var I=this.geom.transform;J.filledSampleCount++;I.packIntoSampleArray(J.samples,H);if(this.geom.clipVertices){J.clipVerticesArray[H]=this.geom.clipVertices}J.geomBounds=y.Geom.unionRects(J.geomBounds,this.getGeomBounds())},getNameMFS:function E(){var I=(E.base||arguments.callee.base).call(this);var H=this.genus==="Drawing"?"Drawing ":"Picture ";return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(H),I)},getGeomBoundsVector:function(H){return H.geomBounds},hitTestVector:function(O,M){var H=this.getImage(),K,N,J=O.samples,I=O.filledSampleCount;for(var L=0;L<I;++L){K=y.AffineTransform.fromPackedSampleArray(J,L);N=O.clipVerticesArray&&O.clipVerticesArray[L];if(D(M,H,K,N)){return true}}return false},getVectorRenderingLayer:function(H){return"ExternalImagesAndInteriors"},prepareVectorRendering:function(J,I,H){H.kind=this.kind;H.id=this.id;H.image=this.getImage();H.onStateChange=(function(K){return function(){K.sQuery().invalidateGeom(K)}}(I.parentSampler));return J.preparePictureVector(H)},renderVector:function(M,H,J,L,K){var I=g.extend(true,{},K);I.transformSamples=L.samples;I.clipPolygons=L.clipVerticesArray;I.numSamples=L.filledSampleCount;I.renderable=true;M.drawPictureVector(H,I)},cleanupVectorRendering:function(I,H){return I.cleanupPictureVector(H)}}}()));y.gObjects.Point=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.pointVector,y.Genus],{doc:{description:"A location in the Euclidean plane.",inherits:"Kind",refspec:{gspKindRef:"PointKind"},usage:{},properties:{style:{description:"",properties:{color:{description:"Foreground color of the Point.",type:"Color"},"drag-expansion":{description:"The Point expands by this number of pixels when dragged.",type:"Number"},radius:{description:"The radius of the filled circle that represents the Point.",type:"Number"},traced:{description:"Whether the point should be traced.",type:"Boolean"},tracedStyle:{description:"Style overrides for traced appearance.",required:false,properties:{color:{description:"Foreground color of the traced GObject.",type:"Color"},radius:{description:".",type:"Number"}}}}}}},kind:"Point",style:{"drag-expansion":5,hidden:false,label:{showLabel:false},radius:4,selectable:true,traced:false},state:{},hasLabel:true,_oldRadius:null,_pulsingJob:null,beginPulsing:function(){var F=this,G=3000,J=Math.random()*G,H=5,I=F.style.radius,D=F.style["drag-expansion"],K=Math.pow(2,H),E=J+Date.now();F._oldRadius=F.style.radius;F._pulsingJob=F.sQuery.sketch.jobScheduler.addJob(function(){var N=Date.now(),M=(N-E)/G,L=Math.pow(Math.sin(y.math.TWO_PI*M)+1,H)/K;F.style.radius=I+L*D;F.invalidateAppearance()},{repeat:true})},stopPulsing:function(){this.sQuery.sketch.jobScheduler.clearJob(this._pulsingJob);this.style.radius=this._oldRadius;this._oldRadius=null;this._pulsingJob=null},modifyRenderAttrsForCurrentState:function(D){switch(this.state.renderState){case"speculative":D.color=y.speculativeColor;break;case"matchedGiven":case"targetHighlit":D.dropShadow=true;D.radius=this.style.radius+this.style["drag-expansion"];break;case"unmatchedGiven":D.dropShadow=true;break;case"invisible":case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},geom:{loc:{x:0,y:0}},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.loc=y.GeometricPoint(this.geom.loc.x,this.geom.loc.y)},getColorableComponent:function(){return"Points"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.preparePoint(D)},renderCleanup:function(E,D){return E.cleanupPoint(D)},render:function(F,J,E){var G,P,K,H,L,I,Q,M=E.traced?true:false,N=1,O=this.calculateOpacity(),D=this.style;if(this.state.renderState==="invisible"){return}P=D.radius;K=D.color;H=D["drag-expansion"];G=this.isRenderable();if(G){L=this.geom.loc.getX();if(isNaN(L)){L=0}I=this.geom.loc.getY();if(isNaN(I)){I=0}}else{L=I=-100}if(E.drag){P+=H}if(M){P*=0.75;O*=0.5;N=0;D=D.tracedStyle;if(D){if(h!==D.radius){P=D.radius}if(h!==D.color){K=D.color}}}Q={renderable:G,cx:L,cy:I,radius:P,color:K,lineWidth:N,opacity:O};this.modifyRenderAttrsForCurrentState(Q);F.drawPoint(J,Q)},getGeomBounds:function(){var E,F=(this.style.radius+this.style["drag-expansion"]),D={};this.modifyRenderAttrsForCurrentState(D);if(D.dropShadow){F+=10}if(this.state.exists){E=y.Geom.insetRect({left:this.geom.loc.x,top:this.geom.loc.y,right:this.geom.loc.x,bottom:this.geom.loc.y},-F)}return E},constrainLabel:function(){this.labelSpec.location=this.geom.loc;this.labelSpec.text=this.label||this.text||this.style.label.text||this.id},hitTest:function(H,E){var D=this.geom.loc.getX(),I=this.geom.loc.getY(),G=this.style.radius,F={left:D-G,right:D+G,top:I-G,bottom:I+G};return !(F.right<H.left||F.left>H.right||F.bottom<H.top||F.top>H.bottom)},transform:function(E,D){this.geom.loc=D.geom.loc.copy();D.affine.transform(this.geom.loc)},createTransformer:function(D){var E=D.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(F,G){G.loc=E(F.loc)}}},createDefaultSpec:function(I,F){var H=(I.metadata.sketchRect.right-I.metadata.sketchRect.left)/2;var G=(I.metadata.sketchRect.bottom-I.metadata.sketchRect.top)/2;var E=(F&&F.style)||{};var D=(F&&F.label)||"";return{"1":{kind:"Point",genus:"OriginPoint",constraint:"Free",style:E,label:D,geom:{loc:{x:H,y:G}}}}},verificationString:function f(E,D){var F=(f.base||arguments.callee.base).call(this,E,D),G;if(F===""&&this.state.exists){G=y.GeometricPoint(E.loc.x,E.loc.y);if(!y.GeometricPoint.expect(G,this.geom.loc)){F+='loc: <span class="error">'+this.geom.loc+'</span>(<span class="expected">'+G+"</span>)"}}return F}});y.gObjects.Polygon=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.vector,y.genera.Path,y.genera.Interior],{doc:{description:"The planar area bound by connecting a series of points by straight line segments.",inherits:"Kind",refspec:{gspKindRef:"PolygonKind"},usage:{},properties:{style:{description:"",properties:{"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false},width:{description:"Width of the strokes in pixels",type:"Number",required:false},opacity:{description:"0 (transparent) to 1 (fully opaque)",type:"Number"},layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"}}}}},kind:"Polygon",style:{hidden:false,opacity:0.5},state:{},hasLabel:true,getColorableComponent:function(){return"Interior"},modifyRenderAttrsForCurrentState:function(D){this.modifyRenderAttrsForInterior(D)},renderPrepare:function(E,D){return E.preparePolygon({})},renderCleanup:function(E,D){return E.cleanupPolygon(D)},render:function(H,D,F){var G=this.isRenderable(),E={renderable:G,points:this.geom.points,opacity:this.calculateOpacity(),color:this.style.color};this.modifyRenderAttrsForCurrentState(E);H.drawPolygon(D,E)},getNumVertices:function(){var D=this;while(D&&D.parents&&(D.parents.source!==h)){D=D.parents.source}return D.parentsList.length},getGeomBounds:function(){var G={},I,E,H,D,F=(this.style.width||0);if(!this.state.exists){return}g.each(this.geom.points,function(J,K){if(K.x!==h&&K.y!==h){if(I===h||K.x<I){I=K.x}if(H===h||K.y<H){H=K.y}if(E===h||K.x>E){E=K.x}if(D===h||K.y>D){D=K.y}}});if(G.left+G.top===h){return}G.left=I;G.top=H;G.right=E;G.bottom=D;return y.Geom.insetRect(G,-F)},hitTest:function(F,D){var E=this.geom.points;return y.Geom.RectSectsPolygon(F,E)},transform:function(E,D){D.affine.transform(this.geom.points)},createTransformer:function(D){var E=D.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(F,H){var G;if(!H.points){H.points=[]}for(G=0;G<F.points.length;G++){H.points[G]=E(F.points[G])}}}},mapPositionToPathValue:function(G){var O=Infinity,L=0;var K,I,N,D,F,E,J;var M=this.geom.points;var H=0;for(F=0;F<M.length;F+=1){I=M[F];K=M[(F+1)%M.length];N=I.subtract(K);D=N.vLength();E=y.GeometricPoint.mapPointToLine(I,K,G,{returnPoint:true,clampP0:true,clampP1:true});J=E.point.subtract(G).vLength2();if(J<O){L=H+E.param*D;O=J}H+=D}return L/H},mapPathValueToPosition:function(J){var I=this.perimeter();var H,G,K,D,E;var L=this.geom.points;var F=0;if(!this.isValueInBounds(J)){return y.GeometricPoint.UNDEFINED}J=J-Math.floor(J);J*=I;for(E=0;E<L.length;E+=1){G=L[E];H=L[(E+1)%L.length];K=H.subtract(G);D=K.vLength();if(J<F+D){return G.add(K.multiply((J-F)/D))}F+=D}return G},mapPathValueToCharacteristic:function(J){var I=this.perimeter();var H,G,K,D,E;var L=this.geom.points;var F=0;J*=I;for(E=0;E<L.length;E+=1){G=L[E];H=L[(E+1)%L.length];K=H.subtract(G);D=K.vLength();if(J<F+D){return{baseVertex:E,baseValue:(J-F)/D}}F+=D}return{baseVertex:0,baseValue:1}},perimeter:function(){var F,E,I,D;var H=this.geom.points;var G=0;for(D=0;D<H.length;D+=1){E=H[D];F=H[(D+1)%H.length];I=F.subtract(E).vLength();G+=I}return G},pathLength:function(){return this.perimeter()},getAnimationRange:function(){return{min:0,max:1-(1e-7)}},area:function(){var G,F,I,E;var H=this.geom.points;var D=0;for(E=0;E<H.length;E+=1){F=H[E];G=H[(E+1)%H.length];I=(F.x*G.y)-(F.y*G.x);D+=I}return Math.abs(D/2)},closedPath:true,getVertices:function(){return this.geom.points},createVectorContext:function(E,D,G){var F=this.getNumVertices();return{numSamples:E,samples:y.createFloatVector(E*2*F),numVertices:F,colors:G?[]:null}},fillSingleSample:function(I,E){var F,G=I.numVertices,D=I.samples,H=2*E*G;I.filledSampleCount++;for(F=0;F<G;++F){D[H+(F*2)]=this.geom.points[F].x;D[H+(F*2)+1]=this.geom.points[F].y}if(I.colors){I.colors[E]=this.style.color}I.geomBounds=y.Geom.unionRects(I.geomBounds,this.getGeomBounds())},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(H,L){var G=[],E=0,K=H.samples,F,D,J=H.filledSampleCount,I=H.numVertices;for(F=0;F<J;++F){G=[];for(D=0;D<I;++D){G.push(y.GeometricPoint(K[E],K[E+1]));E+=2}if(y.Geom.RectSectsPolygon(L,G)){return true}}return false},getVectorRenderingLayer:function(D){return"ExternalImagesAndInteriors"},prepareVectorRendering:function(F,E,D){return F.preparePolygonVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.numVertices=H.numVertices;G.numSamples=H.filledSampleCount;return I.drawPolygonVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupPolygonVector(D)}});y.gObjects.Straight=y.makeClass([y.gObjects.Kind,y.mixins.label,y.genera.Path,y.mixins.vector],{doc:{description:"Any of the family of straight geometric figures: rays, segments, or lines.",inherits:"Kind",refspec:{gspKindRef:"StraightKind"},usage:{},properties:{style:{description:"",properties:{color:{type:"Color"},width:{description:"Width of the strokes in pixels",type:"Number"},"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false}}},debug:{properties:{p0:{description:"The first reference point defining the straight.",required:false,properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"}}},p1:{description:"The second reference point.",required:false,properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"}}}}}}},kind:"Straight",style:{hidden:false,width:3,"line-style":"solid"},hasLabel:true,geom:{},constrainRange:function(E){var D=E;switch(this.genus){case"Segment":if(E>1){D=1}if(E<0){D=0}break;case"Ray":if(E<0){D=0}break;default:}return D},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.p0=y.GeometricPoint.ORIGIN;this.geom.p1=y.GeometricPoint.ORIGIN},getColorableComponent:function(){return"Straights"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareSegment(D)},renderCleanup:function(E,D){return E.cleanupSegment(D)},render:function(H,J,E){function F(O){var N=Number(O);if(isNaN(O)){N=0}return N}var I=this.isRenderable(),L,K,G,D,M;if(I){L=F(this.geom.xp0.x);K=F(this.geom.xp0.y);G=F(this.geom.xp1.x);D=F(this.geom.xp1.y)}M={renderable:I,p0x:L,p0y:K,p1x:G,p1y:D,width:this.style.width,color:this.style.color,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(M);this.setLineDash(M);H.drawSegment(J,M)},getGeomBounds:function(){var G,K,J,F=this.style.width,I,E,H,D;if(this.state.exists){K=this.mapPathValueToPosition(this.constrainRange(Number.NEGATIVE_INFINITY));J=this.mapPathValueToPosition(this.constrainRange(Number.POSITIVE_INFINITY));K.x=(!isNaN(K.x))?K.x:this.geom.p0.x;K.y=(!isNaN(K.y))?K.y:this.geom.p0.y;J.x=(!isNaN(J.x))?J.x:this.geom.p1.x;J.y=(!isNaN(J.y))?J.y:this.geom.p1.y;I=Math.min(K.x,J.x);E=Math.max(K.x,J.x);H=Math.min(K.y,J.y);D=Math.max(K.y,J.y);G=y.Geom.insetRect({left:I,top:H,right:E,bottom:D},-F);if(!y.Geom.isValidRect(G)){return}}return G},hitTest:function(E,D){return y.Geom.SegmentSectsRect(E,this.geom.xp0,this.geom.xp1)},getSignificantBounds:function(){var E=null,K,J,G=this.style.width,I,F,H,D;if(this.state.exists){K=this.geom.p0;J=this.geom.p1;I=Math.min(K.x,J.x);F=Math.max(K.x,J.x);H=Math.min(K.y,J.y);D=Math.max(K.y,J.y);E=y.Geom.insetRect({left:I,top:H,right:F,bottom:D},-G)}return E},transform:function(E,D){},createTransformer:function(D){var E=D.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(F,G){G.p0=E(F.p0);G.p1=E(F.p1);G.xp0=E(F.xp0);G.xp1=E(F.xp1)}}},getZeroPoint:function(){return this.geom.p0},getUnitPoint:function(){return this.geom.p1},getP0:function(){return this.geom.p0},getP1:function(){return this.geom.p1},mapPositionToPathValue:function(D){return this.constrainRange(this.mapPositionToExtendedPathValue(D))},mapPositionToExtendedPathValue:function(D){return y.GeometricPoint.mapPointToLine(this.getZeroPoint(),this.getUnitPoint(),D).param},mapPathValueToPosition:function(E){var G=this.getZeroPoint(),F=this.getUnitPoint(),D=F.subtract(G);return D.multiply(E).add(G)},mapVectorPathValuesToPositions:function(E){var J=this.getZeroPoint(),H=this.getUnitPoint(),D=H.subtract(J),G,I=E.length,F=[];for(G=0;G<I;G++){F[G]=D.multiply(E[G]).add(J)}return F},getAnimationRange:function(){var K,F,J,E,D,I,G,H=(this.genus==="Ray")||(this.genus==="Bisector");if(this.genus==="Segment"){return{min:0,max:1}}K=this.sQuery.sketch;F=K.sketchRect();J=y.Geom.IntersectionsOfRectAndSegment(F,this.geom.xp0,this.geom.xp1);if(J.length>0){I=this.mapPositionToPathValue(J[0])}if(J.length===2){G=this.mapPositionToPathValue(J[1])}if((J.length===1)&&H){E=0;D=I}else{if(J.length===2){E=Math.min(I,G);D=Math.max(I,G)}else{E=H?0:-1;D=2}}return{min:E,max:D}},unitLength:function(){return this.getUnitPoint().subtract(this.getZeroPoint()).vLength()},pathLength:function(){var D=this.getAnimationRange(),E=this.mapPathValueToPosition(D.min),F=this.mapPathValueToPosition(D.max);return F.subtract(E).vLength()},getPointOnPath:function(D,E){return this.getPointOnLine(D,E)},getPointOnLine:function(E,G){var F,D;F=E.p1.subtract(E.p0);D=F.vLength();return F.multiply(G/D).add(E.p0)},getPointOnRay:function(E,G){var F,D;if(G<=0){return E.p0}else{F=E.p1.subtract(E.p0);D=F.vLength();return F.multiply(G/D).add(E.p0)}},getPointOnSegment:function(E,G){var F,D;if(G<=0){return E.p0}else{F=E.p1.subtract(E.p0);D=F.vLength();if(D<=G){return E.p1}else{return F.multiply(G/D).add(E.p0)}}},getClosestPointOnLine:function(G,F){var E,I,H,D;E=F.subtract(G.p0);I=G.p1.subtract(G.p0);if(!I.isZeroLength()){H=E.dot(I)/I.dot(I);D=I.multiply(H).add(G.p0)}else{D=G.p0}return D},pointIsInBounds:function(F,E){var G,D=(E===h)?1.5e-21:E;if(this.genus==="Segment"||this.genus==="Ray"){G=F.subtract(this.getP0()).vLength2();if(G<D){return true}}if(this.genus==="Segment"){G=F.subtract(this.getP1()).vLength2();if(G<D){return true}}return this.isValueInBounds(this.mapPositionToExtendedPathValue(F))},isValueInBoundsLineGenus:function(D){return true},isValueInBoundsSegmentGenus:function(E){var F=1.000000000000002,D=-2e-15;return(E>=D)&&(E<=F)},isValueInBoundsRayGenus:function(E){var D=-2e-15;return(E>=D)},isValueInBounds:function(E){var D={Bisector:this.isValueInBoundsRayGenus,Line:this.isValueInBoundsLineGenus,Axis:this.isValueInBoundsLineGenus,Parallel:this.isValueInBoundsLineGenus,Perpendicular:this.isValueInBoundsLineGenus,Ray:this.isValueInBoundsRayGenus,Segment:this.isValueInBoundsSegmentGenus}[this.genus];return y.math.isFiniteScalar(E)&&(D)?D.call(this,E):false},createVectorContext:function(E,D,F){return{numSamples:E,samples:y.createFloatVector(E*4),colors:F?[]:null,lineWidth:D.style.width}},fillSingleSample:function(F,D){var E=4*D;F.filledSampleCount++;F.samples[E]=this.geom.xp0.x;F.samples[E+1]=this.geom.xp0.y;F.samples[E+2]=this.geom.xp1.x;F.samples[E+3]=this.geom.xp1.y;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRectPoint(F.geomBounds,this.geom.xp0);F.geomBounds=y.Geom.unionRectPoint(F.geomBounds,this.geom.xp1)},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(G,J){var F,L,K,H=G.filledSampleCount,I=G.samples,D=4,E;for(F=0;F<H;F++){E=D*F;L=y.GeometricPoint(I[E],I[E+1]);K=y.GeometricPoint(I[E+2],I[E+3]);if(y.Geom.SegmentSectsRect(J,L,K)){return true}}return false},getVectorRenderingLayer:function(D){return"LineLoci"},prepareVectorRendering:function(F,E,D){return F.prepareSegmentVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.numSamples=H.filledSampleCount;return I.drawSegmentVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupSegmentVector(D)},closedPath:false,verificationString:function f(E,D){var G=(f.base||arguments.callee.base).call(this,E,D),H,F;if(G===""&&this.state.exists){H=y.GeometricPoint(E.p0.x,E.p0.y);F=y.GeometricPoint(E.p1.x,E.p1.y);if(!y.GeometricPoint.expect(H,this.getP0())||!y.GeometricPoint.expect(F,this.getP1())){G+='geom: <span class="error">'+this.getP0()+" -> "+this.getP1()+'</span>(<span class="expected">'+H+" -> "+F+"</span>)"}}return G}});y.gObjects.Text=y.makeClass([y.gObjects.Kind,y.Genus,y.mixins.vector],(function(){function F(H,J){var I={left:H.getX(),top:H.getY(),width:J.width(),height:J.height()};if(J.attrs&&(J.attrs["text-align"]==="center")){I.left-=I.width/2}if(J.attrs&&(J.attrs["vertical-align"]==="middle")){I.top-=I.height/2}return{left:I.left,right:I.left+I.width,top:I.top,bottom:I.top+I.height}}var E={_prepareCommon:function(K,I){var H=y.getFontFamilyFromStyle(K.style,K.sQuery()),L=K.sQuery().getSketch(),M=L.document.resources["font-family"]||K.sQuery().prefs().fontList;I.kind=K.kind;I.color=K.style.color;I.fontTable=M;I["font-family"]=H;I["font-style"]=K.style["font-style"];I["font-weight"]=K.style["font-weight"];I["font-size"]=K.style["font-size"];I["text-decoration"]=K.style["text-decoration"];I["text-align"]=K.style["text-align"];I["vertical-align"]=K.style["vertical-align"];I.padding=K.style.padding;var J=y.mfs.getLineHeight(I["font-family"],I["font-size"]);if(J){I["line-height"]=J}y.mfs.normalizeFont(H,function(N,O){I[N]=O})},create:function(I,J,H){this._prepareCommon(I,H);H.id=I.id;return J.prepareText(H)},createVector:function(K,N,M,I){var H={},L,O;this._prepareCommon(K,I);H.initialArgs=g.extend(true,{},I);H.sampleRefCons=[];H.parentId=K.id;for(var J=0;J<N.numSamples;J++){L={};O=g.extend(true,{},I);O.id=H.parentId+"vector"+J;L.object=M.prepareText(O);L.visible=true;H.sampleRefCons[J]=L}return H},updateVector:function(O,N,J){var H,M,K,L=J.sampleRefCons.length,I=O.filledSampleCount;for(K=0;K<L;++K){J.sampleRefCons[K].visible=(K<I)}for(K=L;K<I;++K){H={};M=g.extend(true,{},J.initialArgs);M.id=J.parentId+"vector"+K;M.parsedMFS=O.parsedMFSValues[K];H.object=N.prepareText(M);H.visible=true;J.sampleRefCons[K]=H}},cleanupVector:function(K,H){var I,J=(H&&H.sampleRefCons)?H.sampleRefCons.length:0;for(I=0;I<J;++I){K.cleanupText(H.sampleRefCons[I])}}};return{doc:{description:"A displayable message.",inherits:"Kind",refspec:{gspKindRef:"TextKind"},usage:{},properties:{geom:{description:"The basic geometry of the GObject",properties:{loc:{description:"The position of the GObject",properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"}}}}},style:{description:"",properties:{color:{description:"Foreground color of the traced GObject.",type:"Color"},"font-family":{description:"The basis font family for text in this GObject. See GSP.getFontFamilyFromStyle() for supported formats",type:"FontFamily"},"font-size":{description:"The basis font size for text in this GObject",type:"FontSize"},"font-style":{description:"The basis font style (slant) for text in this GObject",type:"FontStyle"},"font-weight":{description:"The basis font weight (boldness) for text in this GObject",type:"FontWeight"},"letter-spacing":{description:"The basis font letter spacing for text in this GObject",type:"LetterSpacing"},"text-decoration":{description:"line-through, underlines, and other variations on the label text",type:"TextDecoration"}}},text:{description:"The message.",required:false,type:"String"},textMFS:{description:"The message formatted as an MFS string.",required:false,type:"String"}}},kind:"Text",style:{"text-align":"left","vertical-align":"top"},state:{},geom:{loc:{x:0,y:0}},autoplacementType:"Measurement",doPostReadFromSpec:function G(){(G.base||G.callee.base).call(this);this.geom.loc=y.GeometricPoint(this.geom.loc.x,this.geom.loc.y)},updateLabelForKind:function D(){(D.base||D.callee.base).call(this);if(this.textMFS){this.parsedMFS=y.mfsParser.parse(this.textMFS)}else{if(this.text){this.parsedMFS=y.mfs.makeTextMFS(this.text)}}},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},getTextType:function(){return"Caption"},beginPulsing:function(){},stopPulsing:function(){},modifyRenderAttrsForCurrentState:function(H){switch(this.state.renderState){case"speculative":H.opacity=y.speculativeOpacity;break;case"targetHighlit":case"matchedGiven":H.targetHighlight=true;break;case"invisible":H.opacity=0;break;case"unmatchedGiven":H.pulse=true;break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},renderPrepare:function(I,H){return E.create(this,I,H)},renderCleanup:function(I,H){I.cleanupText(H)},render:function(J,L,H){var O=0,N=0,K=this.isRenderable(),I=K?"visible":"hidden",M=(this.unitPowers&&this.unitPowers.angle===1&&this.sQuery().prefs().units.angle==="rad")?"rad":"scalar",P={visibility:I,constraintFrame:this.state.constraintFrame,opacity:this.calculateOpacity()};if(this.state.selected){return}if(K){O=this.geom.loc.getX();if(isNaN(O)){O=0}N=this.geom.loc.getY();if(isNaN(N)){N=0}P.x=O;P.y=N;P.parsedMFS=this.parsedMFS;if(typeof this.uValue!=="undefined"){P.MFSValues={value:this.formatNumberAsMFS(this.uValue,this.style.precision,M)};this.uValueLast=this.uValue}if(this.parentMFSValues!==h){P.MFSValues=this.parentMFSValues}if(this.isMultimeasure){P.MFSValues=this.getValuesAsMFS()}}this.modifyRenderAttrsForCurrentState(P);J.drawText(L,P)},determineParentalBlank:function(){var I,H=this.parentsList;if(!H){return false}for(I in H){if(H.hasOwnProperty(I)){if(H[I].blank){return true}}}return false},formatNumberAsMFS:function(L,M,K,Q){var O,I=this;function H(R){var S=6;return Math.log(Math.abs(R))*Math.LOG10E>=S}function N(T,S){var V=Math.abs(T),W=Math.floor(Math.log(V)*Math.LOG10E),X=Math.pow(10,W),R=T/X,U=y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(R.toFixed(S)),{type:"symbol",value:"B4"},{type:"super",value:[y.mfs.makeTextMFS("10"),y.mfs.makeTextMFS(W)]});return U}function J(R){var W,S,T,V,U,X=y.math.getSimplePiFraction(R);if(X){T=X.numerator;S=X.denominator;if(T===0){W=y.mfs.makeTextMFS("0")}else{V=Math.abs(T);if(V===1){U={type:"symbol",value:"70"}}else{U=y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(V),{type:"symbol",value:"70"})}if(S===1){W=U}else{W={type:"fraction",value:[y.mfs.makeHorizontalMFS(U),y.mfs.makeTextMFS(S)]};if(T<0){W=y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("-"),W)}}}}else{W=y.mfs.makeTextMFS(R.toFixed(M))}return W}function P(R){var S;S=I.getUnitsMFS&&I.getUnitsMFS();if(!S){return R}return y.mfs.makeHorizontalMFS(R,S)}if(this.blank){O=y.mfs.makeTextMFS(" ")}else{if(isNaN(L)){O=y.mfs.makeTextMFS("undefined")}else{if(!isFinite(L)){if(L===Number.NEGATIVE_INFINITY){O=y.mfs.makeHorizontalMFS({type:"symbol",value:"103"},{type:"symbol",value:"A5"})}else{O={type:"symbol",value:"A5"}}}else{if(K==="rad"){O=J(L)}else{if(H(L)){O=N(L,M)}else{O=L.toFixed(M);O=O.replace(/^-(0(\.0+)?)$/,"$1");O=y.mfs.makeTextMFS(O.replace("-","\u2212"))}}}}}if(Q){return P(O)}return O},getMFSAppearanceForVariant:function(){if(!this.state.exists){return null}var H=g.extend(true,{},this.parsedMFS);if(this.parentMFSValues!==h){y.mfs.realizeParamNodes(H,this.parentMFSValues)}if(this.isMultimeasure){y.mfs.realizeParamNodes(H,this.getValuesAsMFS())}H=y.mfs.replaceNodes(H,"vertical",y.mfs.flattenVerticalNode);return H},constrainLabel:function(){},hitTest:function(J,H,K){var I=F(this.geom.loc,K);return y.Geom.isIntersectRects(I,J)},getGeomBounds:function(H){return H&&F(this.geom.loc,H)},transform:function(I,H){this.geom.loc=H.geom.loc.copy();H.affine.transform(this.geom.loc)},createTransformer:function(H){var I=H.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(I)},transformGeom:function(J,K){K.loc=I(J.loc)}}},createVectorContext:function(J,I,K){var H={numSamples:J,samples:y.createFloatVector(2*J),parsedMFSValues:[]};if(typeof this.uValue!=="undefined"){H.uValues=[]}return H},fillSingleSample:function(I,H){I.filledSampleCount++;I.samples[H*2]=this.geom.loc.x;I.samples[H*2+1]=this.geom.loc.y;I.parsedMFSValues[H]=this.parsedMFS;if(typeof I.uValues!=="undefined"){I.uValues[H]=this.uValue}},getGeomBoundsVector:function(O,N){if(!O.geomBounds){var L=O.samples,H=N&&N.sampleRefCons,K=O.filledSampleCount,J,I;if(!H||!H.length){return null}for(var M=0;M<K;++M){J=y.GeometricPoint(L[M*2],L[M*2+1]);if(H[M]){I=F(J,H[M].object);O.geomBounds=y.Geom.unionRects(O.geomBounds,I)}}}return O.geomBounds},hitTestVector:function(L,P,O){var N=L.samples,H=O&&O.sampleRefCons,M=L.filledSampleCount,Q,I;if(!H||!H.length){return false}for(var K=0,J=M;K<J;++K){Q=y.GeometricPoint(N[K*2],N[K*2+1]);I=F(Q,H[K].object);if(y.Geom.isIntersectRects(I,P)){return true}}return false},getVectorRenderingLayer:function(H){return"Text"},prepareVectorRendering:function(J,I,H){return E.createVector(this,I,J,H)},renderVector:function(I,L,H,P,Q){var J=L,K=J.sampleRefCons,R,N=!Q.hidden,T=(typeof P.uValues!=="undefined"),O=(T&&this.unitPowers&&this.unitPowers.angle===1&&this.sQuery().prefs().units.angle==="rad")?"rad":"scalar",S={constraintFrame:Q.constraintFrame},M;E.updateVector(P,I,J);R=K?K.length:0;for(M=0;M<R;M++){S.visibility=(N&&K[M].visible)?"visible":"hidden";S.x=P.samples[M*2];S.y=P.samples[M*2+1];S.parsedMFS=P.parsedMFSValues[M];if(T){S.MFSValues={value:this.formatNumberAsMFS(P.uValues[M],this.style.precision,O)}}I.drawText(K[M].object,S)}},cleanupVectorRendering:function(I,H){E.cleanupVector(I,H)}}}()));y.gObjects.Arc=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.arcVector,y.genera.Path],{doc:{description:"",inherits:"Kind",refspec:{gspKindRef:"ArcKind"},usage:{},properties:{style:{description:"",properties:{"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false},width:{description:"The width of the curve line in pixels.",type:"Number"}}}}},kind:"Arc",style:{hidden:false,width:3},hasLabel:true,geom:{},getGeometricArc:function(){return this.geom.arc},radius:function(){return this.geom.arc.radius},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.arc=y.GeometricArc.FromCenterAndRadius(y.GeometricPoint.ORIGIN,0)},getColorableComponent:function(){return"Curves"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareArc(D)},renderCleanup:function(E,D){return E.cleanupArc(D)},render:function(G,D,F){var E={renderable:this.isRenderable(),arc:this.geom.arc,color:this.style.color,width:this.style.width,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(E);this.setLineDash(E);G.drawArc(D,E)},getArcBounds:function(F,G){var E=F.center,D=F.radius,H={};if(F.pointIsInBounds(y.GeometricPoint(E.x+1,E.y))){H.right=E.x+D}else{H.right=Math.max(F.initialPoint.x,F.finalPoint.x)}if(F.pointIsInBounds(y.GeometricPoint(E.x-1,E.y))){H.left=E.x-D}else{H.left=Math.min(F.initialPoint.x,F.finalPoint.x)}if(F.pointIsInBounds(y.GeometricPoint(E.x,E.y-1))){H.top=E.y-D}else{H.top=Math.min(F.initialPoint.y,F.finalPoint.y)}if(F.pointIsInBounds(y.GeometricPoint(E.x,E.y+1))){H.bottom=E.y+D}else{H.bottom=Math.max(F.initialPoint.y,F.finalPoint.y)+G}return y.Geom.insetRect(H,-G)},getGeomBounds:function q(){if(!this.state.exists){return}var D=this.geom.arc,E=this.style.width;return this.getArcBounds(D,E)},hitTest:function(E,D){return y.Geom.RectIntersectsCurve(E,{type:"arc",curve:this.geom.arc})},transform:function(E,D){},mapPositionToPathValue:function(D){return this.geom.arc.mapPositionToPathValue(D,this.genus)},mapPathValueToPosition:function(D){return this.geom.arc.mapPathValueToPosition(D,this.genus)},area:function(){return 0},pathLength:function(){return this.geom.arc.getCache(this.genus).perimeterLength},closedPath:false});(function(){var E=5,ab=3.5,J=2.5*ab,D=27,L=2.5*D,F=1.25,I=500,U=15,V=[{expansionFactor:2,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:4},{expansionFactor:2.5,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:5},{expansionFactor:2,diminishmentFactor:2.5,largeTickInterval:2,largeIntervalsPerText:10}],R=[{expansionFactor:2,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:2},{expansionFactor:2.5,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:2},{expansionFactor:2,diminishmentFactor:2.5,largeTickInterval:2,largeIntervalsPerText:5}],H=[{expansionFactor:2,diminishmentFactor:2,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:3/2,diminishmentFactor:12/6,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:4/3,diminishmentFactor:6/4,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:6/4,diminishmentFactor:4/3,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:12/6,diminishmentFactor:3/2,largeTickInterval:6,largeIntervalsPerText:2}],S={"24":{decimal:{precision:6,smallExponentBound:9.9e-7,largeExponentBound:9999999},trigonometric:{precision:3,smallExponentBound:0.000999,largeExponentBound:9999}},"48":{decimal:{precision:3,smallExponentBound:0.000999,largeExponentBound:9999},trigonometric:{precision:3,smallExponentBound:0.000999,largeExponentBound:9999}}},P=function(ad,ac){if(ad==="trigonometric"){return H}if(ac==="vertical"){return R}return V},Y=function(ah,ag,ac,al,ak){var ad=P(ah,ag),aj=ac,ai=al,ae=ak,af=0;if(ah==="trigonometric"){aj*=Math.PI;ai*=F;ae*=F}if(aj>0){while(aj<ai){aj*=ad[af].expansionFactor;af=(af+1)%ad.length}}while(aj>ae){aj/=ad[af].diminishmentFactor;if(--af<0){af=ad.length-1}}return{pixelsBetweenTicks:aj,largeTickInterval:ad[af].largeTickInterval,largeIntervalsPerText:ad[af].largeIntervalsPerText}};y.gObjects.Axis=y.makeClass([y.gObjects.Straight],{doc:{description:"A one dimensional coordinate line.",inherits:"Straight",refspec:{gspKindRef:"AxisKind"},usage:{},properties:{orientation:{description:"Orientation of the axis: 'horizontal' or 'vertical'.",type:"String"},style:{description:"",properties:{tickNumbering:{description:"Tick mark numbering system: 'decimal' or 'trigonometric'.",type:"String",required:false},tickNumberStyle:{description:"Style of tick numbers: 'auto' for default behavior (show them), 'none' to hide them",type:"String",required:false}}}}},orientation:"horizontal",kind:"Axis",style:{tickNumbering:"decimal",tickNumberStyle:"auto"},geom:{},getColorableComponent:function(){return"Axis"},renderPrepare:function O(ad,ac){return ad.prepareAxis(ac)},renderCleanup:function G(ad,ac){return ad.cleanupAxis(ac)},render:function aa(ah,ad,ae){var ag=this.style["font-size"],ac=this.getTickNumberPrecisionInfo(ag,this.style.tickNumbering),af={renderable:this.isRenderable(),origin:this.geom.origin,orientation:this.orientation,unitPixels:this.getUnitPixels(),isPolar:this.isPolar(),color:this.style.color,"line-style":this.style["line-style"],tickNumbering:this.style.tickNumbering,tickSpacing:this.getTickSpacing(),majorTickLength:E,width:this.style.width,tickNumberStyle:this.style.tickNumberStyle,"font-family":this.style["font-family"],"font-size":ag,precisionInfo:ac,sketchRect:this.sQuery.sketch.sketchRect(),opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(af);this.setLineDash(af);ah.drawAxis(ad,af)},hitTest:function N(ad,ac){return(N.base||arguments.callee.base).call(this,ad,ac)},transform:function T(ad,ac){(T.base||arguments.callee.base).call(this,ad,ac)},getZeroPoint:function(){return this.geom.origin},getUnitPoint:function(){return this.geom.unit},getUnitPixels:function(){return this.orientation==="horizontal"?this.geom.unit.x-this.geom.origin.x:-(this.geom.unit.y-this.geom.origin.y)},isPolar:function(){var ac=0,ae=0;function ad(af){if(af.kind==="CoordSys"){++ac;if(af.shape&&(af.shape==="polar")){++ae}}}this.children.forEach(ad);return(ac>0)&&(ac===ae)},getTickSpacing:function(){return Y(this.style.tickNumbering,this.orientation,this.getUnitPixels(),ab,J)},getLineSpacing:function(){return Y(this.style.tickNumbering,this.orientation,this.getUnitPixels(),D,L)},getPolarSpacing:function(ac){var af=P(this.style.tickNumbering,this.orientation),ae={x:ac.x,y:ac.y},ad=0;if(this.style.tickNumbering==="trigonometric"){ae.x*=Math.PI;ae.y*=Math.PI}while(ae.x*ae.y>I){ae.x/=af[ad].diminishmentFactor;ae.y/=af[ad].diminishmentFactor;if(--ad<0){ad=af.length-1}}if((ae.x>0)&&(ae.y>0)){while((ae.x*ae.y<I)||(ae.x<U)||(ae.y<U)){ae.x*=af[ad].expansionFactor;ae.y*=af[ad].expansionFactor;if(++ad>=af.length){ad=0}}}return{pixelsBetweenTicks:{x:ae.x,y:ae.y},largeTickInterval:af[ad].largeTickInterval,intervalsPerText:af[ad].largeTickInterval*af[ad].largeIntervalsPerText}},getTextType:function(){return"AxisTicksAndOptionalLabel"},getTickNumberPrecisionInfo:function(ae,aj){var ad,ag,af=0,ah=1024;for(ad in S){ag=Number(ad);if((ae<ag)&&(ag<ah)){ah=ag}else{if(af<ag){af=ag}}}if(ah>=1024){ah=af}var ac=ah<1024?S[ah]:null,ai=ac&&ac[aj];return ai},getGeomBounds:function X(){var af=3,ad=0.65,ai=2.5,aj=2,ae=E,al=Math.round(this.style["font-size"]*ad),ag=(this.style.tickNumbering==="trigonometric")?ai:aj,ah=this.getTickNumberPrecisionInfo(al,this.style.tickNumbering),ak=(2+ah.precision)*al,ac=(X.base||arguments.callee.base).call(this);ac=y.Geom.insetRect(ac,-ae);ac.left-=(ak+af);ac.bottom+=(al*ag)+af;return ac},mapPositionToPathValue:function Q(ac){return(Q.base||arguments.callee.base).call(this,ac)},mapPathValueToPosition:function K(ac){return(K.base||arguments.callee.base).call(this,ac)},pathLength:function(){return this.geom.unit.subtract(this.geom.origin).vLength()},getPointOnPath:function Z(ac,ad){return(Z.base||arguments.callee.base).call(this,ac,ad)},getClosestPointOnLine:function W(ad,ac){return(W.base||arguments.callee.base).call(this,ad,ac)},pointIsInBounds:function M(ac){return(M.base||arguments.callee.base).call(this,ac)}})}());y.gObjects.CircleInterior=y.makeClass([y.gObjects.Circle,y.genera.Interior],{doc:{description:"The region comprising the interior of a circle.",inherits:"Circle",refspec:{gspKindRef:"CircleInteriorKind"},usage:{},properties:{style:{properties:{layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)","default":"0.5",type:"Number"}}}}},style:{hidden:false,"line-style":"solid",opacity:0.5,width:1},state:{},kind:"CircleInterior",getColorableComponent:function(){return"Interior"},modifyRenderAttrsForCurrentState:function(D){this.modifyRenderAttrsForInterior(D)},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareCircleInterior(D)},renderCleanup:function(E,D){return E.cleanupCircleInterior(D)},render:function(J,E,G){var D,K,I,H=this.isRenderable();if(H){D=Number(this.geom.c.x);if(isNaN(D)){D=0}K=Number(this.geom.c.y);if(isNaN(K)){K=0}I=Number(this.geom.r);if(isNaN(I)){I=0}}else{D=K=I=-100}var F={renderable:H,cx:D,cy:K,r:I,color:this.style.color,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(F);J.drawCircleInterior(E,F)},hitTest:function(E,D){return y.Geom.RectIntersectsCurve(E,{type:"circleInterior",curve:y.GeometricArc.FromCenterAndRadius(this.geom.c,this.geom.r)})},transform:function(E,D){}});y.gObjects.ArcInterior=y.makeClass([y.gObjects.Arc,y.genera.Interior],{doc:{description:"The region comprising the interior of an arc.",inherits:"Arc",refspec:{},usage:{},properties:{style:{properties:{layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)","default":"0.5",type:"Number"}}}}},style:{hidden:false,"line-style":"solid",opacity:0.5,width:1},state:{},kind:"ArcInterior",perimeter:function(){return this.geom.arc.getCache(this.genus).perimeterLength},area:function(){var E=this.geom.arc,D=E.radius*E.radius,F=E.arcAngle*D;if("ArcSegment"===this.genus){F-=D*Math.sin(E.arcAngle)}return F/2},getColorableComponent:function(){return"Interior"},modifyRenderAttrsForCurrentState:function(D){this.modifyRenderAttrsForInterior(D)},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareArcInterior(D)},renderCleanup:function(E,D){return E.cleanupArcInterior(D)},render:function(G,D,F){var E={renderable:this.isRenderable(),arc:this.geom.arc,genus:this.genus,opacity:this.calculateOpacity(),color:this.style.color};this.modifyRenderAttrsForCurrentState(E);G.drawArcInterior(D,E)},getGeomBounds:function q(){var D=(q.base||arguments.callee.base).call(this);if(D){D=y.Geom.unionRectPoint(D,this.geom.arc.center)}return D},hitTest:function(F,D){var E=this.genus==="ArcSector"?"arcSector":"arcSegment";return y.Geom.RectIntersectsCurve(F,{type:E,curve:this.geom.arc})},transform:function(E,D){},closedPath:true});(function(){y.gObjects.CoordSys=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"A Coordinate System.",inherits:"Kind",refspec:{gspKindRef:"CoordSysKind"},usage:{},properties:{shape:{description:"Type or coordinate system: 'polar', 'square', or 'rectangular'.",type:"String"},style:{description:"",properties:{grid:{description:"Appearance of the coordinate system grid: 'gridlines' or 'dotted'",type:"String"},width:{description:"Line width for 'gridlines' coordinate systems",type:"Number"},radius:{description:"Radius of points for 'dotted' coordinate systems",type:"Number"}}}}},kind:"CoordSys",style:{width:0.5,radius:1.5},geom:{},doPostReadFromSpec:function D(){(D.base||arguments.callee.base).call(this);this.geom.origin=y.GeometricPoint.ORIGIN;this.geom.unit0=y.GeometricPoint.ORIGIN;this.geom.unit1=y.GeometricPoint.ORIGIN},getColorableComponent:function(){return"CoordSys"},renderPrepare:function(F,E){return F.prepareCoordSys(E)},renderCleanup:function(F,E){return F.cleanupCoordSys(E)},render:function(H,E,G){var F={renderable:this.isRenderable(),origin:this.geom.origin,shape:this.shape,grid:this.style.grid,gridSpacing:this.geom.gridSpacing,radius:this.style.radius,opacity:this.calculateOpacity(),color:this.style.color,width:this.style.width,sketchRect:this.sQuery.sketch.sketchRect()};this.modifyRenderAttrsForCurrentState(F);H.drawCoordSys(E,F)},hitTest:function(F,P){var I=function(aa,X){var Z=[{cos:1,sin:0},{cos:0.96592582628907,sin:0.25881904510252},{cos:0.86602540378444,sin:0.5},{cos:0.70710678118655,sin:0.70710678118655},{cos:0.5,sin:0.86602540378444},{cos:0.25881904510252,sin:0.96592582628907},{cos:0,sin:1}];var ac,ab,Y;for(ac=0;ac<7;ac++){ab=Z[ac].cos*X;Y=Z[ac].sin*X;if(y.Geom.PointInRect(y.GeometricPoint(ab,Y),aa)){return true}if(y.Geom.PointInRect(y.GeometricPoint(ab,-Y),aa)){return true}if(y.Geom.PointInRect(y.GeometricPoint(-ab,Y),aa)){return true}if(y.Geom.PointInRect(y.GeometricPoint(-ab,-Y),aa)){return true}}return false};if(this.shape==="polar"){var H={x:this.geom.unit0.x-this.geom.origin.x,y:-(this.geom.unit1.y-this.geom.origin.y)},Q=this.getParent("axisX").getPolarSpacing(H).pixelsBetweenTicks,N=Q.y/Q.x,V={left:(F.left-this.geom.origin.x)*N,right:(F.right-this.geom.origin.x)*N,top:F.top-this.geom.origin.y,bottom:F.bottom-this.geom.origin.y},J,M,W,S,K;if(y.Geom.PointInRect(y.GeometricPoint(0,0),V)){return true}J=V.top*V.top+V.left*V.left;M=J;W=V.top*V.top+V.right*V.right;M=(W>M)?W:M;J=(W<M)?W:J;W=V.bottom*V.bottom+V.left*V.left;M=(W>M)?W:M;J=(W<M)?W:J;W=V.bottom*V.bottom+V.right*V.right;M=(W>M)?W:M;J=(W<J)?W:J;S=Q.y;K=S*S;while(K<J){S+=Q.y;K=S*S}while(K<M){if(I(V,S)){return true}S+=Q.y;K=S*S}return false}else{var T={left:F.left-this.geom.origin.getX(),right:F.right-this.geom.origin.getX(),top:F.bottom-this.geom.origin.getY(),bottom:F.top-this.geom.origin.getY()};var L=this.getParent("axisX").getLineSpacing().pixelsBetweenTicks;var G=Math.floor(T.left/L)*L;var U=T.right-G;if(U<L){return false}var E=this.getParent("axisY").getLineSpacing().pixelsBetweenTicks;var O=Math.floor(T.bottom/E)*E;var R=T.top-O;if(R<E){return false}return true}},locatePlot:function(E,J){var I=this.geom.unit0.x-this.geom.origin.x,F=this.geom.origin.x,H=this.geom.unit1.y-this.geom.origin.y,G=this.geom.origin.y;return y.GeometricPoint(E*I+F,J*H+G)},vectorLocatePlot:function(N){var I=N.length,K=y.createFloatVector(I),G,E=this.geom.unit0.x-this.geom.origin.x,F=this.geom.origin.x,H=this.geom.unit1.y-this.geom.origin.y,M=this.geom.origin.y,L,J;if(K.set){K.set(N)}else{K=N.concat()}for(G=0;G<I;G+=2){L=K[G];J=K[G+1];K[G]=L*E+F;K[G+1]=J*H+M}return K},locatePoint:function(F){var H=this.geom.unit0.subtract(this.geom.origin),G=this.geom.unit1.subtract(this.geom.origin),J=F.subtract(this.geom.origin),E=J.x/H.x,I=J.y/G.y;return y.GeometricPoint(E,I)},snapPoint:function(G,J){var Q=this.geom.origin.x,N=this.geom.origin.y,L=this.geom.unit0.x-this.geom.origin.x,K=this.geom.unit1.y-this.geom.origin.y,E=G.x,S=G.y;if(this.shape==="polar"){var P=(G.x-Q)/L,M=(G.y-N)/K,H=Math.round(Math.sqrt(P*P+M*M)),F=0;if(0!==H){var I=Math.PI/12;F=Math.atan2(-M,P);F=Math.round(F/I)*I}E=Q+L*H*Math.cos(F);S=N-K*H*Math.sin(F)}else{E=Math.round((G.x-Q)/L)*L+Q;S=Math.round((G.y-N)/K)*K+N}var R=Math.abs(E-G.x),O=Math.abs(S-G.y);if(!J||((R<J)&&(O<J))){G.x=E;G.y=S}},createDefaultSpec:function(O,N){var G=(N&&N.origin&&N.origin.style)||{},K=(N&&N.xUnitPoint&&N.xUnitPoint.style)||{},Q=(N&&N.xAxis&&N.xAxis.style)||{},P=(N.yUnitPoint&&N.yUnitPoint.style)||{},J=(N&&N.yAxis&&N.yAxis.style)||{},M=(N&&N.shape)||"square",F=(N&&N.style)||{},E=M==="rectangular";var L={"1":{kind:"Point",genus:"OriginPoint",constraint:"Free",style:G},"2":{kind:"Point",genus:"UnitPoint",parents:{origin:"1"},value:28.346456692913385,constraint:"HorizontalUnitPoint",style:K},"3":{kind:"Axis",genus:"Axis",parents:{origin:"1",unitPoint:"2"},constraint:"AxisInternalDist",orientation:"horizontal",label:"x",style:Q},"4":{kind:"Point",genus:"UnitPoint",parents:{unitPoint:"2"},constraint:"UnitPointInternalSquare",style:P},"5":{kind:"Axis",genus:"Axis",parents:{origin:"1",unitPoint:"4"},constraint:"AxisInternalDist",orientation:"vertical",label:"y",style:J},"6":{kind:"CoordSys",genus:"CoordSys",parents:{axisX:"3",axisY:"5"},constraint:"CoordSys",shape:M,style:F}};var I=(O.metadata.sketchRect.right-O.metadata.sketchRect.left)/2;var H=(O.metadata.sketchRect.bottom-O.metadata.sketchRect.top)/2;L["1"].geom={loc:{x:I,y:H}};if(E){L["4"].constraint="UnitPointInternalRectangle";L["4"].unitDistance=28.346456692913364}return L}})}());y.gObjects.Measure=y.makeClass([y.gObjects.Text,y.mixins.labelBase],{doc:{description:"A message rendered in to a sketch canvas.",inherits:"Text",properties:{label:{description:"Text that describes or identifies the value of this object.",type:"String",required:false},style:{properties:{precision:{description:"The number of digits to display after the decimal point.",type:"Number",required:false},nameOrigin:{description:"What identifying value to display.",type:"NameOrigin",required:false},showUnits:{description:"Do we show the unit measurement?",required:false}}},blank:{description:"a display property indicating that the value or result of the calculation should be blank",type:"Boolean","default":false,required:false},debug:{properties:{value:{description:"The numeric value of a measure",required:false,type:"Number"},defined:{description:"Whether the measure is defined",required:false,type:"Boolean"}}}}},kind:"Measure",style:{precision:h,showUnits:true},unitPowers:{scalar:1},initPrecision:function(E){var G="scalar",D=this.unitsObject.hasOwnProperty("length"),F=this.unitsObject.hasOwnProperty("angle"),H;if(!(D&&F)){if(D){G="length"}if(F){G="angle"}}if(this.style.precision!==h){H=this.style.precision}else{H=E.precision[G]}return H},initKind:function j(){(j.base||arguments.callee.base).call(this);this.initMeasure();this.style.precision=this.initPrecision(this.sQuery().prefs())},updateLabelForKind:function e(){(e.base||arguments.callee.base).call(this);this.generateMeasureMFS()},initMeasure:function k(){this.setUnits(this.unitPowers);if(this.value!==h){this.uValue=y.units.convertFromBaseToUnitObject(this.value,this.unitsObject)}},generateMeasureMFS:function p(){var D=[],E=this.getNameMFS(),F;if(this.style.nameOrigin==="namedFromFixedString"){this.parsedMFS=y.mfs.makeTextMFS(this.label);return}if(!y.mfs.isEmptyTextMFS(E)){D.push(E);D.push(y.mfs.makeTextMFS(" = "))}D.push(this.getValueMFS());F=this.getUnitsMFS();if(F!==null){D.push(F)}if(this.style.suffix){D.push(y.mfs.makeTextMFS(this.style.suffix))}this.parsedMFS=y.mfs.makeHorizontalMFS.apply(this,D)},getValueMFS:function w(){return{type:"parameter",value:"value"}},getNameMFS:function(){var E,D=this.style.nameOrigin,F;switch(D){case"namedFromLabel":E=this.label?this.label.replace(/ += +$/,""):"";F=y.labels.parseLabelExpression(E,this.getMathItalicization());break;case"noVisibleName":F=y.mfs.makeTextMFS("");break;case"namedFromTemplate":F=this.getParentalNameMFS();break;default:F=y.mfs.makeTextMFS("Measure "+this.id);break}return F},setUnits:function(D){this.unitPowers=D;this.unitsObject=y.units.makeUnitObjectFromUnitsAndPowers(this.sQuery().prefs().units,D)},getUnitsMFS:function(){if(this.style.showUnits===false){return y.mfs.makeTextMFS("")}return y.units.getMFSForUnitObject(this.unitsObject)},getRawValue:function(){return this.value},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},getTextType:function(){return"Measurement"},getMFSAppearanceForVariant:function c(G){var I=this,D,F=[],J;function H(){var L=(I.unitPowers&&I.unitPowers.angle===1&&I.sQuery().prefs().units.angle==="rad")?"rad":"scalar";return I.formatNumberAsMFS(I.uValue,I.style.precision,L,true)}switch(G){case"valueAsAddend":if(!this.state.exists){return null}if(I.uValue<0){F.push(y.mfs.makeTextMFS(" "));F.push({type:"symbol",value:"103"});F.push(y.mfs.makeTextMFS(" "))}else{F.push(y.mfs.makeTextMFS(" + "))}D=I.uValue;I.uValue=Math.abs(I.uValue);F.push(H());J=y.mfs.makeHorizontalMFS.apply(this,F);I.uValue=D;return J;case"byLabel":return this.getLabelMFS();case"byName":return this.getParentalNameMFS();default:if(!this.state.exists){return null}var E=(G==="default"&&this.style.prefixWithLabel&&this.label);if(E||this.style.suffix){var K=[H()];if(E){K.unshift(y.mfs.makeTextMFS(this.label))}if(this.style.suffix){K.push(y.mfs.makeTextMFS(this.style.suffix))}return y.mfs.makeHorizontalMFS.apply(this,K)}else{return H()}}},verificationString:function f(F,E){var H=(f.base||arguments.callee.base).call(this,F,E);var D,G;if(F.exists&&this.state.exists){if(this.genus!=="Function"){if(!y.math.expect(this.uValue,F.value)){H+='value: <span class="error">'+this.uValue+'</span>(<span class="expected">'+F.value+"</span>)"}D=this.unitPowers.length?this.unitPowers.length:0;if(!y.math.expect(D,F.lengthPower)){H+='length power: <span class="error">'+D+'</span>(<span class="expected">'+F.lengthPower+"</span>)"}G=this.unitPowers.angle?this.unitPowers.angle:0;if(!y.math.expect(G,F.anglePower)){H+='length power: <span class="error">'+G+'</span>(<span class="expected">'+F.anglePower+"</span>)"}}}return H}});y.gObjects.Expression=y.makeClass(y.gObjects.Measure,(function(){var K=y.makeClass(y.TouchTracker,{forwardTouchToSystem:true});return{doc:{description:"A numeric expression.",inherits:"Measure",properties:{expression:{description:"An infix expression",type:"String"},expressionType:{description:"The type of expression. Used mainly for interpreting functions.",type:"UnivExpressionType"},functionExpr:{description:"A set of properties used for function expressions.",required:false,properties:{notation:{description:"Display notation type of the function: 'function' (e.g. 'f(x)') or 'dependentVariable' (e.g. 'y =')",type:"String",required:false},name:{description:"The name of the function, e.g. 'f' in 'y = f(x)'.",type:"String",required:false},dependentVar:{description:"The name of the dependent variable, e.g. 'y' in 'y = f(x)'.",type:"String",required:false},independentVar:{description:"The name of the independent variable, e.g. 'x' in 'y = f(x)'.",type:"String",required:false}}},style:{description:"Properties that influence the appearance of a GObject.",properties:{contenteditable:{description:"Whether the element is inline-editable. Applicable only to Parameters.",type:"Boolean"}}}}},kind:"Expression",expression:"",isExpressionDirty:false,unitPowers:{scalar:1},notation:"function",parsedInfix:h,style:{contenteditable:false},value:h,isFunction:function(){return this.expressionType!=="UniMeasure_ExprType"},isParameter:function(){return((this.genus==="ScalarParameter")||(this.genus==="AngleParameter")||(this.genus==="DistanceParameter"))},renderPrepare:function I(N,M){if(!this.isParameter()){M.isEditableByCalculator=true}return(I.base||arguments.callee.base).apply(this,arguments)},initMeasure:function D(){var M=this.sQuery().prefs().units;this.unit="";if(this.genus==="AngleParameter"){this.setUnits({angle:1});this.unit=M.angle}else{if(this.genus==="DistanceParameter"){this.setUnits({length:1});this.unit=M.length}}this.parseInfixExpression()},initPrecision:function H(){if(!this.isFunction()){return(H.base||arguments.callee.base).call(this)}return h},getValueMFS:function E(){if(this.isFunction()){return y.mfs.makeMFSFromParsedInfix(this.parsedInfix,this.parentsList,true,this.getMathItalicization())}else{if(this.isEditableSimpleExpression()){return{type:"input",value:"value"}}else{return{type:"parameter",value:"value"}}}},isHittable:function G(){return this.isRenderable()&&(this.style.contenteditable||this.style.selectable)},hitTest:function(R,O,Q){var N=Q,T={left:this.geom.loc.getX(),top:this.geom.loc.getY(),width:N.width(),height:N.height()},S={left:T.left,right:T.left+T.width,top:T.top,bottom:T.top+T.height},M={left:Math.max(R.left,S.left),right:Math.min(R.right,S.right),top:Math.max(R.top,S.top),bottom:Math.min(R.bottom,S.bottom)},U=(M.left<M.right&&M.top<M.bottom),P=false;if(U&&O&&(this.style.contenteditable||this.state.selected)){g(".mfs-input",g(Q.element)).each(function(){var W=g(this).convertPointFromPage(O.pageX,O.pageY,O.mouseEvent),V=W.x>=0&&W.y>=0&&W.x<=g(this).outerWidth()&&W.y<=g(this).outerHeight();if(V){P=true;return false}})}if(P){return Object.create(K)}if(U&&this.style.selectable){return y.DragTracker.create(this,Q.element)}return false},doubleClicked:function(N,O){var M=g(N).data("wsp-numfield-ctl");if(M){M.click(O,this)}},makeFnFromInfixExpression:function(){var M=y.mfs.getParsedInfixAndFunction(this.expression);this.parsedInfix=M.parsedInfix;this.setUnits(y.mfs.determineUnit(this.parsedInfix,this.parentsList));this.unitMultiplier=y.units.convertToBaseFromUnitObject(1,this.unitsObject);return M.func},getUnitPowers:function(M){return y.mfs.determineUnit(this.parsedInfix,this.parentsList,M)},curryReferences:function(N,O,M){return function(P){var Q=N.functionExpr&&N.functionExpr.independentVar?N.functionExpr.independentVar:"x";O[Q]=P;return N.fnExpression(O,M)}},parseInfixExpression:function(N){var M=this.sQuery().prefs().units;if(N!==h){this.expression=N}this.fnExpression=this.makeFnFromInfixExpression();this.fnUnits=this.sQuery().prefs().units;if(this.constraint==="Free"){if(!this.isFunction()){this.uValue=this.fnExpression([],M);this.value=this.uValue*this.unitMultiplier}else{var O=this;this.uValue=this.curryReferences(this,[],M);this.value=function(P){return O.uValue(P)*O.unitMultiplier}}this.isExpressionDirty=false}},isEditableSimpleExpression:function(){if(!this.style.contenteditable){return false}if(this.parsedInfix===h){this.parsedInfix=y.mfs.getParsedInfix(this.expression)}return y.mfs.isSimpleExpression(this.parsedInfix)},getUnitsMFS:function L(){if(this.isFunction()){return null}return(L.base||arguments.callee.base).call(this)},getNameMFS:function(){if(this.functionExpr){var T=this.getMathItalicization(),R=this.getLabelMFS()||y.mfs.makeTextMFS("f",T),N=y.mfs.makeTextMFS(this.functionExpr.dependentVar||"y",T),S=y.mfs.makeTextMFS(this.functionExpr.independentVar||"x",T),M=this.functionExpr.notation==="function"?[R,{type:"paren",value:[S]}]:[N];return y.mfs.makeHorizontalMFS.apply(this,M)}var P,O=this.style.nameOrigin,Q;switch(O){case"namedFromLabel":P=this.label?this.label.replace(/ = $/,""):"";Q=y.labels.parseLabelExpression(P);break;case"noVisibleName":Q=y.mfs.makeTextMFS("");break;case"namedFromTemplate":Q=this.createMFSFromInfixExpression();break;default:Q=y.mfs.makeTextMFS("Expression "+this.id);break}return Q},createMFSFromInfixExpression:function(){if(this.parsedInfix===h){this.parsedInfix=y.mfs.getParsedInfix(this.expression)}return y.mfs.makeMFSFromParsedInfix(this.parsedInfix,this.parentsList,false)},getMFSAppearanceForVariant:function J(M){var O=this;function N(){var P=O.getMathItalicization();switch(M){case"expressionOnly":if(!O.parsedInfix){O.parseInfixExpression()}return y.mfs.makeMFSFromParsedInfix(O.parsedInfix,O.parentsList,true,O.getMathItalicization());case"independentVariable":return y.mfs.makeTextMFS(O.functionExpr.independentVar||"x",P);case"dependentVariable":return y.mfs.makeTextMFS(O.functionExpr.dependentVar||"y",P);case"byLabel":return O.getLabelMFS();default:return O.parsedMFS}}if(this.isFunction()){return N()}if(M==="byName"){return this.createMFSFromInfixExpression()}else{return(J.base||arguments.callee.base).call(this,M)}},updateValue:function(M){this.value=M;this.uValue=this.value/this.unitMultiplier;this.isExpressionDirty=true;this.fnExpression=h;this.parsedInfix=h;this.sQuery().invalidateGeom(this)},prepareToSerialize:function(){if(this.isExpressionDirty){this.setParameterValue(this.uValue,this.unit)}},setEditedValue:function(N){var S,R,O=N.trim(),M=false,T=M?this.sQuery().prefs().units:h,P=(N===""),U=false;try{R=y.mfs.getParsedInfixAndFunction(O);S=R.func&&R.func([],T);U=y.math.isFiniteScalar(S)}catch(Q){}if(U||P){this.setParameterValue(O);this.blank=P}this.sQuery().invalidateGeom(this)},setParameterValue:function(S,R){var O=this.fnExpression,T=this.expression,P=this.parsedInfix,M=R||this.unit;this.expression=String(S);if(this.expression!==""&&M){this.expression="("+this.expression+")*1"+M}this.parsedInfix=h;try{this.fnExpression=this.makeFnFromInfixExpression()}catch(Q){Q.message="In expression: '"+this.expression+"': "+Q.message;y.signalCaughtError(Q);this.fnExpression=O;this.expression=T;this.parsedInfix=P}var N=this.sQuery().prefs().units;this.uValue=this.fnExpression([],N);this.value=this.uValue*this.unitMultiplier;this.isExpressionDirty=false;this.sQuery().invalidateGeom(this)},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},verificationString:function F(P,M){var Q=(F.base||arguments.callee.base).call(this,P,M);if(this.blank||/^isDefined\(/.test(this.expression)){return"NO_VERIFICATION"}else{if(P.exists&&this.state.exists){if(this.isFunction()){var N=this.uValue(0),O=this.uValue(1);if(!y.math.expect(N,P.zeroValue)){Q+='Function zero value: <span class="error">'+N+'</span>(<span class="expected">'+P.zeroValue+"</span>)"}if(!y.math.expect(O,P.oneValue)){Q+='Function one value: <span class="error">'+O+'</span>(<span class="expected">'+P.oneValue+"</span>)"}}}}return Q}}})());y.gObjects.AngleMarker=y.makeClass(y.gObjects.Arc,(function(){var G=0.001,D=0.7071067811865475,E=4;return{doc:{description:"Marks the span of an angle. In geometry, angle markers are used to assert congruency relationships.",inherits:"Arc",refspec:{gspKindRef:"AngleMarkerKind"},properties:{style:{properties:{"inner-radius":{description:"The arc radius contained within the angle marker, in pixels",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)",type:"Number"},"radial-spacing":{description:"The separation between arc strokes in an angle marker, in pixels",type:"Number"},"show-angle-direction":{description:"Whether to show a direction arrow.",type:"Boolean"},strokes:{description:"The number of strokes to draw for the marker.",type:"Number"}}}}},kind:"AngleMarker",hasLabel:true,geom:{},invertArrowhead:false,style:{"show-angle-direction":false,"inner-radius":24,opacity:0.25,"radial-spacing":3,strokes:1},getAngleMarkerMFS:function(I){var L=this.getParent("p0"),K=this.getParent("p1"),J=this.getParent("p2"),M=[L.getNameMFS(),K.getNameMFS(),J.getNameMFS()];if(I){M.unshift({type:"symbol",value:"d0"})}return y.mfs.makeHorizontalMFS.apply(this,M)},getNameMFSForLabel:function(){return this.getAngleMarkerMFS(false)},getColorableComponent:function(){return"AngleMarker"},renderPrepare:function(J,I){I={kind:this.kind,id:this.id,strokes:this.style.strokes};return J.prepareAngleMarker(I)},renderCleanup:function(J,I){return J.cleanupAngleMarker(I)},render:function(K,N,I){var Q=this.getParent("p0"),O=this.getParent("p1"),M=this.getParent("p2"),U=Q.geom.loc,S=O.geom.loc,R=M.geom.loc,J=y.Geom.ThreePointCollinear(U,S,R).orientation,P=this.geom.arc,L,T;if(P){L=P.arcAngle<=Math.PI?(J<0):(J>=0);T={color:this.style.color,firstArc:P,isRight:Math.abs((P.arcAngle)-Math.PI/2)<G,opacity:this.style.opacity,fadeOpacity:this.calculateFadeOpacity(),radialSpacing:this.style["radial-spacing"],renderable:this.isRenderable(),"show-angle-direction":this.style["show-angle-direction"],invertArrowhead:this.invertArrowhead,strokes:this.style.strokes,width:this.style.width,swap:L};this.modifyRenderAttrsForCurrentState(T);K.drawAngleMarker(N,T)}},getGeomBounds:function F(){if(!this.state.exists||!this.geom.arc){return}var M=this.geom.arc,N=this.style.width,O=this.style.strokes,U=this.style["radial-spacing"],L=this.style.width,R=Math.abs((M.arcAngle)-Math.PI/2)<G,P=R?D:1,Q=(M.radius*P)+(O-1)*(U+L),J,T,K,S=[],I;if(this.style["show-angle-direction"]){N+=E}if(R){S.push(M.center);J=M.initialPoint.subtract(M.center).unit().multiply(Q);S.push(M.center.add(J));S.push(M.center.add(new y.GeometricPoint(-J.y,J.x)));S.push(S[2].add(J));I={};g.each(S,function(W,V){if((I.left===h)||(I.left>V.x)){I.left=V.x}if((I.top===h)||(I.top>V.y)){I.top=V.y}if((I.right===h)||(I.right<V.x)){I.right=V.x}if((I.bottom===h)||(I.bottom<V.y)){I.bottom=V.y}});I=y.Geom.insetRect(I,-N)}else{J=M.initialPoint.subtract(M.center).unit().multiply(Q).add(M.center);T=M.finalPoint.subtract(M.center).unit().multiply(Q).add(M.center);K=y.GeometricArc.FromCenterAndEndpoints(M.center,J,T);I=this.getArcBounds(K,N);I=y.Geom.unionRectPoint(I,this.geom.arc.center)}return I},hitTest:function(P,L){var M=this,O,S,I,Q,N,K,R;function J(){var U=y.GeometricArc.FromCenterAndEndpoints(M.geom.arc.center,S,I,1);return y.Geom.RectIntersectsCurve(P,{type:"arcSector",curve:U})}function T(){return y.Geom.ParallelogramSectsRect(P,S,M.geom.arc.center,I)}if(!this.geom.arc){return false}Q=Math.abs(this.geom.arc.arcAngle-Math.PI/2)<G;N=Q?D:1;O=this.geom.arc.radius*N+((this.style["radial-spacing"]+this.style.width)*(this.style.strokes-1));K=y.GeometricPoint(Math.cos(this.geom.arc.initialAngle),Math.sin(this.geom.arc.initialAngle)).multiply(O);R=y.GeometricPoint(Math.cos(this.geom.arc.finalAngle),Math.sin(this.geom.arc.finalAngle)).multiply(O);S=K.add(this.geom.arc.center);I=R.add(this.geom.arc.center);if(Q){return T()}else{return J()}},verificationString:function H(J,I){var K=(H.base||arguments.callee.base).call(this,J,I);if(J.exists&&this.state.exists){if(!y.math.expect(this.value,J.value)){K+='value: <span class="error">'+this.value+'</span>(<span class="expected">'+J.value+"</span>)"}}return K}}}()));y.gConstraints.Constraint={doc:{description:"The parent class for all constraints.",refspec:{},usage:{"abstract":true},supported:true,properties:{}},constraintSupportsSpecObj:function(){return true},initConstraint:function(){},updateConstraintAncestry:function(){},updateLabelForConstraint:function i(){},constrain:function(){this.state.exists=false;throw y.createError("Unimplemented method")},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Object "+this.id)},constraintVerificationString:function z(D){return""}};y.gConstraints.Unknown=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Placeholder for an unrecognized constraint.",inherits:"Constraint",refspec:{msg:"An artifact of convenience of the application design."},usage:{"abstract":true},properties:{}},constraint:"Unknown",constrain:function(){this.state.exists=false;this.state.supported=false}});y.gConstraints.Free=y.makeClass(y.gConstraints.Constraint,{doc:{description:"An object with a free constraint can be dragged anywhere in the sketch space and is not bound by any dependencies that affect its geometry.",inherits:"Constraint",refspec:{gspRef:"Free_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Free_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point","Expression","Text"]},existenceRule:"Exists iff the coordinates of its location exist.",properties:{geom:{description:"The basic geometry of the GObject",properties:{loc:{description:"The position of the GObject",properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"}}}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Free_export.json"},constrain:function(){this.state.exists=this.geom.loc&&this.geom.loc.isDefined()}});y.gConstraints.PictureFree=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A free picture can be dragged anywhere in the sketch space and is not bound by any dependencies that affect its geometry.",inherits:"Constraint",refspec:{gspRef:"Free_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Free_C, when applied to Pictures in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Picture"]},existenceRule:"Exists iff its image exists.",properties:{geom:{description:"The basic geometry of the GObject",properties:{transform:{description:"Affine transform of picture from its original (0,0)x(width,height) position.",type:"AffineTransform",properties:{m00:{description:"m00",type:"Number"},m01:{description:"m01",type:"Number"},m10:{description:"m10",type:"Number"},m11:{description:"m11",type:"Number"},m20:{description:"m20",type:"Number"},m21:{description:"m21",type:"Number"}}}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Picture-Misc_export.json"},constrain:function(){this.state.exists=true}});y.gConstraints.PictureNonFree=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Abstract base class for picture constraints.",inherits:"Constraint",refspec:{msg:"This class is an internal object and doesn't have an independent source of requirements."},usage:{"abstract":true,kinds:["Picture"]}}});y.gConstraints.Locus=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A virtual base class for locus subclasses",inherits:"Constraint",refspec:{},usage:{"abstract":true},existenceRule:"Exists if any samples exist",properties:{parents:{description:"",type:"Object",properties:{driverObject:{description:"The object whose motion along a path defines the locus",kind:"Point|Expression"},drivenObject:{description:"The object being driven whose locations define the locus",kind:"Point|Expression|Text|Arc|Circle|Picture|Polygon|Straight|ArcInterior|CircleInterior"}},regex:/^[0-9]+$/}}},constraintSupportsSpecObj:function(E,G){var D=this.doc.properties.parents.properties.drivenObject.kind;var F=G[E.parents.drivenObject].kind;if(D.match(F)===null){return false}return true},clonedDriverGObj:h,clonedSampleGObj:h,sampleGObj:function(){return this.parents.drivenObject},updateConstraintAncestry:function B(){var K=this.sQuery.sketch,J=[],D,I=0,H=this.numSamples,G=this.getParent("driverObject"),F=this.getParent("drivenObject").id,E;J.push(this.getParent("driverObject"));while(this.parents.hasOwnProperty(I)){J.push(this.getParent(I));I++}J.sort(function(M,L){return Number(M.topologicalIndex)-Number(L.topologicalIndex)});D=K.cloneGObjects(J);for(I=0;I<D.length;I++){if(D[I].id===G.id){this.clonedDriverGObj=D[I];D.splice(I,1);break}}for(I=0;I<D.length;I++){if(D[I].id===F){E=D[I];this.driveChain=D;this.clonedSampleGObj=E;break}}this.clonedDriverGObj.state.exists=true;this.vectorContext=E.createVectorContext(H,this,E.constraintChangesColor);this.lastSampleCount=H},prepareDriverWalkInfo:function(){y.signalErrorWithMessage("Locus subclasses must implement prepareDriverWalkInfo")},advanceDriver:function(F,D,E){y.signalErrorWithMessage("Locus subclasses must implement advanceDriver")},moveDriverForValue:function(E,D){y.signalErrorWithMessage("Locus subclasses must implement moveDriverForValue")},constrain:function(J){var E=this.driveChain,H=this.clonedSampleGObj,L=this.clonedDriverGObj,F=this.numSamples,G=this.lastSampleCount!==F,D,K,I;if(G){this.vectorContext=H.createVectorContext(F,this,H.constraintChangesColor);this.lastSampleCount=F}if(this.prepareDriverWalkInfo){I=this.prepareDriverWalkInfo()}this.state.exists=false;H.resetVectorSamples(this.vectorContext);K=0;for(D=0;D<F;D++){this.advanceDriver(L,I,D);J.constrainDriveChain(E);if(H.state.exists||this.vectorContext.isContinuous){H.fillSingleSample(this.vectorContext,K);K++}this.state.exists=this.state.exists||H.state.exists}if(H.recomputeDiscontinuities){H.recomputeDiscontinuities(this.vectorContext)}},samplerPathValueToPosition:function(I){var D=this.driveChain,E=this.clonedSampleGObj,H=this.clonedDriverGObj,G=this.driverDomain.high-this.driverDomain.low,F=this.driverDomain.low+G*I;this.moveDriverForValue(H,F);this.sQuery.sketch.constrainDriveChain(D);return E.state.exists?E.geom.loc:y.GeometricPoint.UNDEFINED},samplerPositionToPathValue:function(D){return this.clonedSampleGObj.positionToPathValueForVector(this.vectorContext,D)},samplerPathLength:function(){return this.clonedSampleGObj.pathLengthForVector(this.vectorContext)}});y.gConstraints.GeomLocus=y.makeClass(y.gConstraints.Locus,{doc:{description:"A Geometric Locus of an object as a parent driver moves along a path.",inherits:"Locus",refspec:{gspRef:"GeomLocus_C"},usage:{"abstract":false,kinds:["Sampler"]},supported:true,properties:{parents:{properties:{domainObject:{description:"The drive path the driver travels along",genus:"Path"}}}}},updateConstraintAncestry:function B(){var D=this.getParent("domainObject");this.closedPath=D.closedPath;(B.base||arguments.callee.base).call(this)},checkParentsExist:function(){var D=this.getParent("domainObject");return D.state.exists},prepareDriverWalkInfo:function(){var G=this.numSamples,F=y.createFloatVector(G),K=this.getParent("domainObject"),E,J=this.driverDomain,H,D=J.low,I;if(K.closedPath){I=(J.high-D)/G}else{I=(J.high-D)/(G-1)}for(H=0;H<G;H++){F[H]=D+(H*I)}if(!K.closedPath){F[G-1]=J.high}E=K.mapVectorPathValuesToPositions(F);return E},advanceDriver:function(F,D,E){F.geom.loc=D[E];F.state.exists=true},moveDriverForValue:function(E,D){var F=this.getParent("domainObject");if(F.closedPath){D=D%1}E.geom.loc=F.mapPathValueToPosition(D);E.state.exists=true}});y.gConstraints.CustomTransformedPath=y.makeClass(y.gConstraints.GeomLocus,{doc:{description:"A Geometric Locus of an object as a parent driver of the custom trasform moves along a path.",inherits:"Locus",refspec:{gspRef:"CustomTransformedPath_C"}}});y.gConstraints.ParametricLocus=y.makeClass(y.gConstraints.Locus,{doc:{description:"A Parametric Locus of an object as a driver parameter moves through a range of values.",inherits:"Locus",refspec:{gspRef:"ParametricLocus_C"},usage:{"abstract":false,kinds:["Sampler"]},supported:true,properties:{parents:{properties:{drivenObject:{description:"The object whose position changes as the driver moves along the path"},driverObject:{description:"The point to drive along the path",kind:"Expression"}}}}},checkParentsExist:function(){return this.getParent("driverObject").state.exists},prepareDriverWalkInfo:function(){var F=this.numSamples,E=y.createFloatVector(F),I=this.driverDomain,G,D=I.low,H=(I.high-D)/(F-1);for(G=0;G<F;G++){E[G]=D+(G*H)}return E},advanceDriver:function(F,D,E){F.updateValue(D[E])},moveDriverForValue:function(E,D){E.updateValue(D)},samplerPathValueToPosition:function n(E){var F=this.driverDomain.high-this.driverDomain.low,D=F?((E-this.driverDomain.low)/F):0;return(n.base||arguments.callee.base).call(this,D)},samplerPositionToPathValue:function d(F){var E=(d.base||arguments.callee.base).call(this,F),D=this.driverDomain.high-this.driverDomain.low;return this.driverDomain.low+E*D},samplerConstrainRange:function(F){var E=F,D=this.driverDomain.low,G=this.driverDomain.high;if(F>G){E=G}if(F<D){E=D}return E},samplerIsValueInBounds:function(D){return((D>=this.driverDomain.low)&&(D<=this.driverDomain.high))}});y.gConstraints.IterateMap=y.makeClass(y.gConstraints.Constraint,(function(){var I=/^preimage\d+$/,J=/^map\d+image\d+$/,H=/^\d+$/;function G(M,L){var K;g.each(M,function(N,O){if(O.id===L){K=O;return false}});return K}function F(M,L){var K=[];g.each(L,function(N,O){K.push(G(M,O))});return K}function D(K){return{map:/map(\d+)/.exec(K)[1],image:/image(\d+)/.exec(K)[1]}}function E(L,K){if(g.inArray(K,L)===-1){L.push(K)}}return{doc:{description:"Iteration Map.",inherits:"Free",refspec:{gspRef:"IterateMap_C"},usage:{"abstract":false,kinds:["Map"]},properties:{parents:{description:"",type:"Object",properties:{preimage0:{description:"The first preimage.  There can be an arbitrary number of preimages, with the form 'preimageX'",kind:"kind"},map0image0:{description:"The first postimage.  There can be an arbitrary number of post-images, with the form 'mapXimageY",kind:"kind"},"0":{description:"The first object in the drive chain.  There may be many objects in the drivechain, numbered from 0 to N",kind:"kind"}},regex:/^preimage[0-9]+$|^map[0-9]+image[0-9]+$|^[0-9]+$/},currentDepth:{description:"The depth of the iteration",required:true,type:"Number"}}},imageArray:null,preImageClones:null,postImageMapArray:null,driveChain:null,randomValueCache:null,onPathPostImages:null,rerandomizeNow:true,updateConstraintAncestry:function(){var O=this.sQuery.sketch,M=[],K,L=this;function N(Q,P){return Number(Q.topologicalIndex)-Number(P.topologicalIndex)}this.imageArray=[];this.preImageClones=[];this.postImageMapArray=[];this.driveChain=[];if(this.rerandomizePointsOnPaths){this.randomValueCache=[];this.onPathPostImages=[]}g.each(L.parents,function(R,Q){var P,S;if(I.test(R)){P=R.match(/\d+/)[0];L.preImageClones[P]=Q.id}else{if(J.test(R)){S=D(R);if(!L.postImageMapArray[S.map]){L.postImageMapArray[S.map]=[]}L.postImageMapArray[S.map][S.image]=Q.id;E(L.driveChain,Q.id);if(L.rerandomizePointsOnPaths&&Q.isFreePointOnPath){E(L.onPathPostImages,Q.id)}}else{if(H.test(R)){E(L.driveChain,Q.id)}else{return}}}E(M,Q)});M.sort(N);K=O.cloneGObjects(M);L.preImageClones=F(K,L.preImageClones);g.each(L.postImageMapArray,function(P,Q){L.postImageMapArray[P]=F(K,L.postImageMapArray[P])});if(L.rerandomizePointsOnPaths){L.onPathPostImages=F(K,L.onPathPostImages)}L.driveChain=F(K,L.driveChain);L.driveChain.sort(N);L.numMaps=L.postImageMapArray.length},registerImageAndGetClone:function(L){var K=L.getParent("source");this.imageArray.push(L);return G(this.driveChain,K.id)},deregisterImage:function(L){var K=g.inArray(L,this.imageArray);if(K>=0){this.imageArray.splice(K,1)}},checkParentsExist:function(){var K=true;function L(N,M){if(M.state){if(!M.state.exists&&!H.test(N)){K=false;return false}}}g.each(this.parents,L);this.state.exists=K;return K},constrain:function(V){var Q=this.finalIterationOnly,P=this,O=this.numMaps,T=0;if(this.rerandomizeNow){this.randomValueCache=[]}function R(W,X){X.collectSample()}function S(W,X){X.clearSamples()}function U(W,X){if(P.currentDepth===0||X.clonedGObj.state.exists){X.stampTerminalSample()}}function N(W){var X=[],Y,aa;function Z(ab){if(ab.kind==="Point"){return{loc:ab.geom.loc.copy(),exists:ab.state.exists}}else{return{value:ab.value,exists:ab.state.exists}}}if(g.isArray(W)){aa=W.length;for(Y=0;Y<aa;Y++){X.push(Z(W[Y]))}return X}else{return Z(W)}}function L(X,W){var Y,aa=X.length,Z;for(Y=0;Y<aa;Y++){Z=X[Y];if(Z.kind==="Point"){Z.geom.loc=W[Y].loc;Z.state.exists=W[Y].exists}else{Z.updateValue(W[Y].value);Z.state.exists=W[Y].exists}}}function M(ab){var aa=ab.onPathPostImages.length,X,Y,Z,W;for(X=0;X<aa;X++){Y=ab.onPathPostImages[X];if(ab.randomValueCache[T]===h){Z=Y.getParent("path");W=Z.getAnimationRange();ab.randomValueCache[T]=W.min+(W.max-W.min)*Math.random()}Y.updateValue(P.randomValueCache[T++])}}function K(X){var W,Y=[];if(X===P.currentDepth){g.each(P.parents,function(Z,aa){var ab;if(J.test(Z)){ab=D(Z);if(!Y[ab.map]){Y[ab.map]=[]}Y[ab.map][ab.image]=N(aa)}})}else{for(W=0;W<O;W++){Y[W]=N(P.postImageMapArray[W])}}for(W=0;W<O;W++){L(P.preImageClones,Y[W]);if(P.rerandomizePointsOnPaths){M(P)}V.constrainDriveChain(P.driveChain);if((!Q)||(X===1)){g.each(P.imageArray,R)}if(X-1){K(X-1)}}}g.each(this.imageArray,S);if(this.currentDepth>0){K(this.currentDepth)}g.each(P.imageArray,U);this.rerandomizeNow=false}}}()));y.gConstraints.IterateMapByParametricDepth=y.makeClass(y.gConstraints.IterateMap,{doc:{description:"Itereation Map by parametric depth.",inherits:"IterateMap",refspec:{gspRef:"IterateMapByParametricDepth_C"},usage:{"abstract":false,kinds:["Map"]},properties:{parents:{description:"",type:"Object",properties:{depth:{description:"the depth to which the construction is iterated",kind:"Measure"}}},currentDepth:{suppressed:true}}},constrain:function u(D){var E=Number(this.getParent("depth").uValue.toFixed());if(E<0){E=0}if(!isFinite(E)){E=null}if(E!==this.currentDepth){this.currentDepth=E;this.rerandomizeNow=true;g.each(this.imageArray,function(F,G){G.sampleCountChanged()})}if(this.currentDepth!==null){this.state.exists=true;(u.base||arguments.callee.base).call(this,D)}else{this.state.exists=false}},constraintVerificationString:function z(D){var E=(z.base||arguments.callee.base).call(this);if(D){E+=this.testConsistency("depth",this.currentDepth,D.depth)}return E}});y.gConstraints.IterateImage=y.makeClass(y.gConstraints.Constraint,{doc:{description:"",inherits:"Constraint",refspec:{gspRef:"IterateImage_C"},usage:{"abstract":false,kinds:["IterateImage"]},existenceRule:"",properties:{parents:{description:"",type:"Object",properties:{source:{description:"The preimage that is to be iterated",kind:"Point|Expression|Text|Arc|Circle|Picture|Polygon|Straight|ArcInterior|CircleInterior"},map:{description:"The iteration map defining the iteration",kind:"Map"}}}}},updateConstraintAncestry:function B(){(B.base||arguments.callee.base).call(this);var E=this.getParent("map"),D=E.registerImageAndGetClone(this);this.clonedGObj=D;this.initializeSampleBuffer()},constrain:function(){this.state.exists=(this.curSampleNum>0)},checkParentsExist:function(){if(!this.getParent("map").state.exists){if(this.state.exists){this.state.exists=false;this.clearSamples()}return false}return true}});y.gConstraints.PointTerminalIteration=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The terminal point of an iterated image of points",inherits:"Constraint",refspec:{gspRef:"TerminalIterationPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Midpoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists if the parental image exists.",properties:{parents:{description:"",properties:{image:{description:"",kind:"IterateImage"}}}},example:""},state:{},checkParentsExist:function(){var D=this.getParent("image").getParent("map");return D.state.exists},constrain:function(){var E=this.getParent("image"),D=E.getTerminalGeom();if(D===null){this.state.exists=false;this.geom.loc=y.GeometricPoint.UNDEFINED}else{this.geom=D;this.state.exists=true}}});y.gConstraints.CompositeText=(function(){var D="-";var I=new RegExp("\\d+"+D+".*");function H(J){switch(J){case 10:return"byLabel";case 11:return"byName";case 12:return"byValue";case 13:return"valueAsAddend";case 14:return"expressionOnly";case 15:return"independentVariable";case 16:return"dependentVariable";case 17:return"pictureIcon";default:return"default"}}function F(M,N){var L=parseInt(N,16),K=(L&65535)-1,J=H((L&4294901760)>>16);return K+D+J}return y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines a caption that has references to dynamically generated text from other objects.",inherits:"Constraint",refspec:{gspRef:"CompositeText_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CompositeText_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff parents exist.",properties:{parents:{description:"Objects referenced in the caption",properties:{"0":{description:'Objects labeled "0", ..., "n"',kind:"kind"}},regex:/^[0-9]+$/}}},updateLabelForConstraint:function E(){(E.base||arguments.callee.base).call(this);var K=this;this.parentMFSValues={};function J(M){var L=F(K,M.refCon);M.visibleNode=1;M.value[0]={type:"parameter",value:L};K.parentMFSValues[L]={type:"text",value:"unfilled"}}y.mfs.walkNode(this.parsedMFS,"switch",J)},constrain:function G(){var J=this;J.state.exists=true;g.each(J.parentMFSValues,function(M){if(!M.match(I)){return}var K=M.split(D),P=K[0],L=K[1],N=J.parentsList[P],O=N.getStrippedMFSAppearanceForVariant(L);if(O===null){J.state.exists=false;return false}J.parentMFSValues[M]=O})},checkParentsExist:function(){return true}})}());y.gConstraints.PictureAcrossThreePoints=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture with upper left defined by a <span class="kind">Param</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{p0:{description:"The location of the original bottom left of the picture",kind:"Point"},p1:{description:"The location of the original bottom right of the picture",kind:"Point"},p2:{description:"The location of the original top left of the picture",kind:"Point"}}}}},constrain:function(){var H=this.getParent("p0").geom.loc,G=this.getParent("p1").geom.loc,F=this.getParent("p2").geom.loc,E=this.getImage(),D=y.AffineTransform.fromPointMapping([y.GeometricPoint(0,E.height),y.GeometricPoint(E.width,E.height),y.GeometricPoint(0,0)],[H,G,F]);if(D){this.geom.transform=D}else{this.state.exists=false}}});y.gConstraints.PictureBetweenTwoPoints=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture with upper left defined by a <span class="kind">Param</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent points exist, and their rounded-to-integer coordinates differ in both x and y values.",properties:{parents:{description:"",properties:{p0:{description:"One corner of the rectangle in which the picture is presented",kind:"Point"},p1:{description:"The other corner of the rectangle in which the picture is presented",kind:"Point"}}}}},constrain:function(){var G=this.getParent("p0").geom.loc.round(),E=this.getParent("p1").geom.loc.round(),F=E.subtract(G),D=this.getImage();this.state.exists=F.getX()!==0&&F.getY()!==0;if(this.state.exists){this.geom.transform=y.AffineTransform({m20:F.getX()<0?E.getX():G.getX(),m21:F.getY()<0?E.getY():G.getY(),m00:Math.abs(F.getX())/D.width,m11:Math.abs(F.getY())/D.height})}}});y.gConstraints.PictureCenteredOnOnePoint=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture centered on a <span class="kind">Point</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"}}},scaleX:{description:"Horizontal scaling factor about center.",type:"Number"},scaleY:{description:"Vertical scaling factor about center.",type:"Number"},angle:{description:"Angle of rotation about center.",type:"Number"}}},constrain:function(){var H=this.getParent("p0").geom.loc,E=this.scaleX,D=this.scaleY,G=this.angle,F=this.getImage();this.geom.transform=y.AffineTransform.Identity.translate(-F.width/2,-F.height/2).scale(E,D).rotate(G).translate(H)}});y.gConstraints.PictureCroppedByInterior=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture cropped by an <span class="genus">Interior</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{source:{description:"Picture to be cropped",kind:"Picture"},cropInterior:{description:"Polygon to which picture will be cropped",kind:"Polygon"}}}}},updateConstraintAncestry:function(){var D=this.getParent("cropInterior");this.geom.clipVertices=D.getVertices()},constrain:function(){var G=this.getParent("source"),E=this.getParent("cropInterior"),F=this;function D(){var I=[],J={top:0,left:0,bottom:G.getImage().height,right:G.getImage().width},K=F.geom.transform.inverse(),H;if(!K){return false}for(H=0;H<E.geom.points.length;H++){I.push(E.geom.points[H].copy())}K.transform(I);return y.Geom.RectSectsPolygon(J,I)}this.geom.transform=G.geom.transform;this.geom.clipVertices=E.getVertices();this.state.exists=D()}});y.gConstraints.PictureHungOnOnePoint=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture with upper left at a <span class="kind">Point</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"}}}}},constrain:function(){var D=this.getParent("p0").geom.loc;this.geom.transform=y.AffineTransform({m20:D.getX(),m21:D.getY(),m00:1,m11:1})}});y.gConstraints.PointOnPathBase=y.makeClass(y.gConstraints.Constraint,{value:0.5,isFreePointOnPath:true,constrain:function u(){var E=this.getParent("path"),F=false,D=y.GeometricPoint.UNDEFINED;if(E.isValueInBounds(this.value)){D=E.mapPathValueToPosition(this.value);if(D&&D.isDefined()){F=true}else{D=y.GeometricPoint.UNDEFINED}}this.state.exists=F;this.geom.loc=D}});y.gConstraints.Straight=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The base class for all straight constraints.",inherits:"Constraint"},getStraightP0:function(){var D=this.getParent("p0");return D.geom.loc},getStraightP1:function(){var D=this.getParent("p1");return D.geom.loc},getOverBarType:function(){return this.overbarType},getParentalNameMFS:function(){var G,F,D,E;G=this.getParent("p0");F=this.getParent("p1");D=G.getNameMFS();E=F.getNameMFS();return{type:"overbar",variant:this.getOverBarType(),value:y.mfs.makeHorizontalMFS(D,E)}}});y.gConstraints.Transform=y.makeClass([y.gConstraints.Constraint,y.mixins.transformable],{doc:{description:"The parent class for all transformations.",inherits:"Constraint",refspec:{msg:"This class is an internal object and doesn't have an independent source of requirements."},usage:{"abstract":true,kinds:["Arc","ArcInterior","Circle","CircleInterior","Picture","Point","Polygon","Straight"]},properties:{parents:{description:"",properties:{source:{description:"The source of the transformation",kind:"kind",type:"GObject"}}}}},isTransformationConstraint:true,determineExists:function(){return h},getSourceGeom:function(){return this.getParent("source").geom},constrain:function(){var D=this.getTransformer();D.transformGeom(this.getSourceGeom(),this.geom);this.state.exists=this.determineExists()},getParentalNameMFS:function(){var D=this.getParent("source");return y.mfs.makeHorizontalMFS(D.getNameMFS(),y.mfs.makeTextMFS("'"))}});y.gConstraints.Ray=y.makeClass(y.gConstraints.Straight,{doc:{description:"Defines a ray from two points. The first point, p0, is the base of the ray.",inherits:"Straight",refspec:{gspRef:"Ray_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Ray_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent points exist and are not coincident.",properties:{parents:{description:"",properties:{p0:{description:"The foot of the ray.",kind:"Point"},p1:{description:"A point on the ray not incident with the foot.",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Ray_export.json"},overbarType:3,getPointOnPath:function(D,E){return this.getPointOnRay(D,E)},constrain:function(){var I,G,E,D,H,F;I=this.getStraightP0();this.geom.p0=I;G=this.getStraightP1();this.geom.p1=G;E=G.subtract(I);if(E.isZeroLength()){this.geom.xp0=y.GeometricPoint(0,0);this.geom.xp1=y.GeometricPoint(0,0)}else{D=E.vLength();H=10000/D;F=I.add(E.multiply(H));this.geom.xp0=I;this.geom.xp1=F}this.state.exists=!E.isZeroLength()}});y.gConstraints.AngleBisector=y.makeClass(y.gConstraints.Ray,{doc:{description:"Constrains a ray to bisect an angle. The ray's foot is the angle vertex.",usage:{"abstract":false,kinds:["Straight"],genus:["Ray"]},inherits:"Ray",refspec:{gspRef:"Bisector_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Bisector_C, in the currently published version of desktop Geometer's Sketchpad."},properties:{parents:{properties:{A:{description:"A point",kind:"Point"},B:{description:"A point",kind:"Point"},C:{description:"A point",kind:"Point"},p0:{suppressed:true},p1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-AngleBisector_export.json"},constrain:function(){var F=this.getParent("A").geom.loc,E=this.getParent("B").geom.loc,K=this.getParent("C").geom.loc,J,H,I,G,D;this.geom.p0=this.geom.p1=this.geom.xp0=this.geom.xp1=h;if(F.equals(E)||E.equals(K)){this.state.exists=false}else{J=F.subtract(E);H=Math.sqrt(9000/J.dot(J));I=E.add(J.multiply(H));J=K.subtract(E);H=Math.sqrt(9000/J.dot(J));G=E.add(J.multiply(H));D=I.add(G).multiply(0.5);J=D.subtract(E);if((Math.abs(J.x)>0.01)||(Math.abs(J.y)>0.01)){this.geom.p1=D;this.geom.xp0=this.geom.p0=E;this.geom.xp1=E.add(J.multiply(10000))}else{this.state.exists=false}}},getParentalNameMFS:function(){return y.mfs.makeTextMFS("AngleBisector "+this.id)}});y.gConstraints.ArcAroundPoint=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines an arc centered about a point, counter-clockwise from the first selected bounding point to the second.",inherits:"Constraint",refspec:{gspRef:"ArcAroundPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcAroundPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Arc"]},existenceRule:"Exists iff parents exist, and parental points are not coincident.",properties:{parents:{description:"",properties:{center:{description:"Center of circle on which the arc is situated",kind:"Point"},p0:{description:"First bounding point",kind:"Point"},p1:{description:"Second bounding point",kind:"Point"}}}}},constrain:function(){var F=this.getParent("center").geom.loc;var E=this.getParent("p0").geom.loc;var D=this.getParent("p1").geom.loc;this.geom.arc=y.GeometricArc.FromCenterAndEndpoints(F,E,D,-1);this.state.exists=this.geom.arc.exists},getParentalNameMFS:function(){return y.mfs.parentsHorizontalOverbar(this,["p0","p1"])}});y.gConstraints.Arc3Points=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines an arc from three points.",inherits:"Constraint",refspec:{gspRef:"Arc3Points_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Arc3Points_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Arc"]},existenceRule:"Exists iff parent points exist and are not pairwise coincident.",properties:{parents:{description:"",properties:{p0:{description:"Initial point",kind:"Point"},p1:{description:"Middle point",kind:"Point"},p2:{description:"Final point",kind:"Point"}}}}},constrain:function(){var F=this.getParent("p0").geom.loc;var E=this.getParent("p1").geom.loc;var D=this.getParent("p2").geom.loc;this.geom.arc=y.GeometricArc.FromThreePoints(F,E,D);this.state.exists=this.geom.arc.exists},getParentalNameMFS:function(){return y.mfs.parentsHorizontalOverbar(this,["p0","p1","p2"])}});y.gConstraints.ArcInterior=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Base class for arc interiors: ArcSegment, ArcSector.",inherits:"Constraint",usage:{"abstract":true,kinds:["ArcInterior"]},existenceRule:"Exists iff parents exist.",properties:{parents:{description:"",properties:{arc:{description:"Defining arc",kind:"Arc"}}}}},constrain:function(){var D=this.getParent("arc");this.geom.arc=D.getGeometricArc();this.state.exists=D.state.exists&&isFinite(this.geom.arc.radius)},getParentalNameMFS:function(){return this.getParent("arc").getNameMFS()}});y.gConstraints.ArcOnCircle=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines an arc on circle, counter-clockwise from the first selected bounding point to the second.",inherits:"Constraint",refspec:{gspRef:"ArcOnCircle_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcOnCircle_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Arc"]},existenceRule:"Exists iff parent points exist and are not coincident.",properties:{parents:{description:"",properties:{circle:{description:"Circle on which the arc is situated",kind:"Circle"},p0:{description:"First bounding point",kind:"Point"},p1:{description:"Second bounding point",kind:"Point"}}}}},constrain:function(){var F=this.getParent("circle").geom.c;var E=this.getParent("p0").geom.loc;var D=this.getParent("p1").geom.loc;this.geom.arc=y.GeometricArc.FromCenterAndEndpoints(F,E,D,-1);this.state.exists=this.geom.arc.exists},getParentalNameMFS:function(){return y.mfs.parentsHorizontalOverbar(this,["p0","p1"])}});y.gConstraints.ActionButton=y.makeClass(y.gConstraints.Free,{doc:{description:"The parent class of all action button constraints.",refspec:{},inherits:"Free",usage:{"abstract":true,kinds:["Button"]},existenceRule:"Exists regardless of existence of parents.",properties:{messages:{description:"First message is default button label",type:"Array",required:false}}},constrain:function(){if(this.messages&&this.messages.length){this.label=this.messages[0]}},press:function(E,D){y.log("press() not implemented for this button; Constraint: "+this.constraint)}});y.gConstraints.Calculation=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A calculated expression",inherits:"Constraint",refspec:{gspRef:"CalculationM_C"},usage:{"abstract":false,kinds:["Expression"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"An associative array of objects used in the expression.",type:"Array"},blank:{suppressed:true}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Expression-Calculation_export.json"},baseUnits:{angle:y.units.unitFamilies.angle.baseUnit,length:y.units.unitFamilies.length.baseUnit},constrain:function(){this.uValue=this.fnExpression(this.parentsList,this.fnUnits);this.blank=y.math.isDefined(this.uValue)?false:this.determineParentalBlank();this.value=this.uValue*this.unitMultiplier}});y.gConstraints.CircleByRadius=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a circle from a center point and the length of a <span class="genus">Path</span>.',inherits:"Constraint",refspec:{gspRef:"CircleRadius_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CircleRadius_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Circle"]},existenceRule:"Exists iff parent center point and path or measure exist and the length or the value is finite and positive.",properties:{parents:{description:"",properties:{p0:{description:"The center point.",kind:"Point"},radius:{description:"A parent whose length or value provides the radius.",kind:"Measure",genus:"Path"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Circle-CircleByRadius_export.json"},constrain:function(){var G,E,D,F;G=this.getParent("center");if(!G){G=this.getParent("p0")}E=G.geom.loc;D=this.getParent("radius");if(D.pathLength){F=D.pathLength()}else{F=D.value}this.geom.c=E;this.geom.r=F;this.state.exists=(this.geom.r>0)&&y.math.isFiniteScalar(this.geom.r)}});y.gConstraints.CircleFromTwoPoints=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines a circle from a center point and a point on the circumference.",inherits:"Constraint",refspec:{gspRef:"Circle_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Circle_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Circle"]},existenceRule:"Exists iff parent points exist and are not coincident.",properties:{parents:{description:"",properties:{p0:{description:"The center of the circle",kind:"Point"},p1:{description:"A point on the circle",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Circle-CircleFromTwoPoints_export.json"},constrain:function(){var E=this.getParent("p0").geom.loc;var D=this.getParent("p1").geom.loc;this.geom.c=E;this.geom.r=D.subtract(E).vLength();this.state.exists=Boolean(this.geom.r)},getParentalNameMFS:function(){var G,F,D,E;G=this.getParent("p0");F=this.getParent("p1");D=G.getNameMFS();E=F.getNameMFS();return y.mfs.makeHorizontalMFS(D,E)}});y.gConstraints.CircleInterior=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines a circle interior from a circle.",inherits:"Constraint",refspec:{gspRef:"CircleInterior_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CircleInterior_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["CircleInterior"]},existenceRule:"Exists iff parents exist.",properties:{parents:{description:"",properties:{circle:{description:"The defining circle",kind:"Circle"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/CircleInterior-CircleInterior_export.json"},constrain:function(){var D=this.getParent("circle");this.geom.c=D.geom.c;this.geom.r=D.geom.r},getParentalNameMFS:function(){return this.getParent("circle").getNameMFS()}});y.gConstraints.Colorize=y.makeClass(y.gConstraints.Transform,{doc:{description:"Defines a new GObject that is coincident to another GObject, but colored differently.",inherits:"Transform",refspec:{gspRef:"Colorization_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Colorization_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":true,subKinds:["Picture"]},existenceRule:"Exists iff the parent measures exist and are finite.",properties:{colorRange:{description:"Color Range: 'LimitToRange', 'WrapToRange', 'ReflectToRange'",type:"String"},colorModel:{description:"Color model of parameters: 'UnivariateHue', 'UnivariateIntensity', 'TrivariateRGB', 'TrivariateHSV'",type:"String"},parameterDomainFrom:{description:"Lower bound of parameter domain.",type:"Number"},parameterDomainTo:{description:"Upper bound of parameter domain.",type:"Number"},style:{type:"Object",properties:{color:{suppressed:true}}}}},constraintChangesColor:true,getTransform:function(){return function(D){return D.copy()}},normalizeColorParameter:function(E){var D,F;F=(E-this.parameterDomainFrom)/(this.parameterDomainTo-this.parameterDomainFrom);D=Math.floor(F);F=F-D;if("LimitToRange"===this.colorRange){if(D<0){F=0}else{if(D>0){F=1}}D=0}D=Math.abs(D);if((1===(D%2))&&(0===F)){D--;F=1}if(("ReflectToRange"===this.colorRange)&&(1===((D)%2))){F=1-F}if(F<0){F=0}else{if(F>1){F=1}}return F},constrain:function u(){var E,D;(u.base||arguments.callee.base).call(this);E=this.convertToColor();if(E){D="rgb(";D+=Math.floor(255*E.red);D+=",";D+=Math.floor(255*E.green);D+=",";D+=Math.floor(255*E.blue);D+=")";this.style.color=D}},constraintVerificationString:function z(D){var E=(z.base||arguments.callee.base).call(this);if(D&&D.color){E+=this.testConsistency("color",this.style.color,D.color)}return E}});y.gConstraints.Function=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A calculated expression",inherits:"Constraint",refspec:{gspRef:"FunctionM_C"},usage:{"abstract":false,kinds:["Expression"]},existenceRule:"Exists iff the parent objects exist.",properties:{parents:{description:"An associative array of objects used in the expression.",type:"Array"},blank:{suppressed:true}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Expression-Function_export.json"},baseUnits:{angle:y.units.unitFamilies.angle.baseUnit,length:y.units.unitFamilies.length.baseUnit},constrain:function(){var D=this;this.uValue=this.curryReferences(this,this.parentsList,this.fnUnits);this.blank=this.determineParentalBlank();this.value=function(E){return D.uValue(E)*D.unitMultiplier}}});y.gConstraints.FunctionPlot=(function(){return y.makeClass([y.gConstraints.Constraint,y.mixins.pointVector],{doc:{description:"A simple function plot",inherits:"Constraint",refspec:{gspRef:"FunctionPlot_C"},usage:{"abstract":false,kinds:["Sampler"]},existenceRule:"Exists iff the parent function and coordinate system exist and at least one sample of the plot exists",properties:{parents:{properties:{"function":{description:"The function evaluated for x",kind:"Expression"},coordSys:{description:"The coordinate system in which the function is evaluated.",kind:"CoordSys"}}}}},getFunctionType:function(){var E=this.getParent("function");return E&&E.expressionType},updateConstraintAncestry:function D(){var G=this.getFunctionType(),F=this.sQuery.sketch.preferences.units.angle,E={};if(G==="RofT_FunctionExprType"){E.conversionFactor=y.units.convert(1,"rad",F,1);E.polar=true;E.invertXAndY=false}else{if(G==="TofR_FunctionExprType"){E.conversionFactor=y.units.convert(1,F,"rad",1);E.polar=true;E.invertXAndY=true}else{if(G==="XofY_FunctionExprType"){E.conversionFactor=1;E.polar=false;E.invertXAndY=true}else{if(G==="YofX_FunctionExprType"){E.conversionFactor=1;E.polar=false;E.invertXAndY=false}}}}this.plottingInfo=E;this.pseudoSampleGObj=y.makeClass(y.mixins.pointVector,{fillSingleSample:function(){throw y.createError("fillSingleSample() should not be called on functionPlot's sample vector")},setAllSamples:function(M,O,N){if(O){M.samples=O;M.filledSampleCount=N;var K=null,I=null,J=null,H=null,Q,P;for(var L=0;L<O.length;L+=2){Q=O[L];P=O[L+1];if(isFinite(Q)&&isFinite(P)){K=((K===null)||(Q<K))?Q:K;J=((J===null)||(P<J))?P:J;I=((I===null)||(Q>I))?Q:I;H=((H===null)||(P>H))?P:H}}M.geomBounds={left:K,top:J,right:I,bottom:H}}else{M.samples=null;M.filledSampleCount=0;M.geomBounds=null}}});this.vectorContext=this.pseudoSampleGObj.createVectorContext(this.numSamples,this,false);this.vectorContext.isDiscrete=this.isDiscrete},isSamplingRequired:function(F){var E=this.getParent("function");return !this.rawSamples||(this.state.constraintFrame<=E.state.constraintFrame)},computeSamples:function(I,S,K,L){var M=y.createFloatVector(L*2),Q,P,T=(K-S)/(L-1),H,J=false,O=this.plottingInfo.conversionFactor,F=this.plottingInfo.polar,N=this.plottingInfo.invertXAndY,R,E,G;for(H=0;H<L;++H){Q=T*H+S;P=I(Q)*O;if(!J&&isFinite(P)){J=true}if(N){R=Q;Q=P;P=R}if(F){G=Q;E=P;Q=E*Math.cos(G);P=E*Math.sin(G)}M[2*H]=Q;M[2*H+1]=P}return J&&M},constrain:function(J){var H=this.getParent("function"),G=this.getParent("coordSys"),I=this.isSamplingRequired(J),E=H&&G&&H.state.exists&&G.state.exists;if(E){if(I){this.rawSamples=this.computeSamples(H.uValue,this.driverDomain.low,this.driverDomain.high,this.numSamples)}if(this.rawSamples){var F=G.vectorLocatePlot(this.rawSamples);this.pseudoSampleGObj.setAllSamples(this.vectorContext,F,this.numSamples);if(I){this.pseudoSampleGObj.recomputeDiscontinuities(this.vectorContext)}}else{this.pseudoSampleGObj.setAllSamples(this.vectorContext,null)}}this.state.exists=this.rawSamples&&E},getParentalNameMFS:function(){var H=this.getParent("function"),G=this.getParent("coordSys"),J=G.getParent("axisX"),E=G.getParent("axisY"),K=H.expressionType,F,I;if((K==="RofT_FunctionExprType")||(K==="YofX_FunctionExprType")){F=J.getNameMFS();I=E.getNameMFS()}else{I=J.getNameMFS();F=E.getNameMFS()}return y.mfs.makeHorizontalMFS(I,y.mfs.makeTextMFS(" = "),H.getLabelMFS(),y.mfs.makeTextMFS("("),F,y.mfs.makeTextMFS(")"))},sampleGObj:function(){return this.pseudoSampleGObj},samplerPathValueToPosition:function(G){var K=this.getParent("function"),I=this.getParent("coordSys"),E=G,L=K.uValue(E)*this.plottingInfo.conversionFactor,F,J,H;if(this.plottingInfo.invertXAndY){F=E;E=L;L=F}if(this.plottingInfo.polar){H=E;J=L;E=J*Math.cos(H);L=J*Math.sin(H)}return I.locatePlot(E,L)},samplerPositionToPathValue:function(G){var F=this.pseudoSampleGObj.positionToPathValueForVector(this.vectorContext,G),E=this.driverDomain.high-this.driverDomain.low;return this.driverDomain.low+F*E},samplerConstrainRange:function(G){var F=G,E=this.driverDomain.low,H=this.driverDomain.high;if(G>H){F=H}if(G<E){F=E}return F},samplerIsValueInBounds:function(E){return((E>=this.driverDomain.low)&&(E<=this.driverDomain.high))}})})();y.gConstraints.Intersection=y.makeClass(y.gConstraints.Constraint,{doc:{description:'A point defined by the intersection of two <span class="kind">Straight</span> objects.',inherits:"Constraint",refspec:{gspRef:"InterLL_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, InterLL_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff parents exist and are not parallel and the intersection point is within the extent of both parents. E.g., the lines containing two segments might intersect outside the extent of the segments. In this case the intersection point for the segments would not exist.",properties:{parents:{description:"",properties:{line0:{description:"",kind:"Straight"},line1:{description:"",kind:"Straight"}}},style:{description:"Appearance of GObject",properties:{color:{description:'"(black)',type:"Color"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Intersection_export.json"},constrain:function(){var E=this.getParent("line0");var D=this.getParent("line1");this.geom.loc=y.Geom.LineLineIntersection(E,D);this.state.exists=this.geom.loc.isDefined()}});y.gConstraints.Line=y.makeClass(y.gConstraints.Straight,{doc:{description:"A straight line that extends to infinity.",inherits:"Straight",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent points exist and are not coincident.",properties:{parents:{description:"",properties:{p0:{description:"First reference point defining the line",kind:"Point"},p1:{description:"Second reference point defining the line",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Line_export.json"},overbarType:4,getPointOnPath:function(D,E){return this.getPointOnLine(D,E)},constrain:function(){var J,H,E,D,I,G,F;J=this.getStraightP0();this.geom.p0=J;H=this.getStraightP1();this.geom.p1=H;E=H.subtract(J);if(E.isZeroLength()){this.geom.xp0=y.GeometricPoint(0,0);this.geom.xp1=y.GeometricPoint(0,0)}else{D=E.vLength();I=10000/D;G=J.add(E.multiply(-I));F=J.add(E.multiply(I));this.geom.xp0=G;this.geom.xp1=F}this.state.exists=!E.isZeroLength()}});y.gConstraints.MeasurementAngle=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of an angle defined by three points.",inherits:"Constraint",refspec:{gspRef:"Angle3PointsMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Angle3PointsMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},p1:{description:"",kind:"Point"},p2:{description:"",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementAngle_export.json"},unitPowers:{angle:1},constrain:function(){var E=this.getParent("p0").geom.loc,D=this.getParent("p1").geom.loc,H=this.getParent("p2").geom.loc,G,F=this.sQuery().prefs().units.angle;G=y.GeometricPoint.threePointFlippedAngle(E,D,H);if(F==="deg"){if(G<0){G+=(2*Math.PI)}if(G>Math.PI){G=(2*Math.PI)-G}}this.value=G;this.uValue=y.units.convert(G,"radians",F)},getParentalNameMFS:function(){var G,D,F,H=[];G=this.parentsList;for(D=0;D<G.length;D+=1){F=G[D].getNameMFS();if(y.mfs.isEmptyTextMFS(F)){F=y.mfs.makeTextMFS(G[D].id)}H.push(F)}var E=y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS.apply(this,H));return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m",true),{type:"symbol",value:"d0"},E)}});y.gConstraints.MeasurementAngleMarker=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The value of an angle marker",inherits:"Constraint",refspec:{gspRef:"AngleMarkerMeasure_C"},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent marker exists.",properties:{parents:{properties:{marker:{description:"The AngleMarker to be measured",kind:"AngleMarker"}}}}},unitPowers:{angle:1},genus:"AngleMeasure",constrain:function(){var D=this.getParent("marker"),E=this.sQuery().prefs().units.angle,F;F=-D.value;this.value=F;if(E==="deg"){if(F<0){F=-F}}this.uValue=y.units.convert(F,"radians",E)},getParentalNameMFS:function(){var D=this.getParent("marker"),E;E=D.getNameMFS();if(y.mfs.isEmptyTextMFS(E)){E=y.mfs.makeTextMFS(D.id)}var F=y.mfs.makeItalicMFS(E);var G=D.label?[F]:[y.mfs.makeTextMFS("m",true),{type:"symbol",value:"d0"},F];return y.mfs.makeHorizontalMFS.apply(this,G)}});y.gConstraints.MeasurementArea=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the area of a <span class="kind">Polygon</span>, <span class="kind">Circle</span>, or <span class="kind">CircleInterior</span>.',inherits:"Constraint",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint, TBD, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist and are not all coincident.",properties:{parents:{description:"",properties:{shape:{description:"",kind:"Arc|Circle|Polygon"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementArea_export.json"},unitPowers:{length:2},constrain:function(){var D,E;E=this.getParent("shape");D=E.area();this.value=D;this.uValue=y.units.convertFromBaseToUnitObject(D,this.unitsObject)},getParentalNameMFS:function(){var D=this.getParent("shape"),E=[y.mfs.makeTextMFS("Area ")];if(D.kind==="Circle"||D.kind==="CircleInterior"){E.push({type:"symbol",value:"100"})}E.push(y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(D.getNameMFS())));return y.mfs.makeHorizontalMFS.apply(this,E)}});y.gConstraints.MeasurementCircumference=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the circumference of a <span class="kind">Circle</span>.',inherits:"Constraint",refspec:{gspRef:"CircumferenceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CircumferenceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent circle exists.",properties:{parents:{description:"",properties:{shape:{description:"The circle whose circumference is to be measured",kind:"Circle"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementCircumference_export.json"},unitPowers:{length:1},constrain:function(){var F,E,D=this.sQuery().prefs().units.length;E=this.getParent("shape");F=E.circumference();this.value=F;this.uValue=y.units.convert(F,"pixels",D)},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Circumference "),{type:"symbol",value:"100"},y.mfs.makeItalicMFS(this.getParent("shape").getNameMFS()))}});y.gConstraints.MeasurementCoordinateBased=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The parent class for all coordinate-system based constraints.",inherits:"Constraint",usage:{"abstract":true,kinds:["Measure"]},properties:{parents:{description:"",properties:{coordSys:{description:"The coordinate system used for the measurements",kind:"CoordSys"}}}}},unitPowers:{scalar:1},getCoordinates:function(E){var D=this.getParent("coordSys");return D.locatePoint(E.geom.loc)}});y.gConstraints.MeasurementDistance=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the distance between two <span class="kind">Point</span>s.',inherits:"Constraint",refspec:{gspRef:"DistanceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, DistanceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"",properties:{p0:{description:"The point from which distance is to be measured",kind:"Point"},obj0:{description:"The point or line to which distance is to be measured",kind:"Point|Straight"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementDistance_export.json"},unitPowers:{length:1},constrain:function(){var H,G,F,I,E,D=this.sQuery().prefs().units.length;G=this.getParent("p0");I=G.geom.loc;F=this.getParent("obj0");if(F.kind==="Point"){E=F.geom.loc;H=E.subtract(I).vLength()}else{if(F.isOfKind("Straight")){E=F.getClosestPointOnLine({p0:F.getZeroPoint(),p1:F.getUnitPoint()},I);H=E.subtract(I).vLength()}else{y.log(this.id+": Cannot compute distance from point to object: "+F.id+"("+F.kind+")")}}this.value=H;this.uValue=y.units.convert(H,"pixels",D)},getParentalNameMFS:function(){var G,F,E,D;F=this.getParent("obj0");G=this.getParent("p0");D=F.getNameMFS();E=G.getNameMFS();if(F.kind==="Straight"){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Distance "),y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(E)),y.mfs.makeTextMFS(" to "),y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(D)))}else{return y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(E,D))}}});y.gConstraints.MeasurementLength=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the length of a <span class="constraint">Segment</span>s.',inherits:"Constraint",refspec:{gspRef:"LengthM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, LengthM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists if the parent segment exists. Also exists if the parent segment is an original segment and end-points are coincident. Then, the length is zero.",properties:{parents:{description:"",properties:{path:{description:"",genus:"Path"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementLength_export.json"},unitPowers:{length:1},checkParentsExist:function(){return true},checkExists:function(){var D=this.getParent("path");if(D.state.exists){return true}if((D.constraint==="Segment")&&D.getParent("p0").state.exists&&D.getParent("p1").state.exists){return true}return false},constrain:function(){var D,F=this.getParent("path"),E=this.sQuery().prefs().units.length;this.state.exists=this.checkExists();if(this.state.exists){D=(F.state.exists)?F.pathLength():0;this.value=D;this.uValue=y.units.convert(D,"pixels",E)}},getParentalNameMFS:function(){var E,F=this.getParent("path"),D=(F.label||F.isTransformationConstraint)?[]:[y.mfs.makeTextMFS("m ",true)];E=F.getNameMFS();if(y.mfs.isEmptyTextMFS(E)){E=y.mfs.makeTextMFS(F.id)}D.push(y.mfs.makeItalicMFS(E));return y.mfs.makeHorizontalMFS.apply(this,D)}});y.gConstraints.MeasurementPerimeter=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the perimeter of a <span class="kind">Polygon</span>s.',inherits:"Constraint",refspec:{gspRef:"PerimeterM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PerimeterM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points all exist and are not coincident.",properties:{parents:{description:"",properties:{shape:{description:"",kind:"Arc|Polygon"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementPerimeter_export.json"},unitPowers:{length:1},constrain:function(){var F,E,D;E=this.getParent("shape");F=E.perimeter();D=this.sQuery().prefs().units.length;this.value=F;this.uValue=y.units.convert(F,"pixels",D)},getParentalNameMFS:function(){var D=this.getParent("shape");return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Perimeter "),y.mfs.makeItalicMFS(D.getNameMFS()))}});y.gConstraints.MeasurementRadius=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the radius of a <span class="kind">Circle</span>.',inherits:"Constraint",refspec:{gspRef:"RadiusM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RadiusM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent circle exist.",properties:{parents:{description:"",properties:{shape:{description:"",kind:"Arc|Circle"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementRadius_export.json"},unitPowers:{length:1},constrain:function(){var D,F,E=this.sQuery().prefs().units.length;F=this.getParent("shape");D=F.radius();if(!isFinite(D)){D=Number.POSITIVE_INFINITY}this.value=D;this.uValue=y.units.convert(D,"pixels",E)},getParentalNameMFS:function(){var E=[y.mfs.makeTextMFS("Radius ")],D=this.getParent("shape").kind;if(D==="Circle"||D==="CircleInterior"){E.push({type:"symbol",value:"100"})}E.push(y.mfs.makeItalicMFS(this.getParent("shape").getNameMFS()));return y.mfs.makeHorizontalMFS.apply(this,E)}});y.gConstraints.MeasurementRatio=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of the ratio of two segments or three points.",inherits:"Constraint",refspec:{gspRef:"RatioM_C"},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points all exist and are not coincident.",properties:{parents:{description:"",properties:{obj0:{description:"First segment or point",kind:"Straight|Point"},obj1:{description:"Second segment or point",kind:"Straight|Point"},obj2:{description:"Third point",kind:"Point",required:false}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementRatio_export.json"},unitPowers:{scalar:1},ratioFromTwoSegments:function(){var E=this.getParent("obj0"),D=this.getParent("obj1"),F;this.state.exists=E.state.exists&&D.state.exists;if(this.state.exists){F=E.pathLength()/D.pathLength();return F}},ratioFromThreePoints:function(){var G=this.getParent("obj0"),F=this.getParent("obj1"),E=this.getParent("obj2"),D;this.state.exists=G.state.exists&&F.state.exists&&E.state.exists;if(this.state.exists){D=y.GeometricPoint.mapPointToLine(G.geom.loc,F.geom.loc,E.geom.loc).param;if(isNaN(D)){if(G.geom.loc.equals(F.geom.loc)&&!F.geom.loc.equals(E.geom.loc)){D=Number.POSITIVE_INFINITY}}return D}},constrain:function(){var D,E=this.getParent("obj0");if(E.kind==="Straight"){D=this.ratioFromTwoSegments()}else{D=this.ratioFromThreePoints()}this.value=D;this.uValue=D},nameFromTwoSegments:function(){var E=this.getParent("obj0"),D=this.getParent("obj1");return{type:"fraction",value:[y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m ",true),E.getNameMFS()),y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m ",true),D.getNameMFS())]}},nameFromThreePoints:function(){var F=this.getParent("obj0"),E=this.getParent("obj1"),D=this.getParent("obj2");return{type:"fraction",value:[y.mfs.makeHorizontalMFS(F.getNameMFS(),D.getNameMFS()),y.mfs.makeHorizontalMFS(F.getNameMFS(),E.getNameMFS())]}},getParentalNameMFS:function(){var D,E=this.getParent("obj0");if(E.kind==="Straight"){D=this.nameFromTwoSegments()}else{D=this.nameFromThreePoints()}return D}});y.gConstraints.MeasurementValueOfPointOnPath=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of the value of a point on path",inherits:"Constraint",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint, TBD, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist and are not all coincident.",properties:{parents:{properties:{point:{description:"The point",kind:"Point"},path:{description:"The path that the point lives on.",genus:"Path"}}}}},unitPowers:{scalar:1},constrain:function(F){var D,E;D=this.getParent("point");E=this.getParent("path");this.value=E.mapPositionToPathValue(D.geom.loc);this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(this.getParent("point").getNameMFS(),y.mfs.makeTextMFS(" on "),this.getParent("path").getNameMFS())}});y.gConstraints.MultimeasureBase=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Abstract class for multimeasure constraints .",inherits:"Constraint",usage:{"abstract":true,kinds:["Text"]},existenceRule:"Exists iff the parents exist."},isMultimeasure:true,values:{},precisions:{},units:{},initTextMFS:function(){y.signalErrorWithMessage("Multimeasures must implement initTextMFS")},initUnits:function(){y.signalErrorWithMessage("Multimeasures must implement initUnits")},initPrecision:function(){y.signalErrorWithMessage("Multimeasures must implement initPrecision")},initConstraint:function(){this.initUnits();this.initPrecision()},updateLabelForConstraint:function i(){(i.base||i.callee.base).call(this);this.initTextMFS()},getValuesAsMFS:function(){var E=this,D={};if(!E.formatNumberAsMFS){y.signalErrorWithMessage("multimeasures are required to be Text kind")}g.each(E.values,function(F,G){D[F]=E.formatNumberAsMFS(G,E.precisions[F],E.units[F],false)});return D},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},verificationString:function f(E,D){return""}});y.gConstraints.MeasurementRectCoordinates=y.makeClass(y.gConstraints.MultimeasureBase,{doc:{description:"The (x, y) coordinates of a point relative to a coordinate system.",inherits:"MultiMeasureBase",refspec:{gspRef:"RectCoordinateM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RectCoordinateM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},initTextMFS:function(){var F=this.getParent("point"),E=F.getNameMFS(),H={type:"parameter",value:"xValue"},D={type:"parameter",value:"yValue"},G=y.mfs.makeHorizontalMFS(H,y.mfs.makeTextMFS(", "),D);this.valuesMFS={type:"paren",value:[G]};this.parsedMFS=y.mfs.makeHorizontalMFS(E,y.mfs.makeTextMFS(": "),this.valuesMFS)},initUnits:function(){this.units={xValue:"scalar",yValue:"scalar"}},initPrecision:function(){var D=this.sQuery().prefs(),E=D.precision.scalar;this.precisions={xValue:E,yValue:E}},constrain:function(){var E=this.getParent("coordSys"),D=this.getParent("point"),F=E.locatePoint(D.geom.loc);this.values={xValue:F.x,yValue:F.y}},getMFSAppearanceForVariant:function(){var D=g.extend(true,{},this.valuesMFS);y.mfs.realizeParamNodes(D,this.getValuesAsMFS());return D}});y.gConstraints.MeasurementPolarCoordinates=y.makeClass(y.gConstraints.MultimeasureBase,{doc:{description:"The (r, theta) coordinates of a point relative to a coordinate system.",inherits:"MultiMeasureBase",refspec:{gspRef:"PolarCoordinateM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PolarCoordinateM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},initTextMFS:function(){var E=this.getParent("point"),D=E.getNameMFS(),G={type:"parameter",value:"rValue"},H={type:"parameter",value:"thetaValue"},F=y.units.makeUnitObjectFromUnitsAndPowers({angle:this.units.thetaValue},{angle:1}),I=y.units.getMFSForUnitObject(F),J=y.mfs.makeHorizontalMFS(G,y.mfs.makeTextMFS(", "),H,I);this.valuesMFS={type:"paren",value:[J]};this.parsedMFS=y.mfs.makeHorizontalMFS(D,y.mfs.makeTextMFS(": "),this.valuesMFS)},initUnits:function(){var D=this.sQuery().prefs().units;this.units={rValue:"scalar",thetaValue:D.angle}},initPrecision:function(){var D=this.sQuery().prefs();this.precisions={rValue:D.precision.scalar,thetaValue:D.precision.angle}},constrain:function(){var E=this.getParent("coordSys"),D=this.getParent("point"),H=E.locatePoint(D.geom.loc),G=H.vLength(),F=Math.atan2(H.y,H.x);this.values={rValue:G,thetaValue:y.units.convert(F,"radians",this.units.thetaValue)}},getMFSAppearanceForVariant:function(){var D=g.extend(true,{},this.valuesMFS);y.mfs.realizeParamNodes(D,this.getValuesAsMFS());return D}});y.gConstraints.Midpoint=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The midpoint of a <span class="constraint">Segment</span>.',inherits:"Constraint",refspec:{gspRef:"Midpoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Midpoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent segment exists.",properties:{parents:{description:"",properties:{path:{description:"",kind:"Straight"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Midpoint_export.json"},state:{},constrain:function(){var E,D;E=this.getParent("path");D=E.mapPathValueToPosition(0.5);this.state.exists=E.state.exists;this.geom.loc=D}});y.gConstraints.Pegged=y.makeClass(y.gConstraints.Constraint,{doc:{description:'A translation of a <span class="kind">Text</span> message to a <span class="kind">Point</span>.',inherits:"Constraint",refspec:{gspRef:"PeggedText_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PeggedText_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff the parent text and point exist.",properties:{parents:{description:"",properties:{p0:{description:"The point to which the pegged text is bound.",kind:"Point"},text:{description:"The original text replicated by this object.",kind:"Text"}}},geom:{suppressed:true}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Text/Pegged_export.json"},style:{"text-align":"center","vertical-align":"middle"},constrain:function(){var D=this.getParent("p0"),E=this.getParent("text");this.parsedMFS=E.getStrippedMFSAppearanceForVariant("default");this.text=null;this.state.exists=(this.parsedMFS!==null)&&D.state.exists;if(this.state.exists){this.geom.loc=D.geom.loc}else{this.geom.loc=y.GeometricPoint.INFINITY}}});y.gConstraints.PointOnPath=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'A point on a <span class="genus">Path</span>.',inherits:"Constraint",refspec:{gspRef:"OnPath_C"},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent path exists.",properties:{value:{description:"",type:"Number"},parents:{description:"",properties:{path:{description:"",genus:"Path"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-PointOnPath_export.json"},updateValue:function(D){this.value=D},transform:function(G,D){var F,E;E=D.geom.loc.copy();D.affine.transform(E);F=this.getParent("path");this.updateValue(F.mapPositionToPathValue(E))},constraintVerificationString:function z(D){return this.testConsistency("value",this.value,D.value)}});y.gConstraints.PlotFixedValueOnPath=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'Defines a point on a <span class="genus">Path</span> that has a fixed value.',inherits:"Constraint",refspec:{gspRef:"PlotFixedValueOnPath_C"},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent path exists.",properties:{value:{description:"",type:"Number"},parents:{description:"",properties:{path:{description:"Identifies the path on which the point is plotted",genus:"Path"}}}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Point-PlotFixedValueOnPath_export.json"},isFreePointOnPath:false});y.gConstraints.PlotValueOnPath=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'Defines a point on a <span class="genus">Path</span> that has a value defined by a <span class="kind">Param</span>.',inherits:"Constraint",refspec:{gspRef:"PlotMarkedValueOnPath_C"},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent param and path exist.",properties:{parents:{description:"",properties:{param:{description:"Identifies a measure whose value determines the position on the path as a normalized path coordinate",kind:"Measure"},path:{description:"Identifies the path on which the point is plotted",genus:"Path"}}}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Point/PlottedPoint_export.json"},isFreePointOnPath:false,constrain:function u(){var D=this.getParent("param");this.value=D.uValue;(u.base||arguments.callee.base).call(this)}});y.gConstraints.Reflect=y.makeClass(y.gConstraints.Transform,{doc:{description:'Defines a <span class="kind">GObject</span> that is the reflection of another GObject with respect to a <span class="kind">Straight</span> object.',inherits:"Transform",refspec:{gspRef:"Reflect_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Reflect_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and mirror exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Reflection_export.json",properties:{parents:{description:"",properties:{mirror:{description:"",kind:"Straight"}}}}},determineExists:function(){return true},getTransform:function(){var D=this.getParent("mirror");return function(K){var F=D.geom.xp0,E=D.geom.xp1,M=F.x,L=F.y,J=E.x-M,I=E.y-L,H=J*J+I*I,G=((K.x-M)*J+(K.y-L)*I)/H;return y.GeometricPoint(2*(G*J+M)-K.x,2*(G*I+L)-K.y)}}});y.gConstraints.Rotate=y.makeClass(y.gConstraints.Transform,{doc:{description:"Defines a new GObject as a rotation of a GObject by a fixed angle about a pivot point p0.",inherits:"Transform",refspec:{gspRef:"RotatefA_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RotatefA_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Rotation_export.json",properties:{parents:{description:"",properties:{center:{description:"The center of the rotation",kind:"Point"}}},angle:{description:"",type:"Number",required:true}}},angle:0,determineExists:function(){var D=this.getAngle();return((typeof D!=="undefined")&&isFinite(D))},getPivot:function(){var D=this.getParent("center");return D.geom.loc},getAngle:function(){return this.angle},getTransform:function(){var D=this;return function(E){return E.rotate(D.getPivot(),D.getAngle())}}});y.gConstraints.Segment=y.makeClass(y.gConstraints.Straight,{doc:{description:"Defines a line segment from two points.",inherits:"Straight",refspec:{gspRef:"Segment_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Segment_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"",properties:{p0:{description:"First reference point defining the segment",kind:"Point"},p1:{description:"Second reference point defining the segment",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Segment_export.json"},overbarType:2,getPointOnPath:function(D,E){return this.getPointOnSegment(D,E)},constrain:function(){var D;this.geom.xp0=this.geom.p0=this.getStraightP0();this.geom.xp1=this.geom.p1=this.getStraightP1();D=this.geom.p1.subtract(this.geom.p0);this.state.exists=!D.isZeroLength()}});y.gConstraints.ColorizeTrivariate=y.makeClass(y.gConstraints.Colorize,{doc:{description:"Defines a new GObject that is coincident to another GObject, but colored differently.",inherits:"Colorize",refspec:{gspRef:"Colorization_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Colorization_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent measures exist and are finite.",properties:{parents:{description:"",properties:{red:{description:"For a trivariate parameterization, the red value.",kind:"Measure"},green:{description:"For a trivariate parameterization, the green value.",kind:"Measure"},blue:{description:"For a trivariate parameterization, the blue value.",kind:"Measure"}}}}},determineExists:function(){var F=this.getParent("red"),E=this.getParent("green"),D=this.getParent("blue");return !!(F&&y.math.isFiniteScalar(F.uValue)&&E&&y.math.isFiniteScalar(E.uValue)&&D&&y.math.isFiniteScalar(D.uValue))},convertToColor:function(){var G=this.getParent("red"),H=this.getParent("green"),P=this.getParent("blue"),D=G&&G.uValue,L=H&&H.uValue,N=P&&P.uValue;if(!y.math.isFiniteScalar(D)||!y.math.isFiniteScalar(L)||!y.math.isFiniteScalar(N)){return null}D=this.normalizeColorParameter(D);L=this.normalizeColorParameter(L);N=this.normalizeColorParameter(N);if("TrivariateHSV"===this.colorModel){var I,M,F,E,Q,K=D,J=L,O=N;if(J===0){D=L=N=O}else{K=K/(60/360);I=Math.floor(K);M=K-I;F=O*(1-J);E=O*(1-J*M);Q=O*(1-J*(1-M));switch(I){case 0:D=O;L=Q;N=F;break;case 1:D=E;L=O;N=F;break;case 2:D=F;L=O;N=Q;break;case 3:D=F;L=E;N=O;break;case 4:D=Q;L=F;N=O;break;default:D=O;L=F;N=E;break}}}return{red:D,green:L,blue:N}}});y.gConstraints.UnitPoint=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Base class for all unit point constraints",inherits:"Constraint",usage:{"abstract":true,kinds:["Point"]}},state:{},kMinUnitPointDistanceFromOrigin:0.1,unitPointDeltaX:function(){return 0},unitPointDeltaY:function(){return 0},unitPointOrigin:function(){return this.parents.origin},constrain:function(){var D=this.unitPointOrigin();this.geom.loc=y.GeometricPoint(D.geom.loc.getX()+this.unitPointDeltaX(),D.geom.loc.getY()+this.unitPointDeltaY())}});y.gConstraints.ColorizeUnivariate=y.makeClass(y.gConstraints.Colorize,{doc:{description:"Defines a new GObject that is coincident to another GObject, but colored differently.",inherits:"Colorize",refspec:{gspRef:"Colorization_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Colorization_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent measures exist and are finite.",properties:{parents:{description:"",properties:{color:{description:"For a univariate parameterization, the color value.",kind:"Measure"}}}}},determineExists:function(){var D=this.getParent("color");return !!(D&&y.math.isFiniteScalar(D.uValue))},convertToColor:function(){var G=this.getParent("color"),P=G&&G.uValue;if(!y.math.isFiniteScalar(P)){return null}var H=3800,K=5100,F=6450,L=4400,N=7800,S=3850,E=6750;var D=0,I=0,M=0,R,Q,O,J;O=this.normalizeColorParameter(P);if("UnivariateHue"===this.colorModel){Q=S+O*(E-S);if((Q<L)&&(Q>H)){M=1;D=(L-Q)/(L-H)}else{if(Q<K){J=(K-Q)/(K-L);I=1-J*J;J=(Q-L)/(K-L);M=1-J*J}else{if(Q<F){J=(Q-K)/(F-K);I=1-J*J;J=(F-Q)/(F-K);D=1-J*J}else{if(Q<N){D=1}else{D=1;I=1;M=1}}}}if(Q>7000){R=0.3+0.7*(N-Q)/(7800-7000)}else{R=1}}else{D=1;I=1;M=1;R=O}return{red:D*R,green:I*R,blue:M*R}}});y.gConstraints.AxisDist=y.makeClass(y.gConstraints.Line,{doc:{description:"An axis determined by origin and unitPoint.",inherits:"Line",refspec:{gspRef:"DistAxis_C"},usage:{"abstract":true,kinds:["Axis"]},existenceRule:"Exists iff the parent origin point and unitPoint exists.",properties:{parents:{description:"",properties:{origin:{description:"The origin of the axis",kind:"Point"},unitPoint:{description:"The unit point defines one unit along the axis",kind:"Point"},p0:{suppressed:true},p1:{suppressed:true}}}}},getStraightP0:function(){return this.geom.p0},getStraightP1:function(){return this.geom.p1},constrain:function u(){var F=100,E=this.geom.unit.subtract(this.geom.origin),D=E.multiply(F/E.vLength());D.y=-D.getY();this.geom.p0=this.geom.origin.subtract(D);this.geom.p1=this.geom.origin.add(D);(u.base||arguments.callee.base).call(this)},getParentalNameMFS:function(){var D=this.getParent("origin");return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("axis "),D.getNameMFS())}});y.gConstraints.ArcSector=y.makeClass(y.gConstraints.ArcInterior,{doc:{description:"Defines an arc sector, bounded by the arc and by the radii to the two endpoints of the arc",inherits:"ArcInterior",usage:{"abstract":false}}});y.gConstraints.ArcSegment=y.makeClass(y.gConstraints.ArcInterior,{doc:{description:"Defines a arc segment, bounded by the arc and by the chord connecting the two endpoints of the arc.",inherits:"ArcInterior",usage:{"abstract":false}}});y.gConstraints.DilateFixFactor=y.makeClass(y.gConstraints.Transform,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by a fixed factor.",inherits:"Transform",refspec:{gspRef:"DilatefR_C"},usage:{"abstract":false},existenceRule:"Exists iff the source object and the center point exists. For dilations of non-points, existence also requires that the dilation factor be non-zero.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-DilateFixFactor_export.json",properties:{parents:{description:"",properties:{center:{description:"The center of the dilation",kind:"Point"}}},scaleFactor:{description:"A scale factor.",type:"Number",required:false}}},scaleFactor:0,determineExists:function(){var D=this.getScaleFactor();return y.math.isFiniteScalar(D)&&((this.kind==="Point")||(D!==0))},getScaleFactor:function(){return this.scaleFactor},getPivot:function(){return this.getParent("center").geom.loc},getTransform:function(){var D=this;return function(E){return E.scale(D.getPivot(),D.getScaleFactor())}},getScalarTransform:function(){var D=this;return function(E){return Math.abs(E*D.getScaleFactor())}}});y.gConstraints.AxisExternalDist=y.makeClass(y.gConstraints.AxisDist,{doc:{description:"An axis determined by origin and parental unit distance.",inherits:"AxisDist",refspec:{gspRef:"ExternalDistAxis_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ExternalDistAxis_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Axis"]},existenceRule:"Exists iff the parent origin point exists and distance parent exists and is positive.",properties:{parents:{description:"",properties:{unitDistance:{description:"A measure or segment",kind:"Measure|Straight"},unitPoint:{suppressed:true}}}}},constrain:function u(){var H=this.getParent("unitDistance"),G=this.getParent("origin").geom.loc,F=H.pathLength?H.pathLength():H.value,E=0,D=0;if(isNaN(F)||(F<=0)){this.state.exists=false;return}if(this.orientation==="horizontal"){E=F}if(this.orientation==="vertical"){D=-F}this.geom.origin=y.GeometricPoint(G.getX(),G.getY());this.geom.unit=y.GeometricPoint(G.getX()+E,G.getY()+D);(u.base||arguments.callee.base).call(this)}});y.gConstraints.UnitPointExternalRectangle=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:"A unit point displaced perpendicularly from the origin of an axis by a given distance.",inherits:"UnitPoint",refspec:{gspRef:"ExternalRectangleUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ExternalRectangleUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent axis exists.",properties:{parents:{description:"",properties:{axis:{description:"The Axis for which this point is the unit point",kind:"Axis"}}},unitDistance:{description:"unit distance from grand-parental origin in pixels",type:"Number"}}},constrain:function(){var G=this.getParent("axis"),F=G.geom.origin.getX(),H=G.geom.origin.getY(),E=G.geom.unit.getX()-F,D=G.geom.unit.getY()-H,I=this.unitDistance;E=(E>0)?1:((E===0)?0:-1);D=(D>0)?1:((D===0)?0:-1);E*=I;D*=I;this.geom.loc=y.GeometricPoint(F+D,H-E)}});y.gConstraints.UnitPointExternalSquare=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:"A unit point displaced perpendicularly from the origin of an axis by the unit distance of that axis.",inherits:"UnitPoint",refspec:{gspRef:"ExternalSquareUnitPoint_C"},usage:{"abstract":false},existenceRule:"Exists iff the parent origin point exists and distance parent exists and is positive.",properties:{parents:{description:"",properties:{axis:{description:"The Axis for which this point is the unit point",kind:"Axis"}}}}},constrain:function(){var G=this.getParent("axis"),F=G.geom.origin.getX(),H=G.geom.origin.getY(),E=G.geom.unit.getX()-F,D=G.geom.unit.getY()-H;this.geom.loc=y.GeometricPoint(F+D,H-E)}});y.gConstraints.HorizontalUnitPoint=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:'A unit point of a horizontal <span class="kind">Axis</span>.',inherits:"UnitPoint",refspec:{gspRef:"HorizontalUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, HorizontalUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent origin point exists.",properties:{value:{description:"horizontal displacement from parental origin in pixels.",type:"Number"},parents:{description:"",properties:{origin:{description:"origin point of related axis.",kind:"Point"}}}}},value:20,unitPointDeltaX:function(){return this.value},transform:function(G,F){var D=this.unitPointOrigin(),E=F.geom.loc.copy();F.affine.transform(E);this.value=Math.max(this.kMinUnitPointDistanceFromOrigin,(E.getX()-D.geom.loc.getX()))}});y.gConstraints.AxisInternalDist=y.makeClass(y.gConstraints.AxisDist,{doc:{description:"An axis determined by origin and unitPoint.",inherits:"AxisDist",refspec:{gspRef:"InternalDistAxis_C"},usage:{"abstract":false,kinds:["Axis"]},existenceRule:"Exists iff the parent origin point and unitPoint exists.",properties:{parents:{description:"",properties:{origin:{description:"",genus:"Point"},unitPoint:{description:"",genus:"Point"}}}}},constrain:function u(){var E=this.getParent("origin").geom.loc,D=this.getParent("unitPoint").geom.loc;this.geom.origin=y.GeometricPoint(E.getX(),E.getY());this.geom.unit=y.GeometricPoint(D.getX(),D.getY());(u.base||arguments.callee.base).call(this)}});y.gConstraints.UnitPointInternalRectangle=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:"A unit point displaced perpendicularly from the origin of a parental axis of a unit point by a given distance.",inherits:"UnitPoint",refspec:{gspRef:"InternalRectangleUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, InternalRectangleUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent unitPoint exists.",properties:{parents:{description:"",properties:{unitPoint:{description:"",kind:"Point"}}},unitDistance:{description:"unit distance from grand-parental origin in pixels",type:"Number"}}},transform:function(H,F){var G=this.getParent("unitPoint"),D=G.getParent("origin"),E=F.geom.loc.copy();F.affine.transform(E);this.unitDistance=Math.max(this.kMinUnitPointDistanceFromOrigin,(D.geom.loc.getY()-E.getY()))},constrain:function(){var J=this.getParent("unitPoint"),F=J.getParent("origin"),G=F.geom.loc.getX(),H=F.geom.loc.getY(),I=this.unitDistance,E=J.geom.loc.getX()-G,D=J.geom.loc.getY()-H;E=(E>0)?1:((E===0)?0:-1);D=(D>0)?1:((D===0)?0:-1);E*=I;D*=I;this.geom.loc=y.GeometricPoint(G+D,H-E)}});y.gConstraints.UnitPointInternalSquare=y.makeClass([y.gConstraints.UnitPoint,y.mixins.transformable],{doc:{description:"A unit point displaced perpendicularly from the origin of a parental axis of a unit point by the unit distance of that axis.",inherits:"UnitPoint",refspec:{gspRef:"InternalSquareUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, InternalSquareUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent unitPoint exists.",properties:{parents:{description:"",properties:{unitPoint:{description:"",kind:"Point"}}}}},constrain:function(){var I=this.getParent("unitPoint"),F=I.getParent("origin"),G=F.geom.loc.getX(),H=F.geom.loc.getY(),E=I.geom.loc.getX()-G,D=I.geom.loc.getY()-H;this.geom.loc=y.GeometricPoint(G+D,H-E)},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Unit point "+this.id)}});y.gConstraints.MeasurementAbscissa=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The abscissa (x coordinate) of a point relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"AbscissaM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AbscissaM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getCoordinates(this.getParent("point"));this.value=D.x;this.uValue=this.value},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeTextMFS("x",true),this.getParent("point").getNameMFS()]}}});y.gConstraints.MeasurementAnalyticSlope=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The slope of a straight relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"AnalyticSlopeM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AnalyticSlopeM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{seg:{description:"",kind:"Straight"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getParent("seg"),E=this.getParent("coordSys"),H=E.locatePoint(D.geom.p0),F=E.locatePoint(D.geom.p1),G=F.subtract(H);this.value=(G.getX()===0)?NaN:(G.getY()/G.getX());this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Slope "),this.getParent("seg").getNameMFS())}});y.gConstraints.GeometricSlope=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The slope of a straight.",inherits:"Constraint",refspec:{gspRef:"GeometricSlopeM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, GeometricSlopeM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{straight:{description:"",kind:"Straight"}}}}},constrain:function(){var D=this.getParent("straight"),G=D.getP0(),E=D.getP1(),F=E.subtract(G);this.value=(F.getX()===0)?NaN:-(F.getY()/F.getX());this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Slope "),this.getParent("straight").getNameMFS())}});y.gConstraints.MeasurementArcBase=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of the angle of an arc. The arc is either an arc object, or a circle and points on the circle which define an arc.",inherits:"Constraint",usage:{"abstract":true,kinds:["Measure"]},existenceRule:"Exists iff the parents and are non-coincident exist."},getParentalArc:function(){throw y.createError("MeasurementArcBase.getParentalArc: Derived class must override!")},getArcNameMFS:function(){throw y.createError("MeasurementArcBase.getParentalArc: Derived class must override!")},measureArcAngle:function(){var E=this.getParentalArc(),F=E.arcAngle,D=this.sQuery().prefs().units.angle;this.value=F;this.uValue=y.units.convert(F,"radians",D)},measureArcLength:function(){var F=this.getParentalArc(),D=F.getCache(F.genus).arcLength||F.arcLength,E=this.sQuery().prefs().units.length;this.value=D;this.uValue=y.units.convert(D,"pixels",E)},getAngleNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m ",true),this.getArcNameMFS())},getLengthNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(y.Strings.loc("GSP.Measure.arcLength")+" "),this.getArcNameMFS())}});y.gConstraints.MeasurementArc=y.makeClass(y.gConstraints.MeasurementArcBase,{doc:{description:"The measurement of the angle of an arc.",inherits:"MeasurementArcBase",existenceRule:"Exists iff the parents and are non-coincident exist.",properties:{parents:{description:"",properties:{arc:{description:"The arc to be measured",kind:"Arc"}}}}},getParentalArc:function(){var D=this.getParent("arc");return D&&D.geom.arc},getArcNameMFS:function(){var D=this.getParent("arc");return D&&D.getParentalNameMFS()}});y.gConstraints.MeasurementArcAngle=y.makeClass(y.gConstraints.MeasurementArc,{doc:{description:"The measurement of an angle defined by three points.",inherits:"MeasurementArc",refspec:{gspRef:"ArcAngle3PointsMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcAngle3PointsMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{angle:1},constrain:function(){this.measureArcAngle()},getParentalNameMFS:function(){return this.getAngleNameMFS()}});y.gConstraints.MeasurementArcLength=y.makeClass(y.gConstraints.MeasurementArc,{doc:{description:'The measurement of the length of a <span class="kind">Arc</span>s.',inherits:"MeasurementArc",refspec:{gspRef:"ArcLengthM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcLengthM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{length:1},constrain:function(){this.measureArcLength()},getParentalNameMFS:function(){return this.getLengthNameMFS()}});y.gConstraints.MeasurementArcOnCircle=y.makeClass(y.gConstraints.MeasurementArcBase,{doc:{description:"The measurement of the angle of an arc. The arc is defined by a circle and points on the circle which define an arc.",inherits:"MeasurementArcBase",existenceRule:"Exists iff the parents and are non-coincident exist.",properties:{parents:{description:"",properties:{circle:{description:"Circle containing arc",kind:"Circle"},p0:{description:"Initial point",kind:"Point"},p1:{description:"Final point (or if p2 is set, middle point)",kind:"Point"},p2:{description:"Final point",kind:"Point",required:false}}}}},getParentalArc:function(){var F,E,D,I,G,H;H=this.getParent("circle");E=this.getParent("p0").geom.loc;D=this.getParent("p1").geom.loc;I=this.getParent("p2");if(I){G=y.Geom.ThreePointCollinear(E,I.geom.loc,D);F=y.GeometricArc.FromCenterAndEndpoints(H.geom.c,E,I.geom.loc,G.orientation)}else{F=y.GeometricArc.FromCenterAndEndpoints(H.geom.c,E,D)}return F},getArcNameMFS:function(){var G=this.getParent("circle"),E=this,D=function(K){var J=E.getParent(K);return J&&J.getNameMFS()||y.mfs.makeTextMFS("")},F={type:"style",value:[{code:"fontStyle",value:"2"}]},I=[];["p0","p1","p2"].forEach(function(J){I.push(D(J))});F.value.push(y.mfs.makeHorizontalMFS.apply(this,I));F={type:"overbar",variant:5,value:F};var H=y.mfs.makeHorizontalMFS({type:"symbol",value:"100"},G.getParentalNameMFS());return y.mfs.makeHorizontalMFS(F,y.mfs.makeTextMFS(" on "),H)}});y.gConstraints.MeasurementArcOnCircleAngle=y.makeClass(y.gConstraints.MeasurementArcOnCircle,{doc:{description:'The measurement of the length of a <span class="kind">Arc</span>s.',inherits:"MeasurementArcOnCircle",refspec:{gspRef:"ArcAngle3PointsMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcAngle3PointsMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{angle:1},constrain:function(){this.measureArcAngle()},getParentalNameMFS:function(){return this.getAngleNameMFS()}});y.gConstraints.MeasurementArcOnCircleLength=y.makeClass(y.gConstraints.MeasurementArcOnCircle,{doc:{description:'The measurement of the length of a <span class="kind">Arc</span>s.',inherits:"MeasurementArcOnCircle",refspec:{gspRef:"ArcLengthM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcLengthM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{length:1},constrain:function(){this.measureArcLength()},getParentalNameMFS:function(){return this.getLengthNameMFS()}});y.gConstraints.MeasurementCoordinateDistance=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The distance between two points relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"CoordinateDistanceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CoordinateDistanceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{p0:{description:"The point from which distance is to be measured",kind:"Point"},p1:{description:"The point to which distance is to be measured",kind:"Point"}}}}},constrain:function(){var E=this.getCoordinates(this.getParent("p0")),D=this.getCoordinates(this.getParent("p1"));this.value=D.subtract(E).vLength();this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(this.getParent("p0").getNameMFS(),this.getParent("p1").getNameMFS())}});y.gConstraints.MeasurementOrdinate=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The ordinate (y coordinate) of a point relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"OrdinateM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, OrdinateM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getCoordinates(this.getParent("point"));this.value=D.y;this.uValue=this.value},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeTextMFS("y",true),this.getParent("point").getNameMFS()]}}});y.gConstraints.MeasurementPolarDirection=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The angle (theta-value of the polar coordinates) of a point relative to the x-axis of a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"PolarDirectionM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PolarDirectionM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},unitPowers:{angle:1},constrain:function(F){var G=this.getCoordinates(this.getParent("point")),D=F.preferences.units.angle,E;E=Math.atan2(G.getY(),G.getX());this.value=E;this.uValue=y.units.convert(E,"radians",D)},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeItalicMFS({type:"symbol",value:"71"}),this.getParent("point").getNameMFS()]}}});y.gConstraints.MeasurementPolarDistance=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The distance from the origin (r-value of the polar coordinates) of a point relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"PolarDistanceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PolarDistanceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getCoordinates(this.getParent("point"));this.value=D.vLength();this.uValue=this.value},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeTextMFS("r",true),this.getParent("point").getNameMFS()]}}});y.gConstraints.PointOnPolygonEdge=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'A point on a <span class="kind">Polygon</span>.',inherits:"Constraint",refspec:{gspRef:"OnPath_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, OnPath_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent param and path exist.",properties:{baseVertex:{description:"index of initial vertex of edge containing point",type:"Number"},baseValue:{description:"parameterized location on edge starting at baseVertex",type:"Number"},parents:{description:"",properties:{path:{description:"",kind:"Polygon"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-PointOnPath_export.json"},value:0.5,isPathValuePrimary:false,updateValue:function(E){this.value=E-Math.floor(E);this.isPathValuePrimary=true;var D=this.getParent("path"),F=D.mapPathValueToCharacteristic(this.value);this.baseVertex=F.baseVertex;this.baseValue=F.baseValue},transform:function(G,E){var D=this.getParent("path"),F=E.geom.loc.copy();E.affine.transform(F);this.updateValue(D.mapPositionToPathValue(F))},constrain:function(){var D=this.getParent("path");var E=D.geom.points,G=E[this.baseVertex],F=E[(this.baseVertex+1)%E.length];this.geom.loc=G.add(F.subtract(G).multiply(this.baseValue));if(!this.isPathValuePrimary){this.value=D.mapPositionToPathValue(this.geom.loc)}}});y.gConstraints.RotateAngleMarker=y.makeClass(y.gConstraints.Rotate,{doc:{description:"Defines a new GObject as a rotation of a GObject by the measure of a marked angle about a pivot point.",inherits:"Rotate",refspec:{gspRef:"RotateByMarkedAngleMarker_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RotateByMarkedAngleMarker_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and the three angle points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-RotateAngleMarker_export.json",properties:{parents:{description:"",properties:{angle:{description:"",kind:"AngleMarker"}}},angle:{suppressed:true}}},getAngle:function(){var D;D=this.getParent("angle");return D.value}});y.gConstraints.RotateMeasureAngle=y.makeClass(y.gConstraints.Rotate,{doc:{description:"Defines a new GObject as a rotation of a GObject by a measure about a pivot point, p0.",inherits:"Rotate",refspec:{gspRef:"RotateByMarkedAngleMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RotateByMarkedAngleMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and the three angle points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-RotateMeasureAngle_export.json",properties:{parents:{description:"",properties:{angle:{description:"",kind:"Measure"}}},angle:{suppressed:true}}},getAngle:function(){var D;D=this.getParent("angle");return -D.value}});y.gConstraints.Rotate3=y.makeClass(y.gConstraints.Rotate,{doc:{description:"Defines a new GObject as a rotation of a GObject about a pivot point, p0, by an angle from three points.",inherits:"Rotate",refspec:{gspRef:"Rotate3A_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Rotate3A_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and the three angle points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Rotation3_export.json",properties:{parents:{description:"",properties:{A:{description:"",kind:"Point"},B:{description:"",kind:"Point"},C:{description:"",kind:"Point"}}},angle:{suppressed:true}}},getAngle:function(){var E,D,F;E=this.getParent("A").geom.loc;D=this.getParent("B").geom.loc;F=this.getParent("C").geom.loc;return y.GeometricPoint.threePointAngle(E,D,F)}});y.gConstraints.AxisUnitCircle=y.makeClass(y.gConstraints.AxisDist,{doc:{description:"An axis determined a unit circle.",inherits:"AxisDist",refspec:{gspRef:"UnitCircleAxis_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, UnitCircleAxis_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Axis"]},existenceRule:"Exists iff the parent circle exists and has positive radius.",properties:{parents:{description:"",properties:{circle:{description:"",kind:"Circle"},origin:{suppressed:true},unitPoint:{suppressed:true}}}}},constrain:function u(){var G=this.getParent("circle"),F=G.geom.r,E=0,D=0;this.geom.origin=G.geom.c;if(isNaN(F)||(F<=0)){this.state.exists=false;return}if(this.orientation==="horizontal"){E=F}if(this.orientation==="vertical"){D=-F}this.geom.unit=y.GeometricPoint(this.geom.origin.getX()+E,this.geom.origin.getY()+D);(u.base||arguments.callee.base).call(this)}});y.gConstraints.AngleMarker=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Marks the angle between two lines.",inherits:"Constraint",refspec:{},usage:{"abstract":true,kinds:["AngleMarker"]},existenceRule:"Exists iff parents exist, and define a non-zero angle.",properties:{parents:{properties:{p0:{description:"A point on an angle edge",kind:"Point"},p1:{description:"The focal point of an angle",kind:"Point"},p2:{description:"A point on the other angle edge",kind:"Point"}}}}},makeArcs:function(E,D,K,J,G){var F=E.subtract(D),I,H;if(Math.abs(this.value)<0.0004){this.geom.arc=h;this.state.exists=true;return}if(F.isZeroLength()){this.state.exists=false}else{I=F.multiply(this.style["inner-radius"]/F.vLength());F=K.subtract(D);if(F.isZeroLength()){this.state.exists=false}else{H=F.multiply(this.style["inner-radius"]/F.vLength());this.geom.arc=y.GeometricArc.FromCenterAndEndpoints(D,D.add(I),D.add(H),G);this.state.exists=this.geom.arc.exists}}},getParentalNameMFS:function(){return this.getAngleMarkerMFS(false)},constrainedAngle:function(E,D){return E},constrain:function(){var E=this.getParent("p0").geom.loc,D=this.getParent("p1").geom.loc,I=this.getParent("p2").geom.loc,H=y.GeometricPoint.threePointAngle(E,D,I),G=y.Geom.ThreePointCollinear(E,D,I),F;if(!G.isStraight){if((H+Math.PI)<y.math.SIMPLE_PI_THRESHOLD){H+=2*Math.PI}}this.value=this.constrainedAngle(H,G);F=G.orientation;this.makeArcs(E,D,I,H,F)}});y.gConstraints.ActionButtonAnimate=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that moves a point on a path.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{parents:{description:"Animating objects",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"kind"}},regex:/^[0-9]+$/},animationStates:{description:"Array of objects containing state information (rate, repeat, motionType, etc.) for each animation controlled by this button.  State information depends on the kind of animation",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Button-Animation_export.json"},animationStates:[],smoothInSpace:true,press:function(O,E){var J=this,I,P,G;function K(){if(!this.animateFunction(O)){O.MotionManager.EndMotion(this.motionID)}}function F(){var Q;this.motionID=h;J.state.isActive=(J.state.motions.length>1);for(Q=0;Q<J.state.motions.length;Q++){if(this===J.state.motions[Q]){J.state.motions.splice(Q,1);break}}if(!J.state.isActive){O.invalidateGeom(J)}}function L(W){var Y=(Math.PI/2),Q,X=Number(new Date()),T,V=this.gobj,U=W.sketchRect(),R;if(!this.animContext){this.animContext={currentAngle:Math.random()*2*Math.PI,lastSampleTime:Number(new Date())-16}}function S(ad,aa,ai,ab,af){var Z=0.2,ag=0.3,aj=ab-ai,ac,ah,ae=aa;if(aj){ac=(ad-ai)/aj;if(ac<Z){ah=Z-ac;if(ah>=ag){ae+=af}else{ae+=(af*ah/ag)}}else{if(ac>(1-Z)){ah=ac-(1-Z);if(ah>=ag){ae-=af}else{ae-=(af*ah/ag)}}}}return ae}R=this.animContext;R.currentAngle+=(Y*Math.random())-(Y*0.5);Q=this.rate*y.kWebSpeedMultiplier;T={x:Math.cos(R.currentAngle)*Q,y:Math.sin(R.currentAngle)*Q};T.x=S(V.geom.loc.getX(),T.x,U.left,U.right,Q);T.y=S(V.geom.loc.getY(),T.y,U.top,U.bottom,Q);V.transform(W,{geom:V.geom,affine:y.AffineTransform({m00:1,m11:1,m20:T.x,m21:T.y})});W.invalidateGeom(V);R.lastSampleTime=X;return true}function M(ab,ad,R){var U=ad.animContext,aa=ad.gobj,X=R.curSampleTime-U.lastSampleTime,Z=(ad.smoothInSpace)?U.stepSize:U.stepSize*(X*y.kIdealFrameRate/1000),T,Q=aa.value,S=true,ac,W=false;function Y(ah,aj){var ag=ah.maxValue-ah.minValue,ae=aj-ah.minValue,ai,ak,af;if((ae>=0)&&(ae<=ag)){y.signalErrorWithMessage("calculateWrappedPosition() should only be called when we need wrapping");return}af=ae%ag;if(ah.oscillate){ai=(ae>0)?(ae-ag):ae;ak=1+Math.floor(Math.abs(ai/ag));if((ak%2)===1){af*=-1}}if(af>0){return{value:ah.minValue+af,direction:1}}else{return{value:ah.maxValue+af,direction:-1}}}function V(){var ae=U.maxValue-U.minValue;if(U.finalValue!==null){if(Z>=ae){return true}else{if(R.firstTime){return false}}if(W){if(((T>=U.finalValue)&&(Q>=U.finalValue))||((T<=U.finalValue)&&(Q<=U.finalValue))){return true}}else{if(((T>=U.finalValue)&&(U.finalValue>=Q))||((Q>=U.finalValue)&&(U.finalValue>=T))){return true}}}return false}if(Q<U.minValue){Q=U.minValue}if(Q>U.maxValue){Q=U.maxValue}T=Q+(Z*U.direction);if((T<U.minValue)||(T>U.maxValue)){ac=Y(U,T);T=ac.value;U.direction=ac.direction;W=true}if(V()){T=U.finalValue;S=false}if(aa.updateValue){aa.updateValue(T)}else{y.signalErrorWithMessage("animateOneStep encountered unexpected object type")}ab.invalidateGeom(aa);return S}function D(U,Q,T){var R=Q.animContext,S=true;if(T.curSampleTime>=R.nextRandomEventTime){Q.gobj.updateValue(R.minValue+Math.random()*(R.maxValue-R.minValue));U.invalidateGeom(Q.gobj);R.nextRandomEventTime=T.curSampleTime+R.randomPeriod;S=R.repeat}return S}function H(W){var S,T=this.path,Q={curSampleTime:Number(new Date()),firstTime:false},X=T.pathLength(),R=T.getAnimationRange(),V=true;if(!this.animContext){Q.firstTime=true;this.animContext={lastPathLength:0,lastSampleTime:Q.curSampleTime-(1000/y.kIdealFrameRate),stepSize:null,minValue:null,maxValue:null,direction:(this.motionType==="backward")?-1:1,oscillate:(this.motionType==="both"),random:(this.motionType==="random"),repeat:this.repeat,finalValue:null,perFrameAdvanceFn:M};if(!this.repeat){this.animContext.finalValue=this.gobj.value}if(this.animContext.random){this.animContext.randomPeriod=y.kNormalSpeedRate/this.rate*1000;this.animContext.nextRandomEventTime=Q.curSampleTime;this.animContext.perFrameAdvanceFn=D}}S=this.animContext;if(!((R.min===S.minValue)&&(R.max===S.maxValue)&&(X===S.lastPathLength))){var U=T.unitLength();if(!S.random){S.stepSize=Math.abs(this.rate/U*y.kWebSpeedMultiplier)}S.minValue=R.min;S.maxValue=R.max;S.lastPathLength=X}V=S.perFrameAdvanceFn(W,this,Q);S.lastSampleTime=Q.curSampleTime;return V}function N(T){var R={curSampleTime:Number(new Date()),firstTime:false},S=true;function Q(Y,U,X){var V=true,W=U.animContext;if(X.curSampleTime>=W.nextDiscreteEventTime){V=M(Y,U,X);W.nextDiscreteEventTime=X.curSampleTime+W.discretePeriod}return V}if(!this.animContext){R.firstTime=true;this.animContext={lastSampleTime:R.curSampleTime-(1000/y.kIdealFrameRate),stepSize:null,minValue:this.paramMinValue,maxValue:this.paramMaxValue,direction:(this.motionType==="backward")?-1:1,oscillate:(this.motionType==="both"),random:(this.motionType==="random"),repeat:this.repeat,finalValue:null,perFrameAdvanceFn:M};if(!this.repeat){this.animContext.finalValue=this.gobj.value}if(this.animContext.random){this.animContext.randomPeriod=1000*this.timeInterval;this.animContext.nextRandomEventTime=R.curSampleTime;this.animContext.perFrameAdvanceFn=D}else{if(this.discrete){this.animContext.discretePeriod=1000*this.timeInterval;this.animContext.nextDiscreteEventTime=R.curSampleTime;this.animContext.stepSize=Math.abs(this.rate);this.animContext.perFrameAdvanceFn=Q}else{if(this.timeInterval===0){y.signalErrorWithMessage("invalid time interval")}this.animContext.stepSize=Math.abs(this.rate/(y.kIdealFrameRate*this.timeInterval))}}}S=this.animContext.perFrameAdvanceFn(T,this,R);this.animContext.lastSampleTime=R.curSampleTime;return S}if(!this.state.isActive){y.log("Started animation "+this.id);this.state.motions=[];this.state.isActive=true;for(I=0;I<this.parentsList.length;I++){G=this.parentsList[I];P={applyMotion:K,completeMotion:F,animateFunction:h,controlList:O.Bap.createControlList([G]),gobj:G,rate:this.animationStates[I].rate,repeat:this.animationStates[I].repeat,motionType:this.animationStates[I].motionType,smoothInSpace:this.smoothInSpace};if(G.isFreePointOnPath){P.path=G.parents.path;P.animateFunction=H}else{if(P.gobj.kind==="Point"){P.animateFunction=L}else{if(P.gobj.kind==="Expression"){P.animateFunction=N;P.isValueChangingMotion=true;P.timeInterval=this.animationStates[I].timeInterval;P.paramMinValue=this.animationStates[I].lowerParamBound;P.paramMaxValue=this.animationStates[I].upperParamBound;P.discrete=this.animationStates[I].discrete}}}P.motionID=O.MotionManager.StartMotion(P);this.state.motions.push(P)}O.invalidateGeom(this)}else{y.log("Canceling animation "+this.id);for(I=0;I<this.state.motions.length;I++){O.MotionManager.EndMotion(this.state.motions[I].motionID)}}}});y.gConstraints.CoordSys=y.makeClass(y.gConstraints.Constraint,{doc:{description:"An coordinate system determined by two axes.",inherits:"Constraint",refspec:{gspRef:"CoordSys_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CoordSys_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["CoordSys"]},existenceRule:"Exists iff the parent axes exists.",properties:{parents:{description:"",properties:{axisX:{description:"The horizontal axis",kind:"Axis"},axisY:{description:"The vertical axis",kind:"Axis"}}}}},isVisible:function(){return(!this.style.hidden)||(!this.getParent("axisX").style.hidden&&!this.getParent("axisY").style.hidden)},constrain:function(){var F=this.getParent("axisX"),E=this.getParent("axisY"),D;this.geom.origin=F.geom.origin;this.geom.unit0=F.geom.unit;this.geom.unit1=E.geom.unit;D={x:this.geom.unit0.x-this.geom.origin.x,y:-(this.geom.unit1.y-this.geom.origin.y)};this.geom.gridSpacing=(this.shape==="polar")?F.getPolarSpacing(D).pixelsBetweenTicks:{x:F.getLineSpacing().pixelsBetweenTicks,y:E.getLineSpacing().pixelsBetweenTicks}}});y.gConstraints.Dilate2SegRatio=y.makeClass(y.gConstraints.DilateFixFactor,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by the ratio of the lengths of two segments.",inherits:"DilateFixFactor",refspec:{gspRef:"Dilate2R_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Dilate2R_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, the center, and the two segments all exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Dilate2SegRatio_export.json",properties:{parents:{description:"",properties:{seg0:{description:"Segment defining the numerator of the scale ratio",kind:"Straight"},seg1:{description:"Segment defining the denominator of the scale ratio",kind:"Straight"}}},scaleFactor:{suppressed:true}}},getScaleFactor:function(){var D=this.getParent("seg0");var F=this.getParent("seg1");var E=D.pathLength()/F.pathLength();return E}});y.gConstraints.Dilate3PtRatio=y.makeClass(y.gConstraints.DilateFixFactor,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by a ratio of three points, A, B, C. The ratio is |AB|/|AC|.",inherits:"DilateFixFactor",refspec:{gspRef:"Dilate3R_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Dilate3R_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object, the three angle points exist and the |AB| evaluates to a non-zero length.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Dilate3PtRatio_export.json",properties:{parents:{description:"",properties:{A:{description:"First control point of the line",kind:"Point"},B:{description:"Second control point of the line",kind:"Point"},C:{description:"The point that is mapped to the line",kind:"Point"}}},scaleFactor:{suppressed:true}}},getScaleFactor:function(){var E=this.getParent("A").geom.loc;var D=this.getParent("B").geom.loc;var F=this.getParent("C").geom.loc;return y.GeometricPoint.mapPointToLine(E,D,F).param}});y.gConstraints.DilateMeasureFactor=y.makeClass(y.gConstraints.DilateFixFactor,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by a measurement.",inherits:"DilateFixFactor",refspec:{gspRef:"DilatemR_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, DilatemR_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, the center point and the measurement exist and the measurement evaluates to a finite, non-zero number.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-DilateMeasureFactor_export.json",properties:{parents:{description:"",properties:{measure:{description:"A measurement or calculation",kind:"Measure"}}},scaleFactor:{suppressed:true}}},getScaleFactor:function(){var E=this.getParent("measure");var D=E.value;return D}});y.gConstraints.Intersection1=y.makeClass(y.gConstraints.Intersection,{doc:{description:'One of two points of intersection of an <span class="kind">Arc</span> or <span class="kind">Circle</span> with another Arc, Circle, or <span class="kind">Straight</span> object.',inherits:"Intersection",refspec:{gspRef:"InterLCA",msg:"This constraint is intended to behave in the same way as the corresponding constraints, InterLCA and InterCCA, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent objects exist and have at least one point of intersection.",properties:{parents:{description:"",properties:{circle:{description:"The first of two GObjects for which intersection(s) are to be determined",kind:"Arc|Circle"},obj:{description:"The second of two GObjects for which intersection(s) are to be determined",kind:"Arc|Circle|Straight",type:"GObject"},line0:{suppressed:true},line1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Intersection12_export.json"},getIntersectionPoints:function(){var L=[],E=this.getParent("circle"),I=this.getParent("obj"),M=E.getGeometricArc(),K=(I.kind==="Straight"||I.kind==="Axis"),G=K?I:I.getGeometricArc(),D=0,H=(M.orientation===0)?"Straight":"Arc",F=(G.kind==="Straight"||G.kind==="Axis"||G.orientation===0)?"Straight":"Arc",J=H+F,N;switch(J){case"StraightStraight":N=y.Geom.LineLineIntersection(M,G);if(N.isDefined()){L.push(N,N)}break;case"ArcStraight":D=M.orientation;L=y.Geom.CircleStraightIntersection(M,G);break;case"StraightArc":D=-G.orientation;L=y.Geom.CircleStraightIntersection(G,M);break;case"ArcArc":D=M.orientation*G.orientation;L=y.Geom.CircleCircleIntersection(M,G);break}L=g.grep(L,function(O){return M.pointIsInBounds(O)&&(K||G.pointIsInBounds(O))});if(-1===D){L.reverse()}return(L)},constrain:function(){var D=this.getIntersectionPoints();if(D[0]){this.geom.loc=D[0];this.state.exists=true}else{this.geom.loc=y.GeometricPoint(h,h);this.state.exists=false}}});(function(){var K={init:function Q(){this.isAtTarget=false;this.controlList=this.sketch.Bap.createControlList([this.moverGObj]);this.motionID=null;this.lastSample=Number(new Date())},isInstant:function(){return(this.button.rate===0)},reconfigureFromConstraints:function N(){var U=this.targetGObj.state.constraintFrame;if(U!==this.constraintFrame){this.constraintFrame=U;if(this.isAtTarget&&this.canKeepMoving()&&this.getStep().isAlreadyThere){this.isAtTarget=true}else{this.isAtTarget=false}}},canKeepMoving:function H(){return this.moverGObj.state.exists&&(false!==this.getDestination())},applyMotion:function G(){var U=Number(new Date()),W=Math.max(U-this.lastSample,1),V;if(!this.isInstant()){this.reconfigureFromConstraints()}if(this.isAtTarget){this.sketch.MotionManager.EndMotion(this.motionID)}else{if(this.canKeepMoving()){V=(this.rate*y.kWebSpeedMultiplier*(W/1000)*y.kIdealFrameRate);this.isAtTarget=this.getStep().move(V);this.sketch.invalidateGeom(this.moverGObj)}this.lastSample=U}},completeMotion:function J(){var U;this.motionID=h;this.button.state.isActive=(this.button.state.motions.length>1);for(U=0;U<this.button.state.motions.length;U++){if(this===this.button.state.motions[U]){this.button.state.motions.splice(U,1);break}}if(!this.button.state.isActive){this.sketch.invalidateGeom(this.button)}}};var I=y.makeClass(K,{initializeDistance:function E(){var U=this.moverGObj,V=this.getDestination();if(this.getDestination()){this.distance=V.subtract(U.geom.loc).vLength()}else{this.distance=10}},getDestination:function P(){return this.targetGObj.geom.loc.isDefined()&&this.targetGObj.geom.loc}});var O=y.makeClass(K,{init:function Q(){(Q.base||arguments.callee.base).call(this);this.isValueChangingMotion=true},getDestination:function P(){if(this.targetGObj.blank){return this.isInstant()?"blank":false}if(this.moverGObj.blank&&!this.isInstant()){return false}return !isNaN(this.targetGObj.value)&&this.targetGObj.value},initializeDistance:function D(){var U=this.moverGObj;if(U.value===this.targetGObj.value){this.distance=0}else{this.distance=-1}},getStep:function F(){var aa=this.moverGObj,Y=this.getDestination(),Z=Y-aa.value,W=(Z<0)?-1:1,U=(Z===0),X={isAlreadyThere:U,move:function V(ab){if(Y==="blank"){aa.setParameterValue("");aa.blank=true;return true}if(!U){if((ab===0)||Math.abs(Z)<=Math.abs(ab)){aa.updateValue(Y);if(aa.blank){aa.blank=false}}else{aa.updateValue(aa.value+W*Math.abs(ab))}}return(ab===0)||U}};return X}});var T=y.makeClass(I,{getStep:function S(){var Y=this.moverGObj.geom.loc,W=this.getDestination().subtract(Y),U=W.vLength(),V=this,X={isAlreadyThere:U<=0.01,move:function(aa){var Z=false,ab;if((aa===0)||(Math.abs(aa)>=U)){ab=W;Z=true}else{ab=W.multiply(aa/U)}V.sketch.MotionManager.ApplyTransformToControlList(V.sketch,new y.AffineTransform({m00:1,m11:1,m20:ab.x,m21:ab.y}),V.controlList,{snapPoints:false,onPathTracksIdealLoc:false});return Z}};return X}});var R=y.makeClass(I,{getStep:function L(){var X=this.moverGObj,ad=this.getDestination(),Y=0.05,ae=X.getParent("path"),af=X.value,Z=ae.mapPositionToPathValue(ad),ac=ae.makeMotionPath(af,Z),U,ab=ae.mapPathValueToPosition(af),aa=ab.equals(ad,Y),V={isAlreadyThere:aa,move:function W(ag){if(!aa){if(ag===0){U=ac.advance(ac.getDistance())}else{U=ac.advance(ag)}X.updateValue(U)}return(ag===0)||aa}};return V}});y.gConstraints.ActionButtonMove=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that moves a set of points towards other points.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{parents:{description:"Set of objects to be moved",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"Point|Expression"}},regex:/^[0-9]+$/},rate:{description:"For point animation, the number of pixels to advance per frame cycle.",type:"Number"},towardInitialDestination:{description:"Rather than follow a moving destination, move to the position the destination was when the movement started ","default":false,type:"Boolean"}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/Move_export.json"},rate:1,towardInitialDestination:false,updateConstraintAncestry:function M(){(M.base||arguments.callee.base).call(this);this.state.motions=[]},press:function(ab,U){var Z=this,Y,V,W=-1,X;function aa(ae,ag){var ac,af,ad;switch(ae.kind){case"Point":af=ae.isFreePointOnPath?R:T;break;case"Expression":af=O;break;default:throw y.createError("Move button encountered unexpected object type")}ad=y.makeInstance(af);g.extend(ad,{moverGObj:ae,targetGObj:ag,sketch:ab,button:Z});ad.init();if(Z.towardInitialDestination){if(!ad.targetGObj.state.exists){return}ac=ad.getDestination();ad.getDestination=function(){return ac}}if(ad.moverGObj.state.exists){ad.initializeDistance();if(0!==this.distance){return ad}}}if(!this.state.isActive){this.state.isActive=true;y.log("Starting move "+Z.id);for(Y=0;Y<this.parentsList.length;Y+=2){V=aa(this.parentsList[Y+1],this.parentsList[Y]);if(V){W=Math.max(W,V.distance);this.state.motions.push(V)}}if(this.state.motions.length===0){this.state.isActive=false;ab.invalidateGeom(this);return}if(this.rate!==0){W=(W===-1)?400:W;X=W/this.rate;if(X===0){X=1}}g.each(this.state.motions,function(ad,ag){var ac,ae,af;if(Z.rate===0){ag.rate=0}else{if(ag.targetGObj.kind==="Point"){ag.rate=ag.distance/X}else{ac=ag.moverGObj.value;ae=ag.getDestination();if(ae!==false){af=ae-ac;ag.rate=af/X}else{ag.rate=100/X}}}if(isNaN(ag.rate)){y.signalErrorWithMessage("This Move Button calculated a Nan rate of speed!");ag.rate=Z.rate}ag.motionID=ab.MotionManager.StartMotion(ag)})}else{y.log("Canceling move "+Z.id);for(Y=0;Y<this.state.motions.length;Y++){ab.MotionManager.EndMotion(this.state.motions[Y].motionID)}}}})})();y.gConstraints.ActionButtonScroll=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that scrolls the sketch to the position of a point.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{parents:{description:"First object can be scrolled to particular location",type:"Array"},scrollDest:{description:"scrolls the page so that the parental point is at specified destination of the window (possible values: center | topLeft).",type:"String"}},example:""},scrollDest:"topLeft",press:function(N,G){var M=this.parentsList[0],J=M.geom.loc.copy(),L=N.sketchRect(),F,I,E;if(this.scrollDest==="center"){I=y.GeometricPoint(L.left+(L.right-L.left)/2,L.top+(L.bottom-L.top)/2);E=J.subtract(I)}else{F=y.GeometricPoint(L.left,L.top);E=J.subtract(F)}var D=0;var K=8,O=this;function H(){N.Scroll.translate(E.x/K,E.y/K);D++;if(D<K){N.addDeferredCall(O,H)}}N.addDeferredCall(O,H)}});y.gConstraints.ActionButtonLinkPage=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that switches to another page in the sketch.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{pageId:{description:"Id of the page being linked to.",type:"String"},buttonId:{description:"(Optional) Id of button to activate on the on the linked page.",type:"String",required:false}},example:""},pageId:"1",press:function(G,D){var F=G.document;F.switchPage(this.pageId);var H=F.focusPage;var E=this.buttonId&&H.sQuery().get(this.buttonId);if(E){E.press(H,"linkButton")}}});y.gConstraints.ActionButtonLinkURL=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that opens a url.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{url:{description:"Url to link to.",type:"String"}},example:""},url:"",init:function x(){(x.base||arguments.callee.base).call(this)},constrain:function(D){},press:function(E,D){if(l){l.open(this.url)}}});y.gConstraints.Parallel=y.makeClass(y.gConstraints.Line,{doc:{description:'Defines a line through a <span class="kind">Point</span> parallel with another <span class="kind">Straight</span>.',inherits:"Line",refspec:{gspRef:"Parallel_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Parallel_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent point and line exist.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},line:{description:"",kind:"Straight"},p1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Parallel_export.json"},constrain:function(){var D=this.getParent("line");var L=D.geom.p0;var K=D.geom.p1;var H=this.getParent("p0").geom.loc;var I=K.subtract(L).multiply(0.5);this.geom.p0=H.subtract(I);this.geom.p1=H.add(I);var G=I.vLength();var J=10000/G;var E=H.add(I.multiply(-J));var F=H.add(I.multiply(J));this.geom.xp0=E;this.geom.xp1=F},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Parallel line "+this.id)}});y.gConstraints.Perpendicular=y.makeClass(y.gConstraints.Line,{doc:{description:'Defines a line through a <span class="kind">Point</span> perpendicular with another <span class="kind">Straight</span>.',inherits:"Line",refspec:{gspRef:"Perpend_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Perpend_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent point and line exist.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},line:{description:"",kind:"Straight"},p1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Perpendicular_export.json"},constrain:function(){var F=this.getParent("line");var D=F.getP1().subtract(F.getP0());var G=y.GeometricPoint(-D.y,D.x);var E=this.getParent("p0").geom.loc;var H=10000;this.geom.p0=E.add(G.multiply(-1/2));this.geom.p1=E.add(G.multiply(1/2));this.geom.xp0=E.add(G.multiply(-H));this.geom.xp1=E.add(G.multiply(H))},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Perpendicular line "+this.id)}});y.gConstraints.PolygonFromPoints=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a polygon from a sequence of <span class="kind">Point</span>s.',inherits:"Free",refspec:{gspRef:"Polygon_C"},usage:{kinds:["Polygon"],"abstract":false},existenceRule:"Exists iff the parent points exist and are not all coincident.",properties:{parents:{description:"An associative array of points that define the polygon. Key values are ignored in processing.",properties:{"0":{description:'Vertices labeled "0", ..., "n"',kind:"Point"}},regex:/^[0-9]+$/}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Polygon-Polygon_export.json"},updateConstraintAncestry:function B(){(B.base||arguments.callee.base).call(this);this.geom.points=[]},constrain:function(){var D,E=false,F;this.geom.points=[];for(D in this.parents){if(this.parents.hasOwnProperty(D)){F=this.getParent(D).geom.loc;this.geom.points.push(F)}if(!E&&this.geom.points.length){E=!F.equals(this.geom.points[0])}}this.state.exists=E},getParentalNameMFS:function(){var D=[];if(this.genus==="Triangle"){D.push({type:"symbol",value:"102"})}this.eachParent(function(E,F){D.push(F.getNameMFS())});return y.mfs.makeHorizontalMFS.apply(this,D)}});y.gConstraints.ActionButtonPresent=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"Defines an action that executes a set of actions.",inherits:"ActionButton",refspec:{msg:"Internal class not intended for instantiation."},usage:{"abstract":true},properties:{parents:{description:"Set of objects to be triggered",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"Button"}},regex:/^[0-9]+$/},stopAnyMotions:{description:"Stop any previously started animations before commencing the presentation.","default":false,type:"Boolean"},eraseAnyTraces:{description:"Erase any previously displayed traces before commencing the presentation.","default":false,type:"Boolean"}}},stopAnyMotions:false,eraseAnyTraces:false,press:function(E,D){if(!this.state.isActive){if(this.eraseAnyTraces){E.clearTraces()}if(this.stopAnyMotions){E.MotionManager.StopAllMotions()}}}});y.gConstraints.ActionButtonPresentSequentially=y.makeClass(y.gConstraints.ActionButtonPresent,{doc:{description:"Defines an action from an ordered sequence of action buttons.",inherits:"ActionButtonPresent",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{waitTime:{description:"Pause between sequential actions in seconds.",type:"Number"}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/Sequence_export.json"},waitTime:0,constrain:function u(F){(u.base||arguments.callee.base).call(this,F);var D,E;if(this.state.isActive){if(!this.state.inInterval){D=this.state.buttonList[this.state.current];if(!D.state.isActive){this.state.current+=1;if(this.state.current>=this.state.buttonList.length){this.state.isActive=false}if(this.state.isActive){this.state.inInterval=true;E=1000*this.waitTime+Number(new Date());y.log("Begin interval: now="+Number(new Date())+" start="+E);F.addDeferredCall(this,function G(J){var I,H;if(this.state.inInterval){I=Number(new Date());if(E<=I){this.state.inInterval=false;y.log("Activating button: "+this.state.current);H=this.state.buttonList[this.state.current];if(!H.state.isActive){H.press(J,"sequenceButton")}}else{J.addDeferredCall(this,G)}}})}}}}},press:function s(H,D){var G,F,E;(s.base||arguments.callee.base).call(this,H);G=this.state.isActive;if(!G){this.state.isActive=true;this.state.buttonList=[];for(F in this.parents){if(this.parents.hasOwnProperty(F)){E=this.getParent(F);this.state.buttonList.push(E)}}this.state.current=0;this.state.inInterval=false;E=this.state.buttonList[this.state.current];if(!E.state.isActive){E.press(H,"sequenceButton")}}else{this.state.isActive=false;E=this.state.buttonList[this.state.current];if(E.state.isActive){E.press(H,"sequenceButton")}if(this.state.inInterval){H.cancelDeferredCall(this)}}}});y.gConstraints.ActionButtonPresentSimultaneously=y.makeClass(y.gConstraints.ActionButtonPresent,{doc:{description:"Defines an action that executes a collection of actions simultaneously.",inherits:"ActionButtonPresent",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{stopAfter:{description:"Stop the presentation after the last action stops, first action stops, or an elapsed number of seconds","default":"lastActionStops",type:"StopCondition"}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/Simultaneous_export.json"},activeButtons:[],stopAfter:"lastActionStops",activateButtons:function(E){var D=this;this.eachParent(function(F,G){if(!G.state.isActive){G.press(E,"simultaneousButton")}if(G.state.isActive){D.activeButtons.push(G)}})},deactivateRemainingButtons:function(E){var D;while(this.activeButtons.length){D=this.activeButtons.pop();if(D.state.isActive){D.press(E)}}},constrain:function u(I){var D=false,H=false,G,F=[];(u.base||arguments.callee.base).call(this,I);if(this.state.isActive){for(G=0;G<this.activeButtons.length;G++){var E=this.activeButtons[G].state.isActive;D=D||(!E);H=H||E;if(E){F.push(this.activeButtons[G])}}this.activeButtons=F;if(this.stopAfter==="firstActionStops"){this.state.isActive=!D;if((!this.state.isActive)&&H){this.deactivateRemainingButtons(I)}}else{this.state.isActive=H}}if(this.state.timerSet&&!this.state.isActive){I.cancelDeferredCall(this)}},press:function s(H,D){var F=!this.state.isActive,E;y.log("SimultaneousButton: state: "+this.state.isActive+" new state: "+F);(s.base||arguments.callee.base).call(this,H);if(F){this.activateButtons(H)}else{this.deactivateRemainingButtons(H)}this.state.isActive=(this.activeButtons.length>0);if(F&&(typeof this.stopAfter==="number")){E=1000*this.stopAfter+Number(new Date());this.state.timerSet=true;H.addDeferredCall(this,function G(J){var I;if(this.state.timerSet){I=Number(new Date());if(E<=I){this.state.timerSet=false;this.deactivateRemainingButtons(J)}else{J.addDeferredCall(this,G)}}})}if(this.state.timerSet&&!F){H.cancelDeferredCall(this)}}});y.gConstraints.ActionButtonToggleHideShow=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"Defines a button that hides visible objects or shows hidden objects, depending on their state.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{messages:{description:"Hide message, Show message",type:"Array"},parents:{description:"Set of objects to be hidden/shown",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"kind"}},regex:/^[0-9]+$/},fade:{description:"when true, the objects fade in or out",type:"Boolean","default":false}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/ToggleDisplayButton_export.json"},fade:false,value:false,updateLabelFromMessage:function(){var E=this.messages[0];var D=this.messages[1];if(!D){D=E}this.label=this.value?D:E},constrain:function(D){this.value=this.areHidden();this.updateLabelFromMessage()},areHidden:function(){var D=true;this.eachParent(function(E,F){if(!F.style.hidden){D=false}},false);return D},beginAction:function(H,E,J){var F=this;function D(N){var L=this.hideShowState,K=Number(new Date()),M=(K-L.startTime)/(L.timeToComplete-L.startTime);if(K>=L.timeToComplete){this.eachParent(function(O,P){this.state.fade=h;P.hide()},false);this.state.isActive=false;this.hideShowState=h;N.invalidateGeom(this)}else{this.eachParent(function(O,P){this.state.fade=M;N.invalidateAppearance(this)},false);N.addDeferredCall(this,D)}}function G(N){var L=this.hideShowState,K=Number(new Date()),M=(K-L.startTime)/(L.timeToComplete-L.startTime);if(!L.oneTimeShow){this.eachParent(function(O,P){if(P.style.hidden){P.state.fade=1;P.show()}});L.oneTimeShow=true}if(K>=L.timeToComplete){this.eachParent(function(O,P){this.state.fade=h;N.invalidateGeom(this)},false);this.state.isActive=false;this.hideShowState=h;N.invalidateGeom(this)}else{this.eachParent(function(O,P){if(h!==P.state.fade){P.state.fade=1-M;N.invalidateAppearance(P)}},false);N.addDeferredCall(this,G)}}function I(N,K){var M=500,L=Number(new Date()),O={startTime:L,timeToComplete:L};if(F.fade&&(K!=="simultaneousButton")){if(K==="sequenceButton"){O.timeToComplete+=M/2}else{O.timeToComplete+=M}}return O}this.hideShowState=I(H,E);switch(H){case"hide":J.addDeferredCall(this,D);break;case"show":J.addDeferredCall(this,G);break}if(E==="simultaneousButton"||(E==="sequenceButton"&&!this.fade)){this.state.isActive=false}},press:function(E,D){if(this.state.isActive){return}this.state.isActive=true;E.invalidateGeom(this);if(this.areHidden()){this.beginAction("show",D,E)}else{this.beginAction("hide",D,E)}}});y.gConstraints.TranslateBase=y.makeClass(y.gConstraints.Transform,{doc:{description:"Abstract class that defines a new GObject that is identical to another GObject, but translated by some amount.",inherits:"Transform",usage:{"abstract":true},existenceRule:"Exists iff the parent point exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Translation_export.json"},determineExists:function(){var D=this.getOffset();return(typeof D!=="undefined")&&D.isFinite()},getParentPixelValue:function(F){var D=this.getParent(F),E;if(this.unit){return D.value}E=this.sQuery().prefs().units;return y.units.convert(D.uValue,E.length,"pixels")},getOffset:function(){throw y.createError("Translation subclasses required to implement getOffset()")},getTransform:function(){var D=this;return function(E){return E.add(D.getOffset())}}});y.gConstraints.TranslateFixXFixY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed x,y coordinate.",inherits:"TranslateBase",refspec:{gspRef:"TranslatefXfY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefXfY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{offset:{description:"Offset in pixel coordinates from the source object",type:"GeometricPoint",required:false,properties:{x:{description:"Horizontal coordinate in pixels",type:"Number"},y:{description:"Vertical coordinate in pixels",type:"Number"}}}}},offset:{x:0,y:0},getOffset:function(){if(!this.offset.transformClass){this.offset=y.GeometricPoint(this.offset.x,this.offset.y)}return this.offset}});y.gConstraints.TranslateFixDist3PtAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction of an angle delineated by three points.",inherits:"Translate",refspec:{gspRef:"TranslatefD3A_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefD3A_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the three points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDist3PtAngle_export.json",properties:{parents:{description:"",properties:{A:{description:"",kind:"Point"},B:{description:"",kind:"Point"},C:{description:"",kind:"Point"}}},distance:{description:"A distance in pixels.","default":"0",type:"Number"}}},distance:0,getOffset:function(){var F=this.getParent("A");var J=this.getParent("B");var G=this.getParent("C");var E=F.geom.loc;var D=J.geom.loc;var K=G.geom.loc;var I=y.GeometricPoint.threePointAngle(E,D,K);var H=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,I);return H}});y.gConstraints.TranslateFixDistAngleMarker=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction specified by an angle marker.",inherits:"Translate",refspec:{gspRef:"TranslateFixedDataMarkedAngleMarker_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateFixedDataMarkedAngleMarker_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the angle marker exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDistAngleMarker_export.json",properties:{parents:{description:"",properties:{marker:{description:"",kind:"AngleMarker"}}},distance:{description:"A distance.",type:"Number"}}},distance:0,getOffset:function(){var D=this.getParent("marker");var F=D.value;var E=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateFixDistFixAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction of a fixed angle.",inherits:"Translate",refspec:{gspRef:"TranslatefDfA_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefDfA_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDistFixAngle_export.json",properties:{distance:{description:"A distance.",type:"Number"},angle:{description:"An angle, in radians.",type:"Number"}}},distance:0,angle:0,getOffset:function(){var D=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,this.angle);return D}});y.gConstraints.TranslateFixDistMeasureAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction defined by an angle measurement.",inherits:"Translate",refspec:{gspRef:"TranslateFixedDistanceMarkedAngleMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateFixedDistanceMarkedAngleMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDistMeasureAngle_export.json",properties:{parents:{description:"",properties:{measure:{description:"",kind:"Measure"}}},distance:{description:"A distance in pixels.",type:"Number"}}},distance:0,getOffset:function(){var D=this.getParent("measure");var F=-D.value;var E=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateFixXMeasureY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed x coordinate and a y coordinate defined by a measure.",inherits:"Translate",refspec:{gspRef:"TranslatefXmY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefXmY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the measurement exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixXMeasureY_export.json",properties:{parents:{description:"",properties:{measure:{description:"",kind:"Measure"}}},offsetX:{description:"","default":"0",type:"Number"}}},offsetX:0,getOffset:function(){var D=this.offsetX;var F=-this.getParentPixelValue("measure");var E=y.GeometricPoint(D,F);return E}});y.gConstraints.TranslateMeasureDist3PtAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance from a measurement and an angle from three points.",inherits:"Translate",refspec:{gspRef:"TranslatemD3A_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemD3A_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, the measurement and the three points all exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDist3PtAngle_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"},A:{description:"",kind:"Point"},B:{description:"",kind:"Point"},C:{description:"",kind:"Point"}}}}},getOffset:function(){var D=this.getParentPixelValue("distance");var I=this.getParent("A");var H=this.getParent("B");var F=this.getParent("C");var L=I.geom.loc;var K=H.geom.loc;var J=F.geom.loc;var E=y.GeometricPoint.threePointAngle(L,K,J);var G=y.GeometricPoint(D,0).rotate(y.GeometricPoint.ORIGIN,E);return G}});y.gConstraints.TranslateMeasureDistAngleMarker=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance measurement in the direction defined by a specified angle marker.",inherits:"Translate",refspec:{gspRef:"TranslateMarkedDistanceMarkedAngleMarker_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateMarkedDistanceMarkedAngleMarker_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, distance measure, and angle marker exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDistAngleMarker_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"},marker:{description:"",kind:"AngleMarker"}}}}},getOffset:function(){var G=this.getParentPixelValue("distance");var D=this.getParent("marker");var F=D.value;var E=y.GeometricPoint(G,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateMeasureDistFixAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance derived from a measurement in the direction defined by a fixed angle in radians.",inherits:"Translate",refspec:{gspRef:"TranslatemDfA_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemDfA_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and angle measurement exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDistFixAngle_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"}}},angle:{description:"A angle(radians).",type:"Number"}}},angle:0,getOffset:function(){var F=this.getParentPixelValue("distance");var E=this.angle;var D=y.GeometricPoint(F,0).rotate(y.GeometricPoint.ORIGIN,E);return D}});y.gConstraints.TranslateMeasureDistMeasureAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance measurement in the direction defined by an angle measurement.",inherits:"Translate",refspec:{gspRef:"TranslateMarkedDistanceMarkedAngleMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateMarkedDistanceMarkedAngleMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the distance and angle measurements exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDistMeasureAngle_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"},angle:{description:"",kind:"Measure"}}}}},getOffset:function(){var G=this.getParentPixelValue("distance");var D=this.getParent("angle");var F=-D.value;var E=y.GeometricPoint(G,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateMeasureXFixY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed y coordinate and an x coordinate defined by a measure.",inherits:"Translate",refspec:{gspRef:"TranslatemXfY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemXfY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the measurement exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureXFixY_export.json",properties:{parents:{description:"",properties:{measure:{description:"",kind:"Measure"}}},offsetY:{description:"",type:"Number"}}},offsetY:0,getOffset:function(){var D=this.getParentPixelValue("measure");var F=-this.offsetY;var E=y.GeometricPoint(D,F);return E}});y.gConstraints.TranslateMeasureXMeasureY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by x and y coordinates defined by measures.",inherits:"Translate",refspec:{gspRef:"TranslatemXmY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemXmY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the two measurements exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureXMeasureY_export.json",properties:{parents:{description:"",properties:{measureX:{description:"",kind:"Measure"},measureY:{description:"",kind:"Measure"}}}}},getOffset:function(){var D=this.getParentPixelValue("measureX");var F=-this.getParentPixelValue("measureY");var E=y.GeometricPoint(D,F);return E}});y.gConstraints.TranslateVector=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a translation of a GObject by an offset that matches the vector defined by two points.",inherits:"Translate",refspec:{gspRef:"TranslateVector_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateVector_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the transformed object and both length defining points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-VectorTranslation_export.json",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},p1:{description:"",kind:"Point"}}}}},getOffset:function(){var E=this.getParent("p0"),D=this.getParent("p1"),G=E.geom.loc,F=D.geom.loc;return F.subtract(G)},getTransform:function(){var D=this;return function(E){return(E.add(D.getOffset()))}}});y.gConstraints.AngleMarker_CCW=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A counter-clockwise angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_CCW_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_CCW_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?0:-Math.PI}else{E-=y.math.TWO_PI}D.orientation=-1;return E}});y.gConstraints.AngleMarker_CW=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A clockwise angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_CW_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_CW_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?0:Math.PI}D.orientation=1;return E}});y.gConstraints.AngleMarker_Reflex=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A reflex angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_Reflex_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_Reflex_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?y.math.TWO_PI:Math.PI}else{if(E<=y.math.SIMPLE_PI_THRESHOLD){E=-(2*Math.PI-E)}}D.orientation=(E<=0)?-1:1;return E}});y.gConstraints.AngleMarker_Simple=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A simple angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_Simple_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_Simple_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?0:-Math.PI;D.orientation=-1}else{if(E>y.math.SIMPLE_PI_THRESHOLD){E=-(2*Math.PI-E)}D.orientation=(E<=0)?-1:1}return E}});y.gConstraints.PlotRhoTheta=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two polar coordinates.',inherits:"Constraint",usage:{"abstract":true,kinds:["Point"]},existenceRule:"Exists iff the parent CoordSys exists and the coordinates are numbers.",properties:{parents:{description:"",properties:{coordSys:{description:"The coordinate system for the coordinates.",kind:"CoordSys"}}}}},getCoordRho:function(){return this.getParent("coordRho").uValue},getCoordTheta:function(){return this.getParent("coordTheta").value},constrain:function(){var G=this.getParent("coordSys"),E=this.getCoordRho(),F=this.getCoordTheta(),D=E*Math.cos(F),H=E*Math.sin(F);this.geom.loc=G.locatePlot(D,H)}});y.gConstraints.PlotXY=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two coordinates.',inherits:"Constraint",usage:{"abstract":true,kinds:["Point"]},existenceRule:"Exists iff the parent CoordSys exists and the coordinates are numbers.",properties:{parents:{description:"",properties:{coordSys:{description:"The coordinate system for the coordinates.",kind:"CoordSys"}}}}},getCoordX:function(){return this.getParent("coordX").uValue},getCoordY:function(){return this.getParent("coordY").uValue},constrain:function(){var E=this.getParent("coordSys"),D=this.getCoordX(),F=this.getCoordY();if(!isFinite(D)||!isFinite(F)){this.state.exists=false}else{this.state.exists=true;this.geom.loc=E.locatePlot(D,F)}}});y.gConstraints.ActionButtonHide=y.makeClass(y.gConstraints.ActionButtonToggleHideShow,{doc:{description:"A button that hides its parents.",inherits:"ActionButtonToggleHideShow",refspec:{msg:"This constraint does not have a functional match in the current version of Geometer's Sketchpad. It was implemented to meet requirements from the Dynamic Number project."},usage:{"abstract":false},properties:{parents:{description:"Set of objects to be hidden",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Button-HideShow_export.json"},updateLabelFromMessage:function(){this.label=this.messages[0]},press:function(E,D){if(this.state.isActive){return}this.state.isActive=true;E.invalidateGeom(this);this.beginAction("hide",D,E)}});y.gConstraints.Intersection2=y.makeClass(y.gConstraints.Intersection1,{doc:{description:'One of two points of intersection of a <span class="kind">Circle</span> with another Circle or a Circle with a <span class="kind">Straight</span> object.',inherits:"Intersection1",refspec:{gspRef:"InterLCB",msg:"This constraint is intended to behave in the same way as the corresponding constraints, InterLCB and InterCCB, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent objects exist and have at least one point of intersection.",properties:{},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Intersection12_export.json"},constrain:function(){var D=this.getIntersectionPoints(),E=D[1]||D[0];if(E){this.geom.loc=E;this.state.exists=true}else{this.geom.loc=y.GeometricPoint(h,h);this.state.exists=false}}});y.gConstraints.PlotFixedRhoFixedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two fixed polar coordinates.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotFixedRhoFixedTheta",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotFixedRhoFixedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordRho:{description:"",type:"Number"},coordTheta:{description:"",kind:"Number"}}},getCoordRho:function(){return this.coordRho},getCoordTheta:function(){return this.coordTheta}});y.gConstraints.PlotFixedRhoMarkedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a fixed and a <span class="kind">Param</span> polar coordinate.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotFixedRhoMarkedTheta_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotFixedRhoMarkedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordRho:{description:"",type:"Number"},parents:{description:"",properties:{coordTheta:{description:"",kind:"Measure"}}}}},getCoordRho:function(){return this.coordRho}});y.gConstraints.PlotFixedXFixedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two fixed coordinates.',inherits:"PlotXY",refspec:{gspRef:"PlotFixedXFixedY_C"},usage:{"abstract":false},existenceRule:"Exists iff the parent CoordSys exists and the coordinates are numbers.",properties:{coordX:{description:"",type:"Number"},coordY:{description:"",type:"Number"}}},getCoordX:function(){return this.coordX},getCoordY:function(){return this.coordY}});y.gConstraints.PlotFixedXMarkedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a fixed coordinate and a <span class="kind">Param</span> coordinate.',inherits:"PlotXY",refspec:{gspRef:"PlotFixedXMarkedY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotFixedXMarkedY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordX:{description:"",type:"Number"},parents:{description:"",properties:{coordY:{description:"",kind:"Measure"}}}}},getCoordX:function(){return this.coordX}});y.gConstraints.PlotMarkedRhoFixedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a <span class="kind">Param</span> and a fixed polar coordinate.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotMarkedRhoFixedTheta_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedRhoFixedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordTheta:{description:"",type:"Number"},parents:{description:"",properties:{coordRho:{description:"",kind:"Measure"}}}}},getCoordTheta:function(){return this.coordTheta}});y.gConstraints.PlotMarkedRhoMarkedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two <span class="kind">Param</span> polar coordinates.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotMarkedRhoMarkedTheta_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedRhoMarkedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{parents:{description:"",properties:{coordRho:{description:"",kind:"Measure"},coordTheta:{description:"",kind:"Measure"}}}}}});y.gConstraints.PlotMarkedXFixedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a <span class="kind">Param</span> coordinate and a fixed coordinate.',inherits:"PlotXY",refspec:{gspRef:"PlotMarkedXFixedY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedXFixedY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordY:{description:"",type:"Number"},parents:{description:"",properties:{coordX:{description:"",kind:"Measure"}}}}},getCoordY:function(){return this.coordY}});y.gConstraints.PlotMarkedXMarkedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two <span class="kind">Param</span> coordinates.',inherits:"PlotXY",refspec:{gspRef:"PlotMarkedXMarkedY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedXMarkedY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Params and CoordSys exist.",properties:{parents:{description:"",properties:{coordX:{description:"",kind:"Measure"},coordY:{description:"",kind:"Measure"}}}}}});y.gConstraints.ActionButtonShow=y.makeClass(y.gConstraints.ActionButtonToggleHideShow,{doc:{description:"Defines an action that reveals a hidden GObject.",inherits:"ActionButtonToggleHideShow",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent objects exist.",properties:{parents:{description:"Set of objects to be shown",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Button-HideShow_export.json"},updateLabelFromMessage:function(){this.label=this.messages[0]},press:function(E,D){if(this.state.isActive){return}this.state.isActive=true;E.invalidateGeom(this);this.beginAction("show",D,E)}});y.css="/* For now, these are not in less. Just import them raw. */\n/*!\n  Web Sketchpad. Copyright &copy; 2014 KCP Technologies, a McGraw-Hill Education Company. All rights reserved.\n  Version: Release: 2014Q4, Version: 4.0.0, Build Number: 805.17-r, Build Stamp: dn.kcptech.com/20150205084111\n*/\n\n/*\n * Styles governing drawing contexts. Within the node we are given we \n * construct a relatively positioned base node. It contains an absolutely\n * positioned node that is used for clipping. All drawing context nodes \n * (canvas layers, html layers) are created within the \n * clipping node and are absolutely positioned. They must correspond exactly\n * to the height and width of the clipping node.\n */\n.wsp-version-4-0-0.wsp-base-node {\n    position: relative;\n    display: inline-block;\n    cursor: default;\n    vertical-align: top;\n    font-size: 0px; /* inline-block adds grot heights for whitespace without this */\n    overflow: visible; /* prevents inheritance of overflow: scroll, which can\n                          cause layout issues */\n}\n\n.wsp-version-4-0-0 .wsp-transform-node {\n  transform-origin: top left;\n  -webkit-transform-origin: top left;\n  -ms-transform-origin: top left;\n  position:absolute;\n  display: inline-table;\n  border-collapse: collapse;\n  border-spacing: 0px;\n  top: 0px; left: 0px;\n  padding: 0px; margin: 0px;\n}\n\n.wsp-version-4-0-0 .wsp-main-row {\n  display: table-row;\n}\n\n.wsp-version-4-0-0 .wsp-sketch-container {\n  display: table-cell;\n  vertical-align: top;\n}\n\n.wsp-version-4-0-0 .wsp-text-layer .wsp-responsive-borderwidth {\n  border-width: 1px;\n}\n\n.wsp-version-4-0-0 .wsp-transform-large {\n  display: inline-block;\n}\n.wsp-version-4-0-0  .wsp-transform-medium {\n  display: none;\n}\n.wsp-version-4-0-0 .wsp-transform-small {\n  display: none;\n}\n\n\n.wsp-version-4-0-0 .wsp-clip-node {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n}\n.wsp-version-4-0-0 .wsp-clip-node canvas, .wsp-version-4-0-0 .wsp-text-layer {\n    position: absolute;\n    left: 0; top: 0;\n}\n\n.wsp-version-4-0-0 .sketch_canvas {\n    -webkit-user-select: none;\n    -moz-user-select: -moz-none;\n}\n\n/*\n * Styles governing html-layer sketch objects.\n */\n.wsp-version-4-0-0 .wsp-Measure, .wsp-version-4-0-0 .wsp-Point, .wsp-version-4-0-0 .wsp-Text, .wsp-version-4-0-0 .wsp-Param, .wsp-version-4-0-0 .wsp-Button, .wsp-version-4-0-0 .wsp-Expression, .wsp-version-4-0-0 .wsp-Label {\n    /*-webkit-touch-callout: none*/\n    /*-moz-touch-callout: none;*/\n    position:absolute;\n}\n\n\n/*\n  Buttons - see comment in wsp-skin.css for details\n*/\n\n.wsp-version-4-0-0 .wsp-Button {\n    display: table;\n    border-collapse: separate;\n    border-spacing: 0px;\n}\n\n.wsp-version-4-0-0 .wsp-Button-row {\n  display: table-row;\n}\n\n.wsp-version-4-0-0 .wsp-Button-drag-handle {\n  display: table-cell;\n  content: \"\";\n  height:100%;\n}\n  \n.wsp-version-4-0-0 .wsp-Button-label-frame {\n  display: table-cell;\n}\n\n.wsp-version-4-0-0 .wsp-Measure, .wsp-version-4-0-0 .wsp-Text, .wsp-version-4-0-0 .wsp-Param, .wsp-version-4-0-0 .wsp-Expression, .wsp-version-4-0-0 .wsp-Label {\n    font-size: 12px;\n    border: none;\n    margin: 0;\n    padding: 0;\n    background-color:transparent;\n    overflow-x: visible;\n    white-space: pre;\n}\n\n.wsp-version-4-0-0 .wsp-Measure, .wsp-version-4-0-0 .wsp-Text {\n    cursor: default;\n}\n\n.wsp-version-4-0-0 .wsp-Measure {\n    line-height: 1;\n}\n\n.wsp-version-4-0-0 .wsp-Point {\n    cursor: pointer;\n    font-size: 8px;\n}\n\n.wsp-version-4-0-0 .wsp-Expression .mfs-input {\n    cursor: text;\n}\n\n/* styles for MFS to HTML conversion */\n.wsp-version-4-0-0 .mfs {\n    /*\n      border: solid thin red;\n    */\n    display: run-in;\n}\n\n.wsp-version-4-0-0 .mfs-abs:before {\n    content: '|';\n}\n\n.wsp-version-4-0-0 .mfs-abs:after {\n    content: '|';\n}\n\n.wsp-version-4-0-0 .mfs-bracket:before {\n    content: '[';\n}\n\n.wsp-version-4-0-0 .mfs-bracket:after {\n    content: ']';\n}\n\n.wsp-version-4-0-0 .mfs-curly:before {\n    content: '{';\n}\n\n.wsp-version-4-0-0 .mfs-curly:after {\n    content: '}';\n}\n\n.wsp-version-4-0-0 .mfs-tightness-normal {\n    letter-spacing: normal;\n}\n.wsp-version-4-0-0 .mfs-tightness-condensed {\n    letter-spacing: -0.1em;\n}\n.wsp-version-4-0-0 .mfs-tightness-expanded {\n    letter-spacing: .2em;\n}\n\n.wsp-version-4-0-0 .mfs-frac {\n    display: inline-block;\n    font-size: 90%;\n    vertical-align: middle;\n    text-align: center;\n}\n\n.wsp-version-4-0-0 .mfs-exponent{\n    vertical-align: super;\n    font-size: 70%;\n}\n\n.wsp-version-4-0-0 .mfs-frac .mfs-numr, .wsp-version-4-0-0 .mfs-frac .mfs-denm{\n    display: block;\n}\n\n.wsp-version-4-0-0 .mfs-numr {\n    border-bottom: thin black solid;\n}\n\n\n.wsp-version-4-0-0 .mfs-super-group, .wsp-version-4-0-0 .mfs-sub-group, .wsp-version-4-0-0 .mfs-horizontal, .wsp-version-4-0-0 .mfs-root, .wsp-version-4-0-0 .mfs-paren,\n.wsp-version-4-0-0 .mfs-bracket, .wsp-version-4-0-0 .mfs-curly, .wsp-version-4-0-0 .mfs-abs {\n    display: inline-block;\n    text-decoration: inherit;\n}\n.wsp-version-4-0-0 .mfs-horizontal {\n  white-space: pre;\n}\n.wsp-version-4-0-0 .mfs-param {\n    /*\n     * background-color: lightgray;\n     */\n    display: inline-block;\n}\n\n.wsp-version-4-0-0 .wsp-text-layer tbody { vertical-align: baseline; }\n\n.wsp-version-4-0-0 .mfs-paren, .wsp-version-4-0-0 .mfs-root {\n    display: inline-table;\n    border-collapse: collapse;\n    border-spacing: 0px;\n}\n\n.wsp-version-4-0-0 .mfs-paren td, .wsp-version-4-0-0 .mfs-root td {\n    padding: 0px;\n}\n\n.wsp-version-4-0-0 .mfs-paren td.mfs-left-paren, .wsp-version-4-0-0 .mfs-paren td.mfs-right-paren {\n    background-size: 100% 100%;\n}\n\n.wsp-version-4-0-0 .mfs-root td.mfs-left-root {\n    background-size: 105% 100%;\n}\n\n.wsp-version-4-0-0 .mfs-root td.mfs-right-root {\n    background-size: 100% 100%;\n}\n\n.wsp-version-4-0-0 td.mfs-right-root {\n    padding-top: .15em;\n}\n\n/* Paren TD's have a dummy span under them, which fixes a rendering\nissue with chrome. If you set the width of the TD itself, chrome adds\nan extra two pixels to the adjoing td containing the parenthesized\nexpression! */\n.wsp-version-4-0-0 .mfs-paren td.mfs-left-paren >span,\n.wsp-version-4-0-0 .mfs-paren td.mfs-right-paren >span\n{\n    display: inline-block;\n    width: .35em;\n}\n\n/* See above comment on paren TD's */\n.wsp-version-4-0-0 .mfs-root td.mfs-left-root >span\n{\n    display: inline-block;\n    width: .7em;\n}\n\n.wsp-version-4-0-0 .mfs-subscript {\n    font-size: smaller;\n    vertical-align: sub;\n}\n.wsp-version-4-0-0 .mfs-style {\n    display: inline;\n}\n\n.wsp-version-4-0-0 .mfs-overbar-arc, .wsp-version-4-0-0 .mfs-overbar-ray, .wsp-version-4-0-0 .mfs-overbar-line,\n.wsp-version-4-0-0 .mfs-overbar-seg {\n    display: inline-block;\n    line-height: 1.4;\n    background-repeat: no-repeat;\n}\n\n.wsp-version-4-0-0 .mfs-overbar-ray, .wsp-version-4-0-0 .mfs-overbar-line {\n    background-size: 100% .3em;\n    padding-top: .02em;\n}\n\n.wsp-version-4-0-0 .mfs-overbar-arc {\n    background-size: 100% .7em;\n    padding-top: .55em;\n}\n\n.wsp-version-4-0-0 .mfs-overbar-seg {\n    background-size: 100% 100%;\n}\n\n.wsp-version-4-0-0 .mfs-overbar-line > .mfs-horizontal .mfs-text:last-child:after,\n.wsp-version-4-0-0 .mfs-overbar-ray > .mfs-horizontal .mfs-text:last-child:after {\n    content: \"\\200A\\200A\"; /* two hair spaces */\n}\n\n.wsp-version-4-0-0 .mfs-overbar-seg > .mfs-horizontal .mfs-text:last-child:after {\n    content: \"\\200A\"; /* one hair space */\n}\n\n.wsp-version-4-0-0 .mfs-underbar-seg {\n    border-bottom-width: thin;\n    border-bottom-color: black;\n    border-bottom-style: solid;\n    line-height: 0.9;\n    display: inline-block;\n}\n\n.wsp-version-4-0-0 .mfs-text {\n    display: inline;\n}\n\n.wsp-version-4-0-0 .mfs-vertical-group {\n    display: inline-block;\n}\n\n.wsp-version-4-0-0 .mfs-vertical-group > * {\n    display: block;\n}\n\n.wsp-version-4-0-0 .wsp-text-layer * {\n    -ms-user-select: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -o-user-select: none;\n    user-select: none;\n}\n\n.wsp-version-4-0-0 .wsp-text-layer {\n    line-height: normal;\n}\n\n.wsp-version-4-0-0 .mfs-input {\n    font-size: inherit;\n    display: inline-block;\n    white-space: nowrap;\n    overflow: visible;\n}\n\n.wsp-version-4-0-0 .wsp-numeric {\n     position: absolute;\n   }\n\n.wsp-version-4-0-0 .wsp-numfield-text {\n    white-space: nowrap;\n}\n\n@-webkit-keyframes blinker { from {opacity:1.0;} to {opacity:0.0;} }\n          @keyframes blinker { from {opacity:1.0;} to {opacity:0.0;} }\n.wsp-version-4-0-0 .wsp-blink {\n    font-size: larger;\n    color: black;\n    font-stretch: ultra-condensed;\n    /*text-decoration:blink;*/\n\n    -webkit-animation-name:blinker;\n            animation-name:blinker;  \n    -webkit-animation-iteration-count:infinite;  \n            animation-iteration-count:infinite;  \n    -webkit-animation-timing-function:cubic-bezier(1.0,0,0,1.0);\n            animation-timing-function:cubic-bezier(1.0,0,0,1.0);\n    -webkit-animation-duration:1s; \n            animation-duration:1s; \n}\n\n.wsp-version-4-0-0 .wsp-selected {\n    background-color: yellow;\n}\n.wsp-version-4-0-0 .wsp-Numberpad {\n    position: absolute;\n    pointer-events: auto;\n    -webkit-user-drag: element;\n}\n\n.wsp-version-4-0-0 .wsp-Numberpad, .wsp-version-4-0-0 .wsp-Numberpad *,\n.wsp-version-4-0-0 .wsp-Numberpad *:before, .wsp-version-4-0-0 .wsp-Numberpad *:after {\n    /** needs to be set to default in case it has been changed by any plugins/frameworks **/\n    /* Bootstrap changes the setting of box-sizing, which is a setting\n       that tells browser whether to take margin, padding into account when imposing the\n       height/width property. */\n    -webkit-box-sizing: content-box;\n    -moz-box-sizing: content-box;\n    box-sizing: content-box;\n}\n\n/* The body of the Numberpad */\n.wsp-version-4-0-0 .wsp-Numberpad-body {\n    display: -webkit-flex;\n    display: flex;\n    -webkit-flex-direction: column;\n    flex-direction: column;\n    -webkit-justify-content: space-around;\n    justify-content: space-around;\n}\n\n/* A row of Buttons */\n.wsp-version-4-0-0 .wsp-Numberpad-row {\n    display: -webkit-flex;\n    display: flex;\n    -webkit-flex-direction: row;\n    flex-direction: row;\n    -webkit-justify-content: space-around;\n    justify-content: space-around;\n}\n\n\n/*\n.wsp-version-4-0-0 .wsp-numpad-key:hover {\n    background-image: linear-gradient(to bottom, #aaa, #666);\n    background-color: #888;\n    color: #eee;\n}\n*/\n\n.wsp-version-4-0-0 .wsp-error-message {\n  text-align: center;\n  margin-top: 25px;\n  margin-bottom: 25px;\n  color: red;\n  font-size: 125%;\n}\n\n.wsp-version-4-0-0 .wsp-tool-container {\n  display: table-cell;\n  vertical-align: top;\n  background-color: #F5F5F5;\n  padding-right: 10px;\n  margin-right: 5px;\n }\n\n.wsp-version-4-0-0 .wsp-tool-column {\n  background:black;\n  border-radius:5px;\n  box-shadow: 3px 3px 7px black;\n}\n\n.wsp-version-4-0-0 .wsp-tool {\n  border: 2px solid black;\n  border-radius: 5px;\n  background-color: white;\n  text-align: center;\n  font-size: 24px;\n  font-weight: 200;\n}\n\n.wsp-version-4-0-0 .wsp-tool > img {\n  display: block;\n}\n\n.wsp-version-4-0-0 .wsp-tool-active {\n  opacity: 0.5;\n  /*border: 2px solid red;*/\n  \n}\n\n.wsp-version-4-0-0 .wsp-text-target-highlight {\n  background-color: rgba(255,0,0,0.5) !important;\n}\n\n.wsp-version-4-0-0 .wsp-text-target-highlight, .wsp-version-4-0-0 .wsp-text-unmatched-given {\n    border: 2px solid rgba(255,0,0,0.5) !important;\n    border-radius: 5px !important;\n    box-shadow: 3px 3px 7px black !important;\n}\n\n@keyframes wsp-version-4-0-0FlickerAnimation {\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n@-o-keyframes wsp-version-4-0-0FlickerAnimation{\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n@-moz-keyframes wsp-version-4-0-0FlickerAnimation{\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n@-webkit-keyframes wsp-version-4-0-0FlickerAnimation{\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n\n.wsp-version-4-0-0 .wsp-text-unmatched-given {\n    -webkit-animation: wsp-version-4-0-0FlickerAnimation 5s infinite;\n    -moz-animation: wsp-version-4-0-0FlickerAnimation 5s infinite;\n    -o-animation: wsp-version-4-0-0FlickerAnimation 5s infinite;\n    animation: wsp-version-4-0-0FlickerAnimation 5s infinite;\n}\n\n\n/* We could, if desired, move the wsp-Transform section into\n * wsp-skin.css and make the transform skinnable.\n * For that to be worthwhile, we would need to make the scale factors\n * used customizable. The css transform isn't a problem - customizers\n * just change it. But wsp.js needs to know that at init time, and it's\n * a bit tricky to encode something in css readable by js (e.g. hiding some info\n * in a hidden node is stymied by browsers that don't set properties until the node\n * is displayed. You could stash something in content::after but querying that isn't\n * supported on IE). Best I can think of here is to have a wsp-responsize-size-small-factor\n * class (and medium, etc.), with some property like opacity set to [0,1]. Code would then sniff that\n * by inserting a node into the DOM. This would have to match the value used in transform: scale();\n */\n/* Section Start: wsp-Transform */\n\n/* The transform node is the target for css transforms that\n  scale down the content to fit in smaller form factor devices.\n\n  CSS transforms are used for the scaling - but since those\n  do not change the content size of their targets, we need\n  to fix our content size too. The technique used is to take\n  the actual content containing wsp-transform-node out of the flow,\n  and create sibling DOM elements (wsp-transform-large, wsp-transform-medium,\n  wsp-transform-small) of appropriate size, and make sure the right one is displayed\n  while the rest are not.\n*/\n\n/* .wsp-transform-node will be position: absolute, with transform-origin: top left \n  wsp-transform-large by default is display: inline-block,\n  wsp-transform-medium, wsp-transform-small are display: none\n  Turn on large, medium, small using media queries - you'll need to override the\n  default ones.\n*/\n\n/*\n *  For our default sizing, some assumptions and numbers.\n *  For a normal desktop sketch, we'll take a usual width as 800px (Mac window is 780x540 by default)\n *  \n *  For a mobile friendly document, we'll take as a baseline iPad landscape width (1024), where our ideal sketch width is 600px.\n *  On iPad portrate width (768px = 75% of 1024px), our ideal sketch width is 400px (75% of 600px)\n *  On Smartphone portrate (480px = 46.875% of 1024px), our ideal sketch width is 300px (50% of 600px)\n *\n *  The media queries are conditionalized by several classes on the root node.\n *  wsp-responsiveSizing: must be present for responsive sizing to be in effect\n *  wsp-responsiveSizing-small-size: support the 50% size;\n *  wsp-responsiveSizing-medium-size: support the 75% size;\n *  wsp-responsiveSizing-medium-break: if present, a break at the medium device width\n *    chooses medium size if available, otherwise small size\n *  wsp-responsiveSizing-small-break: if present, a break at the small device width\n *    chooses small size if available, otherwise medium size\n *\n */\n\n/* \n * First break half way between iPad landscape and iPad Portrate\n * ideal sketch width: 400px;\n * max-width: 892px\n * scale factor: 0.75;\n*/\n@media only screen and (max-width: 892px) {\n  \n\n  /* Small size default if .wsp-responsiveSizing-medium-size*/\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-medium {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-small {\n    display: inline-block;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-node {\n    transform: scale(0.5);\n    -webkit-transform: scale(0.5);\n    -ms-transform: scale(0.5);\n  }\n\n  /* Override with medium size if wsp-responsiveSizing-medium-size */\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-medium {\n    display: inline-block;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-small {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-node {\n    transform: scale(0.75);\n    -webkit-transform: scale(0.75);\n    -ms-transform: scale(0.75);\n  }\n}\n\n/*\n * Second break half way between iPad portrate and Smartphone portrate\n * ideal sketch width: 300px;\n * max-width: 624px\n * scale factor: 0.5;\n*/\n@media only screen and (max-width: 624px) {\n\n  /* Default to medium size if .wsp-responsiveSizing-medium-size */\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-medium {\n    display: inline-block;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-small {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-node {\n    transform: scale(0.75);\n    -webkit-transform: scale(0.75);\n    -ms-transform: scale(0.75);\n  }\n  \n  /* Override to small size if .wsp-responsiveSizing-small-size */\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-medium {\n    display: none;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-small {\n    display: inline-block;\n  }\n  .wsp-version-4-0-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-node {\n    transform: scale(0.5);\n    -webkit-transform: scale(0.5);\n    -ms-transform: scale(0.5);\n  }\n}\n/* Section End: wsp-Transform */\n\n/*\n  Web Sketchpad. Copyright &copy; 2014 KCP Technologies, a McGraw-Hill Education Company. All rights reserved.\n  Version: Release: 2014Q4, Version: 4.0.0, Build Number: 805.17-r, Build Stamp: dn.kcptech.com/20150205084111\n*/\n\n\n/* Section Start: wsp-Button */\n/*\n\n  The outer element of a button will have class .wsp-Button\n  Additional modifiers will be added as classes\n  .wsp-appearance-drag: The button is being dragged / moved;\n  .wsp-appearance-unselect: The button is not arrow selectable\n    and thus not draggable;\n  .wsp-appearance-short: The button is < 28 pixels high;\n  .wsp-appearance-pressed: The button is depressed by user action;\n  .wsp-appearance-active: The button is performing its action, which may\n    continue after it's been clicked;\n\n\n  Within the button we have some substructure to allow\n  for a drag handle, a row of mfs text, and allow for the text\n  top to move down one pixel during a click as part of it's depressed\n  appearance.\n\n  wsp-Button contains a wsp-Button-row\n  wsp-Button-row contains a wsp-Button-drag-handle and a wsp-Button-label-frame\n  wsp-Button-label-frame contains a wsp-Button-label\n\n+-------------------wsp-Button--------------------------+\no--wsp-Button-row-x------wsp-Button-label-frame--------o|\n||                |                                    ||\n||                +------------------------------------||\n|| wsp-Button-    |                                    ||\n|| drag-handle    |                                    ||\n||                |    wsp-Button-label                ||\n||                |                                    ||\n||                |                                    ||\no-----------------x------------------------------------o|\n+-------------------------------------------------------+\n\n*/\n\n/* base style for the whole button */\n.wsp-Button {\n    cursor: pointer;\n}\n\n/* When it's dragging about, lighten it up */\n.wsp-Button.wsp-appearance-drag {\n  opacity: .8;\n}\n\n\n/* Styles for the handle - the dragable bit on the left of the button */\n.wsp-Button-drag-handle {\n  width: 30px;\n  min-width: 30px;\n  padding:0px;\n  margin:0px;\n  border: 1px solid;\n  border-bottom: 3px solid;\n  border-color: rgba(0,0,0,.20);\n  border-bottom-left-radius: 5px;\n  border-top-left-radius: 5px;\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozMTk3Q0Q2QUEyOEMxMUUzQkJDNThBNzkxMDgzM0M1NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozMTk3Q0Q2QkEyOEMxMUUzQkJDNThBNzkxMDgzM0M1NiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjMxOTdDRDY4QTI4QzExRTNCQkM1OEE3OTEwODMzQzU2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjMxOTdDRDY5QTI4QzExRTNCQkM1OEE3OTEwODMzQzU2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+krwYJAAAATBJREFUeNpi/P//PwOtABOJ6iVoZbgXEG8E4mCidYCChQgcDMSngPgMEJ8G4ihi9DESEeYxQJwPxIxo4pOBeCE+jYQMTwHiDDzys6CYLMORwRkktgklEapLYirSIdZwTWh4kgKmALEaIcNVoQp5SDQcpH4qECvhCnOQxEwgFqQgU74C4nQgfoxsuBgQLwJiESrk+hdAHA/Eb2HB8gaIT1OpSLkOxB/RgwVkUScQO+JIbviSIkzuGBAXA/Fv9Aj9B8RVUAXkgFNAXAozGFtqAUmUAfFZEg0+B8RFQPyTmBzKBcTfSAgWbOoJZv9EIM7GI78Ami/IKs/nA/EEUMmMRW47NOMwUFpwhUEjC1bsHoeG8W9qVBYgHAitMBYAMQe1Kgtk4AxNGe+JUcxIy9ofIMAAebvg5/LOIwYAAAAASUVORK5CYII=);\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* When the button is short (< 28 px heigh */\n.wsp-appearance-short .wsp-Button-drag-handle {\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA40lEQVQY023RIU+XcRTF8c/vD5O5OQMGdGCgwGZgFqEQ3SC5yZsw+woMvgDegY1KoFEtElGr0UBlM7Gxr+V5NgRvuXfnnrt77rmgMke1qFZm7G7vPnGp2q1Oq8P/cWZgVK+q8+pHdVbtPxiYiOtTvVZdzMRqtVrAohrYxnH1fKoHNqo9fMAbGNUKvmAHf7DAEm4RnuArPi3jBud4hs94iY84wW8c4Duu7x54NOW9SfP76kX1uno0awZjjNNqA++m1W/xdIxxOca4qSz/a6ArfMMmfuLXbNsY4+FzJhu3qsf3H/IXCFmh/vAsFrYAAAAASUVORK5CYII=);\n}\n\n/* Non-arrow selectable buttons don't have a full sided drag handle.\n It just becomes a narrow vertical strip */\n.wsp-appearance-unselectable .wsp-Button-drag-handle {\n  background-image: none;\n  width: 5px;\n  min-width: 5px;\n}\n \n/* frame the button label (where the text is).\n The frame is the part that's stable when the button is pressed down,\n so it's just responsible for the top border */\n.wsp-Button-label-frame {\n  border-top: 1px solid #c2b892;\n  border-bottom-right-radius: 5px;\n  border-top-right-radius: 5px; \n  background-color: #f5f5ed;\n}\n\n/* Some padding and border for the interior portion of the label */\n.wsp-Button-label {\n  padding-left: 2px;\n  padding-right: 2px;\n  border-style: solid;\n  border-color: #c2b892;\n  border-left-width: 0px;\n  border-right-width: 1px;\n  border-top-width: 0px;\n  border-bottom-width: 3px;\n  border-bottom-right-radius: 5px;\n  border-top-right-radius: 5px;\n}\n\n/* When pressed the frame lets the the label handle the \n border so it can move down a pixel */\n.wsp-appearance-pressed .wsp-Button-label-frame {\n  border-top-color: transparent; \n}\n\n/* Add the border on the top now that the frame has punted it to us */\n.wsp-appearance-pressed .wsp-Button-label {\n  padding-top:1px;\n  border-top-width: 1px;\n  border-bottom-width: 1px;\n}\n\n/* When the button is working, a background */\n.wsp-appearance-active .wsp-Button-label-frame {\n  border-top-color: transparent; \n  opacity: 1;\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAoCAIAAACw1AcgAAAKmWlDQ1BpY2MAAHjalZZ3UJPpFsbP933phZaAgJTQO1KkCyT0AArSwUZIAgRCjCFBBGzI4gqsBRURrOiiiIKrUmQtiAXbItiwb5BFRV1FXWyo3D+4xHvv3Dt39sy8M78588zzvue8/zwAtL08qVSMagDkSOSymNAAVlJyCov4AChAAxKogQ2PnyvlREdHwv+s97cBAQC44cCTSsXw90pTIMzlAyDRAJAmyOXnACDHAJAyvlQmB8DYAGC+WC6VA2ACAGDKkpJTALB8AGBmTHAFADDTJngXADBlcTGBANgxABKNx5NlAFA7AYCVx8+QA1CVAOAkEYgkADQNAPDjZ/IEALRoALDPyVkoAKAVAYB12r/4ZPybZ5rKk8fLUPHELAAAQAoS5UrFvCV/cx3/v3LEisk7jACAlpsdGwEAWgBIPp8XHDvJmUJu5CRL5QExkyySc+NUGkVY/CQrsuM5k5y9MEKll6TNilL55wamTHJBZlziJAuEQcGTLFsYo9Ln5sUGf9cHzprkLF549CTzZACTLBSHxnx/c7TqnRLxLNUs6bIQlUaY+31eeWZcmIplcSpNuiiEq5pXFvbdXxyt8pQpYlR7EEriVZ4CXpBqtxAIIpCAEHKABywIgyAAuTBfDgAQuFC6RCbKyJSzOFKpWGjP4kr4jvYsFydnF0hKTmFNfNe7O4AAAKJD+t4rPAnAKQRAI773EmwBGnoBmAu+98xfAzBbAE4U8xWyvIkeDgAADxRQBybogRGYgTU4gAu4gw+wIRjCIQriIBnmAx8yIQdksBiKYCWUQjmsh81QAzthD+yHQ3AE2uAEnIELcAV64RbcByUMwQsYgfcwhiAIEaEjDEQPMUYsEDvEBfFE/JBgJBKJQZKRVCQDkSAKpAhZhZQjlUgNshtpQH5BjiNnkEtIH3IXGUCGkbfIZxRDaSgTNUQt0WmoJ8pBI9A4dB6agS5CC9ASdC1ajdahB9FW9Ax6Bb2FKtEX6CgGGBXTwUwwB8wTC8SisBQsHZNhy7AyrAqrw5qwDqwbu4EpsZfYJxwBx8CxcA44H1wYLh7Hxy3CLcNV4Gpw+3GtuHO4G7gB3AjuG56ON8Db4b3xXHwSPgO/GF+Kr8LX41vw5/G38EP49wQCQYdgRfAghBGSCVmEQkIFYTuhmdBJ6CMMEkaJRKIe0Y7oS4wi8ohyYilxK/Eg8TTxOnGI+JFEJRmTXEghpBSShFRMqiIdIJ0iXSc9JY2RNcgWZG9yFFlAXkJeR95L7iBfIw+RxyiaFCuKLyWOkkVZSammNFHOUx5Q3lGpVFOqF3U2VURdQa2mHqZepA5QP9G0aLa0QNpcmoK2lraP1km7S3tHp9Mt6Wx6Cl1OX0tvoJ+lP6J/VGOoOapx1QRqy9Vq1VrVrqu9UierW6hz1OerF6hXqR9Vv6b+UoOsYakRqMHTWKZRq3Fco19jVJOh6awZpZmjWaF5QPOS5jMtopalVrCWQKtEa4/WWa1BBsYwYwQy+IxVjL2M84whJoFpxeQys5jlzEPMHuaItpb2dO0E7XztWu2T2kodTMdSh6sj1lmnc0Tnts7nKYZTOFOEU9ZMaZpyfcoH3am6bF2hbplus+4t3c96LL1gvWy9DXpteg/1cfq2+rP1F+vv0D+v/3Iqc6rPVP7UsqlHpt4zQA1sDWIMCg32GFw1GDU0Mgw1lBpuNTxr+NJIx4htlGW0yeiU0bAxw9jPWGS8yfi08XOWNovDErOqWedYIyYGJmEmCpPdJj0mY6ZWpvGmxabNpg/NKGaeZulmm8y6zEbMjc1nmheZN5rfsyBbeFpkWmyx6Lb4YGllmWi52rLN8pmVrhXXqsCq0eqBNd3a33qRdZ31TRuCjadNts12m15b1NbNNtO21vaaHWrnbiey227XZ4+397KX2NfZ9zvQHDgOeQ6NDgOOOo6RjsWObY6vpplPS5m2YVr3tG9Obk5ip71O9521nMOdi507nN+62LrwXWpdbrrSXUNcl7u2u76ZbjddOH3H9DtuDLeZbqvduty+unu4y9yb3Ic9zD1SPbZ59HsyPaM9KzwveuG9AryWe53w+uTt7i33PuL92sfBJ9vngM+zGVYzhDP2zhj0NfXl+e72Vfqx/FL9dvkp/U38ef51/o/ZZmwBu579lGPDyeIc5LwKcAqQBbQEfAj0Dlwa2BmEBYUGlQX1BGsFxwfXBD8KMQ3JCGkMGQl1Cy0M7QzDh0WEbQjr5xpy+dwG7ki4R/jS8HMRtIjYiJqIx5G2kbLIjpnozPCZG2c+mGUxSzKrLQqiuFEbox5GW0Uviv51NmF29Oza2U9inGOKYrpjGbELYg/Evo8LiFsXdz/eOl4R35WgnjA3oSHhQ2JQYmWiMmla0tKkK8n6yaLk9hRiSkJKfcronOA5m+cMzXWbWzr39jyrefnzLs3Xny+ef3KB+gLegqOp+NTE1AOpX3hRvDreaBo3bVvaCD+Qv4X/QsAWbBIMC32FlcKn6b7plenPMnwzNmYMZ/pnVmW+FAWKakRvssKydmZ9yI7K3pc9Lk4UN+eQclJzjku0JNmScwuNFuYv7JPaSUulykXeizYvGpFFyOpzkdx5ue1yplwqv6qwVvygGMjzy6vN+7g4YfHRfM18Sf7VJbZL1ix5WhBS8HMhrpBf2FVkUrSyaGApZ+nuZciytGVdy82WlywfWhG6Yv9Kysrslb8VOxVXFv+1KnFVR4lhyYqSwR9Cf2gsVSuVlfav9lm980fcj6Ife9a4rtm65luZoOxyuVN5VfmXCn7F5Z+cf6r+aXxt+tqede7rdqwnrJesv73Bf8P+Ss3KgsrBjTM3tm5ibSrb9NfmBZsvVU2v2rmFskWxRVkdWd2+1Xzr+q1fajJrbtUG1DZvM9i2ZtuH7YLt13ewdzTtNNxZvvPzLtGuO7tDd7fWWdZV7SHsydvzZG/C3u6fPX9uqNevL6//uk+yT7k/Zv+5Bo+GhgMGB9Y1oo2KxuGDcw/2Hgo61N7k0LS7Wae5/DAcVhx+/kvqL7ePRBzpOup5tOmYxbFtLYyWslakdUnrSFtmm7I9ub3vePjxrg6fjpZfHX/dd8LkRO1J7ZPrTlFOlZwaP11werRT2vnyTMaZwa4FXffPJp29eW72uZ7zEecvXgi5cLab0336ou/FE5e8Lx2/7Hm57Yr7ldarbldbfnP7raXHvaf1mse19l6v3o6+GX2nrvtfP3Mj6MaFm9ybV27NutV3O/72nf65/co7gjvP7orvvrmXd2/s/ooH+AdlDzUeVj0yeFT3u83vzUp35cmBoIGrj2Mf3x/kD774I/ePL0MlT+hPqp4aP2145vLsxHDIcO/zOc+HXkhfjL0s/VPzz22vrF8de81+fXUkaWTojezN+NuKd3rv9v01/a+u0ejRR+9z3o99KPuo93H/J89P3Z8TPz8dW/yF+KX6q83Xjm8R3x6M54yPS3kyHgAAYACApqcDvN0HQE8GYPQCUNQm8i4AACATGR1gIoP8d57IxAAA4A6wpxMgsRMgvBNgBxvAgg3AAIBoNkAcG1BXV9X5Z+Wmu7pMeFHbAPBV4+PvEgGINgBf+8fHx9rGx7/WA2D3ADrfT+RsAACCBkClGbrCpep06/oV/5l3/wHNmfXlY/st0gAAAAlwSFlzAAAASAAAAEgARslrPgAAAAl2cEFnAAAAAQAAACgAg9PABgAAADBJREFUCNdjWPjgPxMjAwMTEyMDEzOUZmJkYGJGphmIE4OJMzMhyRNhJgwzMmCYBQDI9ANK1RWWcgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMi0xMi0xOFQxNjoxNDowOS0wODowMMK1MMQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTItMTItMThUMTY6MTQ6MDktMDg6MDCz6Ih4AAAAAElFTkSuQmCC');\n  background-repeat: no;\n  background-size: 100% 100%;\n}\n\n/* When the button is working, it looks pressed */\n.wsp-appearance-active .wsp-Button-label {\n  padding-top:1px;\n  border-top-width: 1px;\n  border-bottom-width: 1px;\n}\n/* Section End: wsp-Button */\n\n/* The \"cancel\" button in the header, contains an \"x\" */\n.wsp-Numberpad-cancel {\n    margin-left: auto ;\n    text-align: center ;\n    vertical-align: middle ;\n\n    font-weight: bold ;\n    font-size: larger ;\n    background-repeat: no-repeat;\n    background-position: center;\n}\n\n/* Section Start: wsp-tool */\n/* Numpad and Tools share a png of a \"X\" */\n.wsp-tool-cancel, .wsp-Numberpad-cancel {\n    cursor: pointer ;\n    display: block ;\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAB4ElEQVQ4y61UvWsUQRx9s1mEIyF6FpYKFxvB2ORSBgu54giYIoWg/0Caa201nVUqMWksgohY2KlXuFttkBR3CSQHFprAFRZinHXvbm/d25t5FnGP2w8ICz4YmHnDvPl9zBsBSyKNzr3LtVsw1oMx6rMzuAoAvoIsmWh+gX532/Y+ZQ7BkpNRpaoEig4vQKDoVKkq02cnkza5wiLQWrbJlYRQlapCrSWLQmsZR2YAgKONXQhRRlEIUXa0sXteWKpa5iZ3KNsejxJcNCLP9KsgJ7AOVQ2K3EmwfT+K8377m12SpBqRn+UTWBLrX/k6LaTIHSMYo54I95JpEmgAwIMW7kDzJVqDZ2KITQC4P4/FdIbBGHVBzT4E5hI7oxGw7zdEhOfT9PZiubtxDdcztSIG+UIA4A8h9kMRLxdulN9/u4nV3KITfcNXyD5tHQFH4dNp6qSLR28kvDwdX8E1SiaaCXYcAc5gM64J785vcRaPAdd7eOhe+djDcVqoZKKZbX9vEMRd2z7717UwJC3ZgCWBDl/kth+WRMZfP/3vH36l3lEYkj/0Vi/Hd1mLFLVJ2iIt2zs9EGKtkE1I90CItZbtnQI4FwKAJdt1lqEXIo29izT+aOwtC1aXbNeZ2O5/fWx/AXUQdBRBFjTDAAAAAElFTkSuQmCC);\n}\n\n.wsp-tool-ok {\n    cursor: pointer;\n    display: block;\n    top: 0px;\n    right: 38px;\n\n    background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAKQWlDQ1BJQ0MgUHJvZmlsZQAASA2dlndUU9kWh8+9N73QEiIgJfQaegkg0jtIFQRRiUmAUAKGhCZ2RAVGFBEpVmRUwAFHhyJjRRQLg4Ji1wnyEFDGwVFEReXdjGsJ7601896a/cdZ39nnt9fZZ+9917oAUPyCBMJ0WAGANKFYFO7rwVwSE8vE9wIYEAEOWAHA4WZmBEf4RALU/L09mZmoSMaz9u4ugGS72yy/UCZz1v9/kSI3QyQGAApF1TY8fiYX5QKUU7PFGTL/BMr0lSkyhjEyFqEJoqwi48SvbPan5iu7yZiXJuShGlnOGbw0noy7UN6aJeGjjAShXJgl4GejfAdlvVRJmgDl9yjT0/icTAAwFJlfzOcmoWyJMkUUGe6J8gIACJTEObxyDov5OWieAHimZ+SKBIlJYqYR15hp5ejIZvrxs1P5YjErlMNN4Yh4TM/0tAyOMBeAr2+WRQElWW2ZaJHtrRzt7VnW5mj5v9nfHn5T/T3IevtV8Sbsz55BjJ5Z32zsrC+9FgD2JFqbHbO+lVUAtG0GQOXhrE/vIADyBQC03pzzHoZsXpLE4gwnC4vs7GxzAZ9rLivoN/ufgm/Kv4Y595nL7vtWO6YXP4EjSRUzZUXlpqemS0TMzAwOl89k/fcQ/+PAOWnNycMsnJ/AF/GF6FVR6JQJhIlou4U8gViQLmQKhH/V4X8YNicHGX6daxRodV8AfYU5ULhJB8hvPQBDIwMkbj96An3rWxAxCsi+vGitka9zjzJ6/uf6Hwtcim7hTEEiU+b2DI9kciWiLBmj34RswQISkAd0oAo0gS4wAixgDRyAM3AD3iAAhIBIEAOWAy5IAmlABLJBPtgACkEx2AF2g2pwANSBetAEToI2cAZcBFfADXALDIBHQAqGwUswAd6BaQiC8BAVokGqkBakD5lC1hAbWgh5Q0FQOBQDxUOJkBCSQPnQJqgYKoOqoUNQPfQjdBq6CF2D+qAH0CA0Bv0BfYQRmALTYQ3YALaA2bA7HAhHwsvgRHgVnAcXwNvhSrgWPg63whfhG/AALIVfwpMIQMgIA9FGWAgb8URCkFgkAREha5EipAKpRZqQDqQbuY1IkXHkAwaHoWGYGBbGGeOHWYzhYlZh1mJKMNWYY5hWTBfmNmYQM4H5gqVi1bGmWCesP3YJNhGbjS3EVmCPYFuwl7ED2GHsOxwOx8AZ4hxwfrgYXDJuNa4Etw/XjLuA68MN4SbxeLwq3hTvgg/Bc/BifCG+Cn8cfx7fjx/GvyeQCVoEa4IPIZYgJGwkVBAaCOcI/YQRwjRRgahPdCKGEHnEXGIpsY7YQbxJHCZOkxRJhiQXUiQpmbSBVElqIl0mPSa9IZPJOmRHchhZQF5PriSfIF8lD5I/UJQoJhRPShxFQtlOOUq5QHlAeUOlUg2obtRYqpi6nVpPvUR9Sn0vR5Mzl/OX48mtk6uRa5Xrl3slT5TXl3eXXy6fJ18hf0r+pvy4AlHBQMFTgaOwVqFG4bTCPYVJRZqilWKIYppiiWKD4jXFUSW8koGStxJPqUDpsNIlpSEaQtOledK4tE20Otpl2jAdRzek+9OT6cX0H+i99AllJWVb5SjlHOUa5bPKUgbCMGD4M1IZpYyTjLuMj/M05rnP48/bNq9pXv+8KZX5Km4qfJUilWaVAZWPqkxVb9UU1Z2qbapP1DBqJmphatlq+9Uuq43Pp893ns+dXzT/5PyH6rC6iXq4+mr1w+o96pMamhq+GhkaVRqXNMY1GZpumsma5ZrnNMe0aFoLtQRa5VrntV4wlZnuzFRmJbOLOaGtru2nLdE+pN2rPa1jqLNYZ6NOs84TXZIuWzdBt1y3U3dCT0svWC9fr1HvoT5Rn62fpL9Hv1t/ysDQINpgi0GbwaihiqG/YZ5ho+FjI6qRq9Eqo1qjO8Y4Y7ZxivE+41smsImdSZJJjclNU9jU3lRgus+0zwxr5mgmNKs1u8eisNxZWaxG1qA5wzzIfKN5m/krCz2LWIudFt0WXyztLFMt6ywfWSlZBVhttOqw+sPaxJprXWN9x4Zq42Ozzqbd5rWtqS3fdr/tfTuaXbDdFrtOu8/2DvYi+yb7MQc9h3iHvQ732HR2KLuEfdUR6+jhuM7xjOMHJ3snsdNJp9+dWc4pzg3OowsMF/AX1C0YctFx4bgccpEuZC6MX3hwodRV25XjWuv6zE3Xjed2xG3E3dg92f24+ysPSw+RR4vHlKeT5xrPC16Il69XkVevt5L3Yu9q76c+Oj6JPo0+E752vqt9L/hh/QL9dvrd89fw5/rX+08EOASsCegKpARGBFYHPgsyCRIFdQTDwQHBu4IfL9JfJFzUFgJC/EN2hTwJNQxdFfpzGC4sNKwm7Hm4VXh+eHcELWJFREPEu0iPyNLIR4uNFksWd0bJR8VF1UdNRXtFl0VLl1gsWbPkRoxajCCmPRYfGxV7JHZyqffS3UuH4+ziCuPuLjNclrPs2nK15anLz66QX8FZcSoeGx8d3xD/iRPCqeVMrvRfuXflBNeTu4f7kufGK+eN8V34ZfyRBJeEsoTRRJfEXYljSa5JFUnjAk9BteB1sl/ygeSplJCUoykzqdGpzWmEtPi000IlYYqwK10zPSe9L8M0ozBDuspp1e5VE6JA0ZFMKHNZZruYjv5M9UiMJJslg1kLs2qy3mdHZZ/KUcwR5vTkmuRuyx3J88n7fjVmNXd1Z752/ob8wTXuaw6thdauXNu5Tnddwbrh9b7rj20gbUjZ8MtGy41lG99uit7UUaBRsL5gaLPv5sZCuUJR4b0tzlsObMVsFWzt3WazrWrblyJe0fViy+KK4k8l3JLr31l9V/ndzPaE7b2l9qX7d+B2CHfc3em681iZYlle2dCu4F2t5czyovK3u1fsvlZhW3FgD2mPZI+0MqiyvUqvakfVp+qk6oEaj5rmvep7t+2d2sfb17/fbX/TAY0DxQc+HhQcvH/I91BrrUFtxWHc4azDz+ui6rq/Z39ff0TtSPGRz0eFR6XHwo911TvU1zeoN5Q2wo2SxrHjccdv/eD1Q3sTq+lQM6O5+AQ4ITnx4sf4H++eDDzZeYp9qukn/Z/2ttBailqh1tzWibakNml7THvf6YDTnR3OHS0/m/989Iz2mZqzymdLz5HOFZybOZ93fvJCxoXxi4kXhzpXdD66tOTSna6wrt7LgZevXvG5cqnbvfv8VZerZ645XTt9nX297Yb9jdYeu56WX+x+aem172296XCz/ZbjrY6+BX3n+l37L972un3ljv+dGwOLBvruLr57/17cPel93v3RB6kPXj/Mejj9aP1j7OOiJwpPKp6qP6391fjXZqm99Oyg12DPs4hnj4a4Qy//lfmvT8MFz6nPK0a0RupHrUfPjPmM3Xqx9MXwy4yX0+OFvyn+tveV0auffnf7vWdiycTwa9HrmT9K3qi+OfrW9m3nZOjk03dp76anit6rvj/2gf2h+2P0x5Hp7E/4T5WfjT93fAn88ngmbWbm3/eE8/syOll+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADoklEQVRIDb2WTY9MURCG+2t8dTIkWPnYspPYETGJWdC7EaxI7Nj7J3Z+gLAYCWIlwvQIdiRigS1hPRNGZnT3bc9znOpcd3q+QlRSXXXOqfO+p+rUvbfrtdVSZ6qJ9vNSu9lsnq7X69PD4fAYegj/sGv4n/A/o2/xnw4Gg+dML+V9LezAsDweaxrMSqZsh+hao9F4gx1uRol97R73JoTfWGKOFRfMrjYxMXGcjd0KSZ9xaIGvxlhbPlRXjMwi5irSERkbZ9CFDCDoT1RbBhznV2PFmKmSyh4nGBBwnvEsallX0G1oyhq7WSkI7KGW1Tu8xN3ex4pZCObl9i1BURTP8HejksU94G5KojnE1P+JirHI3Z7p9Xpv8FuJ1QU67Tb2CPq3ZECMqiZpmw4+it7F76XLpJRXGUyhnswybkXcYxnN7BHAN7A+UmKbkOtTmQOXE+R2thFskHENsdZcdKrr82DtERC864y/ZawVLXOWtF1j0MkLbqp2Y4+5assHeZlsLsiwZlVrtVo3M245iU6Du5s2ALGjLItiGRzbUALEWwc3SZTRtS5daHcvoDtQu71DA17AV4wRqyZXg5ofc1ASwSRusvYO/YIvsa2ulMnmK2TLZHaOmFnAD2AlGj30iYvafsipR+mS9V4J3gvAKdbjPpbxI67LerozrJnF9XzPeOnuythyGfQjT5bv5AX79wmiQDpNTLx9vMM5ptcjK99buTd+rEVox01Khuz0B9IzEJnhS4axNi6zKtmfhGuVFOBXAEeW6dmE9ARzB1El5s4RG2UcRyZhXFMq6RMmRpP4ltZOc85sgjRlk6j+JFvKseU7c29Z496f+Fi8zSBh7FDVR+EkGx9iJV1G2+gEaiYduu4e/i7H6IZvKLl8LJ4SrPi82PJKeiywQfoAfz/q19yXQQfrV8UDbEQmptj+Q0hcvtriq169A8srQZR3MjdPdHY1vlzG8FOMHHC2fSiXSPWWJ0DKWTqOTD3lSTY9L4bFHXw71+wt73oyyi5zLAmo+P/lMXYKHfd5cqMabw3fIKlM2PUksHwjnSVwRQBfWyuc3s/KIupH08CyeDBjJfJTtBWyhYwtZvoAp7R52X5l4SOTF1FLZYDAUQXcRFoeO1cV8eJr7wGv9Pv9OaxYRZw0gdBF7yF9x4IvYDtQ8a7MbjNEEWvVrNbl/H8m9nqYkYxA/8ffxGCVNLKOP8L+uY0WX9dSnQ3/CEeqQah1TlLLo/zTv/q/APGU2dKb/f3qAAAAAElFTkSuQmCC);\n}\n\n.wsp-tool-cancel {\n\n    top: 0px;\n    right: 0px;\n}\n\n.wsp-tool-cancel, .wsp-tool-ok {\n    position: absolute;\n    margin-right: 10px;\n    margin-top:10px;\n    height: 28px;\n    width: 28px;\n    background-size:28px, 28px;\n    background-color: #888888;\n    border-radius: 14px;\n    border-color:#888888;\n    border-style: solid;\n    border-width: thin;\n    box-shadow: 3px 3px 7px #888888\n}\n\n.wsp-tool-background {\n    background-color:rgba(0,0,0,0.1);\n}\n\n/* Section Start: wsp-Parameter */\n/*\n  Styles for the box around editable values in the sketch\n*/\n.mfs-input {\n    background-color: white;\n    border: thin black solid;\n    padding: 2px;\n    margin: 2px;\n    vertical-align: middle;\n    min-width: .6em;\n    min-height: 1.2em;\n}\n/* Section End: wsp-Parameter */\n\n/* Section Start: wsp-Numberpad */\n\n/*\n  A numeric entry keypad or \"Numberpad\" has a header and a body. The\n  body contains rows of entries, which are either keys or blank\n  spaces.\n  \n *\n *  +-wsp-Numberpad------------------------------------------------------------------+\n *  | +-wsp-Numberpad-header-------------------------------------------------------+ |\n *  | |                                                                            | |\n *  | |                                                       wsp-Numberpad-cancel | |\n *  | |                                                           +--------------+ | |\n *  | |                                                           |              | | |\n *  | |                                                           |       X      | | |\n *  | |                                                           +--------------+ | |\n *  | +----------------------------------------------------------------------------+ |\n *  | +-wsp-Numberpad-Body---------------------------------------------------------+ |\n *  | | +wsp-Numberpad-Row-------------------------------------------------------+ | |\n *  | | | +wsp-Numberpad-key/element/key-1-----+           +-----------+         | | |\n *  | | | |          |             |           |           |           |         | | |\n *  | | | |    1     |             |      2    |           |     3     |         | | |\n *  | | | +----------+             +-----------+           +-----------+         | | |\n *  | | +------------------------------------------------------------------------+ | |\n *  | | +------------------------------------------------------------------------+ | |\n *  | | |  +----------+             +----------+           +-----------+         | | |\n *  | | |  |          |             |          |           |           |         | | |\n *  | | |  |    4     |             |     5    |           |     6     |         | | |\n *  | | |  +----------+             +----------+           +-----------+         | | |\n *  | | +------------------------------------------------------------------------+ | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | +  +----------+             +----------+           +-----------+        |  | |\n *  | | |  |          |             |          |           |           |        |  | |\n *  | | |  |    7     |             |     8    |           |     9     |        |  | |\n *  | | |  +----------+             +----------+           +-----------+        |  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | |  +----------+             +-----------+          +-----------+        |  | |\n *  | | |  |          |             |           |          |           |        |  | |\n *  | | |  |    .     |             |     0     |          |    +/-    |        |  | |\n *  | | |  +----------+             +-----------+          +-----------+        |  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | |                                                                            | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | |  +---------+                                     +-----------+        |  | |\n *  | | |  |         |                                     |           |        |  | |\n *  | | |  | clear   |                                     |delete-left|        |  | |\n *  | | |  +---------+                                     +-----------+        |  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | |                                                                            | |\n *  | |                                                                            | |\n *  | +----------------------------------------------------------------------------+ |\n *  +--------------------------------------------------------------------------------+\n *\n *\n *\n */\n\n/* The Numberpad as a whole */\n.wsp-Numberpad {\n    width: 172px;\n    height: 298px;\n    background-color: #00bdec;\n    border-radius: 9px;\n    border: thin gray solid;\n    padding: 0px 8px 8px 8px;\n}\n\n/* The Numberpad header bar. Contains the cancel button. */\n.wsp-Numberpad-header {\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMDAlJyBoZWlnaHQ9JzI1Jz48cmVjdCBmaWxsPSd3aGl0ZScgeD0nNicgeT0nNicgd2lkdGg9JzkwJScgaGVpZ2h0PScyJy8+PHJlY3QgZmlsbD0nd2hpdGUnIHg9JzYnIHk9JzEyJyB3aWR0aD0nOTAlJyBoZWlnaHQ9JzInLz48cmVjdCBmaWxsPSd3aGl0ZScgeD0nNicgeT0nMTknIHdpZHRoPSc5MCUnIGhlaWdodD0nMicvPjwvc3ZnPgo=\");\n    background-repeat: no-repeat;\n    background-color: #00bdec;\n    height: 25px;\n    margin-bottom: 8px;\n}\n\n/* The \"cancel\" button in the header, contains an \"x\" */\n.wsp-Numberpad-cancel {\n\n    background-color: #00bdec;\n    border-color: #00bdec;\n    height: 28px;\n    width: 28px;\n\n    border-style: solid;\n    border-width: thick;\n    border-radius: 16px;\n\n}\n\n/* The \"erase to left\" button */\n.wsp-Numberpad-erase-to-left {\n    /* the following is an svg image of the 'erase to left' unicode character,\n       \\u232b, base64 encoded. To see original, cut out the quoted part after\n       base64, then un-base64 encode.  */\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCnhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbC1vcGFjaXR5PSIxIiBjb2xvci1yZW5kZXJpbmc9ImF1dG8iCmNvbG9yLWludGVycG9sYXRpb249ImF1dG8iIHN0cm9rZT0iYmxhY2siIHRleHQtcmVuZGVyaW5nPSJhdXRvIgpzdHJva2UtbGluZWNhcD0ic3F1YXJlIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1vcGFjaXR5PSIxIgpzaGFwZS1yZW5kZXJpbmc9ImF1dG8iIGZpbGw9ImJsYWNrIiBzdHJva2UtZGFzaGFycmF5PSJub25lIiBzdHJva2Utd2lkdGg9IjEiCnN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1kYXNob2Zmc2V0PSIwIiBpbWFnZS1yZW5kZXJpbmc9ImF1dG8iCndpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIgdmlld0JveD0iMCAwIDI3NyAyMDAiID4KPHBhdGggZD0iTTI2MiAxODYKTDEwMSAxODYKTDE1ICAxMDAKTDEwMSAgMTMKTDI2MiAgMTMKTDI2MiAxODYKWk0yNDggMTcyIApMMjQ4ICAyNwpMMTA3ICAyNwpMMzUgIDEwMApMMTA3IDE3MgpMMjQ4IDE3MgpaTTIxNyAxMzMKTDIwNyAxNDMKTDE3NCAxMDkKTDE0MCAxNDMKTDEzMSAxMzMKTDE2NCAxMDAKTDEzMSAgNjYKTDE0MCAgNTYgCkwxNzQgIDkwCkwyMDcgIDU2CkwyMTcgIDY2CkwxODMgMTAwCkwyMTcgMTMzIFoiIHN0cm9rZT0ibm9uZSIvPgo8L3N2Zz4K\");\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: 30px;\n}\n\n/* The clear button */\n.wsp-Numberpad-clear {\n    /* the following is an svg image of the 'circled latin capital letter c'\n       unicode character, \\u2428, base64 encoded. To see original, cut out\n       the quoted part after base64, then un-base64 encode.  */\n    background-image: url(\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+Cgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4nICdodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCc+CjxzdmcgZmlsbC1vcGFjaXR5PSIxIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKY29sb3ItcmVuZGVyaW5nPSJhdXRvIiBjb2xvci1pbnRlcnBvbGF0aW9uPSJhdXRvIiBzdHJva2U9ImJsYWNrIgp0ZXh0LXJlbmRlcmluZz0iYXV0byIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIgpzdHJva2Utb3BhY2l0eT0iMSIgc2hhcGUtcmVuZGVyaW5nPSJhdXRvIiBmaWxsPSJibGFjayIgc3Ryb2tlLWRhc2hhcnJheT0ibm9uZSIKc3Ryb2tlLXdpZHRoPSIxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiCnN0cm9rZS1kYXNob2Zmc2V0PSIwIiBpbWFnZS1yZW5kZXJpbmc9ImF1dG8iIHdpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIKdmlld0JveD0iMCAxNTMgMjg3IDI4NyI+CjxwYXRoIGQ9Ik0xNDQgMTc2IApRMTc2IDE3NiAyMDQgMTkyIApRMjMyLjMxMjUgMjA4LjY4NzUgMjQ4IDIzNyAKUTI2NC42NTYyIDI2NC42NTYyIDI2NSAyOTcgClEyNjQuNjU2MiAzMjguOTIxOSAyNDggMzU3IApRMjMyLjE3MTkgMzg0Ljg5MDYgMjA0IDQwMSAKUTE3Ni4wNjI1IDQxNy4yMzQ0IDE0NCA0MTcgClExMTEuOTM3NSA0MTcuMjM0NCA4NCA0MDEgClE1NS44MjgxIDM4NC44OTA2IDQwIDM1NyAKUTIzLjM0MzggMzI4LjkyMTkgMjMgMjk3IApRMjMuMzQzOCAyNjQuNjU2MiA0MCAyMzcgClE1NS42ODc1IDIwOC41NDY5IDg0IDE5MiAKUTExMS43OTY5IDE3NiAxNDQgMTc2IApaTTE0NCAzOTkgClExODUuOTA2MiAzOTkgMjE2IDM2OSAKUTI0Ni41MTU2IDMzOC43NjU2IDI0NyAyOTcgClEyNDYuNTE1NiAyNjkuNTc4MSAyMzMgMjQ2IApRMjE4Ljk1MzEgMjIxLjkwNjIgMTk1IDIwOCAKUTE3MS4yODEyIDE5NC4zNDM4IDE0NCAxOTQgClExMDEuODEyNSAxOTQuMzQzOCA3MiAyMjUgClE0MS40ODQ0IDI1NC44MTI1IDQxIDI5NyAKUTQxLjQ4NDQgMzM4Ljc2NTYgNzEgMzY5IApRMTAyIDM5OSAxNDQgMzk5IApaTTIwMyAzMjAKUTE5Ni41OTM4IDM0Mi44NDM4IDE4MiAzNTQgClExNjcuMzQzOCAzNjUuMjAzMSAxNDcgMzY1IApRMTE0LjA0NjkgMzY1LjIwMzEgOTkgMzQ0IApRODQuMDkzOCAzMjMuNTc4MSA4NCAyOTUgClE4NC4wOTM4IDI2Mi44MjgxIDEwMiAyNDUgClExMTkuMzkwNiAyMjYuNTQ2OSAxNDcgMjI3IApRMTY2Ljc4MTIgMjI2LjU0NjkgMTgxIDIzNyAKUTE5NC42MjUgMjQ2LjUxNTYgMjAwIDI2NiAKTDE4MyAyNzAgClExNzguMzEyNSAyNTUuNzk2OSAxNjkgMjQ5IApRMTYwLjQ1MzEgMjQxLjU5MzggMTQ3IDI0MiAKUTEyNS4xNTYyIDI0MS41OTM4IDExNCAyNTYgClExMDIuNTE1NiAyNzAuMjgxMiAxMDMgMjk1IApRMTAyLjUxNTYgMzIzLjE1NjIgMTE0IDMzNyAKUTEyNi40MjE5IDM0OS44NzUgMTQ1IDM0OS44NzUgClExNjEuMDE1NiAzNDkuODc1IDE3MSAzNDEgClExODAuODQzOCAzMzIuODU5NCAxODUgMzE2IApMMjAzIDMyMCBaCiIgc3Ryb2tlPSJub25lIiAvPgo8L3N2Zz4K\");\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: 30px;\n}\n\n/* A pressable key, like a number or a control key */\n.wsp-Numberpad-key {\n    cursor: pointer;\n    background-color: #eee;\n    border: thin black solid;\n    border-radius: 8px;\n    font-family: Lucida Grande, sans-serif;\n    font-size: 20px;\n    color: black;\n    text-align: center;\n}\n\n/* A pressable key or empty space between keys */\n.wsp-Numberpad-element {\n    margin: 2px;\n    width: 47px;\n    height: 47px;\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 48px;\n}\n\n/* Each key contains its button text as an attribute. Remove or\n   override this to change how keys look. */\n.wsp-Numberpad-key:after { content: attr(data-keyText);}\n\n/* You can override the key text for any key. */\ndiv.wsp-Numberpad-key-0:after {}\ndiv.wsp-Numberpad-key-1:after {}\ndiv.wsp-Numberpad-key-2:after {}\ndiv.wsp-Numberpad-key-3:after {}\ndiv.wsp-Numberpad-key-4:after {}\ndiv.wsp-Numberpad-key-5:after {}\ndiv.wsp-Numberpad-key-6:after {}\ndiv.wsp-Numberpad-key-7:after {}\ndiv.wsp-Numberpad-key-8:after {}\ndiv.wsp-Numberpad-key-9:after {}\ndiv.wsp-Numberpad-key-dot:after {}\ndiv.wsp-Numberpad-key-minus:after {}\ndiv.wsp-Numberpad-key-del:after {}\ndiv.wsp-Numberpad-key-esc:after {}\n\n/* These keys are not present by default, but can be enabled with\njavascript (see section on Javascript customization). */\n\ndiv.wsp-Numberpad-key-plus:after {}\ndiv.wsp-Numberpad-key-star:after {}\ndiv.wsp-Numberpad-key-slash:after {}\ndiv.wsp-Numberpad-key-lparen:after {}\ndiv.wsp-Numberpad-key-rparen:after {}\ndiv.wsp-Numberpad-key-pi:after {}\ndiv.wsp-Numberpad-key-submit:after {}\n\n\n/* Style for a pressed key */\n.wsp-Numberpad-key:active,\n.wsp-Numberpad-key-down {\n    background-color: #636568;\n    border-color: transparent;\n    color: white;\n}\n\n/* One of the special control keys: delete left, clear, or \"+-\". These\n   control key elements also have the wsp-Numberpad-key class, but the\n   style rule below will override styles applied only to that class. */\ndiv.wsp-Numberpad-control-key {\n    background-color: #c5dee5;\n    border-radius: 5px;\n}\n\n/* Section End: wsp-Numberpad */\n\n/* Section Start: misc */\n/*\n  Various misc. styles\n*/\n\n/* In sketch text for error messages e.g. when the document has an unsupported version. */\n.wsp-error-message {\n  text-align: center;\n  margin-top: 25px;\n  margin-bottom: 25px;\n  color: red;\n  font-size: 125%;\n}\n\n/* Section End: misc */\n\n.wsp-Calculator {\n    width: 430px;\n    height: 370px;\n    background-color: #00bdec;\n    border-radius: 9px;\n    border: thin gray solid;\n    padding: 0px 6px 8px 8px;;\n}\n\n.wsp-Calculator-title {\n  background-color:  #ecf8ff;\n  text-align: center;\n  border-radius: 5px;\n  margin-top: 4px;\n}\n\n.wsp-Calculator-display {\n  border-radius: 4px;\n  height: 70px;\n  background-color: white;\n  margin: 7px 0;\n  overflow: auto;\n}\n\n.wsp-Calculator-display-wrapper {\n  position: relative;\n}\n\n.wsp-Calculator-body-wrapper {\n  display: inline-block;\n}\n.wsp-Calculator-body-wrapper > .wsp-Calculator-body {\n  display: inline-block;\n  margin-left: 7px;\n}\n\n.wsp-Calculator-left {\n  display: inline-block;\n  border-radius: 4px;\n  vertical-align: top;\n  width: 140px;\n  height: 205px;\n  background-color: #ecf8ff;\n  margin-top: 5px;\n}\n\n.wsp-Calculator-label-insert {\n  width: 50%;\n  text-align: center;\n  margin: 35px auto 10px auto;\n}\n\n.wsp-Calculator-textual {\n  font-family: Lucida Grande,sans-serif;\n  font-size: 16px;\n}\n\n.wsp-Calculator .dropdown-toggle {\n  width: 110px;\n  white-space: nowrap;\n}\n\n.wsp-Calculator-left .dropdown-toggle {\n  height: 24px;\n}\n\n.wsp-Calculator .dropdown {\n  display: inline-block;\n}\n\n.wsp-Calculator .wsp-select-function ul {\n    top: -220px;\n    left: 110px;\n}\n\n.wsp-Calculator .wsp-select-units ul {\n    top: -70px;\n    left: 110px;\n}\n\n.wsp-Calculator-select-equation ul {\n    top: -170px;\n    left: 135px;\n}\n\n.wsp-Calculator-topmost-select-for-insert,\n.wsp-Calculator-select-for-insert {\n  margin-top: 10px;\n}\n\n.wsp-Calculator .wsp-Calculator-left .dropdown {\n  margin-left: 15px;\n  margin-right: 15px;\n}\n\n.wsp-Calculator .wsp-Calculator-select-for-insert > button,\n.wsp-Calculator .wsp-Calculator-topmost-select-for-insert > button {\n  box-sizing: border-box;\n}\n\n\n.wsp-Calculator-body {\n  display: inline-block;\n}\n\n.wsp-Calculator-bottom {\n  margin-top: 15px;\n}\n\n.wsp-Calculator-select-equation {\n  margin-left: 40px;\n}\n\n.wsp-Calculator-bottom-button {\n  margin-left: 30px;\n  border-radius: 5px;\n  padding: 2px 10px 3px;\n}\n \n.wsp-Calculator-ok-button-inner {\n  padding: 0 10px;\n}\n \n\n.wsp-Calculator .dropdown a {\n  cursor: pointer;\n}\n\n.wsp-Calculator .selected a {\n  background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+Cjxzdmcgd2lkdGg9IjE5LjIxMzE1IiBoZWlnaHQ9IjE4LjI5NDk5NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KIDxtZXRhZGF0YSBpZD0ibWV0YWRhdGE3Ij5pbWFnZS9zdmcreG1sPC9tZXRhZGF0YT4KCiA8Zz4KICA8dGl0bGU+TGF5ZXIgMTwvdGl0bGU+CiAgPGcgaWQ9ImxheWVyMSI+CiAgIDxwYXRoIGQ9Im00Ljc3NDY5LDE4LjI5NDk3OWMtMC4yNzUwMSwtMC4wMDM1NCAtMS40NjE4MSwtMS43Nzg0MzkgLTIuNjM3MzQsLTMuOTQ0MTQ5bC0yLjEzNzM0LC0zLjkzNzgxbDAuNTU0MDIsLTAuNTUzOTZjMC4zMDQ2OSwtMC4zMDQ3NSAxLjEyMzY3LC0wLjU1NDAyIDEuODE5OTUsLTAuNTU0MDJsMS4yNjU5NSwwbDAuNjM2MzgsMi4wMDUwN2wwLjYzNjM4LDIuMDA1MDdsNS4wNjQ0OCwtNS41NDEzMmMyLjc4NTQ1LC0zLjA0NzczIDYuMDAzMDcsLTYuMDQzNjQgNy4xNTAyNDEsLTYuNjU3NTlsMi4wODU3NDksLTEuMTE2MjdsLTQuMjA5NDM5LDQuNzgyMTdjLTIuMzE1MiwyLjYzMDI1IC01LjQ1MTM1LDYuNzQ4MDUgLTYuOTY5MjQsOS4xNTA3NmMtMS41MTc4OCwyLjQwMjcxIC0yLjk4NDc5LDQuMzY1NjYgLTMuMjU5NzgsNC4zNjIwNjFsLTAuMDAwMDEsLTAuMDAwMDExeiIgaWQ9InBhdGgyMjIzIiBmaWxsPSIjMDAwMDAwIi8+CiAgPC9nPgogPC9nPgo8L3N2Zz4=);\n  background-repeat: no-repeat;\n  background-position: left;\n  background-size: 16px 16px;\n}\n\n.wsp-Calculator .mathquill-rendered-math sup {\n    margin-top: 0.5em;\n}\n\n.wsp-Calculator .mathquill-rendered-math sup {\n    margin-top: 0.5em;\n}\n\n.wsp-Calculator .mathquill-editable.hasCursor {\n  box-shadow: none;\n}\n\n.wsp-Calculator .wsp-calculator-editor {\n  padding: 5px;\n}\n\n.wsp-Calculator .wsp-calculator-editor *[wsp-non-function-ref],\n.wsp-Calculator .wsp-calculator-editor *[wsp-function-ref] {\n  background-color: #eee;\n}\n\n.wsp-Calculator .mathquill-rendered-math .numerator {\n  padding: 0.1em 0.1em;\n}\n\n/* override  bootstrap within a calculator */\n.wsp-Calculator *, .wsp-Calculator *:before, .wsp-Calculator *:after {\n-webkit-box-sizing: content-box;\n-moz-box-sizing: content-box;\nbox-sizing: content-box;\n}\n\n.wsp-Calculator .wsp-hide > .paren {\n  display: none;\n }\n\n.wsp-Calculator .wsp-independent-variable {\n  font-style: italic;\n}\n\n.wsp-Calculator .wsp-syntax-error-notice {\n  display: none;\n}\n\n.wsp-Calculator .wsp-syntax-error-notice:after {\n  content: '!';\n}\n\n.wsp-Calculator.wsp-syntax-error .wsp-syntax-error-notice {\n  color: red;\n  background-color: #f8f8f8;\n  font-size: 24px;\n  display: inline;\n  padding: 4px;\n  position: absolute;\n  right: 6px;\n  border: 2px solid red;\n  top: 10px;\n}\n\n.wsp-Calculator .mathquill-editable .hasCursor {\n  -webkit-box-shadow: inset #68b4df 0 0 2px 1px;\n  -moz-box-shadow: inset #68b4df 0 0 2px 1px;\n  box-shadow: inset #68b4df 0 0 2px 1px;\n}\n\n\n/*\n * MathQuill: http://mathquill.com\n * by Jay and Han (laughinghan@gmail.com)\n *\n * This Source Code Form is subject to the terms of the\n * Mozilla Public License, v. 2.0. If a copy of the MPL\n * was not distributed with this file, You can obtain\n * one at http://mozilla.org/MPL/2.0/.\n */\n.mathquill-editable {\n  display: -moz-inline-box;\n  display: inline-block;\n  white-space: pre-wrap;\n}\n.mathquill-editable .cursor {\n  border-left: 1px solid black;\n  margin-right: -1px;\n  position: relative;\n  z-index: 1;\n  padding: 0;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mathquill-editable .cursor.blink {\n  visibility: hidden;\n}\n.mathquill-editable,\n.mathquill-embedded-latex .mathquill-editable {\n  border: 1px solid gray;\n  padding: 2px;\n}\n.mathquill-embedded-latex .mathquill-editable {\n  margin: 1px;\n}\n.mathquill-editable.hasCursor,\n.mathquill-editable .hasCursor {\n  -webkit-box-shadow: #68b4df 0 0 3px 2px;\n  -moz-box-shadow: #68b4df 0 0 3px 2px;\n  box-shadow: #68b4df 0 0 3px 2px;\n}\n.mathquill-editable .latex-command-input {\n  color: inherit;\n  font-family: \"Courier New\", monospace;\n  border: 1px solid gray;\n  padding-right: 1px;\n  margin-right: 1px;\n  margin-left: 2px;\n}\n.mathquill-editable .latex-command-input.empty {\n  background: transparent;\n}\n.mathquill-editable .latex-command-input.hasCursor {\n  border-color: ActiveBorder;\n}\n.mathquill-editable.empty:after,\n.mathquill-textbox:after,\n.mathquill-rendered-math .empty:after {\n  visibility: hidden;\n  content: 'c';\n}\n.mathquill-editable .cursor:only-child:after,\n.mathquill-editable .textarea + .cursor:last-child:after {\n  visibility: hidden;\n  content: 'c';\n}\n.mathquill-textbox {\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n.mathquill-rendered-math {\n  font-variant: normal;\n  font-weight: normal;\n  font-style: normal;\n  font-size: 115%;\n  line-height: 1;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mathquill-rendered-math .non-leaf,\n.mathquill-rendered-math .scaled {\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mathquill-rendered-math var,\n.mathquill-rendered-math .text,\n.mathquill-rendered-math .nonSymbola {\n  font-family: \"Times New Roman\", Symbola, serif;\n  line-height: .9;\n}\n.mathquill-rendered-math * {\n  font-size: inherit;\n  line-height: inherit;\n  margin: 0;\n  padding: 0;\n  border-color: black;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\n.mathquill-rendered-math .empty {\n  background: #ccc;\n}\n.mathquill-rendered-math.empty {\n  background: transparent;\n}\n.mathquill-rendered-math .text {\n  font-size: 87%;\n}\n.mathquill-rendered-math .font {\n  font: 1em \"Times New Roman\", Symbola, serif;\n}\n.mathquill-rendered-math .font * {\n  font-family: inherit;\n  font-style: inherit;\n}\n.mathquill-rendered-math b,\n.mathquill-rendered-math b.font {\n  font-weight: bolder;\n}\n.mathquill-rendered-math var,\n.mathquill-rendered-math i,\n.mathquill-rendered-math i.font {\n  font-style: italic;\n}\n.mathquill-rendered-math var.florin {\n  margin: 0 -0.1em;\n}\n.mathquill-rendered-math big {\n  font-size: 125%;\n}\n.mathquill-rendered-math .roman {\n  font-style: normal;\n}\n.mathquill-rendered-math .sans-serif {\n  font-family: sans-serif, Symbola, serif;\n}\n.mathquill-rendered-math .monospace {\n  font-family: monospace, Symbola, serif;\n}\n.mathquill-rendered-math .overline {\n  border-top: 1px solid black;\n  margin-top: 1px;\n}\n.mathquill-rendered-math .underline {\n  border-bottom: 1px solid black;\n  margin-bottom: 1px;\n}\n.mathquill-rendered-math .binary-operator {\n  padding: 0 0.2em;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mathquill-rendered-math .unary-operator {\n  padding-left: 0.2em;\n}\n.mathquill-rendered-math sup,\n.mathquill-rendered-math sub {\n  position: relative;\n  font-size: 90%;\n}\n.mathquill-rendered-math sup .binary-operator,\n.mathquill-rendered-math sub .binary-operator {\n  padding: 0 .1em;\n}\n.mathquill-rendered-math sup .unary-operator,\n.mathquill-rendered-math sub .unary-operator {\n  padding-left: .1em;\n}\n.mathquill-rendered-math sup.limit,\n.mathquill-rendered-math sub.limit,\n.mathquill-rendered-math sup.nthroot,\n.mathquill-rendered-math sub.nthroot {\n  font-size: 80%;\n}\n.mathquill-rendered-math sup .fraction,\n.mathquill-rendered-math sub .fraction {\n  font-size: 70%;\n  vertical-align: -0.4em;\n}\n.mathquill-rendered-math sup .numerator,\n.mathquill-rendered-math sub .numerator {\n  padding-bottom: 0;\n}\n.mathquill-rendered-math sup .denominator,\n.mathquill-rendered-math sub .denominator {\n  padding-top: 0;\n}\n.mathquill-rendered-math sup {\n  vertical-align: .5em;\n}\n.mathquill-rendered-math sup.limit,\n.mathquill-rendered-math sup.nthroot {\n  vertical-align: 0.8em;\n}\n.mathquill-rendered-math sup.nthroot {\n  margin-right: -0.6em;\n  margin-left: .2em;\n  min-width: .5em;\n}\n.mathquill-rendered-math sub {\n  vertical-align: -0.4em;\n}\n.mathquill-rendered-math sub.limit {\n  vertical-align: -0.6em;\n}\n.mathquill-rendered-math .paren {\n  padding: 0 .1em;\n  vertical-align: bottom;\n  -webkit-transform-origin: bottom center;\n  -moz-transform-origin: bottom center;\n  -ms-transform-origin: bottom center;\n  -o-transform-origin: bottom center;\n  transform-origin: bottom center;\n}\n.mathquill-rendered-math .array {\n  vertical-align: middle;\n  text-align: center;\n}\n.mathquill-rendered-math .array > span {\n  display: block;\n}\n.mathquill-rendered-math .non-italicized-function {\n  font-family: Symbola, \"Times New Roman\", serif;\n  line-height: .9;\n  font-style: normal;\n  padding-right: .2em;\n}\n.mathquill-rendered-math .fraction {\n  font-size: 90%;\n  text-align: center;\n  vertical-align: -0.5em;\n  padding: 0 .2em;\n}\n.mathquill-rendered-math .fraction,\n.mathquill-rendered-math x:-moz-any-link {\n  display: -moz-groupbox;\n}\n.mathquill-rendered-math .fraction,\n.mathquill-rendered-math x:-moz-any-link,\n.mathquill-rendered-math x:default {\n  display: inline-block;\n}\n.mathquill-rendered-math .numerator,\n.mathquill-rendered-math .denominator {\n  display: block;\n}\n.mathquill-rendered-math .numerator {\n  padding: 0 0.1em;\n  margin-bottom: -0.1em;\n}\n.mathquill-rendered-math .denominator {\n  border-top: 1px solid;\n  float: right;\n  width: 100%;\n  padding: .1em .1em 0 .1em;\n  margin-right: -0.1em;\n  margin-left: -0.1em;\n}\n.mathquill-rendered-math .sqrt-prefix {\n  padding-top: 0;\n  position: relative;\n  top: .1em;\n  vertical-align: top;\n  -webkit-transform-origin: top;\n  -moz-transform-origin: top;\n  -ms-transform-origin: top;\n  -o-transform-origin: top;\n  transform-origin: top;\n}\n.mathquill-rendered-math .sqrt-stem {\n  border-top: 1px solid;\n  margin-top: 1px;\n  padding-left: .15em;\n  padding-right: .2em;\n  margin-right: .1em;\n}\n.mathquill-rendered-math .vector-prefix {\n  display: block;\n  text-align: center;\n  line-height: .25em;\n  margin-bottom: -0.1em;\n  font-size: 0.75em;\n}\n.mathquill-rendered-math .vector-stem {\n  display: block;\n}\n.mathquill-rendered-math,\n.mathquill-rendered-math .mathquill-editable {\n  cursor: text;\n  font-family: Symbola, \"Times New Roman\", serif;\n}\n.mathquill-rendered-math .selection,\n.mathquill-editable .selection,\n.mathquill-rendered-math .selection .non-leaf,\n.mathquill-editable .selection .non-leaf,\n.mathquill-rendered-math .selection .scaled,\n.mathquill-editable .selection .scaled {\n  background: #B4D5FE !important;\n  background: Highlight !important;\n  color: HighlightText;\n  border-color: HighlightText;\n}\n.mathquill-rendered-math .selection .matrixed,\n.mathquill-editable .selection .matrixed {\n  background: #39F !important;\n}\n.mathquill-rendered-math .selection .matrixed-container,\n.mathquill-editable .selection .matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color='#3399FF') !important;\n}\n.mathquill-rendered-math .selection.blur,\n.mathquill-editable .selection.blur,\n.mathquill-rendered-math .selection.blur .non-leaf,\n.mathquill-editable .selection.blur .non-leaf,\n.mathquill-rendered-math .selection.blur .scaled,\n.mathquill-editable .selection.blur .scaled,\n.mathquill-rendered-math .selection.blur .matrixed,\n.mathquill-editable .selection.blur .matrixed {\n  background: #D4D4D4 !important;\n  color: black;\n  border-color: black;\n}\n.mathquill-rendered-math .selection.blur .matrixed-container,\n.mathquill-editable .selection.blur .matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color='#D4D4D4') !important;\n}\n.mathquill-editable .textarea,\n.mathquill-rendered-math .textarea {\n  position: relative;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n.mathquill-editable .textarea textarea,\n.mathquill-rendered-math .textarea textarea,\n.mathquill-editable .selectable,\n.mathquill-rendered-math .selectable {\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n  position: absolute;\n  clip: rect(1em 1em 1em 1em);\n}\n.mathquill-rendered-math .matrixed {\n  background: white;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mathquill-rendered-math .matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color='white');\n  margin-top: -0.1em;\n}\n\n/* Import only the bits of bootstrap needed for our components. Code\nis not generated as css output unless actually referenced. */\n/* Components we adopt from bootstrap. */\n.caret {\n  display: inline-block;\n  width: 0;\n  height: 0;\n  margin-left: 2px;\n  vertical-align: middle;\n  border-top: 4px solid;\n  border-right: 4px solid transparent;\n  border-left: 4px solid transparent;\n}\n.dropdown {\n  position: relative;\n}\n.dropdown-toggle:focus {\n  outline: 0;\n}\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  z-index: 1000;\n  display: none;\n  float: left;\n  min-width: 160px;\n  padding: 5px 0;\n  margin: 2px 0 0;\n  list-style: none;\n  font-size: 14px;\n  text-align: left;\n  background-color: #ffffff;\n  border: 1px solid #cccccc;\n  border: 1px solid rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n  background-clip: padding-box;\n}\n.dropdown-menu.pull-right {\n  right: 0;\n  left: auto;\n}\n.dropdown-menu .divider {\n  height: 1px;\n  margin: 9px 0;\n  overflow: hidden;\n  background-color: #e5e5e5;\n}\n.dropdown-menu > li > a {\n  display: block;\n  padding: 3px 20px;\n  clear: both;\n  font-weight: normal;\n  line-height: 1.42857143;\n  color: #333333;\n  white-space: nowrap;\n}\n.dropdown-menu > li > a:hover,\n.dropdown-menu > li > a:focus {\n  text-decoration: none;\n  color: #262626;\n  background-color: #f5f5f5;\n}\n.dropdown-menu > .active > a,\n.dropdown-menu > .active > a:hover,\n.dropdown-menu > .active > a:focus {\n  color: #ffffff;\n  text-decoration: none;\n  outline: 0;\n  background-color: #337ab7;\n}\n.dropdown-menu > .disabled > a,\n.dropdown-menu > .disabled > a:hover,\n.dropdown-menu > .disabled > a:focus {\n  color: #777777;\n}\n.dropdown-menu > .disabled > a:hover,\n.dropdown-menu > .disabled > a:focus {\n  text-decoration: none;\n  background-color: transparent;\n  background-image: none;\n  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);\n  cursor: not-allowed;\n}\n.open > .dropdown-menu {\n  display: block;\n}\n.open > a {\n  outline: 0;\n}\n.dropdown-menu-right {\n  left: auto;\n  right: 0;\n}\n.dropdown-menu-left {\n  left: 0;\n  right: auto;\n}\n.dropdown-header {\n  display: block;\n  padding: 3px 20px;\n  font-size: 12px;\n  line-height: 1.42857143;\n  color: #777777;\n  white-space: nowrap;\n}\n.dropdown-backdrop {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  z-index: 990;\n}\n.pull-right > .dropdown-menu {\n  right: 0;\n  left: auto;\n}\n.dropup .caret,\n.navbar-fixed-bottom .dropdown .caret {\n  border-top: 0;\n  border-bottom: 4px solid;\n  content: \"\";\n}\n.dropup .dropdown-menu,\n.navbar-fixed-bottom .dropdown .dropdown-menu {\n  top: auto;\n  bottom: 100%;\n  margin-bottom: 2px;\n}\n@media (min-width: 768px) {\n  .navbar-right .dropdown-menu {\n    left: auto;\n    right: 0;\n  }\n  .navbar-right .dropdown-menu-left {\n    left: 0;\n    right: auto;\n  }\n}\n";y.noConflict=function(){if(l.GSP===y){l.GSP=C}return y};g(function(){var D="wsp-css-4-0-0";if(g("style#"+D).length===0){g("head").append(g("<style>").attr({id:D}).text(y.css))}});if(typeof l.GSPConfig==="undefined"){l.GSPConfig={}}if(typeof l.GSPConfig.instances==="undefined"){l.GSPConfig.instances=[]}l.GSPConfig.instances.push(y);l.GSP=y})(window,jQuery);