(function(){var a=window.jQuery,y,aH="mathquill-command-id",az="mathquill-block-id",aJ=Math.min,s=Math.max;function at(){}var n=[].slice;function ab(P){var L=P.length-1;return function(){var R=n.call(arguments,0,L);var aQ=n.call(arguments,L);return P.apply(this,R.concat([aQ]))}}var U=ab(function(P,L){return ab(function(aQ,R){if(P in aQ){return aQ[P].apply(aQ,L.concat(R))}})});function aA(L){return ab(function(aQ,R){if(typeof aQ!=="function"){aQ=U(aQ)}var P=function(aR){return aQ.apply(aR,[aR].concat(R))};return L.call(this,P)})}function aG(L){var P=n.call(arguments,1);return function(){return L.apply(this,P)}}function aN(P,L){if(!L){throw new Error("prayer failed: "+P)}}var ac=(function(R,aQ,aU){function L(P){return typeof P==="object"}function aT(P){return typeof P==="function"}function aS(){}return function aR(aZ,aV){if(aV===aU){aV=aZ;aZ=Object}function a0(){var a1=new P;if(aT(a1.init)){a1.init.apply(a1,arguments)}return a1}function P(){}a0.Bare=P;var aY=aS[R]=aZ[R];var aX=P[R]=a0[R]=a0.p=new aS;var aW;aX.constructor=a0;a0.mixin=function(a1){P[R]=a0[R]=aR(a0,a1)[R];return a0};return(a0.open=function(a2){aW={};if(aT(a2)){aW=a2.call(a0,aX,aY,a0,aZ)}else{if(L(a2)){aW=a2}}if(L(aW)){for(var a1 in aW){if(aQ.call(aW,a1)){aX[a1]=aW[a1]}}}if(!aT(aX.init)){aX.init=aZ}return a0})(aV)}})("prototype",({}).hasOwnProperty);var ae=A.L=-1;var aa=A.R=1;function ai(L){aN("a direction was passed",L===ae||L===aa)}var ax=ac(a,function(L){L.insDirOf=function(P,R){return P===ae?this.insertBefore(R.first()):this.insertAfter(R.last())};L.insAtDirEnd=function(P,R){return P===ae?this.prependTo(R):this.appendTo(R)}});var e=ac(function(L){L.parent=0;L[ae]=0;L[aa]=0;L.init=function(R,P,aQ){this.parent=R;this[ae]=P;this[aa]=aQ};this.copy=function(P){return e(P.parent,P[ae],P[aa])}});var av=ac(function(L){L[ae]=0;L[aa]=0;L.parent=0;var R=0;function P(){return R+=1}this.byId={};L.init=function(){this.id=P();av.byId[this.id]=this;this.ends={};this.ends[ae]=0;this.ends[aa]=0};L.dispose=function(){delete av.byId[this.id]};L.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"};L.jQ=ax();L.jQadd=function(aQ){return this.jQ=this.jQ.add(aQ)};L.jQize=function(aS){var aS=ax(aS||this.html());function aR(aV){if(aV.getAttribute){var aT=aV.getAttribute("mathquill-command-id");var aU=aV.getAttribute("mathquill-block-id");if(aT){av.byId[aT].jQadd(aV)}if(aU){av.byId[aU].jQadd(aV)}}for(aV=aV.firstChild;aV;aV=aV.nextSibling){aR(aV)}}for(var aQ=0;aQ<aS.length;aQ+=1){aR(aS[aQ])}return aS};L.createDir=function(aQ,aS){ai(aQ);var aR=this;aR.jQize();aR.jQ.insDirOf(aQ,aS.jQ);aS[aQ]=aR.adopt(aS.parent,aS[ae],aS[aa]);return aR};L.createLeftOf=function(aQ){return this.createDir(ae,aQ)};L.selectChildren=function(aQ,aR){return aM(aQ,aR)};L.bubble=aA(function(aR){for(var aS=this;aS;aS=aS.parent){var aQ=aR(aS);if(aQ===false){break}}return this});L.postOrder=aA(function(aQ){(function aR(aS){aS.eachChild(aR);aQ(aS)})(this);return this});L.isEmpty=function(){return this.ends[ae]===0&&this.ends[aa]===0};L.children=function(){return x(this.ends[ae],this.ends[aa])};L.eachChild=function(){var aQ=this.children();aQ.each.apply(aQ,arguments);return this};L.foldChildren=function(aQ,aR){return this.children().fold(aQ,aR)};L.withDirAdopt=function(aR,aS,aQ,aT){x(this,this).withDirAdopt(aR,aS,aQ,aT);return this};L.adopt=function(aR,aQ,aS){x(this,this).adopt(aR,aQ,aS);return this};L.disown=function(){x(this,this).disown();return this};L.remove=function(){this.jQ.remove();this.postOrder("dispose");return this.disown()}});function V(P,L,R){aN("a parent is always present",P);aN("leftward is properly set up",(function(){if(!L){return P.ends[ae]===R}return L[aa]===R&&L.parent===P})());aN("rightward is properly set up",(function(){if(!R){return P.ends[aa]===L}return R[ae]===L&&R.parent===P})())}var x=ac(function(L){L.init=function(P,aQ,R){if(R===y){R=ae}ai(R);aN("no half-empty fragments",!P===!aQ);this.ends={};if(!P){return}aN("withDir is passed to Fragment",P instanceof av);aN("oppDir is passed to Fragment",aQ instanceof av);aN("withDir and oppDir have the same parent",P.parent===aQ.parent);this.ends[R]=P;this.ends[-R]=aQ;this.jQ=this.fold(this.jQ,function(aS,aR){return aS.add(aR.jQ)})};L.jQ=ax();L.withDirAdopt=function(R,aQ,P,aR){return(R===ae?this.adopt(aQ,P,aR):this.adopt(aQ,aR,P))};L.adopt=function(aQ,R,aS){V(aQ,R,aS);var P=this;P.disowned=false;var aR=P.ends[ae];if(!aR){return this}var aT=P.ends[aa];if(R){}else{aQ.ends[ae]=aR}if(aS){aS[ae]=aT}else{aQ.ends[aa]=aT}P.ends[aa][aa]=aS;P.each(function(aU){aU[ae]=R;aU.parent=aQ;if(R){R[aa]=aU}R=aU});return P};L.disown=function(){var P=this;var aQ=P.ends[ae];if(!aQ||P.disowned){return P}P.disowned=true;var aR=P.ends[aa];var R=aQ.parent;V(R,aQ[ae],aQ);V(R,aR,aR[aa]);if(aQ[ae]){aQ[ae][aa]=aR[aa]}else{R.ends[ae]=aR[aa]}if(aR[aa]){aR[aa][ae]=aQ[ae]}else{R.ends[aa]=aQ[ae]}return P};L.remove=function(){this.jQ.remove();this.each("postOrder","dispose");return this.disown()};L.each=aA(function(R){var aQ=this;var aR=aQ.ends[ae];if(!aR){return aQ}for(;aR!==aQ.ends[aa][aa];aR=aR[aa]){var P=R(aR);if(P===false){break}}return aQ});L.fold=function(P,R){this.each(function(aQ){P=R.call(this,P,aQ)});return P}});var ar={},aE={};var w=ac(e,function(L){L.init=function(R,P){this.parent=R;this.options=P;var aQ=this.jQ=this._jQ=ax('<span class="mq-cursor">&#8203;</span>');this.blink=function(){aQ.toggleClass("mq-blink")};this.upDownCache={}};L.show=function(){this.jQ=this._jQ.removeClass("mq-blink");if("intervalId" in this){clearInterval(this.intervalId)}else{if(this[aa]){if(this.selection&&this.selection.ends[ae][ae]===this[ae]){this.jQ.insertBefore(this.selection.jQ)}else{this.jQ.insertBefore(this[aa].jQ.first())}}else{this.jQ.appendTo(this.parent.jQ)}this.parent.focus()}this.intervalId=setInterval(this.blink,500);return this};L.hide=function(){if("intervalId" in this){clearInterval(this.intervalId)}delete this.intervalId;this.jQ.detach();this.jQ=ax();return this};L.withDirInsertAt=function(R,aQ,P,aR){if(aQ!==this.parent&&this.parent.blur){this.parent.blur()}this.parent=aQ;this[R]=P;this[-R]=aR};L.insDirOf=function(P,R){ai(P);this.withDirInsertAt(P,R.parent,R[P],R);this.parent.jQ.addClass("mq-hasCursor");this.jQ.insDirOf(P,R.jQ);return this};L.insLeftOf=function(P){return this.insDirOf(ae,P)};L.insRightOf=function(P){return this.insDirOf(aa,P)};L.insAtDirEnd=function(P,R){ai(P);this.withDirInsertAt(P,R,0,R.ends[P]);this.jQ.insAtDirEnd(P,R.jQ);R.focus();return this};L.insAtLeftEnd=function(P){return this.insAtDirEnd(ae,P)};L.insAtRightEnd=function(P){return this.insAtDirEnd(aa,P)};L.jumpUpDown=function(aS,aR){var P=this;P.upDownCache[aS.id]=e.copy(P);var aQ=P.upDownCache[aR.id];if(aQ){aQ[aa]?P.insLeftOf(aQ[aa]):P.insAtRightEnd(aQ.parent)}else{var R=P.offset().left;aR.seek(R,P)}};L.offset=function(){var P=this,R=P.jQ.removeClass("mq-cursor").offset();P.jQ.addClass("mq-cursor");return R};L.unwrapGramp=function(){var aQ=this.parent.parent;var P=aQ.parent;var aR=aQ[aa];var aS=this;var R=aQ[ae];aQ.disown().eachChild(function(aT){if(aT.isEmpty()){return}aT.children().adopt(P,R,aR).each(function(aU){aU.jQ.insertBefore(aQ.jQ.first())});R=aT.ends[aa]});if(!this[aa]){if(this[ae]){this[aa]=this[ae][aa]}else{while(!this[aa]){this.parent=this.parent[aa];if(this.parent){this[aa]=this.parent.ends[ae]}else{this[aa]=aQ[aa];this.parent=P;break}}}}if(this[aa]){this.insLeftOf(this[aa])}else{this.insAtRightEnd(P)}aQ.jQ.remove();if(aQ[ae].siblingDeleted){aQ[ae].siblingDeleted(aS.options,aa)}if(aQ[aa].siblingDeleted){aQ[aa].siblingDeleted(aS.options,ae)}};L.startSelection=function(){var P=this.anticursor=e.copy(this);var aQ=P.ancestors={};for(var R=P;R.parent;R=R.parent){aQ[R.parent.id]=R}};L.endSelection=function(){delete this.anticursor};L.select=function(){var R=this.anticursor;if(this[ae]===R[ae]&&this.parent===R.parent){return false}for(var aR=this;aR.parent;aR=aR.parent){if(aR.parent.id in R.ancestors){var aV=aR.parent;break}}aN("cursor and anticursor in the same tree",aV);var P=R.ancestors[aV.id];var aS,aU,aQ=aa;if(aR[ae]!==P){for(var aT=aR;aT;aT=aT[aa]){if(aT[aa]===P[aa]){aQ=ae;aS=aR;aU=P;break}}}if(aQ===aa){aS=P;aU=aR}if(aS instanceof e){aS=aS[aa]}if(aU instanceof e){aU=aU[ae]}this.hide().selection=aV.selectChildren(aS,aU);this.insDirOf(aQ,this.selection.ends[aQ]);this.selectionChanged();return true};L.clearSelection=function(){if(this.selection){this.selection.clear();delete this.selection;this.selectionChanged()}return this};L.deleteSelection=function(){if(!this.selection){return}this[ae]=this.selection.ends[ae][ae];this[aa]=this.selection.ends[aa][aa];this.selection.remove();this.selectionChanged();delete this.selection};L.replaceSelection=function(){var P=this.selection;if(P){this[ae]=P.ends[ae][ae];this[aa]=P.ends[aa][aa];delete this.selection}return P}});var aM=ac(x,function(P,L){P.init=function(){L.init.apply(this,arguments);this.jQ=this.jQ.wrapAll('<span class="mq-selection"></span>').parent()};P.adopt=function(){this.jQ.replaceWith(this.jQ=this.jQ.children());return L.adopt.apply(this,arguments)};P.clear=function(){this.jQ.replaceWith(this.jQ[0].childNodes);return this};P.join=function(R){return this.fold("",function(aQ,aR){return aQ+aR[R]()})}});var I=ac(function(L){L.init=function(aR,aQ,R){this.API=aR;this.root=aQ;this.container=R;aR.__controller=aQ.controller=this;this.cursor=aQ.cursor=w(aQ,aR.__options)};L.handle=function(aR,aQ){var R=this.API.__options.handlers;if(R&&R[aR]){if(aQ===ae||aQ===aa){R[aR](aQ,this.API)}else{R[aR](this.API)}}};var P=[];this.onNotify=function(R){P.push(R)};L.notify=function(){for(var R=0;R<P.length;R+=1){P[R].apply(this.cursor,arguments)}return this}});function A(P){if(!P||!P.nodeType){return null}var L=ax(P).children(".mq-root-block").attr(az);return L?av.byId[L].controller.API:null}A.noConflict=function(){window.MathQuill=Q;return A};var Q=window.MathQuill;window.MathQuill=A;function K(P){function L(aQ,aR){var R=A(aQ);if(R instanceof P||!aQ||!aQ.nodeType){return R}return P(ax(aQ),aR)}L.prototype=P.prototype;return L}var C=ac(),aL={};A.__options=C.p;var ao=ac(function(L){L.init=function(){throw"wtf don't call me, I'm 'abstract'"};L.initRoot=function(R,aQ,aS){this.__options=C();this.config(aS);var P=I(this,R,aQ);P.createTextarea();var aR=aQ.contents().detach();R.jQ=ax('<span class="mq-root-block"/>').attr(az,R.id).appendTo(aQ);this.latex(aR.text());this.revert=function(){return aQ.empty().unbind(".mathquill").removeClass("mq-editable-field mq-math-mode mq-text-mode").append(aR)}};L.config=A.config=function(aR){for(var R in aR){if(aR.hasOwnProperty(R)){var P=aR[R],aQ=aL[R];this.__options[R]=(aQ?aQ(P):P)}}return this};L.el=function(){return this.__controller.container[0]};L.text=function(){return this.__controller.exportText()};L.latex=function(P){if(arguments.length>0){this.__controller.renderLatexMath(P);if(this.__controller.blurred){this.__controller.cursor.hide().parent.blur()}return this}return this.__controller.exportLatex()};L.html=function(){return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i,"").replace(/ mq-hasCursor|mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")};L.reflow=function(){this.__controller.root.postOrder("reflow");return this}});A.prototype=ao.prototype;A.StaticMath=K(ac(ao,function(P,L){P.init=function(R){this.initRoot(m(),R.addClass("mq-math-mode"));this.__controller.delegateMouseEvents();this.__controller.staticMathTextareaEvents()};P.latex=function(){var R=L.latex.apply(this,arguments);if(arguments.length>0){this.__controller.root.postOrder("registerInnerField",this.innerFields=[])}return R}}));var u=A.EditableField=ac(ao,function(L){L.initRootAndEvents=function(P,R,aQ){this.initRoot(P,R,aQ);this.__controller.editable=true;this.__controller.delegateMouseEvents();this.__controller.editablesTextareaEvents()};L.focus=function(){this.__controller.textarea.focus();return this};L.blur=function(){this.__controller.textarea.blur();return this};L.write=function(P){this.__controller.writeLatex(P);if(this.__controller.blurred){this.__controller.cursor.hide().parent.blur()}return this};L.cmd=function(aQ){var R=this.__controller.notify(),aR=R.cursor.show();if(/^\\[a-z]+$/i.test(aQ)){aQ=aQ.slice(1);var P=ar[aQ];if(P){aQ=P(aQ);if(aR.selection){aQ.replaces(aR.replaceSelection())}aQ.createLeftOf(aR)}else{}}else{aR.parent.write(aR,aQ,aR.replaceSelection())}if(R.blurred){aR.hide().parent.blur()}return this};L.select=function(){var P=this.__controller;P.notify("move").cursor.insAtRightEnd(P.root);while(P.cursor[ae]){P.selectLeft()}return this};L.clearSelection=function(){this.__controller.cursor.clearSelection();return this};L.moveToDirEnd=function(P){this.__controller.notify("move").cursor.insAtDirEnd(P,this.__controller.root);return this};L.moveToLeftEnd=function(){return this.moveToDirEnd(ae)};L.moveToRightEnd=function(){return this.moveToDirEnd(aa)};L.keystroke=function(R){var R=R.replace(/^\s+|\s+$/g,"").split(/\s+/);for(var P=0;P<R.length;P+=1){this.__controller.keystroke(R[P],{preventDefault:at})}return this};L.typedText=function(R){for(var P=0;P<R.length;P+=1){this.__controller.typedText(R.charAt(P))}return this}});function aK(L){var R="moveOutOf deleteOutOf selectOutOf upOutOf downOutOf reflow".split(" ");for(var P=0;P<R.length;P+=1){(function(aQ){L[aQ]=function(aR){this.controller.handle(aQ,aR)}}(R[P]))}}var Z=ac(function(a2,L,aS){function aT(a5,a4){if(a5){a5="'"+a5+"'"}else{a5="EOF"}throw"Parse Error: "+a4+" at "+a5}a2.init=function(a4){this._=a4};a2.parse=function(a5){return this.skip(a3)._(a5,a4,aT);function a4(a7,a6){return a6}};a2.or=function(a5){aN("or is passed a parser",a5 instanceof aS);var a4=this;return aS(function(a9,a8,a7){return a4._(a9,a8,a6);function a6(ba){return a5._(a9,a8,a7)}})};a2.then=function(a5){var a4=this;return aS(function(a9,a8,a6){return a4._(a9,a7,a6);function a7(bc,ba){var bb=(a5 instanceof aS?a5:a5(ba));aN("a parser is returned",bb instanceof aS);return bb._(bc,a8,a6)}})};a2.many=function(){var a4=this;return aS(function(ba,a9,a7){var a6=[];while(a4._(ba,a8,a5)){}return a9(ba,a6);function a8(bc,bb){ba=bc;a6.push(bb);return true}function a5(){return false}})};a2.times=function(a6,a4){if(arguments.length<2){a4=a6}var a5=this;return aS(function(be,bd,a7){var a9=[];var bg=true;var a8;for(var bb=0;bb<a6;bb+=1){bg=a5._(be,bf,ba);if(!bg){return a7(be,a8)}}for(;bb<a4&&bg;bb+=1){bg=a5._(be,bf,bc)}return bd(be,a9);function bf(bi,bh){a9.push(bh);be=bi;return true}function ba(bi,bh){a8=bh;be=bi;return false}function bc(bi,bh){return false}})};a2.result=function(a4){return this.then(aU(a4))};a2.atMost=function(a4){return this.times(0,a4)};a2.atLeast=function(a5){var a4=this;return a4.times(a5).then(function(a6){return a4.many().map(function(a7){return a6.concat(a7)})})};a2.map=function(a4){return this.then(function(a5){return aU(a4(a5))})};a2.skip=function(a4){return this.then(function(a5){return a4.result(a5)})};var aV=this.string=function(a6){var a4=a6.length;var a5="expected '"+a6+"'";return aS(function(ba,a9,a8){var a7=ba.slice(0,a4);if(a7===a6){return a9(ba.slice(a4),a7)}else{return a8(ba,a5)}})};var a0=this.regex=function(a4){aN("regexp parser is anchored",a4.toString().charAt(1)==="^");var a5="expected "+a4;return aS(function(ba,a9,a8){var a7=a4.exec(ba);if(a7){var a6=a7[0];return a9(ba.slice(a6.length),a6)}else{return a8(ba,a5)}})};var aU=aS.succeed=function(a4){return aS(function(a6,a5){return a5(a6,a4)})};var aR=aS.fail=function(a4){return aS(function(a7,a5,a6){return a6(a7,a4)})};var aQ=aS.letter=a0(/^[a-z]/i);var aX=aS.letters=a0(/^[a-z]*/i);var aZ=aS.digit=a0(/^[0-9]/);var R=aS.digits=a0(/^[0-9]*/);var P=aS.whitespace=a0(/^\s+/);var aY=aS.optWhitespace=a0(/^\s*/);var aW=aS.any=aS(function(a6,a5,a4){if(!a6){return a4(a6,"expected any character")}return a5(a6.slice(1),a6.charAt(0))});var a1=aS.all=aS(function(a6,a5,a4){return a5("",a6)});var a3=aS.eof=aS(function(a6,a5,a4){if(a6){return a4(a6,"expected EOF")}return a5(a6,a6)})});var ag=(function(){var L={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};function R(aR){var aU=aR.which||aR.keyCode;var aQ=L[aU];var aT;var aS=[];if(aR.ctrlKey){aS.push("Ctrl")}if(aR.originalEvent&&aR.originalEvent.metaKey){aS.push("Meta")}if(aR.altKey){aS.push("Alt")}if(aR.shiftKey){aS.push("Shift")}aT=aQ||String.fromCharCode(aU);if(!aS.length&&!aQ){return aT}aS.push(aT);return aS.join("-")}return function P(aR,a1){var aZ=null;var aU=null;var aY=a(aR);var a8=a(a1.container||aY);var aV=at,aT;function a6(a9){aV=a9;clearTimeout(aT);aT=setTimeout(a9)}a8.bind("keydown keypress input keyup focusout paste",function(){aV()});function a0(a9){aV();aV=at;clearTimeout(aT);aY.val(a9);if(a9){aY[0].select()}a5=!!a9}var a5=false;function a4(){var a9=aY[0];if(!("selectionStart" in a9)){return false}return a9.selectionStart!==a9.selectionEnd}function aX(){}function a7(a9){aZ=a9;aU=null;if(a5){a6(function(){aY[0].select();aV=at;clearTimeout(aT)})}aX()}function aS(a9){if(aZ&&aU){aX()}aU=a9;a6(a3)}function a3(){if(a4()){return}var a9=aY.val();if(a9.length===1){aY.val("");a1.typedText(a9)}else{if(a9){aY[0].select()}}}function aW(){aZ=aU=null}function aQ(a9){aY.focus();a6(a2)}function a2(){var a9=aY.val();aY.val("")}a8.bind({focusout:aW,paste:aQ});return{select:a0}}}());I.open(function(P,L){P.exportText=function(){return this.root.foldChildren("",function(R,aQ){return R+aQ.text()})}});I.open(function(L){L.focusBlurEvents=function(){var R=this,P=R.root,aS=R.cursor;var aT;R.textarea.focus(function(){R.blurred=false;clearTimeout(aT);R.container.addClass("mq-focused");if(!aS.parent){aS.insAtRightEnd(P)}if(aS.selection){aS.selection.jQ.removeClass("mq-blur");R.selectionChanged()}else{aS.show()}}).blur(function(){R.blurred=true;aT=setTimeout(function(){P.postOrder("intentionalBlur");aS.clearSelection();aR()});ax(window).on("blur",aQ)});function aQ(){clearTimeout(aT);if(aS.selection){aS.selection.jQ.addClass("mq-blur")}aR()}function aR(){aS.hide().parent.blur();R.container.removeClass("mq-focused");ax(window).off("blur",aQ)}R.blurred=true;aS.hide().parent.blur()}});I.open(function(L){L.keystroke=function(R,P){this.cursor.parent.keystroke(R,P,this)}});av.open(function(L){L.keystroke=function(R,aQ,P){var aR=P.cursor;switch(R){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":while(aR[ae]||aR.selection){P.backspace()}break;case"Shift-Backspace":case"Backspace":P.backspace();break;case"Esc":case"Tab":P.escapeDir(aa,R,aQ);return;case"Shift-Tab":case"Shift-Esc":P.escapeDir(ae,R,aQ);return;case"End":P.notify("move").cursor.insAtRightEnd(aR.parent);break;case"Ctrl-End":P.notify("move").cursor.insAtRightEnd(P.root);break;case"Shift-End":while(aR[aa]){P.selectRight()}break;case"Ctrl-Shift-End":while(aR[aa]||aR.parent!==P.root){P.selectRight()}break;case"Home":P.notify("move").cursor.insAtLeftEnd(aR.parent);break;case"Ctrl-Home":P.notify("move").cursor.insAtLeftEnd(P.root);break;case"Shift-Home":while(aR[ae]){P.selectLeft()}break;case"Ctrl-Shift-Home":while(aR[ae]||aR.parent!==P.root){P.selectLeft()}break;case"Left":P.moveLeft();break;case"Shift-Left":P.selectLeft();break;case"Ctrl-Left":break;case"Right":P.moveRight();break;case"Shift-Right":P.selectRight();break;case"Ctrl-Right":break;case"Up":P.moveUp();break;case"Down":P.moveDown();break;case"Shift-Up":if(aR[ae]){while(aR[ae]){P.selectLeft()}}else{P.selectLeft()}case"Shift-Down":if(aR[aa]){while(aR[aa]){P.selectRight()}}else{P.selectRight()}case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":while(aR[aa]||aR.selection){P.deleteForward()}break;case"Shift-Del":case"Del":P.deleteForward();break;case"Meta-A":case"Ctrl-A":P.notify("move").cursor.insAtRightEnd(P.root);while(aR[ae]){P.selectLeft()}break;default:return}aQ.preventDefault();P.scrollHoriz()};L.moveOutOf=L.moveTowards=L.deleteOutOf=L.deleteTowards=L.unselectInto=L.selectOutOf=L.selectTowards=function(){aN("overridden or never called on this node")}});I.open(function(P){this.onNotify(function(R){if(R==="move"||R==="upDown"){this.show().clearSelection()}});P.escapeDir=function(R,aQ,aR){ai(R);var aS=this.cursor;if(aS.parent!==this.root){aR.preventDefault()}if(aS.parent===this.root){return}aS.parent.moveOutOf(R,aS);return this.notify("move")};aL.leftRightIntoCmdGoes=function(R){if(R&&R!=="up"&&R!=="down"){throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+R+'"'}return R};P.moveDir=function(R){ai(R);var aR=this.cursor,aQ=aR.options.leftRightIntoCmdGoes;if(aR.selection){aR.insDirOf(R,aR.selection.ends[R])}else{if(aR[R]){aR[R].moveTowards(R,aR,aQ)}else{aR.parent.moveOutOf(R,aR,aQ)}}return this.notify("move")};P.moveLeft=function(){return this.moveDir(ae)};P.moveRight=function(){return this.moveDir(aa)};P.moveUp=function(){return L(this,"up")};P.moveDown=function(){return L(this,"down")};function L(R,aQ){var aT=R.notify("upDown").cursor;var aS=aQ+"Into",aR=aQ+"OutOf";if(aT[aa][aS]){aT.insAtLeftEnd(aT[aa][aS])}else{if(aT[ae][aS]){aT.insAtRightEnd(aT[ae][aS])}else{aT.parent.bubble(function(aU){var aV=aU[aR];if(aV){if(typeof aV==="function"){aV=aU[aR](aT)}if(aV instanceof av){aT.jumpUpDown(aU,aV)}if(aV!==true){return false}}})}}return R}this.onNotify(function(R){if(R!=="upDown"){this.upDownCache={}}});this.onNotify(function(R){if(R==="edit"){this.show().deleteSelection()}});P.deleteDir=function(aQ){ai(aQ);var aR=this.cursor;var R=aR.selection;this.notify("edit");if(!R){if(aR[aQ]){aR[aQ].deleteTowards(aQ,aR)}else{aR.parent.deleteOutOf(aQ,aR)}}if(aR[ae].siblingDeleted){aR[ae].siblingDeleted(aR.options,aa)}if(aR[aa].siblingDeleted){aR[aa].siblingDeleted(aR.options,ae)}aR.parent.bubble("reflow");return this};P.backspace=function(){return this.deleteDir(ae)};P.deleteForward=function(){return this.deleteDir(aa)};this.onNotify(function(R){if(R!=="select"){this.endSelection()}});P.selectDir=function(R){var aS=this.notify("select").cursor,aQ=aS.selection;ai(R);if(!aS.anticursor){aS.startSelection()}var aR=aS[R];if(aR){if(aQ&&aQ.ends[R]===aR&&aS.anticursor[-R]!==aR){aR.unselectInto(R,aS)}else{aR.selectTowards(R,aS)}}else{aS.parent.selectOutOf(R,aS)}aS.clearSelection();aS.select()||aS.show()};P.selectLeft=function(){return this.selectDir(ae)};P.selectRight=function(){return this.selectDir(aa)}});var ay=(function(){function a2(a5){var a6=m();a5.adopt(a6,0,0);return a6}function aV(a7){var a6=a7[0]||m();for(var a5=1;a5<a7.length;a5+=1){a7[a5].children().adopt(a6,a6.ends[aa],0)}return a6}var L=Z.string;var aQ=Z.regex;var a4=Z.letter;var aW=Z.any;var a1=Z.optWhitespace;var a3=Z.succeed;var aU=Z.fail;var aX=a4.map(function(a5){return p(a5)});var aY=aQ(/^[^${}\\_^]/).map(function(a5){return aq(a5)});var P=aQ(/^[^\\a-eg-zA-Z]/).or(L("\\").then(aQ(/^[a-z]+/i).or(aQ(/^\s+/).result(" ")).or(aW))).then(function(a6){var a5=ar[a6];if(a5){return a5(a6).parser()}else{return aU("unknown command: \\"+a6)}});var aR=P.or(aX).or(aY);var aT=L("{").then(function(){return a0}).skip(L("}"));var aS=a1.then(aT.or(aR.map(a2)));var a0=aS.many().map(aV).skip(a1);var aZ=L("[").then(aS.then(function(a5){return a5.join("latex")!=="]"?a3(a5):aU()}).many().map(aV).skip(a1)).skip(L("]"));var R=a0;R.block=aS;R.optBlock=aZ;return R})();I.open(function(P,L){P.exportLatex=function(){return this.root.latex().replace(/(\\[a-z]+) (?![a-z])/ig,"$1")};P.writeLatex=function(aR){var aU=this.notify("edit").cursor;var aQ=Z.all;var R=Z.eof;var aT=ay.skip(R).or(aQ.result(false)).parse(aR);if(aT&&!aT.isEmpty()){aT.children().adopt(aU.parent,aU[ae],aU[aa]);var aS=aT.jQize();aS.insertBefore(aU.jQ);aU[ae]=aT.ends[aa];aT.finalizeInsert(aU.options,aU);if(aT.ends[aa][aa].siblingCreated){aT.ends[aa][aa].siblingCreated(aU.options,ae)}if(aT.ends[ae][ae].siblingCreated){aT.ends[ae][ae].siblingCreated(aU.options,aa)}aU.parent.bubble("reflow")}return this};P.renderLatexMath=function(aT){var aQ=this.root,aW=this.cursor;var aS=Z.all;var R=Z.eof;var aV=ay.skip(R).or(aS.result(false)).parse(aT);aQ.eachChild("postOrder","dispose");aQ.ends[ae]=aQ.ends[aa]=0;if(aV){aV.children().adopt(aQ,0,0)}var aU=aQ.jQ;if(aV){var aR=aV.join("html");aU.html(aR);aQ.jQize(aU.children());aQ.finalizeInsert(aW.options)}else{aU.empty()}delete aW.selection;aW.insAtRightEnd(aQ)};P.renderLatexText=function(aS){var aW=this.root,a0=this.cursor;aW.jQ.children().slice(1).remove();aW.eachChild("postOrder","dispose");aW.ends[ae]=aW.ends[aa]=0;delete a0.selection;a0.show().insAtRightEnd(aW);var aX=Z.regex;var aU=Z.string;var a1=Z.eof;var aZ=Z.all;var aV=aU("$").then(ay).skip(aU("$").or(a1)).map(function(a4){var a3=ap(a0);a3.createBlocks();var a2=a3.ends[ae];a4.children().adopt(a2,0,0);return a3});var aY=aU("\\$").result("$");var aQ=aY.or(aX(/^[^$]/)).map(aq);var R=aV.or(aQ).many();var aR=R.skip(a1).or(aZ.result(false)).parse(aS);if(aR){for(var aT=0;aT<aR.length;aT+=1){aR[aT].adopt(aW,aW.ends[aa],0)}aW.jQize().appendTo(aW.jQ);aW.finalizeInsert(a0.options)}}});I.open(function(L){L.delegateMouseEvents=function(){var P=this.root.jQ;this.container.bind("mousedown.mathquill",function(aV){var R=ax(aV.target).closest(".mq-root-block");var aX=av.byId[R.attr(az)||P.attr(az)];var aS=aX.controller,aZ=aS.cursor,aQ=aZ.blink;var a0=aS.textareaSpan,aY=aS.textarea;var aU;function aT(a1){aU=ax(a1.target)}function aW(a1){if(!aZ.anticursor){aZ.startSelection()}aS.seek(aU,a1.pageX,a1.pageY).cursor.select();aU=y}function aR(a1){aZ.blink=aQ;if(!aZ.selection){if(aS.editable){aZ.show()}else{a0.detach()}}R.unbind("mousemove",aT);ax(a1.target.ownerDocument).unbind("mousemove",aW).unbind("mouseup",aR)}if(aS.blurred){if(!aS.editable){R.prepend(a0)}aY.focus()}aV.preventDefault();aV.target.unselectable=true;aZ.blink=at;aS.seek(ax(aV.target),aV.pageX,aV.pageY).cursor.startSelection();R.mousemove(aT);ax(aV.target.ownerDocument).mousemove(aW).mouseup(aR)})}});I.open(function(L){L.seek=function(aS,aQ,P){var aU=this.notify("select").cursor;if(aS){var aT=aS.attr(az)||aS.attr(aH);if(!aT){var R=aS.parent();aT=R.attr(az)||R.attr(aH)}}var aR=aT?av.byId[aT]:this.root;aN("nodeId is the id of some Node that exists",aR);aU.clearSelection().show();aR.seek(aQ,aU);this.scrollHoriz();return this}});I.open(function(L){L.scrollHoriz=function(){var aV=this.cursor,aS=aV.selection;var aR=this.root.jQ[0].getBoundingClientRect();if(!aS){var R=aV.jQ[0].getBoundingClientRect().left;if(R>aR.right-20){var P=R-(aR.right-20)}else{if(R<aR.left+20){var P=R-(aR.left+20)}else{return}}}else{var aT=aS.jQ[0].getBoundingClientRect();var aQ=aT.left-(aR.left+20);var aU=aT.right-(aR.right-20);if(aS.ends[ae]===aV[aa]){if(aQ<0){var P=aQ}else{if(aU>0){if(aT.left-aU<aR.left+20){var P=aQ}else{var P=aU}}else{return}}}else{if(aU>0){var P=aU}else{if(aQ<0){if(aT.right-aQ>aR.right-20){var P=aU}else{var P=aQ}}else{return}}}}this.root.jQ.stop().animate({scrollLeft:"+="+P},100)}});I.open(function(L){C.p.substituteTextarea=function(){return ax("<textarea>")[0]};L.createTextarea=function(){var aQ=this.textareaSpan=ax('<span class="mq-textarea"></span>'),R=this.API.__options.substituteTextarea();if(!R.nodeType){throw"substituteTextarea() must return a DOM element, got "+R}R=this.textarea=ax(R).appendTo(aQ);var P=this;P.cursor.selectionChanged=function(){P.selectionChanged()};P.container.bind("copy",function(){P.setTextareaSelection()})};L.selectionChanged=function(){var P=this;ad(P.container[0]);if(P.textareaSelectionTimeout===y){P.textareaSelectionTimeout=setTimeout(function(){P.setTextareaSelection()})}};L.setTextareaSelection=function(){this.textareaSelectionTimeout=y;var P="";if(this.cursor.selection){P=this.cursor.selection.join("latex");if(this.API.__options.statelessClipboard){P="$"+P+"$"}}this.selectFn(P)};L.staticMathTextareaEvents=function(){var aQ=this,R=aQ.root,aT=aQ.cursor,P=aQ.textarea,aS=aQ.textareaSpan;this.container.prepend('<span class="mq-selectable">$'+aQ.exportLatex()+"$</span>");aQ.blurred=true;P.bind("cut paste",false).focus(function(){aQ.blurred=false}).blur(function(){if(aT.selection){aT.selection.clear()}setTimeout(aR)});function aR(){aS.detach();aQ.blurred=true}aQ.selectFn=function(aU){P.val(aU);if(aU){P.select()}}};L.editablesTextareaEvents=function(){var aQ=this,R=aQ.root,aT=aQ.cursor,P=aQ.textarea,aS=aQ.textareaSpan;var aR=ag(P,this);this.selectFn=function(aU){aR.select(aU)};this.container.prepend(aS).on("cut",function(aU){if(aT.selection){setTimeout(function(){aQ.notify("edit");aQ.notify("cut");aT.parent.bubble("reflow")})}});this.focusBlurEvents()};L.typedText=function(P){if(P==="\n"){return this.handle("enter")}var R=this.notify().cursor;R.parent.write(R,P,R.show().replaceSelection());this.scrollHoriz()};L.paste=function(P){if(this.API.__options.statelessClipboard){if(P.slice(0,1)==="$"&&P.slice(-1)==="$"){P=P.slice(1,-1)}else{P="\\text{"+P+"}"}}this.writeLatex(P).cursor.show()}});var G=ac(av,function(P,L){P.finalizeInsert=function(aQ,aR){var R=this;R.postOrder("finalizeTree",aQ);R.postOrder("contactWeld",aR);R.postOrder("blur");R.postOrder("reflow");if(R[aa].siblingCreated){R[aa].siblingCreated(aQ,ae)}if(R[ae].siblingCreated){R[ae].siblingCreated(aQ,aa)}R.bubble("reflow")}});var aD=ac(G,function(P,L){P.init=function(aR,aS,R){var aQ=this;L.init.call(aQ);if(!aQ.ctrlSeq){aQ.ctrlSeq=aR}if(aS){aQ.htmlTemplate=aS}if(R){aQ.textTemplate=R}};P.replaces=function(R){R.disown();this.replacedFragment=R};P.isEmpty=function(){return this.foldChildren(true,function(R,aQ){return R&&aQ.isEmpty()})};P.parser=function(){var aQ=ay.block;var R=this;return aQ.times(R.numBlocks()).map(function(aS){R.blocks=aS;for(var aR=0;aR<aS.length;aR+=1){aS[aR].adopt(R,R.ends[aa],0)}return R})};P.createLeftOf=function(aR){var R=this;var aQ=R.replacedFragment;R.createBlocks();L.createLeftOf.call(R,aR);if(aQ){aQ.adopt(R.ends[ae],0,0);aQ.jQ.appendTo(R.ends[ae].jQ)}R.finalizeInsert(aR.options);R.placeCursor(aR)};P.createBlocks=function(){var aQ=this,aS=aQ.numBlocks(),aR=aQ.blocks=Array(aS);for(var R=0;R<aS;R+=1){var aT=aR[R]=m();aT.adopt(aQ,aQ.ends[aa],0)}};P.placeCursor=function(R){R.insAtRightEnd(this.foldChildren(this.ends[ae],function(aQ,aR){return aQ.isEmpty()?aQ:aR}))};P.moveTowards=function(aQ,aS,aR){var R=aR&&this[aR+"Into"];aS.insAtDirEnd(-aQ,R||this.ends[-aQ])};P.deleteTowards=function(R,aQ){aQ.startSelection();this.selectTowards(R,aQ);aQ.select()};P.selectTowards=function(R,aQ){aQ[-R]=this;aQ[R]=this[R]};P.selectChildren=function(){return aM(this,this)};P.unselectInto=function(R,aQ){aQ.insAtDirEnd(-R,aQ.anticursor.ancestors[this.id])};P.seek=function(aS,aU){function aR(aW){var aV={};aV[ae]=aW.jQ.offset().left;aV[aa]=aV[ae]+aW.jQ.outerWidth();return aV}var aT=this;var aQ=aR(aT);if(aS<aQ[ae]){return aU.insLeftOf(aT)}if(aS>aQ[aa]){return aU.insRightOf(aT)}var R=aQ[ae];aT.eachChild(function(aW){var aV=aR(aW);if(aS<aV[ae]){if(aS-R<aV[ae]-aS){if(aW[ae]){aU.insAtRightEnd(aW[ae])}else{aU.insLeftOf(aT)}}else{aU.insAtLeftEnd(aW)}return false}else{if(aS>aV[aa]){if(aW[aa]){R=aV[aa]}else{if(aQ[aa]-aS<aS-aV[aa]){aU.insRightOf(aT)}else{aU.insAtRightEnd(aW)}}}else{aW.seek(aS,aU);return false}}})};P.numBlocks=function(){var R=this.htmlTemplate.match(/&\d+/g);return R?R.length:0};P.html=function(){var aT=this;var aV=aT.blocks;var R=" mathquill-command-id="+aT.id;var aU=aT.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);aN("no unmatched angle brackets",aU.join("")===this.htmlTemplate);for(var aR=0,aQ=aU[0];aQ;aR+=1,aQ=aU[aR]){if(aQ.slice(-2)==="/>"){aU[aR]=aQ.slice(0,-2)+R+"/>"}else{if(aQ.charAt(0)==="<"){aN("not an unmatched top-level close tag",aQ.charAt(1)!=="/");aU[aR]=aQ.slice(0,-1)+R+">";var aS=1;do{aR+=1,aQ=aU[aR];aN("no missing close tags",aQ);if(aQ.slice(0,2)==="</"){aS-=1}else{if(aQ.charAt(0)==="<"&&aQ.slice(-2)!=="/>"){aS+=1}}}while(aS>0)}}}return aU.join("").replace(/>&(\d+)/g,function(aX,aW){return" mathquill-block-id="+aV[aW].id+">"+aV[aW].join("html")})};P.latex=function(){return this.foldChildren(this.ctrlSeq,function(R,aQ){return R+"{"+(aQ.latex()||" ")+"}"})};P.textTemplate=[""];P.text=function(){var aQ=this,R=0;return aQ.foldChildren(aQ.textTemplate[R],function(aS,aT){R+=1;var aR=aT.text();if(aS&&aQ.textTemplate[R]==="("&&aR[0]==="("&&aR.slice(-1)===")"){return aS+aR.slice(1,-1)+aQ.textTemplate[R]}return aS+aT.text()+(aQ.textTemplate[R]||"")})}});var F=ac(aD,function(P,L){P.init=function(aQ,R,aR){if(!aR){aR=aQ&&aQ.length>1?aQ.slice(1):aQ}L.init.call(this,aQ,R,[aR])};P.parser=function(){return Z.succeed(this)};P.numBlocks=function(){return 0};P.replaces=function(R){R.remove()};P.createBlocks=at;P.moveTowards=function(R,aQ){aQ.jQ.insDirOf(R,this.jQ);aQ[-R]=this;aQ[R]=this[R]};P.deleteTowards=function(R,aQ){aQ[R]=this.remove()[R]};P.seek=function(R,aQ){if(R-this.jQ.offset().left<this.jQ.outerWidth()/2){aQ.insLeftOf(this)}else{aQ.insRightOf(this)}};P.latex=function(){return this.ctrlSeq};P.text=function(){return this.textTemplate};P.placeCursor=at;P.isEmpty=function(){return true}});var aq=ac(F,function(P,L){P.init=function(aQ,R){L.init.call(this,aQ,"<span>"+(R||aQ)+"</span>")}});var ak=ac(F,function(P,L){P.init=function(aQ,R,aR){L.init.call(this,aQ,'<span class="mq-binary-operator">'+R+"</span>",aR)}});var m=ac(G,function(P,L){P.join=function(R){return this.foldChildren("",function(aQ,aR){return aQ+aR[R]()})};P.html=function(){return this.join("html")};P.latex=function(){return this.join("latex")};P.text=function(){return this.ends[ae]===this.ends[aa]?this.ends[ae].text():"("+this.join("text")+")"};P.keystroke=function(aQ,aR,R){if(R.API.__options.spaceBehavesLikeTab&&(aQ==="Spacebar"||aQ==="Shift-Spacebar")){aR.preventDefault();R.escapeDir(aQ==="Shift-Spacebar"?ae:aa,aQ,aR);return}return L.keystroke.apply(this,arguments)};P.moveOutOf=function(aQ,aS,aR){var R=aR&&this.parent[aR+"Into"];if(!R&&this[aQ]){aS.insAtDirEnd(-aQ,this[aQ])}else{aS.insDirOf(aQ,this.parent)}};P.selectOutOf=function(R,aQ){aQ.insDirOf(R,this.parent)};P.deleteOutOf=function(R,aQ){aQ.unwrapGramp()};P.seek=function(R,aR){var aQ=this.ends[aa];if(!aQ||aQ.jQ.offset().left+aQ.jQ.outerWidth()<R){return aR.insAtRightEnd(this)}if(R<this.ends[ae].jQ.offset().left){return aR.insAtLeftEnd(this)}while(R<aQ.jQ.offset().left){aQ=aQ[ae]}return aQ.seek(R,aR)};P.write=function(aS,R,aR){var aQ;if(R.match(/^[a-eg-zA-Z]$/)){aQ=p(R)}else{if(aQ=aE[R]||ar[R]){aQ=aQ(R)}else{aQ=aq(R)}}if(aR){aQ.replaces(aR)}aQ.createLeftOf(aS)};P.focus=function(){this.jQ.addClass("mq-hasCursor");this.jQ.removeClass("mq-empty");return this};P.blur=function(){this.jQ.removeClass("mq-hasCursor");if(this.isEmpty()){this.jQ.addClass("mq-empty")}return this}});var an=ac(m,aK);A.MathField=K(ac(u,function(P,L){P.init=function(R,aQ){R.addClass("mq-editable-field mq-math-mode");this.initRootAndEvents(an(),R,aQ)}}));var T=ac(av,function(P,L){P.ctrlSeq="\\text";P.replaces=function(aQ){if(aQ instanceof x){this.replacedText=aQ.remove().jQ.text()}else{if(typeof aQ==="string"){this.replacedText=aQ}}};P.jQadd=function(aQ){L.jQadd.call(this,aQ);if(this.ends[ae]){this.ends[ae].jQadd(this.jQ[0].firstChild)}};P.createLeftOf=function(aS){var aQ=this;L.createLeftOf.call(this,aS);if(aQ[aa].siblingCreated){aQ[aa].siblingCreated(aS.options,ae)}if(aQ[ae].siblingCreated){aQ[ae].siblingCreated(aS.options,aa)}aQ.bubble("reflow");aS.insAtRightEnd(aQ);if(aQ.replacedText){for(var aR=0;aR<aQ.replacedText.length;aR+=1){aQ.write(aS,aQ.replacedText.charAt(aR))}}};P.parser=function(){var aQ=this;var aR=Z.string;var aS=Z.regex;var aT=Z.optWhitespace;return aT.then(aR("{")).then(aS(/^[^}]*/)).skip(aR("}")).map(function(aU){g(aU).adopt(aQ,0,0);return aQ})};P.textContents=function(){return this.foldChildren("",function(aQ,aR){return aQ+aR.text})};P.text=function(){return'"'+this.textContents()+'"'};P.latex=function(){return"\\text{"+this.textContents()+"}"};P.html=function(){return('<span class="mq-text-mode" mathquill-command-id='+this.id+">"+this.textContents()+"</span>")};P.moveTowards=function(aQ,aR){aR.insAtDirEnd(-aQ,this)};P.moveOutOf=function(aQ,aR){aR.insDirOf(aQ,this)};P.unselectInto=P.moveTowards;P.selectTowards=aD.prototype.selectTowards;P.deleteTowards=aD.prototype.deleteTowards;P.selectOutOf=function(aQ,aR){aR.insDirOf(aQ,this)};P.deleteOutOf=function(aQ,aR){if(this.isEmpty()){aR.insRightOf(this)}};P.write=function(aT,aR,aS){if(aS){aS.remove()}if(aR!=="$"){if(!aT[ae]){g(aR).createLeftOf(aT)}else{aT[ae].appendText(aR)}}else{if(this.isEmpty()){aT.insRightOf(this);aq("\\$","$").createLeftOf(aT)}else{if(!aT[aa]){aT.insRightOf(this)}else{if(!aT[ae]){aT.insLeftOf(this)}else{var aQ=T();var aU=this.ends[ae];aU.disown();aU.adopt(aQ,0,0);aT.insLeftOf(this);L.createLeftOf.call(aQ,aT)}}}}};P.seek=function(aT,aY){aY.hide();var aV=R(this);var aW=this.jQ.width()/this.text.length;var aU=Math.round((aT-this.jQ.offset().left)/aW);if(aU<=0){aY.insAtLeftEnd(this)}else{if(aU>=aV.text.length){aY.insAtRightEnd(this)}else{aY.insLeftOf(aV.splitRight(aU))}}var aR=aT-aY.show().offset().left;var aS=aR&&aR<0?ae:aa;var aZ=aS;while(aY[aS]&&aR*aZ>0){aY[aS].moveTowards(aS,aY);aZ=aR;aR=aT-aY.offset().left}if(aS*aR<-aS*aZ){aY[-aS].moveTowards(-aS,aY)}if(!aY.anticursor){this.anticursorPosition=aY[ae]&&aY[ae].text.length}else{if(aY.anticursor.parent===this){var aQ=aY[ae]&&aY[ae].text.length;if(this.anticursorPosition===aQ){aY.anticursor=e.copy(aY)}else{if(this.anticursorPosition<aQ){var aX=aY[ae].splitRight(this.anticursorPosition);aY[ae]=aX}else{var aX=aY[aa].splitRight(this.anticursorPosition-aQ)}aY.anticursor=e(this,aX[ae],aX)}}}};P.blur=function(){m.prototype.blur.call(this);R(this)};function R(aQ){aQ.jQ[0].normalize();var aS=aQ.jQ[0].firstChild;var aR=g(aS.data);aR.jQadd(aS);aQ.children().disown();return aR.adopt(aQ,0,0)}P.focus=m.prototype.focus});var g=ac(av,function(P,L){P.init=function(aQ){L.init.call(this);this.text=aQ};P.jQadd=function(aQ){this.dom=aQ;this.jQ=ax(aQ)};P.jQize=function(){return this.jQadd(document.createTextNode(this.text))};P.appendText=function(aQ){this.text+=aQ;this.dom.appendData(aQ)};P.prependText=function(aQ){this.text=aQ+this.text;this.dom.insertData(0,aQ)};P.insTextAtDirEnd=function(aR,aQ){ai(aQ);if(aQ===aa){this.appendText(aR)}else{this.prependText(aR)}};P.splitRight=function(aQ){var aR=g(this.text.slice(aQ)).adopt(this.parent,this,this[aa]);aR.jQadd(this.dom.splitText(aQ));this.text=this.text.slice(0,aQ);return aR};function R(aQ,aR){return aR.charAt(aQ===ae?0:-1+aR.length)}P.moveTowards=function(aQ,aS){ai(aQ);var aR=R(-aQ,this.text);var aT=this[-aQ];if(aT){aT.insTextAtDirEnd(aR,aQ)}else{g(aR).createDir(-aQ,aS)}return this.deleteTowards(aQ,aS)};P.latex=function(){return this.text};P.deleteTowards=function(aQ,aR){if(this.text.length>1){if(aQ===aa){this.dom.deleteData(0,1);this.text=this.text.slice(1)}else{this.dom.deleteData(-1+this.text.length,1);this.text=this.text.slice(0,-1)}}else{this.remove();this.jQ.remove();aR[aQ]=this[aQ]}};P.selectTowards=function(aR,aU){ai(aR);var aQ=aU.anticursor;var aS=R(-aR,this.text);if(aQ[aR]===this){var aT=g(aS).createDir(aR,aU);aQ[aR]=aT;aU.insDirOf(aR,aT)}else{var aV=this[-aR];if(aV){aV.insTextAtDirEnd(aS,aR)}else{var aT=g(aS).createDir(-aR,aU);aT.jQ.insDirOf(-aR,aU.selection.jQ)}if(this.text.length===1&&aQ[-aR]===this){aQ[-aR]=this[-aR]}}return this.deleteTowards(aR,aU)}});aE.$=ar.text=ar.textnormal=ar.textrm=ar.textup=ar.textmd=T;function O(R,P,L){return ac(T,{ctrlSeq:R,htmlTemplate:"<"+P+" "+L+">&0</"+P+">"})}ar.em=ar.italic=ar.italics=ar.emph=ar.textit=ar.textsl=O("\\textit","i",'class="mq-text-mode"');ar.strong=ar.bold=ar.textbf=O("\\textbf","b",'class="mq-text-mode"');ar.sf=ar.textsf=O("\\textsf","span",'class="mq-sans-serif mq-text-mode"');ar.tt=ar.texttt=O("\\texttt","span",'class="mq-monospace mq-text-mode"');ar.textsc=O("\\textsc","span",'style="font-variant:small-caps" class="mq-text-mode"');ar.uppercase=O("\\uppercase","span",'style="text-transform:uppercase" class="mq-text-mode"');ar.lowercase=O("\\lowercase","span",'style="text-transform:lowercase" class="mq-text-mode"');var ap=ac(aD,function(P,L){P.init=function(R){L.init.call(this,"$");this.cursor=R};P.htmlTemplate='<span class="mq-math-mode">&0</span>';P.createBlocks=function(){L.createBlocks.call(this);this.ends[ae].cursor=this.cursor;this.ends[ae].write=function(aR,R,aQ){if(R!=="$"){m.prototype.write.call(this,aR,R,aQ)}else{if(this.isEmpty()){aR.insRightOf(this.parent);this.parent.deleteTowards(dir,aR);aq("\\$","$").createLeftOf(aR.show())}else{if(!aR[aa]){aR.insRightOf(this.parent)}else{if(!aR[ae]){aR.insLeftOf(this.parent)}else{m.prototype.write.call(this,aR,R,aQ)}}}}}};P.latex=function(){return"$"+this.ends[ae].latex()+"$"}});var h=ac(an,function(P,L){P.keystroke=function(R){if(R==="Spacebar"||R==="Shift-Spacebar"){return}return L.keystroke.apply(this,arguments)};P.write=function(aS,aQ,aR){if(aR){aR.remove()}if(aQ==="$"){ap(aS).createLeftOf(aS)}else{var R;if(aQ==="<"){R="&lt;"}else{if(aQ===">"){R="&gt;"}}aq(aQ,R).createLeftOf(aS)}}});A.TextField=K(ac(u,function(L){L.init=function(P){P.addClass("mq-editable-field mq-text-mode");this.initRootAndEvents(h(),P)};L.latex=function(P){if(arguments.length>0){this.__controller.renderLatexText(P);if(this.__controller.blurred){this.__controller.cursor.hide().parent.blur()}return this}return this.__controller.exportLatex()}}));var am=aE["\\"]=ac(aD,function(P,L){P.ctrlSeq="\\";P.replaces=function(R){this._replacedFragment=R.disown();this.isEmpty=function(){return false}};P.htmlTemplate='<span class="mq-latex-command-input mq-non-leaf">\\<span>&0</span></span>';P.textTemplate=["\\"];P.createBlocks=function(){L.createBlocks.call(this);this.ends[ae].focus=function(){this.parent.jQ.addClass("mq-hasCursor");if(this.isEmpty()){this.parent.jQ.removeClass("mq-empty")}return this};this.ends[ae].blur=function(){this.parent.jQ.removeClass("mq-hasCursor");if(this.isEmpty()){this.parent.jQ.addClass("mq-empty")}return this};this.ends[ae].write=function(aR,R,aQ){if(aQ){aQ.remove()}if(R.match(/[a-z]/i)){aq(R).createLeftOf(aR)}else{this.parent.renderCommand(aR);if(R!=="\\"||!this.isEmpty()){this.parent.parent.write(aR,R)}}};this.ends[ae].keystroke=function(aQ,aR,R){if(aQ==="Tab"||aQ==="Enter"||aQ==="Spacebar"){this.parent.renderCommand(R.cursor);aR.preventDefault();return}return L.keystroke.apply(this,arguments)}};P.createLeftOf=function(aQ){L.createLeftOf.call(this,aQ);if(this._replacedFragment){var R=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("mq-blur").bind("mousedown mousemove",function(aR){ax(aR.target=R).trigger(aR);return false}).insertBefore(this.jQ).add(this.jQ)}};P.latex=function(){return"\\"+this.ends[ae].latex()+" "};P.renderCommand=function(aR){this.jQ=this.jQ.last();this.remove();if(this[aa]){aR.insLeftOf(this[aa])}else{aR.insAtRightEnd(this.parent)}var aQ=this.ends[ae].latex();if(!aQ){aQ=" "}var R=ar[aQ];if(R){R=R(aQ);if(this._replacedFragment){R.replaces(this._replacedFragment)}R.createLeftOf(aR)}else{R=T();R.replaces(aQ);R.createLeftOf(aR);aR.insRightOf(R);if(this._replacedFragment){this._replacedFragment.remove()}}}});ar.notin=ar.cong=ar.equiv=ar.oplus=ar.otimes=ac(ak,function(P,L){P.init=function(R){L.init.call(this,"\\"+R+" ","&"+R+";")}});ar["\u2260"]=ar.ne=ar.neq=aG(ak,"\\ne ","&ne;");ar.ast=ar.star=ar.loast=ar.lowast=aG(ak,"\\ast ","&lowast;");ar.therefor=ar.therefore=aG(ak,"\\therefore ","&there4;");ar.cuz=ar.because=aG(ak,"\\because ","&#8757;");ar.prop=ar.propto=aG(ak,"\\propto ","&prop;");ar["\u2248"]=ar.asymp=ar.approx=aG(ak,"\\approx ","&asymp;");ar.isin=ar["in"]=aG(ak,"\\in ","&isin;");ar.ni=ar.contains=aG(ak,"\\ni ","&ni;");ar.notni=ar.niton=ar.notcontains=ar.doesnotcontain=aG(ak,"\\not\\ni ","&#8716;");ar.sub=ar.subset=aG(ak,"\\subset ","&sub;");ar.sup=ar.supset=ar.superset=aG(ak,"\\supset ","&sup;");ar.nsub=ar.notsub=ar.nsubset=ar.notsubset=aG(ak,"\\not\\subset ","&#8836;");ar.nsup=ar.notsup=ar.nsupset=ar.notsupset=ar.nsuperset=ar.notsuperset=aG(ak,"\\not\\supset ","&#8837;");ar.sube=ar.subeq=ar.subsete=ar.subseteq=aG(ak,"\\subseteq ","&sube;");ar.supe=ar.supeq=ar.supsete=ar.supseteq=ar.supersete=ar.superseteq=aG(ak,"\\supseteq ","&supe;");ar.nsube=ar.nsubeq=ar.notsube=ar.notsubeq=ar.nsubsete=ar.nsubseteq=ar.notsubsete=ar.notsubseteq=aG(ak,"\\not\\subseteq ","&#8840;");ar.nsupe=ar.nsupeq=ar.notsupe=ar.notsupeq=ar.nsupsete=ar.nsupseteq=ar.notsupsete=ar.notsupseteq=ar.nsupersete=ar.nsuperseteq=ar.notsupersete=ar.notsuperseteq=aG(ak,"\\not\\supseteq ","&#8841;");ar.N=ar.naturals=ar.Naturals=aG(aq,"\\mathbb{N}","&#8469;");ar.P=ar.primes=ar.Primes=ar.projective=ar.Projective=ar.probability=ar.Probability=aG(aq,"\\mathbb{P}","&#8473;");ar.Z=ar.integers=ar.Integers=aG(aq,"\\mathbb{Z}","&#8484;");ar.Q=ar.rationals=ar.Rationals=aG(aq,"\\mathbb{Q}","&#8474;");ar.R=ar.reals=ar.Reals=aG(aq,"\\mathbb{R}","&#8477;");ar.C=ar.complex=ar.Complex=ar.complexes=ar.Complexes=ar.complexplane=ar.Complexplane=ar.ComplexPlane=aG(aq,"\\mathbb{C}","&#8450;");ar.H=ar.Hamiltonian=ar.quaternions=ar.Quaternions=aG(aq,"\\mathbb{H}","&#8461;");ar.quad=ar.emsp=aG(aq,"\\quad ","    ");ar.qquad=aG(aq,"\\qquad ","        ");ar.diamond=aG(aq,"\\diamond ","&#9671;");ar.bigtriangleup=aG(aq,"\\bigtriangleup ","&#9651;");ar.ominus=aG(aq,"\\ominus ","&#8854;");ar.uplus=aG(aq,"\\uplus ","&#8846;");ar.bigtriangledown=aG(aq,"\\bigtriangledown ","&#9661;");ar.sqcap=aG(aq,"\\sqcap ","&#8851;");ar.triangleleft=aG(aq,"\\triangleleft ","&#8882;");ar.sqcup=aG(aq,"\\sqcup ","&#8852;");ar.triangleright=aG(aq,"\\triangleright ","&#8883;");ar.odot=aG(aq,"\\odot ","&#8857;");ar.bigcirc=aG(aq,"\\bigcirc ","&#9711;");ar.dagger=aG(aq,"\\dagger ","&#0134;");ar.ddagger=aG(aq,"\\ddagger ","&#135;");ar.wr=aG(aq,"\\wr ","&#8768;");ar.amalg=aG(aq,"\\amalg ","&#8720;");ar.models=aG(aq,"\\models ","&#8872;");ar.prec=aG(aq,"\\prec ","&#8826;");ar.succ=aG(aq,"\\succ ","&#8827;");ar.preceq=aG(aq,"\\preceq ","&#8828;");ar.succeq=aG(aq,"\\succeq ","&#8829;");ar.simeq=aG(aq,"\\simeq ","&#8771;");ar.mid=aG(aq,"\\mid ","&#8739;");ar.ll=aG(aq,"\\ll ","&#8810;");ar.gg=aG(aq,"\\gg ","&#8811;");ar.parallel=aG(aq,"\\parallel ","&#8741;");ar.bowtie=aG(aq,"\\bowtie ","&#8904;");ar.sqsubset=aG(aq,"\\sqsubset ","&#8847;");ar.sqsupset=aG(aq,"\\sqsupset ","&#8848;");ar.smile=aG(aq,"\\smile ","&#8995;");ar.sqsubseteq=aG(aq,"\\sqsubseteq ","&#8849;");ar.sqsupseteq=aG(aq,"\\sqsupseteq ","&#8850;");ar.doteq=aG(aq,"\\doteq ","&#8784;");ar.frown=aG(aq,"\\frown ","&#8994;");ar.vdash=aG(aq,"\\vdash ","&#8870;");ar.dashv=aG(aq,"\\dashv ","&#8867;");ar.longleftarrow=aG(aq,"\\longleftarrow ","&#8592;");ar.longrightarrow=aG(aq,"\\longrightarrow ","&#8594;");ar.Longleftarrow=aG(aq,"\\Longleftarrow ","&#8656;");ar.Longrightarrow=aG(aq,"\\Longrightarrow ","&#8658;");ar.longleftrightarrow=aG(aq,"\\longleftrightarrow ","&#8596;");ar.updownarrow=aG(aq,"\\updownarrow ","&#8597;");ar.Longleftrightarrow=aG(aq,"\\Longleftrightarrow ","&#8660;");ar.Updownarrow=aG(aq,"\\Updownarrow ","&#8661;");ar.mapsto=aG(aq,"\\mapsto ","&#8614;");ar.nearrow=aG(aq,"\\nearrow ","&#8599;");ar.hookleftarrow=aG(aq,"\\hookleftarrow ","&#8617;");ar.hookrightarrow=aG(aq,"\\hookrightarrow ","&#8618;");ar.searrow=aG(aq,"\\searrow ","&#8600;");ar.leftharpoonup=aG(aq,"\\leftharpoonup ","&#8636;");ar.rightharpoonup=aG(aq,"\\rightharpoonup ","&#8640;");ar.swarrow=aG(aq,"\\swarrow ","&#8601;");ar.leftharpoondown=aG(aq,"\\leftharpoondown ","&#8637;");ar.rightharpoondown=aG(aq,"\\rightharpoondown ","&#8641;");ar.nwarrow=aG(aq,"\\nwarrow ","&#8598;");ar.ldots=aG(aq,"\\ldots ","&#8230;");ar.cdots=aG(aq,"\\cdots ","&#8943;");ar.vdots=aG(aq,"\\vdots ","&#8942;");ar.ddots=aG(aq,"\\ddots ","&#8944;");ar.surd=aG(aq,"\\surd ","&#8730;");ar.triangle=aG(aq,"\\triangle ","&#9653;");ar.ell=aG(aq,"\\ell ","&#8467;");ar.top=aG(aq,"\\top ","&#8868;");ar.flat=aG(aq,"\\flat ","&#9837;");ar.natural=aG(aq,"\\natural ","&#9838;");ar.sharp=aG(aq,"\\sharp ","&#9839;");ar.wp=aG(aq,"\\wp ","&#8472;");ar.bot=aG(aq,"\\bot ","&#8869;");ar.clubsuit=aG(aq,"\\clubsuit ","&#9827;");ar.diamondsuit=aG(aq,"\\diamondsuit ","&#9826;");ar.heartsuit=aG(aq,"\\heartsuit ","&#9825;");ar.spadesuit=aG(aq,"\\spadesuit ","&#9824;");ar.oint=aG(aq,"\\oint ","&#8750;");ar.bigcap=aG(aq,"\\bigcap ","&#8745;");ar.bigcup=aG(aq,"\\bigcup ","&#8746;");ar.bigsqcup=aG(aq,"\\bigsqcup ","&#8852;");ar.bigvee=aG(aq,"\\bigvee ","&#8744;");ar.bigwedge=aG(aq,"\\bigwedge ","&#8743;");ar.bigodot=aG(aq,"\\bigodot ","&#8857;");ar.bigotimes=aG(aq,"\\bigotimes ","&#8855;");ar.bigoplus=aG(aq,"\\bigoplus ","&#8853;");ar.biguplus=aG(aq,"\\biguplus ","&#8846;");ar.lfloor=aG(aq,"\\lfloor ","&#8970;");ar.rfloor=aG(aq,"\\rfloor ","&#8971;");ar.lceil=aG(aq,"\\lceil ","&#8968;");ar.rceil=aG(aq,"\\rceil ","&#8969;");ar.opencurlybrace=ar.lbrace=aG(aq,"\\lbrace ","{");ar.closecurlybrace=ar.rbrace=aG(aq,"\\rbrace ","}");ar["\u222b"]=ar["int"]=ar.integral=aG(F,"\\int ","<big>&int;</big>");ar.caret=aG(aq,"\\text{^}","^");ar.underscore=aG(aq,"\\_","_");ar.slash=aG(aq,"/");ar.vert=aG(aq,"|");ar.perp=ar.perpendicular=aG(aq,"\\perp ","&perp;");ar.nabla=ar.del=aG(aq,"\\nabla ","&nabla;");ar.hbar=aG(aq,"\\hbar ","&#8463;");ar.AA=ar.Angstrom=ar.angstrom=aG(aq,"\\text\\AA ","&#8491;");ar.ring=ar.circ=ar.circle=aG(aq,"\\circ ","&#8728;");ar.bull=ar.bullet=aG(aq,"\\bullet ","&bull;");ar.setminus=ar.smallsetminus=aG(aq,"\\setminus ","&#8726;");ar.not=ar["\u00ac"]=ar.neg=aG(aq,"\\neg ","&not;");ar["\u2026"]=ar.dots=ar.ellip=ar.hellip=ar.ellipsis=ar.hellipsis=aG(aq,"\\dots ","&hellip;");ar.converges=ar.darr=ar.dnarr=ar.dnarrow=ar.downarrow=aG(aq,"\\downarrow ","&darr;");ar.dArr=ar.dnArr=ar.dnArrow=ar.Downarrow=aG(aq,"\\Downarrow ","&dArr;");ar.diverges=ar.uarr=ar.uparrow=aG(aq,"\\uparrow ","&uarr;");ar.uArr=ar.Uparrow=aG(aq,"\\Uparrow ","&uArr;");ar.to=aG(ak,"\\to ","&rarr;");ar.rarr=ar.rightarrow=aG(aq,"\\rightarrow ","&rarr;");ar.implies=aG(ak,"\\Rightarrow ","&rArr;");ar.rArr=ar.Rightarrow=aG(aq,"\\Rightarrow ","&rArr;");ar.gets=aG(ak,"\\gets ","&larr;");ar.larr=ar.leftarrow=aG(aq,"\\leftarrow ","&larr;");ar.impliedby=aG(ak,"\\Leftarrow ","&lArr;");ar.lArr=ar.Leftarrow=aG(aq,"\\Leftarrow ","&lArr;");ar.harr=ar.lrarr=ar.leftrightarrow=aG(aq,"\\leftrightarrow ","&harr;");ar.iff=aG(ak,"\\Leftrightarrow ","&hArr;");ar.hArr=ar.lrArr=ar.Leftrightarrow=aG(aq,"\\Leftrightarrow ","&hArr;");ar.Re=ar.Real=ar.real=aG(aq,"\\Re ","&real;");ar.Im=ar.imag=ar.image=ar.imagin=ar.imaginary=ar.Imaginary=aG(aq,"\\Im ","&image;");ar.part=ar.partial=aG(aq,"\\partial ","&part;");ar.infty=ar.infin=ar.infinity=aG(aq,"\\infty ","&infin;");ar.alef=ar.alefsym=ar.aleph=ar.alephsym=aG(aq,"\\aleph ","&alefsym;");ar.xist=ar.xists=ar.exist=ar.exists=aG(aq,"\\exists ","&exist;");ar.and=ar.land=ar.wedge=aG(aq,"\\wedge ","&and;");ar.or=ar.lor=ar.vee=aG(aq,"\\vee ","&or;");ar.o=ar.O=ar.empty=ar.emptyset=ar.oslash=ar.Oslash=ar.nothing=ar.varnothing=aG(ak,"\\varnothing ","&empty;");ar.cup=ar.union=aG(ak,"\\cup ","&cup;");ar.cap=ar.intersect=ar.intersection=aG(ak,"\\cap ","&cap;");ar.deg=ar.degree=aG(aq,"^\\circ ","&deg;");ar.ang=ar.angle=aG(aq,"\\angle ","&ang;");var t=ac(F,function(P,L){P.init=function(aQ,R){L.init.call(this,aQ,"<var>"+(R||aQ)+"</var>")};P.text=function(){var R=this.ctrlSeq;if(this[ae]&&!(this[ae] instanceof t)&&!(this[ae] instanceof ak)){R="*"+R}if(this[aa]&&!(this[aa] instanceof ak)&&!(this[aa].ctrlSeq==="^")){R+="*"}return R}});C.p.autoCommands={_maxLength:0};aL.autoCommands=function(L){if(!/^[a-z]+(?: [a-z]+)*$/i.test(L)){throw'"'+L+'" not a space-delimited list of only letters'}var aR=L.split(" "),aS={},P=0;for(var R=0;R<aR.length;R+=1){var aQ=aR[R];if(aQ.length<2){throw'autocommand "'+aQ+'" not minimum length of 2'}if(ar[aQ]===f){throw'"'+aQ+'" is a built-in operator name'}aS[aQ]=1;P=s(P,aQ.length)}aS._maxLength=P;return aS};var p=ac(t,function(R,P){R.init=function(aQ){return P.init.call(this,this.letter=aQ)};R.createLeftOf=function(aV){var aT=aV.options.autoCommands,aR=aT._maxLength;if(aR>0){var aU=this.letter,aQ=aV[ae],aS=1;while(aQ instanceof p&&aS<aR){aU=aQ.letter+aU,aQ=aQ[ae],aS+=1}while(aU.length){if(aT.hasOwnProperty(aU)){for(var aS=2,aQ=aV[ae];aS<aU.length;aS+=1,aQ=aQ[ae]){}x(aQ,aV[ae]).remove();aV[ae]=aQ[ae];return ar[aU](aU).createLeftOf(aV)}aU=aU.slice(1)}}P.createLeftOf.apply(this,arguments)};R.italicize=function(aQ){this.jQ.toggleClass("mq-operator-name",!aQ);return this};R.finalizeTree=R.siblingDeleted=R.siblingCreated=function(aR,aQ){if(aQ!==ae&&this[aa] instanceof p){return}this.autoUnItalicize(aR)};R.autoUnItalicize=function(aQ){var a0=aQ.autoOperatorNames;if(a0._maxLength===0){return}var a1=this.letter;for(var aV=this[ae];aV instanceof p;aV=aV[ae]){a1=aV.letter+a1}for(var aR=this[aa];aR instanceof p;aR=aR[aa]){a1+=aR.letter}x(aV[aa]||this.parent.ends[ae],aR[ae]||this.parent.ends[aa]).each(function(a3){a3.italicize(true).jQ.removeClass("mq-first mq-last");a3.ctrlSeq=a3.letter});outer:for(var aX=0,aY=aV[aa]||this.parent.ends[ae];aX<a1.length;aX+=1,aY=aY[aa]){for(var aZ=aJ(a0._maxLength,a1.length-aX);aZ>0;aZ-=1){var aS=a1.slice(aX,aX+aZ);if(a0.hasOwnProperty(aS)){for(var aW=0,aU=aY;aW<aZ;aW+=1,aU=aU[aa]){aU.italicize(false);var a2=aU}var aT=q.hasOwnProperty(aS);aY.ctrlSeq=(aT?"\\":"\\operatorname{")+aY.ctrlSeq;a2.ctrlSeq+=(aT?" ":"}");if(au.hasOwnProperty(aS)){a2[ae][ae][ae].jQ.addClass("mq-last")}if(L(aY[ae])){aY.jQ.addClass("mq-first")}if(L(a2[aa])){a2.jQ.addClass("mq-last")}aX+=aZ-1;aY=a2;continue outer}}}};function L(aQ){return aQ instanceof F&&!(aQ instanceof ak)}});var q={};var au={limsup:1,liminf:1,projlim:1,injlim:1};(function(){var aQ=C.p.autoOperatorNames={_maxLength:9};var L=("arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr").split(" ");for(var P=0;P<L.length;P+=1){q[L[P]]=aQ[L[P]]=1}var aR="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" ");for(var P=0;P<aR.length;P+=1){q[aR[P]]=1}var R="sin cos tan sec cosec csc cotan cot ctg".split(" ");for(var P=0;P<R.length;P+=1){aQ[R[P]]=aQ["arc"+R[P]]=aQ[R[P]+"h"]=aQ["ar"+R[P]+"h"]=aQ["arc"+R[P]+"h"]=1}}());aL.autoOperatorNames=function(L){if(!/^[a-z]+(?: [a-z]+)*$/i.test(L)){throw'"'+L+'" not a space-delimited list of only letters'}var aR=L.split(" "),aS={},P=0;for(var R=0;R<aR.length;R+=1){var aQ=aR[R];if(aQ.length<2){throw'"'+aQ+'" not minimum length of 2'}aS[aQ]=1;P=s(P,aQ.length)}aS._maxLength=P;return aS};var f=ac(F,function(P,L){P.init=function(R){this.ctrlSeq=R};P.createLeftOf=function(aR){var aQ=this.ctrlSeq;for(var R=0;R<aQ.length;R+=1){p(aQ.charAt(R)).createLeftOf(aR)}};P.parser=function(){var aQ=this.ctrlSeq;var aR=m();for(var R=0;R<aQ.length;R+=1){p(aQ.charAt(R)).adopt(aR,aR.ends[aa],0)}return Z.succeed(aR.children())}});for(var aC in q){if(q.hasOwnProperty(aC)){ar[aC]=f}}ar.operatorname=ac(aD,function(L){L.createLeftOf=at;L.numBlocks=function(){return 1};L.parser=function(){return ay.block.map(function(P){return P.children()})}});ar.f=ac(p,function(P,L){P.init=function(){F.p.init.call(this,this.letter="f",'<var class="mq-florin">&fnof;</var>')};P.italicize=function(R){this.jQ.html(R?"&fnof;":"f").toggleClass("mq-florin",R);return L.italicize.apply(this,arguments)}});ar[" "]=ar.space=aG(aq,"\\ "," ");ar["'"]=ar.prime=aG(aq,"'","&prime;");ar.backslash=aG(aq,"\\backslash ","\\");if(!aE["\\"]){aE["\\"]=ar.backslash}ar.$=aG(aq,"\\$","$");var aB=ac(F,function(P,L){P.init=function(aQ,R){L.init.call(this,aQ,'<span class="mq-nonSymbola">'+(R||aQ)+"</span>")}});ar["@"]=aB;ar["&"]=aG(aB,"\\&","&amp;");ar["%"]=aG(aB,"\\%","%");ar.alpha=ar.beta=ar.gamma=ar.delta=ar.zeta=ar.eta=ar.theta=ar.iota=ar.kappa=ar.mu=ar.nu=ar.xi=ar.rho=ar.sigma=ar.tau=ar.chi=ar.psi=ar.omega=ac(t,function(P,L){P.init=function(R){L.init.call(this,"\\"+R+" ","&"+R+";")}});ar.phi=aG(t,"\\phi ","&#981;");ar.phiv=ar.varphi=aG(t,"\\varphi ","&phi;");ar.epsilon=aG(t,"\\epsilon ","&#1013;");ar.epsiv=ar.varepsilon=aG(t,"\\varepsilon ","&epsilon;");ar.piv=ar.varpi=aG(t,"\\varpi ","&piv;");ar.sigmaf=ar.sigmav=ar.varsigma=aG(t,"\\varsigma ","&sigmaf;");ar.thetav=ar.vartheta=ar.thetasym=aG(t,"\\vartheta ","&thetasym;");ar.upsilon=ar.upsi=aG(t,"\\upsilon ","&upsilon;");ar.gammad=ar.Gammad=ar.digamma=aG(t,"\\digamma ","&#989;");ar.kappav=ar.varkappa=aG(t,"\\varkappa ","&#1008;");ar.rhov=ar.varrho=aG(t,"\\varrho ","&#1009;");ar.pi=ar["\u03c0"]=aG(aB,"\\pi ","&pi;");ar.lambda=aG(aB,"\\lambda ","&lambda;");ar.Upsilon=ar.Upsi=ar.upsih=ar.Upsih=aG(F,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>');ar.Gamma=ar.Delta=ar.Theta=ar.Lambda=ar.Xi=ar.Pi=ar.Sigma=ar.Phi=ar.Psi=ar.Omega=ar.forall=ac(aq,function(P,L){P.init=function(R){L.init.call(this,"\\"+R+" ","&"+R+";")}});var H=ac(aD,function(L){L.init=function(P){this.latex=P};L.createLeftOf=function(R){var P=ay.parse(this.latex);P.children().adopt(R.parent,R[ae],R[aa]);R[ae]=P.ends[aa];P.jQize().insertBefore(R.jQ);P.finalizeInsert(R.options,R);if(P.ends[aa][aa].siblingCreated){P.ends[aa][aa].siblingCreated(R.options,ae)}if(P.ends[ae][ae].siblingCreated){P.ends[ae][ae].siblingCreated(R.options,aa)}R.parent.bubble("reflow")};L.parser=function(){var P=ay.parse(this.latex).children();return Z.succeed(P)}});ar["\u00b9"]=aG(H,"^1");ar["\u00b2"]=aG(H,"^2");ar["\u00b3"]=aG(H,"^3");ar["\u00bc"]=aG(H,"\\frac14");ar["\u00bd"]=aG(H,"\\frac12");ar["\u00be"]=aG(H,"\\frac34");var l=ac(ak,function(L){L.init=aq.prototype.init;L.contactWeld=L.siblingCreated=L.siblingDeleted=function(R,P){if(P===aa){return}this.jQ[0].className=(!this[ae]||this[ae] instanceof ak?"":"mq-binary-operator");return this}});ar["+"]=aG(l,"+","+");ar["\u2013"]=ar["-"]=aG(l,"-","&minus;");ar["\u00b1"]=ar.pm=ar.plusmn=ar.plusminus=aG(l,"\\pm ","&plusmn;");ar.mp=ar.mnplus=ar.minusplus=aG(l,"\\mp ","&#8723;");aE["*"]=ar.sdot=ar.cdot=aG(ak,"\\cdot ","&middot;");var k=ac(ak,function(P,L){P.init=function(aR,R){this.data=aR;this.strict=R;var aQ=(R?"Strict":"");L.init.call(this,aR["ctrlSeq"+aQ],aR["html"+aQ],aR["text"+aQ])};P.swap=function(R){this.strict=R;var aQ=(R?"Strict":"");this.ctrlSeq=this.data["ctrlSeq"+aQ];this.jQ.html(this.data["html"+aQ]);this.textTemplate=[this.data["text"+aQ]]};P.deleteTowards=function(R,aQ){if(R===ae&&!this.strict){this.swap(true);return}L.deleteTowards.apply(this,arguments)}});var N={ctrlSeq:"\\le ",html:"&le;",text:"\u2264",ctrlSeqStrict:"<",htmlStrict:"&lt;",textStrict:"<"};var v={ctrlSeq:"\\ge ",html:"&ge;",text:"\u2265",ctrlSeqStrict:">",htmlStrict:"&gt;",textStrict:">"};ar["<"]=ar.lt=aG(k,N,true);ar[">"]=ar.gt=aG(k,v,true);ar["\u2264"]=ar.le=ar.leq=aG(k,N,false);ar["\u2265"]=ar.ge=ar.geq=aG(k,v,false);var c=ac(ak,function(P,L){P.init=function(){L.init.call(this,"=","=")};P.createLeftOf=function(R){if(R[ae] instanceof k&&R[ae].strict){R[ae].swap(false);return}L.createLeftOf.apply(this,arguments)}});ar["="]=c;ar.times=aG(ak,"\\times ","&times;","[x]");ar["\u00f7"]=ar.div=ar.divide=ar.divides=aG(ak,"\\div ","&divide;","[/]");aE["~"]=ar.sim=aG(ak,"\\sim ","&sim;","~");var aw,ad=at,r=document.createElement("div"),j=r.style,aj={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1},d;for(var al in aj){if(al in j){d=al;break}}if(d){aw=function(P,L,R){P.css(d,"scale("+L+","+R+")")}}else{if("filter" in j){ad=function(L){L.className=L.className};aw=function(aQ,L,aS){L/=(1+(aS-1)/2);aQ.css("fontSize",aS+"em");if(!aQ.hasClass("mq-matrixed-container")){aQ.addClass("mq-matrixed-container").wrapInner('<span class="mq-matrixed"></span>')}var aR=aQ.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+L+",SizingMethod='auto expand')");function R(){aQ.css("marginRight",(aR.width()-1)*(L-1)/L+"px")}R();var P=setInterval(R);ax(window).load(function(){clearTimeout(P);R()})}}else{aw=function(P,L,R){P.css("fontSize",R+"em")}}}var X=ac(aD,function(P,L){P.init=function(aR,aQ,R){L.init.call(this,aR,"<"+aQ+" "+R+">&0</"+aQ+">")}});ar.mathrm=aG(X,"\\mathrm","span",'class="mq-roman mq-font"');ar.mathit=aG(X,"\\mathit","i",'class="mq-font"');ar.mathbf=aG(X,"\\mathbf","b",'class="mq-font"');ar.mathsf=aG(X,"\\mathsf","span",'class="mq-sans-serif mq-font"');ar.mathtt=aG(X,"\\mathtt","span",'class="mq-monospace mq-font"');ar.underline=aG(X,"\\underline","span",'class="mq-non-leaf mq-underline"');ar.overline=ar.bar=aG(X,"\\overline","span",'class="mq-non-leaf mq-overline"');var S=ar.textcolor=ac(aD,function(P,L){P.setColor=function(R){this.color=R;this.htmlTemplate='<span class="mq-textcolor" style="color:'+R+'">&0</span>'};P.latex=function(){return"\\textcolor{"+this.color+"}{"+this.blocks[0].latex()+"}"};P.parser=function(){var R=this;var aS=Z.optWhitespace;var aQ=Z.string;var aR=Z.regex;return aS.then(aQ("{")).then(aR(/^[#\w\s.,()%-]*/)).skip(aQ("}")).then(function(aT){R.setColor(aT);return L.parser.call(R)})}});var aF=ar["class"]=ac(aD,function(P,L){P.parser=function(){var R=this,aQ=Z.string,aR=Z.regex;return Z.optWhitespace.then(aQ("{")).then(aR(/^[-\w\s\\\xA0-\xFF]*/)).skip(aQ("}")).then(function(aS){R.htmlTemplate='<span class="mq-class '+aS+'">&0</span>';return L.parser.call(R)})}});var ah=ac(aD,function(P,L){P.ctrlSeq="_{...}^{...}";P.createLeftOf=function(R){if(!R[ae]&&R.options.supSubsRequireOperand){return}return L.createLeftOf.apply(this,arguments)};P.contactWeld=function(aV){for(var aQ=ae;aQ;aQ=(aQ===ae?aa:false)){if(this[aQ] instanceof ah){for(var aS="sub";aS;aS=(aS==="sub"?"sup":false)){var aU=this[aS],R=this[aQ][aS];if(!aU){continue}if(!R){this[aQ].addBlock(aU.disown())}else{if(!aU.isEmpty()){aU.jQ.children().insAtDirEnd(-aQ,R.jQ);var aR=aU.children().disown();var aT=e(R,aR.ends[aa],R.ends[ae]);if(aQ===ae){aR.adopt(R,R.ends[aa],0)}else{aR.adopt(R,0,R.ends[ae])}}else{var aT=e(R,0,R.ends[ae])}}this.placeCursor=(function(aW,aX){return function(aY){aY.insAtDirEnd(-aQ,aW||aX)}}(R,aU))}this.remove();if(aV&&aV[ae]===this){if(aQ===aa&&aT){aT[ae]?aV.insRightOf(aT[ae]):aV.insAtLeftEnd(aT.parent)}else{aV.insRightOf(this[aQ])}}break}}this.respace()};C.p.charsThatBreakOutOfSupSub="";P.finalizeTree=function(){this.ends[ae].write=function(aQ,R){if(aQ.options.charsThatBreakOutOfSupSub.indexOf(R)>-1){aQ.insRightOf(this.parent)}m.p.write.apply(this,arguments)}};P.latex=function(){function R(aR,aS){var aQ=aS&&aS.latex();return aS?aR+(aQ.length===1?aQ:"{"+(aQ||" ")+"}"):""}return R("_",this.sub)+R("^",this.sup)};P.respace=P.siblingCreated=P.siblingDeleted=function(aQ,R){if(R===aa){return}this.jQ.toggleClass("mq-limit",this[ae].ctrlSeq==="\\int ")};P.addBlock=function(aQ){if(this.supsub==="sub"){this.sup=this.upInto=this.sub.upOutOf=aQ;aQ.adopt(this,this.sub,0).downOutOf=this.sub;aQ.jQ=ax('<span class="mq-sup"/>').append(aQ.jQ.children()).attr(az,aQ.id).prependTo(this.jQ)}else{this.sub=this.downInto=this.sup.downOutOf=aQ;aQ.adopt(this,0,this.sup).upOutOf=this.sup;aQ.jQ=ax('<span class="mq-sub"></span>').append(aQ.jQ.children()).attr(az,aQ.id).appendTo(this.jQ.removeClass("mq-sup-only"));this.jQ.append('<span style="display:inline-block;width:0">&nbsp;</span>')}for(var R=0;R<2;R+=1){(function(aU,aR,aT,aS){aU[aR].deleteOutOf=function(aV,aW){aW.insDirOf(aV,this.parent);if(!this.isEmpty()){aW[-aV]=this.ends[aV];this.children().disown().withDirAdopt(aV,aW.parent,aW[aV],this.parent).jQ.insDirOf(aV,this.parent.jQ)}aU.supsub=aT;delete aU[aR];delete aU[aS+"Into"];aU[aT][aS+"OutOf"]=J;delete aU[aT].deleteOutOf;if(aR==="sub"){ax(aU.jQ.addClass("mq-sup-only")[0].lastChild).remove()}this.remove()}}(this,"sub sup".split(" ")[R],"sup sub".split(" ")[R],"down up".split(" ")[R]))}}});var b=ac(aD,function(P,L){P.init=function(aQ,R){var aR='<span class="mq-large-operator mq-non-leaf"><span class="mq-to"><span>&1</span></span><big>'+R+'</big><span class="mq-from"><span>&0</span></span></span>';F.prototype.init.call(this,aQ,aR)};P.createLeftOf=function(R){L.createLeftOf.apply(this,arguments);if(R.options.sumStartsWithNEquals){p("n").createLeftOf(R);c().createLeftOf(R)}};P.latex=function(){function R(aQ){return aQ.length===1?aQ:"{"+(aQ||" ")+"}"}return this.ctrlSeq+"_"+R(this.ends[ae].latex())+"^"+R(this.ends[aa].latex())};P.parser=function(){var aQ=Z.string;var aT=Z.optWhitespace;var aS=Z.succeed;var aV=ay.block;var R=this;var aU=R.blocks=[m(),m()];for(var aR=0;aR<aU.length;aR+=1){aU[aR].adopt(R,R.ends[aa],0)}return aT.then(aQ("_").or(aQ("^"))).then(function(aW){var aX=aU[aW==="_"?0:1];return aV.then(function(aY){aY.children().adopt(aX,aX.ends[aa],0);return aS(R)})}).many().result(R)};P.finalizeTree=function(){this.downInto=this.ends[ae];this.upInto=this.ends[aa];this.ends[ae].upOutOf=this.ends[aa];this.ends[aa].downOutOf=this.ends[ae]}});ar["\u2211"]=ar.sum=ar.summation=aG(b,"\\sum ","&sum;");ar["\u220f"]=ar.prod=ar.product=aG(b,"\\prod ","&prod;");ar.coprod=ar.coproduct=aG(b,"\\coprod ","&#8720;");function J(R){var L=this.parent,P=R;do{if(P[aa]){return R.insLeftOf(L)}P=P.parent.parent}while(P!==L);R.insRightOf(L)}ar.subscript=ar._=ac(ah,function(P,L){P.supsub="sub";P.htmlTemplate='<span class="mq-supsub mq-non-leaf"><span class="mq-sub">&0</span><span style="display:inline-block;width:0">&nbsp;</span></span>';P.textTemplate=["_"];P.finalizeTree=function(){this.downInto=this.sub=this.ends[ae];this.sub.upOutOf=J;L.finalizeTree.call(this)}});ar.superscript=ar.supscript=ar["^"]=ac(ah,function(P,L){P.supsub="sup";P.htmlTemplate='<span class="mq-supsub mq-non-leaf mq-sup-only"><span class="mq-sup">&0</span></span>';P.textTemplate=["**"];P.finalizeTree=function(){this.upInto=this.sup=this.ends[aa];this.sup.downOutOf=J;L.finalizeTree.call(this)}});var aI=ar.frac=ar.dfrac=ar.cfrac=ar.fraction=ac(aD,function(P,L){P.ctrlSeq="\\frac";P.htmlTemplate='<span class="mq-fraction mq-non-leaf"><span class="mq-numerator">&0</span><span class="mq-denominator">&1</span><span style="display:inline-block;width:0">&nbsp;</span></span>';P.textTemplate=["(","/",")"];P.finalizeTree=function(){this.upInto=this.ends[aa].upOutOf=this.ends[ae];this.downInto=this.ends[ae].downOutOf=this.ends[aa]}});var D=ar.over=aE["/"]=ac(aI,function(P,L){P.createLeftOf=function(aQ){if(!this.replacedFragment){var R=aQ[ae];while(R&&!(R instanceof ak||R instanceof (ar.text||at)||R instanceof b||R.ctrlSeq==="\\ "||/^[,;:]$/.test(R.ctrlSeq))){R=R[ae]}if(R instanceof b&&R[aa] instanceof ah){R=R[aa];if(R[aa] instanceof ah&&R[aa].ctrlSeq!=R.ctrlSeq){R=R[aa]}}if(R!==aQ[ae]){this.replaces(x(R[aa]||aQ.parent.ends[ae],aQ[ae]));aQ[ae]=R}}L.createLeftOf.call(this,aQ)}});var aO=ar.sqrt=ar["\u221a"]=ac(aD,function(P,L){P.ctrlSeq="\\sqrt";P.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-sqrt-prefix">&radic;</span><span class="mq-non-leaf mq-sqrt-stem">&0</span></span>';P.textTemplate=["sqrt(",")"];P.parser=function(){return ay.optBlock.then(function(R){return ay.block.map(function(aR){var aQ=af();aQ.blocks=[R,aR];R.adopt(aQ,0,0);aR.adopt(aQ,R,0);return aQ})}).or(L.parser.call(this))};P.reflow=function(){var R=this.ends[aa].jQ;aw(R.prev(),1,R.innerHeight()/+R.css("fontSize").slice(0,-2)+0.1)}});var M=ar.vec=ac(aD,function(P,L){P.ctrlSeq="\\vec";P.htmlTemplate='<span class="mq-non-leaf"><span class="mq-vector-prefix">&rarr;</span><span class="mq-vector-stem">&0</span></span>';P.textTemplate=["vec(",")"]});var af=ar.nthroot=ac(aO,function(P,L){P.htmlTemplate='<sup class="mq-nthroot mq-non-leaf">&0</sup><span class="mq-scaled"><span class="mq-sqrt-prefix mq-scaled">&radic;</span><span class="mq-sqrt-stem mq-non-leaf">&1</span></span>';P.textTemplate=["sqrt[","](",")"];P.latex=function(){return"\\sqrt["+this.ends[ae].latex()+"]{"+this.ends[aa].latex()+"}"}});function z(P,L){P.jQadd=function(){L.jQadd.apply(this,arguments);this.delimjQs=this.jQ.children(":first").add(this.jQ.children(":last"));this.contentjQ=this.jQ.children(":eq(1)")};P.reflow=function(){var R=this.contentjQ.outerHeight()/parseFloat(this.contentjQ.css("fontSize"));aw(this.delimjQs,aJ(1+0.2*(R-1),1.2),1.05*R)}}var aP=ac(ac(aD,z),function(P,L){P.init=function(aR,aQ,aT,aS,R){L.init.call(this,"\\left"+aS,y,[aQ,aT]);this.side=aR;this.sides={};this.sides[ae]={ch:aQ,ctrlSeq:aS};this.sides[aa]={ch:aT,ctrlSeq:R}};P.numBlocks=function(){return 1};P.html=function(){this.htmlTemplate='<span class="mq-non-leaf"><span class="mq-scaled mq-paren'+(this.side===aa?" mq-ghost":"")+'">'+this.sides[ae].ch+'</span><span class="mq-non-leaf">&0</span><span class="mq-scaled mq-paren'+(this.side===ae?" mq-ghost":"")+'">'+this.sides[aa].ch+"</span></span>";return L.html.call(this)};P.latex=function(){return"\\left"+this.sides[ae].ctrlSeq+this.ends[ae].latex()+"\\right"+this.sides[aa].ctrlSeq};P.oppBrack=function(aQ,R){return aQ instanceof aP&&aQ.side&&aQ.side!==-R&&(this.sides[this.side].ch==="|"||aQ.side===-this.side)&&aQ};P.closeOpposing=function(R){R.side=0;R.sides[this.side]=this.sides[this.side];R.delimjQs.eq(this.side===ae?0:1).removeClass("mq-ghost").html(this.sides[this.side].ch)};P.createLeftOf=function(aR){if(!this.replacedFragment){var R=this.oppBrack(aR[ae],ae)||this.oppBrack(aR[aa],aa)||this.oppBrack(aR.parent.parent)}if(R){var aQ=this.side=-R.side;this.closeOpposing(R);if(R===aR.parent.parent&&aR[aQ]){x(aR[aQ],aR.parent.ends[aQ],-aQ).disown().withDirAdopt(-aQ,R.parent,R,R[aQ]).jQ.insDirOf(aQ,R.jQ);R.bubble("reflow")}}else{R=this,aQ=R.side;if(R.replacedFragment){R.side=0}else{if(aR[-aQ]){R.replaces(x(aR[-aQ],aR.parent.ends[-aQ],aQ));aR[-aQ]=0}}L.createLeftOf.call(R,aR)}if(aQ===ae){aR.insAtLeftEnd(R.ends[ae])}else{aR.insRightOf(R)}};P.placeCursor=at;P.unwrap=function(){this.ends[ae].children().disown().adopt(this.parent,this,this[aa]).jQ.insertAfter(this.jQ);this.remove()};P.deleteSide=function(aS,R,aV){var aU=this.parent,aR=this[aS],aT=aU.ends[aS];if(aS===this.side){this.unwrap();aR?aV.insDirOf(-aS,aR):aV.insAtDirEnd(aS,aU);return}this.side=-aS;if(this.oppBrack(this.ends[ae].ends[this.side],aS)){this.closeOpposing(this.ends[ae].ends[this.side]);var aQ=this.ends[ae].ends[aS];this.unwrap();if(aQ.siblingCreated){aQ.siblingCreated(aV.options,aS)}aR?aV.insDirOf(-aS,aR):aV.insAtDirEnd(aS,aU)}else{if(this.oppBrack(this.parent.parent,aS)){this.parent.parent.closeOpposing(this);this.parent.parent.unwrap()}else{this.sides[aS]={ch:W[this.sides[this.side].ch],ctrlSeq:W[this.sides[this.side].ctrlSeq]};this.delimjQs.removeClass("mq-ghost").eq(aS===ae?0:1).addClass("mq-ghost").html(this.sides[aS].ch)}if(aR){var aQ=this.ends[ae].ends[aS];x(aR,aT,-aS).disown().withDirAdopt(-aS,this.ends[ae],aQ,0).jQ.insAtDirEnd(aS,this.ends[ae].jQ.removeClass("mq-empty"));if(aQ.siblingCreated){aQ.siblingCreated(aV.options,aS)}aV.insDirOf(-aS,aR)}else{(R?aV.insDirOf(aS,this):aV.insAtDirEnd(aS,this.ends[ae]))}}};P.deleteTowards=function(R,aQ){this.deleteSide(-R,false,aQ)};P.finalizeTree=function(){this.ends[ae].deleteOutOf=function(R,aQ){this.parent.deleteSide(R,true,aQ)};this.finalizeTree=this.intentionalBlur=function(){this.delimjQs.eq(this.side===ae?1:0).removeClass("mq-ghost");this.side=0}};P.siblingCreated=function(aQ,R){if(R===-this.side){this.finalizeTree()}}});var W={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|"};function B(P,R){var R=R||P,aQ=W[P],L=W[R];aE[P]=aG(aP,ae,P,aQ,R,L);aE[aQ]=aG(aP,aa,P,aQ,R,L)}B("(");B("[");B("{","\\{");ar.langle=aG(aP,ae,"&lang;","&rang;","\\langle ","\\rangle ");ar.rangle=aG(aP,aa,"&lang;","&rang;","\\langle ","\\rangle ");aE["|"]=aG(aP,ae,"|","|","|","|");ar.left=ac(aD,function(L){L.parser=function(){var R=Z.regex;var P=Z.string;var aQ=Z.succeed;var aR=Z.optWhitespace;return aR.then(R(/^(?:[([|]|\\\{)/)).then(function(aT){var aS=(aT.charAt(0)==="\\"?aT.slice(1):aT);return ay.then(function(aU){return P("\\right").skip(aR).then(R(/^(?:[\])|]|\\\})/)).map(function(aV){var aX=(aV.charAt(0)==="\\"?aV.slice(1):aV);var aW=aP(0,aS,aX,aT,aV);aW.blocks=[aU];aU.adopt(aW,0,0);return aW})})})}});ar.right=ac(aD,function(L){L.parser=function(){return Z.fail("unmatched \\right")}});var i=ar.blob=ac(aD,function(L,P){L.init=function(R){P.init.call(this,"\\blob")};L.parser=function(){var aR=Z.string;var aW=Z.succeed;var aV=Z.any;var aQ=Z.fail;var aT=Z.skip;var aS=Z.regex;var R=function(aX){return aX.join("")};var aU=this;return aR("\\endBlob").or(aR("\\\\")).or(aV).then(function(aX){switch(aX){case"\\endBlob":return aQ();case"\\\\":return aW("\\");default:return aW(aX)}}).many().map(R).skip(aR("\\endBlob")).then(function(aX){aU.htmlBlob=aX;return aW(aU)})};L.html=function(){return'<span class="mq-blob" '+aH+'= "'+this.id+'" >'+this.htmlBlob+"</span>"};L.latex=function(){var R=this.htmlBlob.replace(/\\/g,"\\\\");return"\\blob"+R+"\\endBlob"};L.replaces=function(R){R.remove()};L.createBlocks=at;L.moveTowards=function(R,aQ){aQ.jQ.insDirOf(R,this.jQ);aQ[-R]=this;aQ[R]=this[R]};L.deleteTowards=function(R,aQ){aQ[R]=this.remove()[R]};L.seek=function(R,aQ){if(R-this.jQ.offset().left<this.jQ.outerWidth()/2){aQ.insLeftOf(this)}else{aQ.insRightOf(this)}};L.placeCursor=at;L.isEmpty=function(){return true}});var Y=ar.binom=ar.binomial=ac(ac(aD,z),function(P,L){P.ctrlSeq="\\binom";P.htmlTemplate='<span class="mq-non-leaf"><span class="mq-paren mq-scaled">(</span><span class="mq-non-leaf"><span class="mq-array mq-non-leaf"><span>&0</span><span>&1</span></span></span><span class="mq-paren mq-scaled">)</span></span>';P.textTemplate=["choose(",",",")"]});var o=ar.choose=ac(Y,function(L){L.createLeftOf=D.prototype.createLeftOf});var E=ac(A.MathField,function(L){L.init=function(aQ,R){aK(aQ);this.__options=C();var P=I(this,aQ,R);P.editable=true;P.createTextarea();P.editablesTextareaEvents();P.cursor.insAtRightEnd(aQ)}});ar.MathQuillMathField=ac(aD,function(P,L){P.ctrlSeq="\\MathQuillMathField";P.htmlTemplate='<span class="mq-editable-field"><span class="mq-root-block">&0</span></span>';P.parser=function(){var R=this,aQ=Z.string,aR=Z.regex,aS=Z.succeed;return aQ("[").then(aR(/^[a-z][a-z0-9]*/i)).skip(aQ("]")).map(function(aT){R.name=aT}).or(aS()).then(L.parser.call(R))};P.finalizeTree=function(){E(this.ends[ae],this.jQ)};P.registerInnerField=function(R){R.push(R[this.name]=this.ends[ae].controller.API)};P.latex=function(){return this.ends[ae].latex()};P.text=function(){return this.ends[ae].text()}})}());+function(h){var e=".dropdown-backdrop";var b='[data-toggle="dropdown"]';var a=function(i){h(i).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.1";a.prototype.toggle=function(m){var l=h(this);if(l.is(".disabled, :disabled")){return}var k=f(l);var j=k.hasClass("open");d();if(!j){if("ontouchstart" in document.documentElement&&!k.closest(".navbar-nav").length){h('<div class="dropdown-backdrop"/>').insertAfter(h(this)).on("click",d)}var i={relatedTarget:this};k.trigger(m=h.Event("show.bs.dropdown",i));if(m.isDefaultPrevented()){return}l.attr("aria-expanded","true");k.toggleClass("open").trigger("shown.bs.dropdown",i)}return false};a.prototype.keydown=function(m){if(!/(38|40|27|32)/.test(m.which)||/input|textarea/i.test(m.target.tagName)){return}var l=h(this);m.preventDefault();m.stopPropagation();if(l.is(".disabled, :disabled")){return}var k=f(l);var j=k.hasClass("open");if((!j&&m.which!=27)||(j&&m.which==27)){if(m.which==27){k.find(b).trigger("focus")}return l.trigger("click")}var n=" li:not(.divider):visible a";var o=k.find('[role="menu"]'+n+', [role="listbox"]'+n);if(!o.length){return}var i=o.index(m.target);if(m.which==38&&i>0){i--}if(m.which==40&&i<o.length-1){i++}if(!~i){i=0}o.eq(i).trigger("focus")};function d(i){if(i&&i.which===3){return}h(e).remove();h(b).each(function(){var l=h(this);var k=f(l);var j={relatedTarget:this};if(!k.hasClass("open")){return}k.trigger(i=h.Event("hide.bs.dropdown",j));if(i.isDefaultPrevented()){return}l.attr("aria-expanded","false");k.removeClass("open").trigger("hidden.bs.dropdown",j)})}function f(k){var i=k.attr("data-target");if(!i){i=k.attr("href");i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")}var j=i&&h(i);return j&&j.length?j:k.parent()}function g(i){return this.each(function(){var k=h(this);var j=k.data("bs.dropdown");if(!j){k.data("bs.dropdown",(j=new a(this)))}if(typeof i=="string"){j[i].call(k)}})}var c=h.fn.dropdown;h.fn.dropdown=g;h.fn.dropdown.Constructor=a;h.fn.dropdown.noConflict=function(){h.fn.dropdown=c;return this};h(document).on("click.bs.dropdown.data-api",d).on("click.bs.dropdown.data-api",".dropdown form",function(i){i.stopPropagation()}).on("click.bs.dropdown.data-api",b,a.prototype.toggle).on("keydown.bs.dropdown.data-api",b,a.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',a.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',a.prototype.keydown)}(jQuery);(function(){function d(p,m){var q;m=m||{};this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=m.touchBoundary||10;this.layer=p;this.tapDelay=m.tapDelay||200;this.tapTimeout=m.tapTimeout||700;if(d.notNeeded(p)){return}function r(l,i){return function(){return l.apply(i,arguments)}}var k=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"];var o=this;for(var n=0,j=k.length;n<j;n++){o[k[n]]=r(o[k[n]],o)}if(b){p.addEventListener("mouseover",this.onMouse,true);p.addEventListener("mousedown",this.onMouse,true);p.addEventListener("mouseup",this.onMouse,true)}p.addEventListener("click",this.onClick,true);p.addEventListener("touchstart",this.onTouchStart,false);p.addEventListener("touchmove",this.onTouchMove,false);p.addEventListener("touchend",this.onTouchEnd,false);p.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){p.removeEventListener=function(l,t,i){var s=Node.prototype.removeEventListener;if(l==="click"){s.call(p,l,t.hijacked||t,i)}else{s.call(p,l,t,i)}};p.addEventListener=function(s,t,l){var i=Node.prototype.addEventListener;if(s==="click"){i.call(p,s,t.hijacked||(t.hijacked=function(u){if(!u.propagationStopped){t(u)}}),l)}else{i.call(p,s,t,l)}}}if(typeof p.onclick==="function"){q=p.onclick;p.addEventListener("click",function(i){q(i)},false);p.onclick=null}}var c=navigator.userAgent.indexOf("Windows Phone")>=0;var b=navigator.userAgent.indexOf("Android")>0&&!c;var h=/iP(ad|hone|od)/.test(navigator.userAgent)&&!c;var f=h&&(/OS 4_\d(_\d)?/).test(navigator.userAgent);var g=h&&(/OS [6-7]_\d/).test(navigator.userAgent);var a=navigator.userAgent.indexOf("BB10")>0;d.prototype.needsClick=function(i){switch(i.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(i.disabled){return true}break;case"input":if((h&&i.type==="file")||i.disabled){return true}break;case"label":case"iframe":case"video":return true}return(/\bneedsclick\b/).test(i.className)};d.prototype.needsFocus=function(i){switch(i.nodeName.toLowerCase()){case"textarea":return true;case"select":return !b;case"input":switch(i.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return !i.disabled&&!i.readOnly;default:return(/\bneedsfocus\b/).test(i.className)}};d.prototype.sendClick=function(j,k){var i,l;if(document.activeElement&&document.activeElement!==j){document.activeElement.blur()}l=k.changedTouches[0];i=document.createEvent("MouseEvents");i.initMouseEvent(this.determineEventType(j),true,true,window,1,l.screenX,l.screenY,l.clientX,l.clientY,false,false,false,false,0,null);i.forwardedTouchEvent=true;j.dispatchEvent(i)};d.prototype.determineEventType=function(i){if(b&&i.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};d.prototype.focus=function(i){var j;if(h&&i.setSelectionRange&&i.type.indexOf("date")!==0&&i.type!=="time"&&i.type!=="month"){j=i.value.length;i.setSelectionRange(j,j)}else{i.focus()}};d.prototype.updateScrollParent=function(j){var k,i;k=j.fastClickScrollParent;if(!k||!k.contains(j)){i=j;do{if(i.scrollHeight>i.offsetHeight){k=i;j.fastClickScrollParent=i;break}i=i.parentElement}while(i)}if(k){k.fastClickLastScrollTop=k.scrollTop}};d.prototype.getTargetElementFromEventTarget=function(i){if(i.nodeType===Node.TEXT_NODE){return i.parentNode}return i};d.prototype.onTouchStart=function(k){var i,l,j;if(k.targetTouches.length>1){return true}i=this.getTargetElementFromEventTarget(k.target);l=k.targetTouches[0];if(h){j=window.getSelection();if(j.rangeCount&&!j.isCollapsed){return true}if(!f){if(l.identifier&&l.identifier===this.lastTouchIdentifier){k.preventDefault();return false}this.lastTouchIdentifier=l.identifier;this.updateScrollParent(i)}}this.trackingClick=true;this.trackingClickStart=k.timeStamp;this.targetElement=i;this.touchStartX=l.pageX;this.touchStartY=l.pageY;if((k.timeStamp-this.lastClickTime)<this.tapDelay){k.preventDefault()}return true};d.prototype.touchHasMoved=function(i){var k=i.changedTouches[0],j=this.touchBoundary;if(Math.abs(k.pageX-this.touchStartX)>j||Math.abs(k.pageY-this.touchStartY)>j){return true}return false};d.prototype.onTouchMove=function(i){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(i.target)||this.touchHasMoved(i)){this.trackingClick=false;this.targetElement=null}return true};d.prototype.findControl=function(i){if(i.control!==undefined){return i.control}if(i.htmlFor){return document.getElementById(i.htmlFor)}return i.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};d.prototype.onTouchEnd=function(k){var m,l,j,o,n,i=this.targetElement;if(!this.trackingClick){return true}if((k.timeStamp-this.lastClickTime)<this.tapDelay){this.cancelNextClick=true;return true}if((k.timeStamp-this.trackingClickStart)>this.tapTimeout){return true}this.cancelNextClick=false;this.lastClickTime=k.timeStamp;l=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(g){n=k.changedTouches[0];i=document.elementFromPoint(n.pageX-window.pageXOffset,n.pageY-window.pageYOffset)||i;i.fastClickScrollParent=this.targetElement.fastClickScrollParent}j=i.tagName.toLowerCase();if(j==="label"){m=this.findControl(i);if(m){this.focus(i);if(b){return false}i=m}}else{if(this.needsFocus(i)){if((k.timeStamp-l)>100||(h&&window.top!==window&&j==="input")){this.targetElement=null;return false}this.focus(i);this.sendClick(i,k);if(!h||j!=="select"){this.targetElement=null;k.preventDefault()}return false}}if(h&&!f){o=i.fastClickScrollParent;if(o&&o.fastClickLastScrollTop!==o.scrollTop){return true}}if(!this.needsClick(i)){k.preventDefault();this.sendClick(i,k)}return false};d.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};d.prototype.onMouse=function(i){if(!this.targetElement){return true}if(i.forwardedTouchEvent){return true}if(!i.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(i.stopImmediatePropagation){i.stopImmediatePropagation()}else{i.propagationStopped=true}i.stopPropagation();i.preventDefault();return false}return true};d.prototype.onClick=function(i){var j;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(i.target.type==="submit"&&i.detail===0){return true}j=this.onMouse(i);if(!j){this.targetElement=null}return j};d.prototype.destroy=function(){var i=this.layer;if(b){i.removeEventListener("mouseover",this.onMouse,true);i.removeEventListener("mousedown",this.onMouse,true);i.removeEventListener("mouseup",this.onMouse,true)}i.removeEventListener("click",this.onClick,true);i.removeEventListener("touchstart",this.onTouchStart,false);i.removeEventListener("touchmove",this.onTouchMove,false);i.removeEventListener("touchend",this.onTouchEnd,false);i.removeEventListener("touchcancel",this.onTouchCancel,false)};d.notNeeded=function(j){var i;var m;var l;var k;if(typeof window.ontouchstart==="undefined"){return true}m=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(m){if(b){i=document.querySelector("meta[name=viewport]");if(i){if(i.content.indexOf("user-scalable=no")!==-1){return true}if(m>31&&document.documentElement.scrollWidth<=window.outerWidth){return true}}}else{return true}}if(a){l=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(l[1]>=10&&l[2]>=3){i=document.querySelector("meta[name=viewport]");if(i){if(i.content.indexOf("user-scalable=no")!==-1){return true}if(document.documentElement.scrollWidth<=window.outerWidth){return true}}}}if(j.style.msTouchAction==="none"||j.style.touchAction==="manipulation"){return true}k=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(k>=27){i=document.querySelector("meta[name=viewport]");if(i&&(i.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)){return true}}if(j.style.touchAction==="none"||j.style.touchAction==="manipulation"){return true}return false};d.attach=function(j,i){return new d(j,i)};var e=window.FastClick;d.noConflict=function(){window.FastClick=e;return d};window.FastClick=d}());if(typeof JSONcanonical!=="object"){JSONcanonical={}}(function(){function d(f){return f<10?"0"+f:f}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,a,e={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},c;function b(f){i.lastIndex=0;return i.test(f)?'"'+f.replace(i,function(j){var k=e[j];return typeof k==="string"?k:"\\u"+("0000"+j.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function g(t,p){var m,l,u,j,r=h,o,s=p[t];if(s&&typeof s==="object"&&typeof s.toJSON==="function"){s=s.toJSON(t)}if(typeof c==="function"){s=c.call(p,t,s)}switch(typeof s){case"string":return b(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s){return"null"}h+=a;o=[];if(Object.prototype.toString.apply(s)==="[object Array]"){j=s.length;for(m=0;m<j;m+=1){o[m]=g(m,s)||"null"}u=o.length===0?"[]":h?"[\n"+h+o.join(",\n"+h)+"\n"+r+"]":"["+o.join(",")+"]";h=r;return u}if(c&&typeof c==="object"){j=c.length;for(m=0;m<j;m+=1){if(typeof c[m]==="string"){l=c[m];u=g(l,s);if(u){o.push(b(l)+(h?": ":":")+u)}}}}else{var q=function(A,z){var v=Number(A),k=Number(z),y=isFinite(v),x=isFinite(k);if(y&&x){return v<k?-1:(v>k?1:0)}if(y){return -1}if(x){return 1}return A<z?-1:(A>z?1:0)};var w=[],f,n;for(l in s){if(Object.prototype.hasOwnProperty.call(s,l)){w.push(l)}}w.sort(q);f=w.length;for(n=0;n<f;++n){l=w[n];u=g(l,s);if(u){o.push(b(l)+(h?": ":":")+u)}}}u=o.length===0?"{}":h?"{\n"+h+o.join(",\n"+h)+"\n"+r+"}":"{"+o.join(",")+"}";h=r;return u}}if(typeof JSONcanonical.stringify!=="function"){JSONcanonical.stringify=function(l,j,k){var f;h="";a="";if(typeof k==="number"){for(f=0;f<k;f+=1){a+=" "}}else{if(typeof k==="string"){a=k}}c=j;if(j&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number")){throw new Error("JSON.stringify")}return g("",{"":l})}}}());!function(b){if("object disable exports"==typeof exports&&"undefined"!=typeof module){module.exports=b()}else{if("function disable define"==typeof define&&define.amd){define([],b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.jsondiffpatch=b()}}}(function(){var d,b,a;return(function c(f,k,h){function g(q,n){if(!k[q]){if(!f[q]){var m=typeof require=="function"&&require;if(!n&&m){return m(q,!0)}if(e){return e(q,!0)}var p=new Error("Cannot find module '"+q+"'");throw p.code="MODULE_NOT_FOUND",p}var i=k[q]={exports:{}};f[q][0].call(i.exports,function(l){var o=f[q][1][l];return g(o?o:l)},i,i.exports,c,f,k,h)}return k[q].exports}var e=typeof require=="function"&&require;for(var j=0;j<h.length;j++){g(h[j])}return g})({1:[function(f,g,e){(function(l){var j=f("./diffpatcher").DiffPatcher;e.DiffPatcher=j,e.create=function(n){return new j(n)},e.dateReviver=f("./date-reviver");var i;if(e.diff=function(){return i||(i=new j),i.diff.apply(i,arguments)},e.patch=function(){return i||(i=new j),i.patch.apply(i,arguments)},e.unpatch=function(){return i||(i=new j),i.unpatch.apply(i,arguments)},e.reverse=function(){return i||(i=new j),i.reverse.apply(i,arguments)},l.browser){e.homepage="https://github.com/benjamine/jsondiffpatch",e.version="0.1.22"}else{var m="../package.json",h=f(m);e.homepage=h.homepage,e.version=h.version;var q="./formatters",k=f(q);e.formatters=k,e.console=k.console}}).call(this,f("_process"))},{"./date-reviver":7,"./diffpatcher":8,_process:2}],2:[function(f,g,e){function h(){}var i=g.exports={};i.nextTick=function(){var l="undefined"!=typeof window&&window.setImmediate,k="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(l){return function(m){return window.setImmediate(m)}}if(k){var j=[];return window.addEventListener("message",function(p){var m=p.source;if((m===window||null===m)&&"process-tick"===p.data&&(p.stopPropagation(),j.length>0)){var q=j.shift();q()}},!0),function(m){j.push(m),window.postMessage("process-tick","*")}}return function(m){setTimeout(m,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")}},{}],3:[function(h,i,g){var e=h("../pipe").Pipe,f=function(){};f.prototype.setResult=function(j){return this.result=j,this.hasResult=!0,this},f.prototype.exit=function(){return this.exiting=!0,this},f.prototype.switchTo=function(j,k){return"string"==typeof j||j instanceof e?this.nextPipe=j:(this.next=j,k&&(this.nextPipe=k)),this},f.prototype.push=function(j,k){return j.parent=this,"undefined"!=typeof k&&(j.childName=k),j.root=this.root||this,j.options=j.options||this.options,this.children?(this.children[this.children.length-1].next=j,this.children.push(j)):(this.children=[j],this.nextAfterChildren=this.next||null,this.next=j),j.next=this,this},g.Context=f},{"../pipe":15}],4:[function(g,h,f){var e=g("./context").Context,i=function(j,k){this.left=j,this.right=k,this.pipe="diff"};i.prototype=new e,f.DiffContext=i},{"./context":3}],5:[function(g,i,f){var e=g("./context").Context,h=function(j,k){this.left=j,this.delta=k,this.pipe="patch"};h.prototype=new e,f.PatchContext=h},{"./context":3}],6:[function(h,i,g){var f=h("./context").Context,e=function(j){this.delta=j,this.pipe="reverse"};e.prototype=new f,g.ReverseContext=e},{"./context":3}],7:[function(f,g,e){g.exports=function(j,i){var h;return"string"==typeof i&&(h=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+\-])(\d{2}):(\d{2}))$/.exec(i))?new Date(Date.UTC(+h[1],+h[2]-1,+h[3],+h[4],+h[5],+h[6],+(h[7]||0))):i}},{}],8:[function(j,i,n){var m=j("./processor").Processor,o=j("./pipe").Pipe,r=j("./contexts/diff").DiffContext,e=j("./contexts/patch").PatchContext,g=j("./contexts/reverse").ReverseContext,l=j("./filters/trivial"),p=j("./filters/nested"),h=j("./filters/arrays"),f=j("./filters/dates"),k=j("./filters/texts"),q=function(s){this.processor=new m(s),this.processor.pipe(new o("diff").append(p.collectChildrenDiffFilter,l.diffFilter,f.diffFilter,k.diffFilter,p.objectsDiffFilter,h.diffFilter).shouldHaveResult()),this.processor.pipe(new o("patch").append(p.collectChildrenPatchFilter,h.collectChildrenPatchFilter,l.patchFilter,k.patchFilter,p.patchFilter,h.patchFilter).shouldHaveResult()),this.processor.pipe(new o("reverse").append(p.collectChildrenReverseFilter,h.collectChildrenReverseFilter,l.reverseFilter,k.reverseFilter,p.reverseFilter,h.reverseFilter).shouldHaveResult())};q.prototype.options=function(){return this.processor.options.apply(this.processor,arguments)},q.prototype.diff=function(t,s){return this.processor.process(new r(t,s))},q.prototype.patch=function(t,s){return this.processor.process(new e(t,s))},q.prototype.reverse=function(s){return this.processor.process(new g(s))},q.prototype.unpatch=function(t,s){return this.patch(t,this.reverse(s))},n.DiffPatcher=q},{"./contexts/diff":4,"./contexts/patch":5,"./contexts/reverse":6,"./filters/arrays":9,"./filters/dates":10,"./filters/nested":12,"./filters/texts":13,"./filters/trivial":14,"./pipe":15,"./processor":16}],9:[function(l,k,n){var t=l("../contexts/diff").DiffContext,e=l("../contexts/patch").PatchContext,h=l("../contexts/reverse").ReverseContext,f=l("./lcs"),u=3,o="function"==typeof Array.isArray?Array.isArray:function(v){return v instanceof Array},p="function"==typeof Array.prototype.indexOf?function(w,v){return w.indexOf(v)}:function(y,x){for(var w=y.length,v=0;w>v;v++){if(y[v]===x){return v}}return -1},r=function(W){if(W.leftIsArray){for(var K,H,S,O,Z=W.options&&W.options.objectHash,Q=function(R,v,ab,C,y){var A=R[ab],ac=v[C];if(A===ac){return !0}if("object"!=typeof A||"object"!=typeof ac){return !1}if(!Z){return !1}var x,F;return"number"==typeof ab?(y.hashCache1=y.hashCache1||[],x=y.hashCache1[ab],"undefined"==typeof x&&(y.hashCache1[ab]=x=Z(A,ab))):x=Z(A),"undefined"==typeof x?!1:("number"==typeof C?(y.hashCache2=y.hashCache2||[],F=y.hashCache2[C],"undefined"==typeof F&&(y.hashCache2[C]=F=Z(ac,C))):F=Z(ac),"undefined"==typeof F?!1:x===F)},I={},N=0,V=0,Y=W.left,T=W.right,X=Y.length,G=T.length;X>N&&G>N&&Q(Y,T,N,N,I);){K=N,O=new t(W.left[K],W.right[K]),W.push(O,K),N++}for(;X>V+N&&G>V+N&&Q(Y,T,X-1-V,G-1-V,I);){H=X-1-V,S=G-1-V,O=new t(W.left[H],W.right[S]),W.push(O,S),V++}var D;if(N+V===X){if(X===G){return void W.setResult(void 0).exit()}for(D=D||{_t:"a"},K=N;G-V>K;K++){D[K]=[T[K]]}return void W.setResult(D).exit()}if(N+V===G){for(D=D||{_t:"a"},K=N;X-V>K;K++){D["_"+K]=[Y[K],0,0]}return void W.setResult(D).exit()}I={};var M=Y.slice(N,X-V),z=T.slice(N,G-V),B=f.get(M,z,Q,I),J=[];for(D=D||{_t:"a"},K=N;X-V>K;K++){p(B.indices1,K-N)<0&&(D["_"+K]=[Y[K],0,0],J.push(K))}var w=!0;W.options&&W.options.arrays&&W.options.arrays.detectMove===!1&&(w=!1);var L=!1;W.options&&W.options.arrays&&W.options.arrays.includeValueOnMove&&(L=!0);var aa=J.length;for(K=N;G-V>K;K++){var P=p(B.indices2,K-N);if(0>P){var E=!1;if(w&&aa>0){for(var U=0;aa>U;U++){if(H=J[U],Q(M,z,H-N,K-N,I)){D["_"+H].splice(1,2,K,u),L||(D["_"+H][0]=""),S=K,O=new t(W.left[H],W.right[S]),W.push(O,S),J.splice(U,1),E=!0;break}}}E||(D[K]=[T[K]])}else{H=B.indices1[P]+N,S=B.indices2[P]+N,O=new t(W.left[H],W.right[S]),W.push(O,S)}}W.setResult(D).exit()}};r.filterName="arrays";var i={numerically:function(w,v){return w-v},numericallyBy:function(v){return function(x,w){return x[v]-w[v]}}},q=function(D){if(D.nested&&"a"===D.delta._t){var w,J,A=D.delta,y=D.left,G=[],z=[],K=[];for(w in A){if("_t"!==w){if("_"===w[0]){if(0!==A[w][2]&&A[w][2]!==u){throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+A[w][2])}G.push(parseInt(w.slice(1),10))}else{1===A[w].length?z.push({index:parseInt(w,10),value:A[w][0]}):K.push({index:parseInt(w,10),delta:A[w]})}}}for(G=G.sort(i.numerically),w=G.length-1;w>=0;w--){J=G[w];var x=A["_"+J],C=y.splice(J,1)[0];x[2]===u&&z.push({index:x[1],value:C})}z=z.sort(i.numericallyBy("index"));var F=z.length;for(w=0;F>w;w++){var B=z[w];y.splice(B.index,0,B.value)}var E,I=K.length;if(I>0){for(w=0;I>w;w++){var H=K[w];E=new e(D.left[H.index],H.delta),D.push(E,H.index)}}return D.children?void D.exit():void D.setResult(D.left).exit()}};q.filterName="arrays";var s=function(y){if(y&&y.children&&"a"===y.delta._t){for(var x,w=y.children.length,v=0;w>v;v++){x=y.children[v],y.left[x.childName]=x.result}y.setResult(y.left).exit()}};s.filterName="arraysCollectChildren";var j=function(x){if(!x.nested){return void (x.delta[2]===u&&(x.newName="_"+x.delta[1],x.setResult([x.delta[0],parseInt(x.childName.substr(1),10),u]).exit()))}if("a"===x.delta._t){var w,v;for(w in x.delta){"_t"!==w&&(v=new h(x.delta[w]),x.push(v,w))}x.exit()}};j.filterName="arrays";var g=function(A,z,y){var x=z;if("string"==typeof z&&"_"===z[0]){x=parseInt(z.substr(1),10)}else{var B="_"+z;if(o(y)&&0===y[2]){x=B}else{for(var w in A){var v=A[w];o(v)&&v[2]===u&&v[1].toString()===z&&(x=w.substr(1))}}}return x},m=function(z){if(z&&z.children&&"a"===z.delta._t){for(var y,x=z.children.length,w={_t:"a"},A=0;x>A;A++){y=z.children[A];var v=y.newName;"undefined"==typeof v&&(v=g(z.delta,y.childName,y.result)),w[v]!==y.result&&(w[v]=y.result)}z.setResult(w).exit()}};m.filterName="arraysCollectChildren",n.diffFilter=r,n.patchFilter=q,n.collectChildrenPatchFilter=s,n.reverseFilter=j,n.collectChildrenReverseFilter=m},{"../contexts/diff":4,"../contexts/patch":5,"../contexts/reverse":6,"./lcs":11}],10:[function(f,g,e){var h=function(i){i.left instanceof Date?(i.setResult(i.right instanceof Date?i.left.getTime()!==i.right.getTime()?[i.left,i.right]:void 0:[i.left,i.right]),i.exit()):i.right instanceof Date&&i.setResult([i.left,i.right]).exit()};h.filterName="dates",e.diffFilter=h},{}],11:[function(g,h,e){var k=function(l,o,p,m){return l[p]===o[m]},j=function(x,q,m,l){var s,v,o=x.length,w=q.length,p=[o+1];for(s=0;o+1>s;s++){for(p[s]=[w+1],v=0;w+1>v;v++){p[s][v]=0}}for(p.match=m,s=1;o+1>s;s++){for(v=1;w+1>v;v++){p[s][v]=m(x,q,s-1,v-1,l)?p[s-1][v-1]+1:Math.max(p[s-1][v],p[s][v-1])}}return p},i=function(o,q,u,p,s,l){if(0===p||0===s){return{sequence:[],indices1:[],indices2:[]}}if(o.match(q,u,p-1,s-1,l)){var m=i(o,q,u,p-1,s-1,l);return m.sequence.push(q[p-1]),m.indices1.push(p-1),m.indices2.push(s-1),m}return o[p][s-1]>o[p-1][s]?i(o,q,u,p,s-1,l):i(o,q,u,p-1,s,l)},f=function(m,p,s,o){o=o||{};var q=j(m,p,s||k,o),l=i(q,m,p,m.length,p.length,o);return"string"==typeof m&&"string"==typeof p&&(l.sequence=l.sequence.join("")),l};e.get=f},{}],12:[function(i,h,l){var p=i("../contexts/diff").DiffContext,e=i("../contexts/patch").PatchContext,f=i("../contexts/reverse").ReverseContext,j=function(w){if(w&&w.children){for(var u,q=w.children.length,v=w.result,s=0;q>s;s++){u=w.children[s],"undefined"!=typeof u.result&&(v=v||{},v[u.childName]=u.result)}v&&w.leftIsArray&&(v._t="a"),w.setResult(v).exit()}};j.filterName="collectChildren";var n=function(s){if(!s.leftIsArray&&"object"===s.leftType){var r,q;for(r in s.left){q=new p(s.left[r],s.right[r]),s.push(q,r)}for(r in s.right){"undefined"==typeof s.left[r]&&(q=new p(void 0,s.right[r]),s.push(q,r))}return s.children&&0!==s.children.length?void s.exit():void s.setResult(void 0).exit()}};n.filterName="objects";var m=function(s){if(s.nested&&!s.delta._t){var r,q;for(r in s.delta){q=new e(s.left[r],s.delta[r]),s.push(q,r)}s.exit()}};m.filterName="objects";var o=function(v){if(v&&v.children&&!v.delta._t){for(var s,q=v.children.length,u=0;q>u;u++){s=v.children[u],v.left.hasOwnProperty(s.childName)&&void 0===s.result?delete v.left[s.childName]:v.left[s.childName]!==s.result&&(v.left[s.childName]=s.result)}v.setResult(v.left).exit()}};o.filterName="collectChildren";var g=function(s){if(s.nested&&!s.delta._t){var r,q;for(r in s.delta){q=new f(s.delta[r]),s.push(q,r)}s.exit()}};g.filterName="objects";var k=function(w){if(w&&w.children&&!w.delta._t){for(var u,q=w.children.length,v={},s=0;q>s;s++){u=w.children[s],v[u.childName]!==u.result&&(v[u.childName]=u.result)}w.setResult(v).exit()}};k.filterName="collectChildren",l.collectChildrenDiffFilter=j,l.objectsDiffFilter=n,l.patchFilter=m,l.collectChildrenPatchFilter=o,l.reverseFilter=g,l.collectChildrenReverseFilter=k},{"../contexts/diff":4,"../contexts/patch":5,"../contexts/reverse":6}],13:[function(j,h,k){var o=2,l=60,f=null,i=function(){if(!f){var q;if("undefined"!=typeof diff_match_patch){q="function"==typeof diff_match_patch?new diff_match_patch:new diff_match_patch.diff_match_patch}else{if("function"==typeof j){try{var v="diff_match_patch_uncompressed",u=j("../../public/external/"+v);q=new u.diff_match_patch}catch(p){q=null}}}if(!q){var s=new Error("text diff_match_patch library not found");throw s.diff_match_patch_not_found=!0,s}f={diff:function(t,r){return q.patch_toText(q.patch_make(t,r))},patch:function(z,y){for(var w=q.patch_apply(q.patch_fromText(y),z),x=0;x<w[1].length;x++){if(!w[1][x]){var t=new Error("text patch failed");t.textPatchFailed=!0}}return w[0]}}}return f},n=function(p){if("string"===p.leftType){var r=p.options&&p.options.textDiff&&p.options.textDiff.minLength||l;if(p.left.length<r||p.right.length<r){return void p.setResult([p.left,p.right]).exit()}var q=i().diff;p.setResult([q(p.left,p.right),0,o]).exit()}};n.filterName="texts";var m=function(p){if(!p.nested&&p.delta[2]===o){var q=i().patch;p.setResult(q(p.left,p.delta[0])).exit()}};m.filterName="texts";var e=function(C){var y,x,v,p,B,A,u,s,w=null,z=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;for(v=C.split("\n"),y=0,x=v.length;x>y;y++){p=v[y];var q=p.slice(0,1);"@"===q?(w=z.exec(p),A=y,u=null,s=null,v[A]="@@ -"+w[3]+","+w[4]+" +"+w[1]+","+w[2]+" @@"):"+"===q?(u=y,v[y]="-"+v[y].slice(1),"+"===v[y-1].slice(0,1)&&(B=v[y],v[y]=v[y-1],v[y-1]=B)):"-"===q&&(s=y,v[y]="+"+v[y].slice(1))}return v.join("\n")},g=function(p){p.nested||p.delta[2]===o&&p.setResult([e(p.delta[0]),0,o]).exit()};g.filterName="texts",k.diffFilter=n,k.patchFilter=m,k.reverseFilter=g},{}],14:[function(g,h,f){var e="function"==typeof Array.isArray?Array.isArray:function(l){return l instanceof Array},k=function(l){if(l.left===l.right){return void l.setResult(void 0).exit()}if("undefined"==typeof l.left){if("function"==typeof l.right){throw new Error("functions are not supported")}return void l.setResult([l.right]).exit()}if("undefined"==typeof l.right){return void l.setResult([l.left,0,0]).exit()}if("function"==typeof l.left||"function"==typeof l.right){throw new Error("functions are not supported")}return l.leftType=null===l.left?"null":typeof l.left,l.rightType=null===l.right?"null":typeof l.right,l.leftType!==l.rightType?void l.setResult([l.left,l.right]).exit():"boolean"===l.leftType||"number"===l.leftType?void l.setResult([l.left,l.right]).exit():("object"===l.leftType&&(l.leftIsArray=e(l.left)),"object"===l.rightType&&(l.rightIsArray=e(l.right)),l.leftIsArray!==l.rightIsArray?void l.setResult([l.left,l.right]).exit():void 0)};k.filterName="trivial";var i=function(l){return"undefined"==typeof l.delta?void l.setResult(l.left).exit():(l.nested=!e(l.delta),l.nested?void 0:1===l.delta.length?void l.setResult(l.delta[0]).exit():2===l.delta.length?void l.setResult(l.delta[1]).exit():3===l.delta.length&&0===l.delta[2]?void l.setResult(void 0).exit():void 0)};i.filterName="trivial";var j=function(l){return"undefined"==typeof l.delta?void l.setResult(l.delta).exit():(l.nested=!e(l.delta),l.nested?void 0:1===l.delta.length?void l.setResult([l.delta[0],0,0]).exit():2===l.delta.length?void l.setResult([l.delta[1],l.delta[0]]).exit():3===l.delta.length&&0===l.delta[2]?void l.setResult([l.delta[0]]).exit():void 0)};j.filterName="trivial",f.diffFilter=k,f.patchFilter=i,f.reverseFilter=j},{}],15:[function(g,h,f){var e=function(i){this.name=i,this.filters=[]};e.prototype.process=function(k){if(!this.processor){throw new Error("add this pipe to a processor before using it")}for(var n=this.debug,m=this.filters.length,j=k,l=0;m>l;l++){var p=this.filters[l];if(n&&this.log("filter: "+p.filterName),p(j),"object"==typeof j&&j.exiting){j.exiting=!1;break}}!j.next&&this.resultCheck&&this.resultCheck(j)},e.prototype.log=function(i){console.log("[jsondiffpatch] "+this.name+" pipe, "+i)},e.prototype.append=function(){return this.filters.push.apply(this.filters,arguments),this},e.prototype.prepend=function(){return this.filters.unshift.apply(this.filters,arguments),this},e.prototype.indexOf=function(i){if(!i){throw new Error("a filter name is required")}for(var k=0;k<this.filters.length;k++){var j=this.filters[k];if(j.filterName===i){return k}}throw new Error("filter not found: "+i)},e.prototype.list=function(){for(var i=[],k=0;k<this.filters.length;k++){var j=this.filters[k];i.push(j.filterName)}return i},e.prototype.after=function(i){var k=this.indexOf(i),j=Array.prototype.slice.call(arguments,1);if(!j.length){throw new Error("a filter is required")}return j.unshift(k+1,0),Array.prototype.splice.apply(this.filters,j),this},e.prototype.before=function(i){var k=this.indexOf(i),j=Array.prototype.slice.call(arguments,1);if(!j.length){throw new Error("a filter is required")}return j.unshift(k,0),Array.prototype.splice.apply(this.filters,j),this},e.prototype.clear=function(){return this.filters.length=0,this},e.prototype.shouldHaveResult=function(i){if(i===!1){return void (this.resultCheck=null)}if(!this.resultCheck){var j=this;return this.resultCheck=function(k){if(!k.hasResult){console.log(k);var l=new Error(j.name+" failed");throw l.noResult=!0,l}},this}},f.Pipe=e},{}],16:[function(f,g,e){var h=function(i){this.selfOptions=i,this.pipes={}};h.prototype.options=function(i){return i&&(this.selfOptions=i),this.selfOptions},h.prototype.pipe=function(j,i){if("string"==typeof j){if("undefined"==typeof i){return this.pipes[j]}this.pipes[j]=i}if(j&&j.name){if(i=j,i.processor===this){return i}this.pipes[i.name]=i}return i.processor=this,i},h.prototype.process=function(n,k){var l=n;l.options=this.options();for(var m,p,j=k||n.pipe||"default";j;){"undefined"!=typeof l.nextAfterChildren&&(l.next=l.nextAfterChildren,l.nextAfterChildren=null),"string"==typeof j&&(j=this.pipe(j)),j.process(l),p=l,m=j,j=null,l&&l.next&&(l=l.next,j=p.nextPipe||l.pipe||m)}return l.hasResult?l.result:void 0},e.Processor=h},{}]},{},[1])(1)});var hexcase=0;var b64pad="";function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function b64_md5(a){return rstr2b64(rstr_md5(str2rstr_utf8(a)))}function any_md5(a,b){return rstr2any(rstr_md5(str2rstr_utf8(a)),b)}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_md5(a,b){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_md5(a,c,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function md5_vm_test(){return hex_md5("abc").toLowerCase()==="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr_hmac_md5(c,f){var e=rstr2binl(c);if(e.length>16){e=binl_md5(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binl_md5(a.concat(rstr2binl(f)),512+f.length*8);return binl2rstr(binl_md5(d.concat(g),512+128))}function rstr2hex(c){var e=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=e.charAt((a>>>4)&15)+e.charAt(a&15)}return b}function rstr2b64(c){b64pad=b64pad||"";var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var e=0;e<a;e+=3){var g=(c.charCodeAt(e)<<16)|(e+1<a?c.charCodeAt(e+1)<<8:0)|(e+2<a?c.charCodeAt(e+2):0);for(var d=0;d<4;d++){if(e*8+d*6>c.length*8){b+=b64pad}else{b+=f.charAt((g>>>6*(3-d))&63)}}}return b}function rstr2any(m,c){var b=c.length;var l,f,a,n,e;var k=Array(Math.ceil(m.length/2));for(l=0;l<k.length;l++){k[l]=(m.charCodeAt(l*2)<<8)|m.charCodeAt(l*2+1)}var h=Math.ceil(m.length*8/(Math.log(c.length)/Math.log(2)));var g=Array(h);for(f=0;f<h;f++){e=Array();n=0;for(l=0;l<k.length;l++){n=(n<<16)+k[l];a=Math.floor(n/b);n-=a*b;if(e.length>0||a>0){e[e.length]=a}}g[f]=n;k=e}var d="";for(l=g.length-1;l>=0;l--){d+=c.charAt(g[l])}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binl(b){var a=Array(b.length>>2);var c;for(c=0;c<a.length;c++){a[c]=0}for(c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a}function binl2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(h,e,d,c,g,f){return safe_add(bit_rol(safe_add(safe_add(e,h),safe_add(c,f)),g),d)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))}
/*!
  Web Sketchpad. Copyright &copy; 2015 KCP Technologies, a McGraw-Hill Education Company. All rights reserved. 
  Version: Release: 2015Q1, Semantic Version: 4.1.0, Build Number: 832.19-r, Build Stamp: dn.kcptech.com/20150326110202

  Web Sketchpad uses FastClick, By the Financial Times, which includes this license:

  Copyright (c) 2014 The Financial Times Ltd.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation
  files (the "Software"), to deal in the Software without
  restriction, including without limitation the rights to use,
  copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the
  Software is furnished to do so, subject to the following
  conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
  HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
  OTHER DEALINGS IN THE SOFTWARE.

*/
(function(a){(function(){function b(c){if(a.event.props.indexOf(c)===-1){a.event.props.push(c)}}b("touches");b("targetTouches");b("changedTouches")})();a.fn.mousetouch=function(c){var b={};return this.each(function(){var d=a(this);if(c){a.extend(b,c)}d.css("-webkit-user-select","none");d.css("-webkit-touch-callout","none");d.css("-webkit-tap-highlight-color","rgba(0,0,0,0)");d.css("-ms-touch-action","none");d.bind("MSGestureHold",function(){return false});d.bind("contextmenu",function(){return false});d.bind("mousedown.mousetouch-mousedown",function(f){var g=function(k){var i="touchmove",h;if(!k.which&&k.button){if(k.button&1){k.which=1}else{if(k.button&4){k.which=2}else{if(k.button&2){k.which=3}}}}if(k.which>1){return false}if(k.type==="mousedown"){i="touchstart"}else{if(k.type==="mouseup"){i="touchend"}}h=a.Event(i);var j=[{identifier:"mouse0",target:k.target,clientX:k.clientX,clientY:k.clientY,screenX:k.screenX,screenY:k.screenY,pageX:k.pageX,pageY:k.pageY,mouseEvent:k}];h.touches=(i==="touchend")?[]:j;h.targetTouches=h.touches;h.changedTouches=j;d.trigger(h);return !h.isDefaultPrevented()};a(document).bind("mouseup.mousetouch mousemove.mousetouch",function(h){if(h.type==="mouseup"){a(document).unbind(".mousetouch")}return g(h)});return g(f)})})}}(jQuery));(function(e){var k,b;var a,c,f,j,i,h,d;var g;if(window.convertPointFromPageToNode){k=function(m,l){var n=window.convertPointFromPageToNode(this.get(0),new Point(m,l));return{x:n.x,y:n.y}}}if(!k){a=function(u,t){var r=u.length,q=u[0].length,p=t[0].length,o,m,l,n,s=[];for(o=0;o<r;o++){s[o]=[]}for(o=0;o<r;o++){for(m=0;m<p;m++){n=0;for(l=0;l<q;l++){n+=u[o][l]*t[l][m]}s[o][m]=n}}return s};c=function(l,n){var o,p=[];for(o=0;o<l.length;o++){p[o]=l[o].slice(0);p[o][l[o].length-1]+=+n[o]||0}return p};f=function(p){p=p.match(/matrix3?d?\(([^\)]+)\)/i)[1].split(",");if(p.length===6){p=[p[0],p[1],0,0,p[2],p[3],0,0,0,0,1,0,p[4],p[5],0,1]}var o,n,l=[];for(o=0;o<4;o++){for(n=0;n<4;n++){l[o]=l[o]||[];l[o][n]=parseFloat(p[n*4+o])}}return l};j=function(m,p){var o=m.outerWidth(false),l=m.outerHeight(false),n=a(p,[[0,o,0,o],[0,0,l,0,l],[0,0,0,0],[1,1,1,1]]);return{left:Math.min.apply(Math,n[0]),top:Math.min.apply(Math,n[1]),right:Math.max.apply(Math,n[0]),bottom:Math.max.apply(Math,n[1])}};g=f("matrix(1,0,0,1,0,0)");i=function(n){var o=window.getComputedStyle?window.getComputedStyle(n,null)||{}:{},m,l,p=1;function q(u){var t=1,s;if(typeof(u)==="number"){return u}if(u!==undefined&&u!==""&&u!=="normal"){s=u.match(/(\d+|\d+\.\d*)(%?)$/);if(s){t=parseFloat(s[1],10);if(s[2]==="%"){t/=100}}}return t}function r(t){var s=(t.currentStyle&&t.currentStyle.getAttribute)?t.currentStyle.getAttribute("zoom"):undefined;return q(s)}m=(o.msTransform||o.MozTransform||o.OTransform||o.WebkitTransform||"none");p=r(n);if("none"===m){m="matrix(1,0,0,1,0,0)"}l=o.msTransformOrigin||o.MozTransformOrigin||o.OTransformOrigin||o.WebkitTransformOrigin||"";l=l.indexOf("%")!==-1?"":l;l=l.replace(/px/g,"");return{origin:l,transform:m,zoom:p}};d=function(n){var m,l,p,o,q;p=i(n);if(null===p){return null}m=f(p.transform);l=p.origin;l=f("matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+((l||"0 0")+" 0").split(" ").slice(0,3)+",1)");l[0][0]*=p.zoom;l[1][1]*=p.zoom;o=c(g,[-l[0][3],-l[1][3],-l[2][3]]);q=a(a(l,m),o);return q};h=function(m){var l=g,o,p;function n(q){var v=q.offset(),s=q[0],u=s.ownerDocument,t,r;if(u&&u.documentElement.msContentZoomFactor&&u.documentElement.msContentZoomFactor!==1){t=u.defaultView;v.left-=t.pageXOffset;v.top-=t.pageYOffset;r=e("html");v.left+=r.scrollLeft();v.top+=r.scrollTop()}return v}m.parents().each(function(){var q=d(this);if(null!==q){l=a(q,l)}});o=j(m,l);p=n(m);l=c(l,[p.left-o.left,p.top-o.top,0]);return l};k=function(n,m){var l=h(this);return{x:((n-l[0][3])*l[1][1]-(m-l[1][3])*l[0][1])/(l[0][0]*l[1][1]-l[0][1]*l[1][0]),y:(l[0][0]*(m-l[1][3])-l[1][0]*(n-l[0][3]))/(l[0][0]*l[1][1]-l[0][1]*l[1][0])}};b=function(l,o){var n=h(this);var m={x:l*n[0][0]+o*n[0][1]+n[0][3],y:l*n[1][0]+o*n[1][1]+n[1][3]};return m}}e.fn.convertPointFromPage=k;e.fn.convertPageFromPoint=b}(jQuery));if(typeof Object.create!=="function"){Object.create=function(b){var a=function(){};a.prototype=b;return new a()}}(function(l,g,h){var r=l.document,a=l.location,b=l.navigator,C=l.GSP;var y=(function(){function G(I,N,J,L){var M=N[J],K=typeof(M);if(K==="object"){if(!I[J]){I[J]=g.isArray(M)?[]:{}}g.extend(true,I[J],M)}else{if(K==="function"){if(L){L[J]=M}}else{I[J]=M}}}function E(M,L){var J,I,N,K={};for(I=0;I<M.length;I++){N=M[I];if(!N){throw y.createError("copyData() from undefined source!")}for(J in N){G(K,N,J,L)}}return K}function D(J,I){var L={},K=[];J.forEach(function(M){L[M]=true});I.forEach(function(M){L[M]=true});y.eachKeyValue(L,function(M){K.push(M)});return K}function F(K,J){var L={},I=[];K.forEach(function(M){L[M]=true});J.forEach(function(M){if(L[M]!==h){delete L[M]}});y.eachKeyValue(L,function(M){I.push(M)});return I}return{version:{number:"4.1.0",major:"4",minor:"1",patch:"0",build:"832.19-r",release:"2015Q1"},kNormalSpeedRate:3,kIdealFrameRate:60,kWebSpeedMultiplier:0.5,gOptions:{"debug-geom-bounds":false,"graphics-engine":"standard","label-engine":"canvas",instantiateUnsupportedObjects:false,perfTestMode:false},gObjects:{},mixins:{},gConstraints:{},genera:{},signal:function(I){if(I.localize&&I.message){I.message=y.Strings.loc(I.message)}else{if(I.code&&!I.message){I.message=y.Strings.loc(I.code)}}g(r).trigger("gLog",I);return I},log:function(J){if(J.indexOf("%@")>=0){var I=Array.prototype.slice.call(arguments,1);J=y.Strings.format(J,I)}return y.signal({code:"GSP.Debug.log",message:J,logType:"debug"})},logPerf:function(I){return y.signal({code:"GSP.Debug.log",message:I,logType:"perf"})},caseData:function(K,I,J){return y.signal({message:I,logType:"data",gobj:K,data:J})},makeClass:function(P,O){var K,N,J,R,T,Q,U,M={};if(!P){if(console){console.log("makeClass with undefined baseClass")}P={}}if(!g.isArray(P)){P=[P]}function V(X){var aa,Z,Y=[];for(aa=0;aa<X.length;++aa){Z=X[aa];if(Z.baseKinds){Y=D(Y,Z.baseKinds)}if(Z.kind){Y=D(Y,[Z.kind])}}return Y}function I(Y){var aa,Z,X=[];for(aa=0;aa<Y.length;++aa){Z=Y[aa];if(Z.baseGenera){X=D(X,Z.baseGenera)}if(Z.genus){X=D(X,[Z.genus])}}return X}function S(Y){var X=[],ab,aa,Z,ac;for(ab=0;ab<Y.length;++ab){aa=Y[ab];Z=aa&&aa.doc&&aa.doc.usage;ac=Z&&Z.kinds;if(ac){X=D(X,ac)}}return X}function W(X,Y){var Z=[],aa=Y&&Y.doc&&Y.doc.usage;if(aa&&aa.kinds){return g.merge([],aa.kinds)}Z=S(X);if(aa&&aa.addKinds){return D(Z,aa.addKinds)}if(aa&&aa.subKinds){return F(Z,aa.subKinds)}return Z}T=V(P);U=I(P);Q=W(P,O);R=E(P,M);g.extend(true,R,O);if(T&&T.length){R.baseKinds=T}if(U&&U.length){R.baseGenera=U}if(R.doc&&R.doc.usage&&Q.length){R.doc.usage.kinds=Q}function L(Y){var X,Z=0;for(X=0;X<P.length;X++){if(h!==P[X][Y]){Z++}}return Z}for(K in M){J=L(K);if(h!==O[K]){R[K]=O[K];if(1===J){R[K].base=M[K]}else{R[K].base={};for(N=0;N<P.length;N++){R[K].base[N]=P[N][K]}}}else{if(J>1){throw y.createError("Ambiguous multiple inheritance for "+K)}R[K]=M[K]}}return R},makeInstance:function H(N,J,L){var I=Object.create(N),K,M={};for(K in N){if(!L||!L[K]){G(M,N,K)}}g.extend(true,M,J);for(K in M){I[K]=M[K]}return I},stringify:function(J,I){if(l.JSON&&l.JSON.stringify){return l.JSON.stringify(J,I)}return"JSON.stringify not supported"},eachKeyValue:function(K,L){var I,J;for(I in K){J=L.call(K[I],I,K[I]);if(J===false){break}}}}}());y.ConfigDefaults={NumberpadManager:{delegates:{registerElement:function(D){D.WSP_NumberpadManager(g("body"))},registerCalculatorElement:function(D){D.WSP_NumberpadManager(g("body"))},blurAllNumberpads:function(D){D.WSP_NumberpadManager.blurNumpads()}},options:{keyOrder:[["1","2","3"],["4","5","6"],["7","8","9"],["dot","0","negative"],["star","","backspace"]],keyOrderCalculator:[["1","2","3","plus","lparen"],["4","5","6","minus","rparen"],["7","8","9","star","exponent"],["dot","0","clear","slash","backspace"]]}}};y.getConfigValue=function(E){if(typeof E==="string"){E=E.split(".")}function F(G){for(var H=0;H<E.length;H++){if(G&&typeof G==="object"){G=G[E[H]]}else{return{found:false}}}return{found:true,value:G}}var D=F(l.GSPConfig);if(D.found){return D.value}else{return F(y.ConfigDefaults).value}};jQuery.fn.WSP_NumberpadManager=(function(I){var T,D,V=[],U=0,O={"8":"backspace","9":"tab","13":"submit","27":"esc","32":"space","33":"pageup","34":"pagedown","35":"end","36":"home","37":"left","37-S":"selectleft","38":"up","39":"right","39-S":"selectright","40":"down","45":"insert","46":"delete","48":"0","48-S":"rparen","49":"1","50":"2","51":"3","52":"4","53":"5","54":"6","54-S":"exponent","55":"7","56":"8","56-S":"star","57":"9","57-S":"lparen","61-S":"plus","80":"pi","82":"r","84":"t","88":"x","89":"y","96":"0","97":"1","98":"2","99":"3","100":"4","101":"5","102":"6","103":"7","104":"8","105":"9","106":"star","107":"plus","108":"submit","109":"minus","110":"dot","111":"slash","173":"minus","187-S":"plus","188":"comma","188-S":"lessthan","189":"minus","190":"dot","190-S":"greaterthan","191":"slash"};var M=l.MathQuill.noConflict();var S=l.FastClick.noConflict();function P(aa){var ac=aa.altKey?"-A":"",Y=aa.ctrlKey?"-C":"",ab=aa.metaKey?"-M":"",X=aa.shiftKey?"-S":"",Z=String(aa.which);return[Z,ac,Y,ab,X].join("")}function K(X){I.each(V,function(){if(!X||!(this.isModalController)){this.vBlur()}})}function E(){K();I.each(V,function(){if(this.numpad){I(this.numpad.numpadEl).remove();this.numpad=null}});U=0}function Q(){var X=null;I.each(V,function(){var Y=this;if(Y.hasVFocus){X=Y;return}});return X}T=(function(){function X(ab,aa){return ab<=aa?ab:aa}function Z(ab,aa){return ab>aa?ab:aa}function Y(aa,ab){this.textNode=aa;this.text=I(aa).text()||"";this.gobj=ab;this.cursor=0;this.rangeEnd=this.cursor;this.collapsed=(this.cursor===this.rangeEnd);this.startWidth=I(aa).width()}Y.prototype.adjustFieldWidth=function(aa){if(!aa){var ad=this.getTextWidth(),ab=I(this.textNode).width(),ac=Math.max(ad+1,this.startWidth);if(ab!==ac){I(this.textNode).width(ac)}}else{I(this.textNode).width("auto")}};Y.prototype.setCursor=function(aa){this.cursor=aa;this.rangeEnd=aa;this.collapsed=true;this.render()};Y.prototype.unsetCursor=function(){this.cursor=h;this.rangeEnd=h;this.collapsed=h;this.render()};Y.prototype.getTextWidth=function(){var aa=I(".wsp-numfield-text",this.textNode).width();return aa};Y.prototype.toString=function(){return"text/cursor/rangeEnd/collapsed = "+[this.text,this.cursor,this.rangeEnd,this.collapsed].join("/")};Y.prototype.render=function(){function ab(ae){var ai=X(this.cursor,this.rangeEnd),af=Z(this.cursor,this.rangeEnd),aj=this.text.substring(0,ai),ad=this.text.substring(ai,af),ac=this.text.substring(af),ah=I("<span>"),ag=I("<span>").addClass("wsp-numfield-text");if(this.collapsed){ah.addClass("wsp-blink").html("&#124;")}else{ah.addClass("wsp-selected").text(ad)}if(aj){ag.append(aj)}ag.append(ah);if(ac){ag.append(ac)}ag.appendTo(ae)}var aa=I(this.textNode);aa.empty();if(this.cursor!==h&&this.cursor>=0&&this.cursor<=this.text.length){ab.call(this,aa);this.adjustFieldWidth(false)}else{I("<span>").addClass("wsp-numfield-text").html(this.text).appendTo(aa);this.adjustFieldWidth(true)}};Y.prototype.moveLeft=function(ab){var aa=ab||1;if(!this.collapsed){this.collapseToStart()}else{this.cursor=Math.max(0,this.cursor-aa);this.rangeEnd=this.cursor}this.render()};Y.prototype.moveRight=function(ab){var aa=ab||1;if(!this.collapsed){this.collapseToEnd()}else{this.cursor=Math.min(this.text.length,this.cursor+aa);this.rangeEnd=this.cursor}this.render()};Y.prototype.selectAll=function(){this.rangeEnd=0;this.cursor=this.text.length;this.collapsed=(this.cursor===this.rangeEnd);this.render()};Y.prototype.selectLeft=function(ab){var aa=ab||1;this.rangeEnd=Math.max(0,this.rangeEnd-aa);this.collapsed=(this.cursor===this.rangeEnd);this.render()};Y.prototype.selectRight=function(ab){var aa=ab||1;this.rangeEnd=Math.min(this.text.length,this.rangeEnd+aa);this.collapsed=(this.cursor===this.rangeEnd);this.render()};Y.prototype.collapse=function(ab){var aa=ab||this.text.length;this.cursor=aa;this.rangeEnd=aa;this.collapsed=true;this.render()};Y.prototype.collapseToStart=function(){this.cursor=X(this.cursor,this.rangeEnd);this.rangeEnd=this.cursor;this.collapsed=true;this.render()};Y.prototype.collapseToEnd=function(){this.cursor=Z(this.cursor,this.rangeEnd);this.rangeEnd=this.cursor;this.collapsed=true;this.render()};Y.prototype.deleteAtCursor=function(ab){var aa=ab||1;if(this.collapsed){this.selectLeft(aa)}this.insertAtCursor("")};Y.prototype.deleteRight=function(ab){var aa=ab||1;if(this.collapsed){this.selectRight(aa)}this.insertAtCursor("")};Y.prototype.insertAtCursor=function(aa){var ae=this.text,ad=X(this.cursor,this.rangeEnd),ab=Z(this.cursor,this.rangeEnd),ac=[];if(ad>0){ac.push(ae.substring(0,ad))}ac.push(aa);if(ab<ae.length){ac.push(ae.substring(ab))}this.text=ac.join("");this.cursor=ad+aa.length;this.rangeEnd=this.cursor;this.collapsed=true;this.render()};Y.prototype.paste=function(aa){this.insertAtCursor(aa)};Y.prototype.isValueNegative=function(){if(this.text.substring(0,1)==="-"){return true}else{return false}};Y.prototype.makeValueNegative=function(){var aa;if(this.text.length===0){this.insertAtCursor("-")}else{if(this.text.substring(0,1)!=="-"){aa=this.cursor;this.setCursor(0);this.insertAtCursor("-");this.setCursor(aa+1);this.render()}}};Y.prototype.makeValuePositive=function(){var aa;if(this.text.substring(0,1)==="-"){aa=this.cursor;this.setCursor(1);this.deleteAtCursor();this.setCursor(aa-1);this.render()}};Y.prototype.prepare=function(){function ac(ag){var ai="",ah;if(ag.numerator===0){ai="0"}else{if(ag.numerator<0){ai="-"}ah=Math.abs(ag.numerator);if(ah!==1){ai+=ah;ai+="*"}ai+="\u03C0";if(ag.denominator!==1){ai+="/";ai+=ag.denominator}}return ai}function ad(ai,ag){var ah=Math.pow(10,ag);return String(Math.round(ai*ah)/ah)}function ae(aj,ag){var ah=y.math.getSimplePiFraction(aj),ai;if(ah){ai=ac(ah)}else{ai=ad(aj,ag)}return ai}var af=this.gobj,ab=Math.max(3,af.style.precision),aa=af.blank?"":ae(af.uValue,ab);I(this.textNode).html(aa);this.text=aa;this.selectAll()};Y.prototype.reset=function(){this.text="";this.cursor=0;this.rangeEnd=0;this.collapsed=true;this.render()};Y.prototype.moveUp=function(){};Y.prototype.moveDown=function(){};Y.prototype.tab=function(){};Y.prototype.positionCursorByOffset=function(ab){var af=this.text,aa=af.length,ac,ad,ae;ae=ab-I(this.textNode).offset().left;ac=this.getTextWidth();ad=aa?ac/aa:0;if(ae===h){console.warn("positionCursorByOffset: undefined offset")}if(ae>ac){this.setCursor(af.length)}else{this.setCursor(Math.round(ae/ad))}};Y.prototype.submit=function(){K()};Y.prototype.finishEditing=function(){var ac=this.gobj,ab=ac.value;function aa(){return ac.sQuery().get(ac.id)===ac}if(!aa()){return}ac.state.selected=false;this.gobj.setEditedValue(this.text);this.gobj.sQuery.sketch.event("EditParameter",{gobj:this.gobj},{oldValue:ab,expression:this.text,newValue:this.gobj.value});if(this.calculatorDidClose){this.calculatorDidClose("changesAccepted")}};return Y}(I));var F=-1,R=1;function H(X,Z){var Y=this;this.editorEl=X;this.gobj=Z;this.mq().__controller.constructor.onNotify(function(aa){if(aa==="cut"){Y.performEdit(function(){})}})}H.prototype=Object.create(T.prototype);H.prototype.mq=function(){var X=M;return X(this.editorEl[0])};H.prototype.withCursor=function(X){return X(this.mq().__controller.cursor)};H.prototype.showCursor=function(){this.withCursor(function(X){X.show()})};H.prototype.focus=function(){this.editorEl.find(".mq-textarea *").focus()};H.prototype.moveToFarRight=function(){this.mq().moveToRightEnd()};H.prototype.tab=function(){this.mq().keystroke("Tab")};H.prototype.selectLeft=function(X){this.mq().keystroke("Shift-Left")};H.prototype.paste=function(Y){if(Y.slice(0,1)==="$"&&Y.slice(-1)==="$"){Y=Y.slice(1,-1)}var X=this;this.performEdit(function(){X.writeLatex(Y)})};H.prototype.selectRight=function(X){this.mq().keystroke("Shift-Right")};H.prototype.insertAtCursor=function(Y,X){this.mq().cmd(Y);if(!X){this.showCursor()}};H.prototype.writeLatex=function(X){this.mq().write(X)};H.prototype.ascendTwo=function(){this.withCursor(function(X){X.insRightOf(X.parent.parent)})};H.prototype.insertFunction=function(X){this.insertAtCursor("(");this.moveLeft();X();this.moveRight()};H.prototype.writeLiteral=function(Y){var X=y.Strings.format("\\blob<span>%@</span>\\endBlob",[Y]);this.writeLatex(X)};H.prototype.insertSimpleFunction=function(Y){var X=this;this.insertFunction(function(){X.writeLiteral(Y)})};H.prototype.insertParentFunction=function(Y){var X=this;this.insertFunction(function(){y.mfs.renderMathquillFromParsedInfix(Y,X,X.parents)})};H.prototype.deleteAtCursor=function(X){this.mq().keystroke("Backspace")};H.prototype.deleteRight=function(X){this.mq().keystroke("Right Backspace")};H.prototype.moveLeft=function(X){this.mq().keystroke("Left")};H.prototype.moveRight=function(X){this.mq().keystroke("Right")};H.prototype.moveUp=function(X){this.mq().keystroke("Up")};H.prototype.moveDown=function(X){this.mq().keystroke("Down")};H.prototype.insertParent=function(Y){var X=this;function Z(){var aa=0,ab;while(true){if(!X.parents[aa]){X.parents[aa]=Y}if(X.parents[aa]===Y){ab={type:"reference",name:String(aa),kind:"reference:"+aa,children:{},refCount:1,index:0};if(Y.isFunction&&Y.isFunction()){X.insertParentFunction(ab)}else{y.mfs.renderMathquillFromParsedInfix(ab,X,X.parents)}return}aa++}}X.performEdit(Z)};H.prototype.coalesceParents=function(){var aa=0,X={},ab=this,Z="wsp-ref",Y={};I("*[wsp-ref]",this.editorEl).each(function(){var ad=I(this),ac=ad.attr(Z);if(!X[ac]){X[ac]=aa;Y[aa]=ab.parents[ac];aa++}ad.attr(Z,X[ac])});ab.parents=Y};H.prototype.cleanupTouchRegime=function(){if(this.touchRegime){this.gobj.sQuery.sketch.popAllTouchRegimesIncluding(this.touchRegime)}this.touchRegime=null};H.prototype.prepare=function(){var Z=this;Z.finishEditing=function(){Z.cleanupTouchRegime();if(Z.calculatorDidClose){Z.calculatorDidClose(Z.closeReason||"changesNotAccepted")}Z.closeReason=null};Z.reset();try{y.mfs.renderMathquillFromParsedInfix(Z.gobj.parsedInfix,Z,Z.gobj.parentsList);Z.showCursor()}catch(Y){y.signalCaughtError(Y)}var X=y.BackClickRegime.createWithEditor(Z);X.delegate=Z;Z.gobj.sQuery.sketch.pushTouchRegime(X);Z.touchRegime=X;Z.focus()};H.prototype.regimeDidPop=function(X){K()};H.prototype.reset=function(){var X=this.gobj;this.parents=X.parents||{};if(X.isFunction()){this.notation=X.functionExpr.notation;this.independentVar=X.functionExpr.independentVar;this.generateEquationOptions()}this.hideErrorNotice();this.mq().latex("")};H.prototype.setIndependentVar=function(X){this.independentVar=X;I(".wsp-independent-variable",this.editorEl).each(function(){I(this).text(X)})};H.prototype.registerIndependentVariable=function(){this.withCursor(function(Y){var X=Y[F];X.jQ.eq(0).addClass("wsp-independent-variable")})};H.prototype.renderAndSelect=function(Y){var X=this;this.withCursor(function(aa){var Z=aa[F];Y();while(aa[F]!==Z){X.selectLeft()}})};H.prototype.renderOnLeft=function(Y){var Z,X;this.withCursor(function(aa){if(aa[R]){Z=aa[R];Y();aa.insLeftOf(Z)}else{X=aa.parent;Y();aa.insAtRightEnd(X)}})};H.prototype.submit=function(){var X,aa=this,Z=this.gobj;if(this.errorNoticeIsVisible()){return}function ab(){aa.coalesceParents();X=aa.translateMathQuillToInfix();if(Z.isFunction()){Z.functionExpr.notation=aa.notation;switch(aa.independentVar){case"x":Z.expressionType="YofX_FunctionExprType";Z.functionExpr.dependentVar="y";break;case"y":Z.expressionType="XofY_FunctionExprType";Z.functionExpr.dependentVar="x";break;case"r":Z.expressionType="TofR_FunctionExprType";Z.functionExpr.dependentVar="θ";break;case"θ":Z.expressionType="RofT_FunctionExprType";Z.functionExpr.dependentVar="r";break;default:break}Z.functionExpr.independentVar=aa.independentVar}try{y.mfs.getParsedInfixAndFunction(X)}catch(ad){return}var ac=Z.sQuery.sketch.gobjList;y.ObjectGraph.setParents(ac.constraintList,Z,aa.parents);Z.parents=aa.parents;Z.parentsList=ac.createCanonicalParentReferences(Z);Z.parseInfixExpression(X);Z.generateMeasureMFS();Z.descendentGraphHasChanged()}try{ab()}catch(Y){y.signalCaughtError(Y)}this.closeReason="changesAccepted";K()};H.prototype.getCalculatorElement=function(){return this.editorEl.closest(".wsp-Calculator")};H.prototype.showErrorNotice=function(){this.getCalculatorElement().addClass("wsp-syntax-error");I(".wsp-Calculator-ok-button",this.getCalculatorElement()).attr("disabled","true")};H.prototype.hideErrorNotice=function(){this.getCalculatorElement().removeClass("wsp-syntax-error");I(".wsp-Calculator-ok-button",this.getCalculatorElement()).removeAttr("disabled")};H.prototype.errorNoticeIsVisible=function(){return this.getCalculatorElement().hasClass("wsp-syntax-error")};H.prototype.performEdit=function(Z){var X;Z();try{X=this.translateMathQuillToInfix();y.mfs.getParsedInfixAndFunction(X);this.hideErrorNotice()}catch(Y){this.showErrorNotice()}};H.prototype.translateMathQuillToInfix=function(){function Y(ad){function Z(ae){var af;function ai(ak,aj){if(!aj){aj=ae}return aj.children().eq(ak)}if(ae.hasClass("mq-non-leaf")){var ah=ai(0),ag;if(ae.hasClass("mq-supsub")){return Y(ae.children())}if(ah.hasClass("mq-sqrt-prefix")){ag=ai(1);return"sqrt("+Y(ag.children())+")"}else{if(ah.hasClass("mq-paren")){ag=ai(1);af=Y(ag.children());switch(ah.text()){case"(":return"("+af+")";case"|":return"abs("+af+")";default:y.log("unrecognized delimiter: "+ah.text());return"("+af+")"}}else{if(ah.hasClass("mq-numerator")){ag=ai(1);return"(("+Y(ah.children())+")/("+Y(ag.children())+"))"}else{if(!ah.hasClass("mq-cursor")){y.log("unrecognized child of non-leaf: "+ah[0].outerHTML)}}}}return""}else{if(ae.hasClass("mq-root-block")||ae.hasClass("mq-selection")||ae.hasClass("mq-text")){return Y(ae.children())}else{if(ae.hasClass("mq-sup")){return"^("+Y(ae.children())+")"}else{if(ae.hasClass("mq-blob")){if(ai(0).hasClass("wsp-ref")){return"@"+ai(0).attr("wsp-ref")+" "}else{return ai(0).text()}}else{if(ae.hasClass("mq-cursor")){return""}else{if(ae.children().length===0){return ae.text()||""}else{y.log("unrecognized mathquill node: "+ae[0].outerHTML);return""}}}}}}}function ac(ae){return ae.replace("·","*").replace("⋅","*").replace("\u2212","-").replace("\u0192","f").replace("\xa0","")}var aa=[];for(var ab=0;ab<ad.length;ab++){aa.push(ac(Z(ad.eq(ab))))}return aa.join("")}function X(Z){return I("> :not(:first-child)",Z)}return Y(X(this.editorEl))};function N(){if(!(this instanceof N)){return new N()}}N.prototype={init:function(ag,ad,Y,ae){var Z,ah,ai,aa;this.editedEl=ag;U+=1;this.numpadHome=ad;this.numpadEl=I("<div>").addClass(this.cssClass).prop({id:"numpad"+(U)}).css({position:"absolute"});this.initializeEventHandlers();S.attach(this.numpadEl[0]);var ab=this.addHeader(ae);this.dragHandle=ab.dragHandle;this.editor=this.createEditor(ab.editorElt,ae);ai=this.addBody();var af=y.getConfigValue(this.getConfigKey());for(Z=0;Z<af.length;Z+=1){aa=I("<div>").addClass("wsp-Numberpad-row");for(ah=0;ah<af[Z].length;ah+=1){aa.append(this.makeKey(af[Z][ah]))}ai.append(aa)}this.initializeKeys(this.numpadEl);if(!Y){this.hide()}this.numpadEl.css("visibility","hidden");this.numpadHome.append(this.numpadEl);this.position();this.numpadEl.css("visibility","visible");function X(al){function am(ap){var ao=ap.data,an,aq;ap.preventDefault();an=ap.pageX-ao.touch.dx;aq=ap.pageY-ao.touch.dy;ao.numpadEl.offset({left:an,top:aq})}function ak(an){I(r).off("mousemove",am);I(r).off("mouseup",ak)}var aj=al.data;al.preventDefault();aj.touch={dx:al.pageX-I(this).offset().left,dy:al.pageY-I(this).offset().top};I(r).on("mousemove",aj,am);I(r).on("mouseup",aj,ak)}function ac(an){function al(au){var ax=au.originalEvent,ar=au.data,at=ax.touches.length,aw,aq,av;if(at>=1){au.preventDefault();aw=ax.touches[0];aq=aw.pageX-ar.touch.dx;av=aw.pageY-ar.touch.dy;ar.numpadEl.offset({left:aq,top:av})}}function am(aq){I(this).off("touchmove",al);I(this).off("touchend",am)}var ap=an.originalEvent,aj=an.data,ak=ap.touches.length,ao;console.log("Touch Ct: "+ak);if(ak===1){an.preventDefault();ao=ap.touches[0];aj.touch={dx:ao.pageX-I(this).offset().left,dy:ao.pageY-I(this).offset().top};console.log("Touch offset: "+aj.touch.dx+", "+aj.touch.dy)}I(this).on("touchmove",aj,al);I(this).on("touchend",aj,am)}I(this.dragHandle).on("mousedown",this,X);I(this.dragHandle).on("touchstart",this,ac)},createEditor:function(X,Y){return new T(X,Y)},addHeader:function(){var Y=I("<div>").addClass("wsp-Numberpad-header");var X=I("<div>").addClass("wsp-Numberpad-cancel");X.appendTo(Y);X.on("touchstart mousedown",function(){K()});this.numpadEl.append(Y);return{dragHandle:Y,editorElt:this.editedEl}},addBody:function(){var X=I("<div>").addClass("wsp-Numberpad-body");this.numpadEl.append(X);return X},getConfigKey:function(){return"NumberpadManager.options.keyOrder"},cssClass:"wsp-Numberpad",keySpecs:{"1":{clss:"wsp-Numberpad-numkey",ent:"1"},"2":{clss:"wsp-Numberpad-numkey",ent:"2"},"3":{clss:"wsp-Numberpad-numkey",ent:"3"},"4":{clss:"wsp-Numberpad-numkey",ent:"4"},"5":{clss:"wsp-Numberpad-numkey",ent:"5"},"6":{clss:"wsp-Numberpad-numkey",ent:"6"},"7":{clss:"wsp-Numberpad-numkey",ent:"7"},"8":{clss:"wsp-Numberpad-numkey",ent:"8"},"9":{clss:"wsp-Numberpad-numkey",ent:"9"},"0":{clss:"wsp-Numberpad-numkey",ent:"0"},dot:{clss:"wsp-Numberpad-numkey",ent:"."},pi:{clss:"wsp-Numberpad-numkey",ent:"&pi;"},plus:{clss:"wsp-Numberpad-control-key",ent:"+"},minus:{clss:"wsp-Numberpad-control-key",ent:"-"},exponent:{clss:"wsp-Numberpad-control-key",ent:"^"},negative:{clss:"wsp-Numberpad-control-key",ent:"&#177;",op:"negative"},star:{clss:"wsp-Numberpad-control-key",ent:"*",op:"insertStar"},slash:{clss:"wsp-Numberpad-control-key",ent:"/"},lparen:{clss:"wsp-Numberpad-control-key",ent:"("},rparen:{clss:"wsp-Numberpad-control-key",ent:")"},backspace:{clss:"wsp-Numberpad-control-key wsp-Numberpad-erase-to-left",ent:"",op:"backspace"},clear:{clss:"wsp-Numberpad-control-key wsp-Numberpad-clear",ent:"",op:"reset"},submit:{clss:"wsp-Numberpad-control-key",ent:"&#10003;",op:"submit"},left:{op:"moveLeft"},right:{op:"moveRight"},up:{op:"moveUp"},down:{op:"moveDown"},tab:{op:"tab"},selectleft:{op:"selectLeft"},selectright:{op:"selectRight"},x:{op:"xPressed"},y:{op:"yPressed"},r:{op:"rPressed"},t:{op:"tPressed"},esc:{op:"doCancel"},"delete":{op:"deleteRight"}},makeKey:function(aa){var Y=this.keySpecs[aa],Z;if(Y){var X=I("<div/>").html(Y.ent).text();Z=I("<div>").addClass("wsp-Numberpad-key wsp-Numberpad-element").addClass(Y.clss).addClass("wsp-Numberpad-key-"+aa).attr("data-keyText",X).data("wsp-key-name",aa);Y.value=X}else{if(aa===""){Z=I("<div>").addClass("wsp-Numberpad-element")}else{Z=I("<div>").text("?")}}return Z},getKeyValue:function(X){return this.keySpecs[X].value},initializeKeys:function(X){I(".wsp-Numberpad-key",X).on("touchstart mousedown",this,function(Y){Y.data.keyPressed(I(this).data("wsp-key-name"));return false})},initializeEventHandlers:function(){},hide:function(){I(this.numpadEl).hide()},position:function(){var ac=this.numpadEl.outerWidth(),ag=this.numpadEl.outerHeight(),af=I(this.editedEl).outerHeight(),ae=I(this.editedEl).offset(),Y=I(r).scrollTop(),X=ae.top-I(r).scrollTop(),Z=Y+I(l).height()-(ae.top+af),ad=ae.left,ab=Z<ag,aa=X<ag&&ab;if(aa){ae.top=Y}else{if(ab){ae.top-=ag}else{ae.top+=af}}if(ad<ac){if(aa){ae.left+=ac/2}}else{ae.left-=ac}this.numpadEl.offset(ae)},show:function(){I(this.numpadEl).show();this.position()},keyPressed:function(X){var Y=this.keySpecs[X];if(Y){if(Y.op){if(this[Y.op]){this[Y.op]()}else{if(this.editor[Y.op]){this.editor[Y.op]()}}}else{if(Y.value!==h){this.editor.insertAtCursor(Y.value)}}}},backspace:function(){this.editor.deleteAtCursor()},negative:function(){if(!this.editor.isValueNegative()){this.editor.makeValueNegative()}else{this.editor.makeValuePositive()}},unpressAllKeys:function(){I(".wsp-Numberpad-key",this.numpadEl).removeClass("wsp-Numberpad-key-down")},submit:function(){this.editor.submit();this.unpressAllKeys()},insertStar:function(){if(this.keySpecs.star.value){this.editor.insertAtCursor("*")}},doCancel:function(){this.closeReason="changesNotAccepted";K()}};function L(){N.apply(this,arguments)}function W(X){return X.closest(".wsp-Calculator").length}L.prototype=Object.create(N.prototype);L.prototype.keySpecs=I.extend(true,{},N.prototype.keySpecs);L.prototype.createEditor=function(X,Y){return new H(X,Y)};L.prototype.keyPressed=function(X){var Y=this;this.editor.performEdit(function(){N.prototype.keyPressed.call(Y,X)})};L.prototype.initMathQuill=function(Y){var X=/(Mobi)|(Android)/.test(b.userAgent);M.MathField(Y[0],{substituteTextarea:function(){var Z=X?I('<span tabindex="0"></span>>'):I("<textarea></textarea>");return Z[0]}})};L.prototype.initializeEventHandlers=function(Y){var X=this;this.numpadEl.on("click",function(ab){var aa=I(ab.target).closest(".wsp-calculator-edited").length;var Z=I(ab.target).closest(".wsp-Calculator-display").length;if(Z&&!aa){X.editor.moveToFarRight()}X.editor.showCursor();X.editor.focus()});this.numpadEl.on("mousedown",function(Z){if(W(I(r.activeElement))){Z.preventDefault()}})};L.prototype.addHeader=function(Z){var ab,aa,X,Y,ac=I("<span>").addClass("wsp-syntax-error-notice");ab=I("<div/>").addClass("wsp-Calculator-title");ab.text("Edit "+(Z.isFunction()?"Function":"Calculation"));X=I("<span/>").css("border","none");this.initMathQuill(X);X.addClass("wsp-calculator-edited");aa=I("<div/>").addClass("wsp-Calculator-display").append(X);Y=I("<div>").addClass("wsp-Calculator-display-wrapper").append(aa).append(ac);this.numpadEl.append(ab).append(Y);return{dragHandle:ab,editorElt:X}};L.prototype.insertIndependentVariable=function(X){if(this.editor.gobj.isFunction()&&X===this.editor.independentVar){this.editor.insertAtCursor(X);this.editor.registerIndependentVariable()}};L.prototype.xPressed=function(){this.insertIndependentVariable("x")};L.prototype.yPressed=function(){this.insertIndependentVariable("y")};L.prototype.rPressed=function(){this.insertIndependentVariable("r")};L.prototype.tPressed=function(){this.insertIndependentVariable("θ")};L.prototype.addBody=function(){var ad=this,ag=I("<div/>").addClass("wsp-Calculator-body-wrapper"),af=I("<div/>").addClass("wsp-Calculator-left"),am=I("<p/>").addClass("wsp-Calculator-label-insert").text("Insert:"),ap=function(az,aB,ay){var aw=I("<div/>").addClass("dropdown"),aC=I("<ul/>").addClass("dropdown-menu"),ax=I("<button/>").addClass("dropdown-toggle").attr("data-toggle","dropdown").addClass("wsp-Calculator-textual").text(aB).append(I("<span/>").addClass("caret"));aw.append(ax).append(aC);if(ay){for(var aA=0;aA<ay.length;aA++){aC.append(ay[aA])}}return aw},Y=function(){return I("<button/>").addClass("wsp-Calculator-textual").addClass("wsp-Calculator-bottom-button")},ab=function(aw){return aw.addClass("wsp-Calculator-select-for-insert")},ae=function(){return I("<li/>").addClass("divider")},al=function(ax,az,ay){var aw=I("<a/>").data("value",ax).text(az?az:ax);if(ay){aw.css("font-style","italic")}return I("<li/>").append(aw)},Z=function(ax,aw,ay){I("a",ax).data(aw,ay);return ax},ao=function(aw,ax){I("a",aw).text(ax);return aw},aa=function(ax,aw){I("a",ax).addClass(aw);return ax},an=function(){return aa(al("","",true),("wsp-independent-variable-option"))},aq=function(aw){return aw.addClass("selected")},av=ap("values","Values",[ae(),an(),ae(),al("pi","π",true),al("e","e",true)]).addClass("wsp-Calculator-topmost-select-for-insert"),ar=ab(ap("functions","Functions",[ae(),al("function","sin"),al("function","cos"),al("function","tan"),al("function","Arcsin"),al("function","Arccos"),al("function","Arctan"),ae(),al("|","abs"),al("\\sqrt","sqrt"),al("function","ln"),al("function","log"),al("function","sgn"),al("function","round"),al("function","trunc")])).addClass("wsp-select-function"),X=ab(ap("units","Units",[ae(),al(" pixels"),al(" cm"),al(" inches"),ae(),al(" radians"),al(" degrees")])).addClass("wsp-select-units"),ak=I("<div/>").addClass("wsp-Calculator-body"),ai=I("<div/>").addClass("wsp-Calculator-bottom"),ac=ap("equation","Equation",[]).addClass("wsp-Calculator-select-equation"),ah=Y().text("Cancel"),au=Y().addClass("wsp-Calculator-ok-button").append(I("<span/>").addClass("wsp-Calculator-ok-button-inner").text("OK"));I(ah).on("click",function(){ad.doCancel();return false});I(au).on("click",function(){ad.editor.submit();return false});af.append(am).append(av).append(ar).append(X);I("a",af).on("click",function(ax){var aw=I(this),ay=aw.data("value");ad.editor.performEdit(function(){if(ay==="function"){ad.editor.insertSimpleFunction(aw.text())}else{ad.editor.insertAtCursor(ay);if(aw.hasClass("wsp-independent-variable-option")){ad.editor.registerIndependentVariable()}}})});ag.append(af).append(ak);if(!ad.editor.gobj.isFunction()){ac.css("visibility","hidden")}function at(az,aw){var ay=I(".dropdown-menu",az);ay.empty();for(var ax=0;ax<aw.length;ax++){ay.append(aw[ax])}}function aj(){var aw=I(".wsp-independent-variable-option",av).parent();Z(aw,"value",ad.editor.independentVar);ao(aw,ad.editor.independentVar)}ad.editor.generateEquationOptions=function(){var az,aw=ad.editor.independentVar;function ax(){switch(aw){case"x":return"y";case"y":return"x";case"r":return"θ";case"θ":return"r"}throw y.createError("unrecognized independent variable")}function ay(aD,aB){var aC=al(aB);Z(aC,"independentVar",aD);return(aw===aD)?aq(aC):aC}function aA(){var aC=al(ax()+"= notation"),aB=al("f("+aw+") notation");Z(aC,"notation","dependentVariable");Z(aB,"notation","function");if(ad.editor.notation==="function"){aB=aq(aB)}else{aC=aq(aC)}return[ae(),aC,aB,ae()]}az=aA().concat([ay("x","y = f(x)"),ay("y","x = f(y)"),ay("θ","r = f(θ)"),ay("r","θ = f(r)")]);at(ac,az);aj();I("a",ac).on("click",function(aE){var aC=I(this),aB=aC.data("independentVar"),aD;if(aB){ad.editor.setIndependentVar(aB)}else{aD=aC.data("notation");if(aD){ad.editor.notation=aD}}ad.editor.generateEquationOptions()})};ai.append(ac).append(ah).append(au);this.numpadEl.append(ag).append(ai);I(".dropdown-toggle",this.numpadEl).dropdown();return ak};L.prototype.getConfigKey=function(){return"NumberpadManager.options.keyOrderCalculator"};L.prototype.cssClass="wsp-Calculator wsp-version-4-1-0";function J(Y,X){if(!(this instanceof J)){return new J(Y)}I(Y).css({"-webkit-user-select":"none","-moz-user-select":"none","-ie-user-select":"none","user-select":"none"});this.editedEl=Y;this.numpadParent=X;this.hasVFocus=false;this.numpad=null;V.push(this)}J.prototype={createAndInitNumpad:function(X){this.numpad=this.createNumpad();this.numpad.init(this.editedEl,this.numpadParent,true,X)},isModalController:false,createNumpad:function(){return new N()},vFocus:function(Y){var X=this;K();l.setTimeout(function(){X.hasVFocus=true;if(!X.numpad){X.createAndInitNumpad(Y)}else{X.numpad.show()}X.numpad.editor.prepare();if(X.futureDidCloseCallback){X.numpad.editor.calculatorDidClose=X.futureDidCloseCallback;X.futureDidCloseCallback=null}},0)},vBlur:function(){if(this.hasVFocus){this.numpad.editor.unsetCursor();this.numpad.editor.finishEditing();this.hasVFocus=false;this.numpad.hide()}},click:function(X,Y){if(X.stopPropagation){X.stopPropagation()}if(!this.hasVFocus){this.vFocus(Y)}else{this.numpad.editor.positionCursorByOffset(X.pageX)}},paste:function(Y){var X=Y.getData("text/plain");this.numpad.editor.paste(X)},setListener:function(X){if(this.numpad&&this.numpad.editor){this.numpad.editor.calculatorDidClose=X}else{this.futureDidCloseCallback=X}},clearListener:function(){if(this.numpad&&this.numpad.editor){this.numpad.editor.calculatorDidClose=null}this.futureDidCloseCallback=null}};function G(){J.apply(this,arguments)}G.prototype=Object.create(J.prototype);G.prototype.createNumpad=function(){return new L()};G.prototype.isModalController=true;D=function(){var X;I(r).on("paste",function(Z){var Y=Q();if(Y){Y.paste(Z.originalEvent.clipboardData);return false}return true});I(r).on("focus","*",function(Y){K(true)});I(r).on("WillChangeCurrentPage.WSP UnloadDocument.WSP",function(){E()});I(r).on("keydown keyup",function(ac){var aa=Q(),Y,Z,ab;if(!aa){return}if(aa.isModalController&&!W(I(ac.target))){return}Y=aa.numpad;Z=P(ac);ab=O[Z];if(ab){ac.preventDefault();if(ac.type==="keydown"){I(".wsp-Numberpad-key-"+ab,Y.numpadEl).addClass("wsp-Numberpad-key-down");Y.keyPressed(ab)}else{I(".wsp-Numberpad-key-"+ab,Y.numpadEl).removeClass("wsp-Numberpad-key-down")}}});X=function(Y){this.each(function(){var aa=I(this),Z;if(aa.hasClass("mfs-input")){Z=new J(this,Y)}else{Z=new G(this,Y)}aa.data("wsp-numfield-ctl",Z)})};X.blurNumpads=function(){K()};return X};return new D()}(jQuery));y.EventEmitter=(function(){var E={events:["StartCurrentPage","StopCurrentPage","LoadDocument","UnloadDocument","WillChangeCurrentPage","DidChangeCurrentPage","LoadPage","UnloadPage","StartSketchFrame","EndSketchFrame","StartDrag","MoveDrag","EndDrag","StartScroll","MoveScroll","EndScroll","PressButton","EditParameter"],trigger:function(K,I,G){var F=K+".WSP",J;if(this.events.indexOf(K)<0){throw y.createError("Unregistered event triggered: "+K)}g(this.canvasNode).trigger(F,[I,G]);try{J=new CustomEvent(F,{detail:{context:I,attributes:G}});this.canvasNode[0].dispatchEvent(J)}catch(H){}},getAvailableEvents:function(){var F=this.events;return F.map(function(G){return G+".WSP"})}};var D=function(F){var G=Object.create(E);G.canvasNode=F;return G};return D}());y.createError=function(F,E){var D=new Error(F);D.code=E;return D};y.signalCaughtError=function(D){return y.signal({message:D.message,error:D,stack:D.stack,logType:"error",code:D.code||"GSP.Error.uncodedError"})};y.signalErrorWithCode=function(F,E){var H=[F].concat(E),G=y.Strings.loc.apply(y.Strings,H),D=y.createError(G,F);this.signalCaughtError(D)};y.signalErrorWithMessage=function(F,E){var D=y.createError(F,E);this.signalCaughtError(D)};y.Prefs=(function(){var D={units:{length:"cm",angle:"deg"},precision:{length:2,angle:2,scalar:2},fadeTraces:false,fadeHalfLife:5,fadeSaturationFloor:0.0625,colorableComponents:{Points:{color:"red"},Straights:{color:"navy"},Curves:{color:"green"},Interior:{color:"rgb(138,102,217)"},Plot:{color:"purple"},PointLocus:{color:"maroon"},Selection:{color:"rgb(195,0,195)"},Background:{color:"white"},CoordSys:{color:"silver"},TextGObject_BackgroundContrast:{color:"black"},ActionButton:{color:"rgb(255,165,0)"},LabelText_BackgroundContrast:{color:"black"},Axis:{color:"rgb(96,96,96)"},AngleMarker:{color:"rgb(64,64,64)"},Picture:{color:"red"}},text:{mathItalicization:true,textTypes:{Label:{"font-family":"Times","font-size":24,"font-weight":"bold","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"},Caption:{"font-family":"Times","font-size":16,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black",padding:"2px 4px"},Measurement:{"font-family":"Times","font-size":18,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"},Action:{label:{"font-family":"Arial","font-size":16,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"}},Table:{"font-family":"Arial","font-size":14,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"},AxisTicksAndOptionalLabel:{"font-family":"Geneva","font-size":14,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black",label:{"font-family":"Geneva","font-size":14,"font-weight":"normal","font-style":"normal","text-decoration":"none","letter-spacing":"none",color:"black"}}}}};return D}());y.SketchEvent=function(E,D){if(!(this instanceof y.SketchEvent)){return new y.SketchEvent(E,D)}this.type=E;if(D){g.extend(this,D)}this.timeStamp=this.timeStamp||g.now()};y.SketchEventHandler=(function(){var D=function(){},I=1,F=1;function J(K,N){var M,L;for(L=0;L<N.length;L++){M=N[L];if(!K[M]){K[M]={}}K=K[M]}return K}function H(K,N){var M,L;for(L=0;L<N.length;L++){M=N[L];K=K[M];if(K===h){break}}return K}function E(K){var L;if(g.isArray(K)){L=K.slice();L.sort()}else{L=[K]}return L}g.extend(D,{emitterIDFromTargetList:function(K,L){var N=J(this.targetsIDMap,[L]),M=J(N,K);if(M.result===h){M.result=F++}return M.result},addHandler:function(K,N,O){var P=E(K),Q=this.emitterIDFromTargetList(P,N),L,M;if(!O.wspguid){O.wspguid=I++}L=J(this.handlers,[O.wspguid]);if(L.refCount){L.refCount++}else{L.refCount=1;L.handler=O}if(!this.emitters[Q]){this.emitters[Q]={type:N,targets:P,handlerID:[]}}this.emitters[Q].handlerID.push(O.wspguid);for(M=0;M<P.length;M++){J(this.triggers,[P[M],N])[Q]=true}},removeHandler:function(K,N,O){var R=this.emitterIDFromTargetList(E(K),N),Q=this.emitters[R],P=O.wspguid,M,L;if(!Q){y.signalErrorWithMessage("removeHandler called on unknown target "+K);return}if(this.handlers[P].refCount===1){delete this.handlers[P]}else{this.handlers[P].refCount--}Q.handlerID.splice(Q.handlerID.lastIndexOf(P),1);if(0===Q.handlerID.length){for(M in this.triggers){for(L in this.triggers[M]){delete this.triggers[M][L][R]}}delete this.emitters[R];delete this.sketchEventList[R]}},raiseSketchEvent:function(K,M){var L=H(this.triggers,[K,M]),N;if(!L){return}for(N in L){J(this.sketchEventList,[N,M])[K]=true}},processOneSketchEvent:function(Q){var N,M,O,L,P,K={};N=this.emitters[Q];M=this.handlers[N.handlerID];for(L=0;L<N.targets.length;L++){P=N.targets[L];K[P]=H(this.sketchEventList,[Q,N.type,P])?true:false}O=new y.SketchEvent(N.type,{targetMap:K});if(this.sketchEventPreprocessor){this.sketchEventPreprocessor(O)}for(L=0;L<N.handlerID.length;L++){M=this.handlers[N.handlerID[L]].handler;M(O)}},processSketchEvents:function(){var K;for(K in this.sketchEventList){this.processOneSketchEvent(K)}this.sketchEventList={};this.frameIndex++},getFrameIndex:function(){return this.frameIndex},hasSketchEvents:function(){return !g.isEmptyObject(this.sketchEventList)}});function G(K){this.sketchEventPreprocessor=K;this.targetsIDMap={};this.triggers={};this.emitters={};this.handlers={};this.sketchEventList={};this.frameIndex=0}G.prototype=D;return G}());(function(H){var G=(function(){var I=/iP(ad|hone|od).*OS 6/.test(l.navigator.userAgent),N=0,K=l.requestAnimationFrame||null,O=l.cancelAnimationFrame||null,J={};["webkit","moz"].forEach(function(P){K=K||l[P+"RequestAnimationFrame"]||null;O=O||l[P+"CancelAnimationFrame"]||l[P+"CancelRequestAnimationFrame"]||null});function M(T,Q){var P=new Date().getTime();var R=Math.max(0,16-(P-N));var S=l.setTimeout(function(){T(P+R)},R);N=P+R;return S}function L(P){clearTimeout(P)}J.nextFrame=(!I&&K!=null)?K:M;J.cancelFrame=(!I&&O!=null)?O:L;return J})();var F=G.nextFrame;var E=G.cancelFrame;var D={_preprocessJobs:null,_modelJobs:null,_renderJobs:null,_tick:function(){var L=new Date().getTime(),J,N,I;function K(P){if(P.scheduledFireTime<=L){try{if(P.callback()===false){P.isActive=false}}catch(O){O.message="Error executing job: "+O.message;P.isActive=false;H.signalCaughtError(O)}if(P.repeat){P.scheduledFireTime=L+P.delay}else{P.isActive=false}if(!P.isActive&&P.doneCallback){P.doneCallback("finished")}}}J=this._preprocessJobs.slice();J.forEach(K);L=new Date().getTime();N=this._modelJobs.slice();N.forEach(K);L=new Date().getTime();I=this._renderJobs.slice();I.forEach(K);function M(O){return O.isActive}this._preprocessJobs=this._preprocessJobs.filter(M);this._modelJobs=this._modelJobs.filter(M);this._renderJobs=this._renderJobs.filter(M);if((this._preprocessJobs.length+this._modelJobs.length+this._renderJobs)>0){this._requestAnimFrameIfNeeded()}},_animFrameHandle:null,_requestAnimFrameIfNeeded:function(){var I=this;if(this._animFrameHandle!==null){return}this._animFrameHandle=F(function(){I._animFrameHandle=null;I._tick()})},addJob:function(M,L){L=L||{};var K=L.delay||0;var J;if(K>0){J=new Date().getTime()+K}else{J=0}var I={callback:M,delay:K,scheduledFireTime:J,repeat:L.repeat,doneCallback:L.done,queue:L.priority||"model",isActive:true};if(I.queue==="preprocess"){this._preprocessJobs.push(I)}else{if(I.queue==="render"){this._renderJobs.push(I)}else{this._modelJobs.push(I)}}this._requestAnimFrameIfNeeded();return I},clearJob:function(K){var J;if(K.queue==="preprocess"){J=this._preprocessJobs}else{if(K.queue==="render"){J=this._renderJobs}else{J=this._modelJobs}}var I=J.indexOf(K);if(I===-1){throw H.createError("Job Scheduler.clearJob() called on a unscheduled job")}J.splice(I,1);K.isActive=false;if(K.doneCallback){K.doneCallback("cancelled")}if((this._preprocessJobs.length+this._renderJobs.length+this._modelJobs.length)===0){E(this._animFrameHandle);this._animFrameHandle=null}},clearAllJobs:function(){function I(J){J.isActive=false;if(J.doneCallback){J.doneCallback("cancelled")}}this._preprocessJobs.forEach(I);this._modelJobs.forEach(I);this._renderJobs.forEach(I);this._preprocessJobs=[];this._modelJobs=[];this._renderJobs=[];if(this._animFrameHandle!==null){E(this._animFrameHandle);this._animFrameHandle=null}}};H.JobScheduler={create:function(){var I=Object.create(D);I._preprocessJobs=[];I._modelJobs=[];I._renderJobs=[];return I},isActive:function(I){return !!(I&&I.isActive)}}}(y));(function(D){D.ObjectGraph={convertObjectSpec:function(L,E,I){var G=[],H={},F=I||0,K={};g.extend(H,E);D.eachKeyValue(L,function J(M,O){if(!H[M]){K[M]=true;if(O.parents){var N={};g.each(O.parents,function(P,R){var Q=H[R];if(!Q){if(K[R]){throw D.createError("Circular reference in object graph")}if(!L[R]){throw D.createError("Unknown parent id encountered building object graph: "+R)}J(R,L[R]);Q=H[R]}if(Q.children===h){Q.children=[]}Q.children.push(O);N[P]=Q});O.parents=N}O.id=M;O.topologicalIndex=F++;G.push(O);H[M]=O;K[M]=false}});return G},subgraphFromNode:function(H,K){var L={},G=K?g.extend({},K):{},F={},I=[H];G[H.id]=H;g.extend(L,G);function E(M){L[M.id]=M;if(M.children){M.children.forEach(function(N){if(!L[N.id]){E(N)}})}}function J(M){if(G[M.id]){return true}if(F[M.id]){return false}var N=!!L[M.id];if(N&&M.parents){g.each(M.parents,function(P,O){if(!J(O)){N=false;return false}})}if(!N){F[M.id]=M;return false}else{G[M.id]=M;I.push(M);return true}}E(H);g.each(L,function(M,N){J(N)});return I},getNextFreeIdNumber:function(E){var F=0,G=false;E.forEach(function(H){var I=parseInt(H.id,10);if(isNaN(I)){G=true;return false}if(I>F){F=I}});if(!G){return(F+1)}},setParents:function(G,I,H){var E;I.parents={};if(H===h||g.isEmptyObject(H)){return}g.each(H,function(J,L){I.parents[J]=L;if(L.children===h){L.children=[]}if(L.children.indexOf(I)===-1){L.children.push(I)}var K=L.topologicalIndex;if(E===h||E<K){E=K}});I.topologicalIndex=E+1;function F(K){if(K.children){var J=K.topologicalIndex;K.children.forEach(function(L){if(L.topologicalIndex<=J){L.topologicalIndex=J+1;F(L)}})}}F(I);G.sort(function(K,J){return Number(K.topologicalIndex)-Number(J.topologicalIndex)})},createSpecFromGraph:function(E){var F={};E.forEach(function(H){var G=g.extend({},H);F[G.id]=G;G.id=h;G.topologicalIndex=h;G.children=h;if(G.parents){var I={};g.each(G.parents,function(J,K){I[J]=K.id});G.parents=I}});return F},copy:function(E){return this.convertObjectSpec(this.createSpecFromGraph(E))},mergeToNode:function(O,J,K){var E=K.parents;var N,G;if(E){for(var I in E){if(E.hasOwnProperty(I)){N=E[I];G=N.children.indexOf(K);N.children.splice(G,1)}}}if(!J.children){J.children=[]}if(K.children){J.children=J.children.concat(K.children);K.children.forEach(function(P){g.each(P.parents,function(Q,R){if(R===K){P.parents[Q]=J}})})}var H,L=O.length;var M,F;for(H=0;H<L;++H){if(O[H]===K){M=H}if(O[H]===J){F=H}}if(F>M){O[M]=O[F];O.splice(F,1)}else{O.splice(M,1)}},deleteNode:function(L,E){var H={},F;if(L.indexOf(E)===-1){throw D.createError("ObjectGraph.deleteNode() called on node not in graph")}function M(N){return(H[N.id]!==h)}function J(N){H[N.id]=N}function K(N){var O=N.parents,P,S,R=L.indexOf(N);if(O){for(var Q in O){if(O.hasOwnProperty(Q)){P=O[Q];if(!M(P)){S=P.children.indexOf(N);P.children.splice(S,1)}}}}if(R!==-1){L.splice(R,1)}}function G(N){J(N);if(N.children){N.children.forEach(function(O){if(!M(O)){G(O)}})}}G(E);for(var I in H){if(H.hasOwnProperty(I)){F=H[I];K(F)}}return Object.keys(H)}}}(y));y.GObjList=(function(){var D=function(){};g.extend(D,{createCanonicalParentReferences:function(F){function H(K){var J,I=[];K.sort(function(N,M){var L,P,O=y.BapEdgeInfo[F.constraint];if(O&&O[N.name]){L=O[N.name].sortIndex}if(O&&O[M.name]){P=O[M.name].sortIndex}if((h===L)&&(h===P)){L=parseInt(N.name,10);P=parseInt(M.name,10)}if((h===L)&&(h===P)){if(N.name<M.name){return -1}if(N.name>M.name){return 1}return 0}if(h===L){return 1}if(h===P){return -1}return L-P});for(J=0;J<K.length;J++){I.push(K[J].gobj)}return I}var G=[];if(F.parents){g.each(F.parents,function(I,J){G.push({name:I,gobj:J})});return H(G)}return[]},mergeToGObj:function(H,G,I){var F=this;delete this.gobjects[G.id];y.ObjectGraph.mergeToNode(this.constraintList,H,G);if(H.children){H.children.forEach(function(J){J.parentsList=F.createCanonicalParentReferences(J)})}if(!H.label){H.label=G.label}if(G.destroy){G.destroy()}I.renderCleanupGObj(G);H.descendentGraphHasChanged();this.renderList=y.createRenderList(this.constraintList)},addGObjects:function(K,M){var H=this;function N(P){P.toDelete=true;for(var O=0;O<P.children.length;++O){P.children[O].toDelete=true}}var F=0;if(this.constraintList.length>0){F=this.constraintList[this.constraintList.length-1].topologicalIndex+1}var G=y.ObjectGraph.convertObjectSpec(K,this.gobjects,F),J,I;this.constraintList=this.constraintList||[];this.renderList=this.renderList||[];for(I=0;I<G.length;++I){J=G[I];try{if(J.state.supported&&!J.toDelete){H.gobjects[J.id]=J;this.constraintList.push(J);J.parentsList=H.createCanonicalParentReferences(J);J.doPostReadFromSpec();J.init();if(M){y.addToRenderList(this.renderList,J);M(J)}}else{N(J)}}catch(L){L.message='Initializing "'+(J?J.id:"Unknown GObject")+'": '+L.message;y.signalCaughtError(L);J.toDelete=true}}if(!M){this.renderList=y.createRenderList(this.constraintList)}for(I=G.length-1;I>=0;--I){J=G[I];if(J.toDelete){y.ObjectGraph.deleteNode(G,J)}}},removeGObjects:function(F,I){var H=this,G=Object.keys(F),J=[];G.forEach(function(M){var L=H.gobjects[M],K;if(J.indexOf(M)!==-1){return}if(L){K=y.ObjectGraph.deleteNode(H.constraintList,L);J=J.concat(K)}});J.forEach(function(L){var K=H.gobjects[L];if(K){I.invalidateAppearance(K);if(K.destroy){K.destroy()}I.renderCleanupGObj(K)}delete H.gobjects[L]});this.renderList=y.createRenderList(this.constraintList)}});function E(F){this.gobjects={};if(F){this.addGObjects(F)}else{this.constraintList=y.ObjectGraph.convertObjectSpec({})}}E.prototype=D;return E}());y.SQuery=(function(I){var J=[];J.getSketch=function(){return this.sketch};J.findDottedProperty=function(V,U,T){var S=U.split("."),R,W=V;for(R=0;R<S.length;R+=1){if(typeof W!=="object"){return}W=W[S[R]]}if(typeof T==="undefined"){return W}if(typeof W!=="undefined"){return T(W)}};J.each=function(S){var R;for(R=0;R<this.length;R+=1){S.call(this[R],R,this[R])}return this};J.hide=function(){this.each(function(R,S){S.hide()});return this};J.show=function(){this.each(function(R,S){S.show()});return this};J.invalidateGeom=function(R){this.getSketch().invalidateGeom(R)};J.showLabel=function(){var R=this.getSketch();this.each(function(S,T){if(!T.style){T.style={}}if(!T.style.label){T.style.label={}}T.style.label.showLabel=true;R.invalidateAppearance(T)});return this};J.hideLabel=function(){var R=this.getSketch();this.each(function(S,T){if(!T.style){T.style={}}if(!T.style.label){T.style.label={}}T.style.label.showLabel=false;R.invalidateAppearance(T)});return this};J.get=function(S){var R=this.getSketch();return R.gobjList.gobjects[S]};J.dirty=function(){this.getSketch().isDirty=true};J.eraseTraces=function(){this.getSketch().clearTraces()};J.stopMotions=function(){};J.attr=function(U,X){function T(ag,ae,ac,ad){var ab=ac.split("."),af=ae,aa,Z;for(aa=0;aa<ab.length-1;aa+=1){Z=I.trim(ab[aa]);if(!af[Z]){af[Z]={}}af=af[Z]}if(I.type(ad)==="function"){af[I.trim(ab[ab.length-1])]=ad.call(ae,aa,ae)}else{af[I.trim(ab[ab.length-1])]=ad}}function W(ad,ac){var ab=ac.split("."),ae=ad,aa,Z;for(aa=0;aa<ab.length;aa+=1){Z=I.trim(ab[aa]);if(typeof ae[Z]==="undefined"){return}ae=ae[Z]}return ae}var Y=this.getSketch(),R="",S,V;if(X!==h&&X.length!==0){this.each(function(aa,ab){var Z;if(this){Z=W(this,U);if(Z!==h){T(aa,ab,U,X);Y.invalidateGeom(ab)}else{if(this.style){Z=W(this,"style."+U);if(Z!==h){T(aa,ab,"style."+U,X);Y.invalidateGeom(ab)}}}}})}if(I.type(U)==="object"){S=U;for(V in S){if(S.hasOwnProperty(V)){R=this.attr(V,S[V])}}}else{if(I.type(U)==="string"){if(this[0]){R=W(this[0],U)}if((R===h)&&this[0].style){R=W(this[0],"style."+U)}}}return R};J.parents=function(){var S,T,U,V,R;V=this.getSketch();R=new V.sQuery();for(S=0;S<this.length;S+=1){U=this[S];if(U.parents){for(T in U.parents){if(U.parents.hasOwnProperty(T)){R.push(U.parents[T])}}}}return R};J.press=function(S){var R=this.getSketch().document;this.each(function(T,U){if(U.press){if(h===S||S!==U.state.isActive){R.getFocusPage().constrain();U.press(R.getFocusPage());R.getFocusPage().constrainAndRedraw()}}});return this};J.value=function(R){var S=this.getSketch();if(h===R){if(this[0].uValue!==h){return this[0].uValue}if(this[0].value!==h){return this[0].value}if(this[0].geom&&this[0].geom.loc){return this[0].geom.loc}return h}this.each(function(T,U){if(U.updateValue){U.updateValue(R)}else{if(U.geom&&U.geom.loc&&jQuery.isPlainObject(R)){U.geom.loc.x=R.x;U.geom.loc.y=R.y;S.invalidateGeom(U)}}});return this};J.prefs=function(){return this.getSketch().preferences};J.getResource=function(S,R){var T=this.getSketch().document.resources[S];return T&&T[R]};J.getSketchDelta=function(){var S=this.getSketch(),R=S.document.getPageDeltaObj(S.metadata.id);return JSONcanonical.stringify(R)};J.applySketchDelta=function(S){var R,T=this.getSketch();if(typeof S==="string"){R=JSON.parse(S)}else{R=S}T.document.applyDeltaToActivePage(R)};J.getSketchJSON=function(){return this.getSketch().document.getDocumentJSON()};J.toString=J.getSketchJSON;function O(S,T,W){var V=this.getSketch(),R=V.getCurrentPageId(),U=S.split(" ");this.each(function(X,Y){I.each(U,function(Z,aa){W.call(V.document,R,Y.id,aa,T)})})}function K(S,U,X){var W=this.getSketch(),R=W.getCurrentPageId(),V=S.split(" "),T=[];this.each(function(Y,Z){T.push(Z.id)});I.each(V,function(Y,Z){X.call(W.document,R,T,Z,U)})}J.on=function(R,S){O.call(this,R,S,this.getSketch().document.bindGObjEvent)};J.off=function(R,S){O.call(this,R,S,this.getSketch().document.unbindGObjEvent)};J.onGroup=function(R,S){K.call(this,R,S,this.getSketch().document.bindGObjEvent)};J.offGroup=function(R,S){K.call(this,R,S,this.getSketch().document.unbindGObjEvent)};function F(U,S,T){var R;for(R in S){if(S.hasOwnProperty(R)){T[R]=S[R]}}}function N(W,U,T,V){var S,R;for(S in T){if(T.hasOwnProperty(S)){R=J.findDottedProperty(T[S],W);if(typeof R==="undefined"){R=J.findDottedProperty(T[S],"style."+W)}if(U===R){V[S]=T[S]}}}}function D(R,S,T){T[R.name]=S[R.name]}function M(S,U,V){var R,T=new RegExp("\\b"+S.name+"\\b");for(R in U){if(U.hasOwnProperty(R)){if(U[R]["class"]&&(T.test(U[R]["class"]))){V[R]=U[R]}}}}function P(R,S,T){N("kind",R.name,S,T)}function H(R,T,V){var S=R.name,U=R.value;N(S,U,T,V);N("style."+S,U,T,V)}var G={attr:H,"class":M,global:F,id:D,kind:P};function L(R,V,Y){var U,T,X=R.parts,W=V,S;for(T=0;T<X.length;T+=1){U=G[X[T].type];if(T===X.length-1){S=Y}else{S={}}U(X[T],W,S);W=S}}function E(S,T,V){var R,U;for(R=0;R<S.length;R+=1){U=S[R];if(U.type==="global"){F(U,T,V)}else{if(U.type==="id"){D(U,T,V)}else{if(U.type==="class"){M(U,T,V)}else{if(U.type==="kind"){P(U,T,V)}else{if(U.type==="attr"){H(U,T,V)}else{if(U.type==="selectorAnd"){L(U,T,V)}else{y.log("Unclassified squery selector: "+U)}}}}}}}}function Q(R){var S=function S(T){if(!(this instanceof S)){return new S(T)}var V,U,Y=R.getFocusPage?R.getFocusPage():R,W=(Y.gobjList&&Y.gobjList.gobjects)||{},X={};this.sketch=R;if(T!==h){if(I.isArray(T)){V=T}else{if(I.type(T)==="string"){V=y.squerySelector.parse(T)}else{V=[]}}E(V,W,X);for(U in X){if(X.hasOwnProperty(U)){this.push(X[U])}}}};S.sketch=R;S.prototype=J;return S}return Q}(jQuery));y.PerfMonitor=(function(E){var I,D,G,F;var H=1000/60;D={clear:function(){this.data={}},set:function(K,J){this.data[K]=J},get:function(J){return this.data[J]},increment:function(L,J){var K=J||1;if(typeof this.data[L]!=="number"){this.data[L]=K}else{this.data[L]+=K}},log:function(K,J){if(typeof this.logs[K]==="undefined"){this.logs[K]=[]}this.logs[K].push(J)}};I=function(){var J=Object.create(D);J.data={};J.logs={};return J};F=function(){var J=Object.create(G);J.stats=new I();J.stats.set("Start",J.now());J.times={idle:h,active:h,constrain:h,render:h,fade:h};return J};G={now:function(){if(l.performance&&l.performance.now){return l.performance.now()}else{return E.now()}},getFrameCount:function(){return this.stats.get("Activation Count")},animFrameHandler:function(){var N=this.times.idle,M=this.times.active,K=this.now(),L=K-N,O=K-M,J=L,P=Math.max(0,(L/H)-1);this.times.last=N;this.times.frame=O;this.times.active=K;this.times.constrain=this.times.render=this.times.fade=h;this.stats.increment("Activation Count");this.stats.increment("Idle Accum",J);if(P>0){this.stats.increment("Activation Missed",Math.round(P))}},constrainHandler:function(){this.times.constrain=this.now();this.stats.increment("Constrain Count");this.stats.increment("Touch Accum",this.times.constrain-this.times.active)},renderHandler:function(){this.times.render=this.now();this.stats.increment("Render Count");this.stats.increment("Constrain Accum",this.times.render-this.times.constrain)},fadeHandler:function(){this.times.fade=this.now();this.stats.increment("Fade Count");if(typeof this.times.render!=="undefined"){this.stats.increment("Render Accum",this.times.fade-this.times.render)}},idleHandler:function(){var J=this.now(),K=J-this.times.active;this.stats.increment("Idle Count");this.times.idle=J;this.stats.increment("Active Accum",K);if(K>this.FRAME_INTERVAL){this.stats.increment("Late Frames")}if(typeof this.times.fade!=="undefined"){this.stats.increment("Fade Accum",this.times.idle-this.times.fade)}else{if(typeof this.times.render!=="undefined"){this.stats.increment("Render Accum",this.times.idle-this.times.render)}}},unknownStateHandler:function(){y.signalErrorWithMessage("PerfMonitor: unknown state")},stateChange:function(J){var K=this[J+"Handler"]||this.unknownStateHandler;K.call(this)},report:function(M,L,N){function K(P,Q){if(Q){return P/Q}else{return 0}}var O=(typeof N==="undefined")?true:N,J=y.stringify({name:M,phase:L,frames:this.stats.get("Activation Count"),frameTime:K(this.now()-this.stats.get("Start"),this.stats.get("Activation Count")),active:K(this.stats.get("Active Accum"),this.stats.get("Activation Count")),missedFrames:this.stats.get("Activation Missed"),lateFrames:this.stats.get("Late Frames"),idle:K(this.stats.get("Idle Accum"),this.stats.get("Idle Count")),touch:K(this.stats.get("Touch Accum"),this.stats.get("Activation Count")),constrainCt:this.stats.get("Constrain Count"),constrain:K(this.stats.get("Constrain Accum"),this.stats.get("Constrain Count")),renderCt:this.stats.get("Render Count"),render:K(this.stats.get("Render Accum"),this.stats.get("Render Count")),fadeCt:this.stats.get("Fade Count"),fade:K(this.stats.get("Fade Accum"),this.stats.get("Fade Count"))});if(O){this.stats.clear();this.stats.set("Start",this.now())}return J}};return F}(jQuery));y.speculativeOpacity=0.5;y.speculativeColor="#888888";y.targetHighlightColor="red";y.targetHighlightPathBolding=2;y.diffPatch=jsondiffpatch.create({objectHash:function(D){return(D.id!==h)?D.id:JSONcanonical.stringify(D)}});y.getKindObj=function(F){var D=y.gObjects[F],G=D&&D.doc,E=G&&G.supported,H=E||(G&&y.gOptions.instantiateUnsupportedObjects);return H?D:null};y.getConstraintObj=function(E){var D=y.gConstraints[E],G=D&&D.doc,F=G&&G.supported,H=F||(G&&y.gOptions.instantiateUnsupportedObjects);return H?D:null};y.gobjIdMapFromArray=function(E){var D={};E.forEach(function(F){D[F.id]=F});return D};y.getFontFamilyFromStyle=function(F,H){var G,D,E=F["font-family"];if(g.type(E)==="number"){D=H.getResource("fontList",E);if(!D){G=H.prefs().fontList;D=G[E]}}if(!D){D=E}return D};y.modifyRenderAttrsForLineStyle=function(D,E){var G,F=E.width||1;switch(D){case"dashed":G=Math.round(8*(1+(F-1)/4));E.lineDash=[G,6];break;case"dotted":E.lineDash=[F,Math.max(2,Math.round(1.2*F))];break;default:E.lineDash=[]}};y.gobjPrototype=(function(){var D={};return function(E,H){var G=[E,H].join(":"),F=D[G];if(!F){F=y.makeClass(y.gObjects[E],y.gConstraints[H]);D[G]=F}return F}}());y.gobjFromSpec=function(O,E,N,J){var H=O.kind,D=y.getKindObj(H),F=O.constraint,M=y.getConstraintObj(F),G,L,K=D&&D.kindSupportsSpecObj(O,J),I=M&&M.constraintSupportsSpecObj(O,J);if(!K){y.log("GObject "+E+' has undefined kind: "'+O.kind+'"');H="Unknown";F="Unknown"}else{if(!I){y.log("GObject "+E+' has undefined constraint: "'+O.constraint+'"');if(D.doc.defaultConstraint){F=D.doc.defaultConstraint}else{H="Unknown";F="Unknown"}}}L=y.gobjPrototype(H,F);G=y.makeInstance(L,O,{doc:true});G.id=E;G.sQuery=N;if(!K||!I){G.state.supported=false}return G};y.gobjectsFromSpec=function(G,J){var H=G,D={},I,F,E;for(I in H){if(H.hasOwnProperty(I)){F=H[I];if(F){E=y.gobjFromSpec(F,I,J,H);D[I]=E}else{y.signalErrorWithMessage('Undefined gobject in sketch document: "'+I+'"')}}}return D};y.generateChecksum=function(D){return b64_md5(JSONcanonical.stringify(D))};y.getSketchDiff=function(E,D){function F(I){var H=g.extend(true,{},I),K=H.objects;for(var J in K){if(K.hasOwnProperty(J)){K[J].debug=h}}return H}var G={};G.diff=y.diffPatch.diff(F(E),F(D));G.checksum=y.generateChecksum(E);return G};y.applySketchDiff=function(D,F){if(F.checksum!==y.generateChecksum(D)){y.log("Applying sketch diff to the wrong source spec")}try{y.diffPatch.patch(D,F.diff)}catch(E){y.log("applySketchDiff() aborted: "+E.message)}};y.getDocumentDiff=function(F,E){var D={};D.checksum=y.generateChecksum(F);D.metadataDiff=y.diffPatch.diff(F.metadata,E.metadata);D.resourcesDiff=y.diffPatch.diff(F.resources,E.resources);D.pageDiffs=[];if(F.pages){F.pages.forEach(function(H,G){var I=E.pages[G];D.pageDiffs[G]=y.getSketchDiff(H,I)})}if(F.tools){F.tools.forEach(function(I,H){var G=E.tools[H];D.pageDiffs[H]=y.diffPatch.diff(I,G)})}return D};y.applyDocumentDiff=function(F,E){if(E.checksum!==y.generateChecksum(F)){y.log("Applying doc diff to source spec with different checksums")}try{y.diffPatch.patch(F.metadata,E.metadataDiff);y.diffPatch.patch(F.resources,E.resourcesDiff);if(F.pages){F.pages.forEach(function(I,G){var H=E.pageDiffs[G];if(H){y.applySketchDiff(I,H)}})}if(F.tools){F.tools.forEach(function(I,H){var G=E.toolDiffs[H];y.diffPatch.patch(I,G)})}}catch(D){y.log("applyDocumentDiff aborted: "+D.message)}};y.layerInfo=(function(){var E={NeverVisible:{z_index:0,engine:null,construction_sort:1},ExternalImagesAndInteriors:{z_index:1,engine:"standard",construction_sort:-1},LineLoci:{z_index:2,engine:"standard",construction_sort:1},CoordinateSystem:{z_index:3,engine:"standard",construction_sort:1},Axes:{z_index:4,engine:"standard",construction_sort:1},LinesCurves:{z_index:5,engine:"standard",construction_sort:1},Rays:{z_index:5+0.1,engine:"standard",construction_sort:-1},Segments:{z_index:5+0.2,engine:"standard",construction_sort:-1},PathMarkers:{z_index:6,engine:"standard",construction_sort:1},Tables:{z_index:7,engine:"standard",construction_sort:1},Text:{z_index:8,engine:"html",construction_sort:1},Buttons:{z_index:9,engine:"html",construction_sort:1},DiscretePointVectors:{z_index:10,engine:"standard",construction_sort:1},Points:{z_index:11,engine:"standard",construction_sort:1},PointsFree:{z_index:11+0.1,engine:"standard",construction_sort:-1},PointsSemiFree:{z_index:11+0.2,engine:"standard",construction_sort:-1}},D={AngleMarker:E.LineLoci,Arc:E.LinesCurves,ArcInterior:E.ExternalImagesAndInteriors,Axis:E.Axes,Button:E.Buttons,Circle:E.LinesCurves,CircleInterior:E.ExternalImagesAndInteriors,CoordSys:E.CoordinateSystem,Expression:E.Text,Measure:E.Text,Param:E.Text,Picture:E.ExternalImagesAndInteriors,Point:E.Points,PointFree:E.PointsFree,PointSemiFree:E.PointsSemiFree,Polygon:E.ExternalImagesAndInteriors,Straight:E.LinesCurves,Segment:E.Segments,Ray:E.Rays,Text:E.Text};return function(F){var G=F.kind;if(F.getRenderingLayer){return E[F.getRenderingLayer()]}if(F.kind==="Point"){if(F.constraint==="Free"){G+=F.constraint}else{if(F.value!==h){G+="SemiFree"}}}else{if(F.kind==="Straight"){if(F.genus==="Segment"||F.genus==="Ray"){G=F.genus}}}return D.hasOwnProperty(G)?D[G]:{z_index:6,engine:"standard",construction_sort:1}}}());(function(){function E(G){var F=y.layerInfo(G).z_index;if(h===F){F=0}return F}function D(H,G,I){if(I[H.id]===h){I[H.id]={kindLayerCache:E(H)}}if(I[G.id]===h){I[G.id]={kindLayerCache:E(G)}}var J;J=I[H.id].kindLayerCache-I[G.id].kindLayerCache;if(0!==J){return J}if((H.style.layerOrder!==h)&&(G.style.layerOrder!==h)){J=H.style.layerOrder-G.style.layerOrder;if(0!==J){return J}}var K=I[H.id].constructionOrder,F=I[G.id].constructionOrder;if((K!==h)&&(F!==h)){return F-K}return y.layerInfo(G).construction_sort}y.createRenderList=function(H){var I=H.slice(),G,F={};for(G=0;G<I.length;G++){F[I[G].id]={constructionOrder:G*y.layerInfo(I[G]).construction_sort,kindLayerCache:E(I[G])}}I.sort(function(K,J){return D(K,J,F)});return I};y.blurDocumentActiveElement=function(H){try{if(r.activeElement){if(r.activeElement.nodeName.toLowerCase()!=="body"){g(r.activeElement).blur()}var G=y.getConfigValue("NumberpadManager.delegates.blurAllNumberpads");G(H)}}catch(F){}};y.addToRenderList=function(M,L){var F=0,K=M.length,I=F,H,J,G={};while(F<K){I=F+((K-F)>>1);H=D(M[I],L,G);if(H<=0){F=I+1}else{K=I}}J=(H<=0)?F:K;M.splice(J,0,L)};y.AutoplacementMetrics={Measurement:{sketchLeftMargin:10,sketchTopMargin:5,gObjTopMargin:1,rightIsolation:60,bottomIsolation:15},Button:{sketchLeftMargin:10,sketchTopMargin:5,gObjTopMargin:3,rightIsolation:50,bottomIsolation:15}}}());y.Document=(function(){var G=1,H={attachToNode:function(J){var P="wsp-version-4-1-0",I=g(J),O=this,K=O.docSpec.metadata.width,Q=O.docSpec.metadata.height,L=g('<div class="wsp-base-node '+P+'"><div class="wsp-transform-node"><div class=wsp-main-row></div></div><div class="wsp-transform-large"></div><div class="wsp-transform-medium"></div><div class="wsp-transform-small"></div></div>'),N,M={};I.empty().append(L);N=g(".wsp-main-row",L[0]);if(this.hasTools()){O.attachToolsToNode(N);K+=N.outerWidth()}N.append(g("<div class=wsp-sketch-container></div>"));g(".wsp-transform-large",L[0]).css({width:K,height:Q});g(".wsp-transform-medium",L[0]).css({width:K*0.75,height:Q*0.75});g(".wsp-transform-small",L[0]).css({width:K*0.5,height:Q*0.5});if(this.docOptions.responsiveSizing===true){L.addClass("wsp-responsiveSizing");if(K>400){L.addClass("wsp-responsiveSizing-medium-break");L.addClass("wsp-responsiveSizing-medium-size");L.addClass("wsp-responsiveSizing-small-break");L.addClass("wsp-responsiveSizing-small-size")}else{if(K>300){L.addClass("wsp-responsiveSizing-medium-size");L.addClass("wsp-responsiveSizing-small-break")}}}M.position="relative";if(this.docOptions.sizeParentToContent){if(I.prop("nodeName").toLowerCase()==="div"&&I.css("display")==="block"){M.display="inline-block"}}I.css(M);this.canvasNode=I;this.eventEmitter=y.EventEmitter(this.canvasNode)},event:function(K,J,I){J=J||{};J.document=this;this.eventEmitter.trigger(K,J,I)},getFocusPage:function(){return this.focusPage},getPageCount:function(){return this.docSpec.pages.length},getCurrentPageSpec:function(I){var K=g.extend(true,{},this.getOrigPageSpec(I)),J=this.getPageDeltaObj(I);if(J&&!g.isEmptyObject(K)){y.applySketchDiff(K,J)}return K},getOrigPageSpec:function(I){if(h===I){I=this.docSpec.metadata["start-page"];if(h===I||this.getIndexForPageId(I)===null){I=this.docSpec.pages[0].metadata.id}}if(this.pageData[I]===h){y.signalErrorWithCode("GSP.Error.invalidSwitchPage");return null}else{return this.pageData[I].spec}},getPageIdAtIndex:function(J){if((J<0)||(J>=this.docSpec.pages.length)){return null}var K=this.docSpec.pages[J],I=(K&&K.metadata&&(K.metadata.id!=null))?K.metadata.id:String(J+1);return I},getIndexForPageId:function(J){if(this.docSpec.pages){var L,I,K;for(I=0;I<this.docSpec.pages.length;I++){L=this.docSpec.pages[I];K=(L&&L.metadata&&(L.metadata.id!=null))?L.metadata.id:String(I+1);if(K===J){return I}}}return null},createSketchEventHandlersForPage:function(I,J){this.gobjectEventHandlers[J.getCurrentPageId()]=new y.SketchEventHandler(function(L){var K;function M(P){var Q,N=0,O;for(Q in P){if(P.hasOwnProperty(Q)){if(N!==0){O=h;break}N++;O=Q}}return O}K=M(L.targetMap);if(K){L.target=J.gobjList.gobjects[K]}})},bindGObjEvent:function(I,L,J,K){this.gobjectEventHandlers[I].addHandler(L,J,K)},unbindGObjEvent:function(I,L,J,K){this.gobjectEventHandlers[I].removeHandler(L,J,K)},raiseSketchEvent:function(J,K,L){var M=this.gobjectEventHandlers[J],I=this,N=this.focusPage;if(J!==N.metadata.id){throw y.createError("Document.raiseSketchEvent() can only raise events for the active page")}M.raiseSketchEvent(K,L);if(!y.JobScheduler.isActive(M.processEventsJob)){M.processEventsJob=N.jobScheduler.addJob(function(){I.processSketchEvents(J);M.processEventsJob=null},{priority:"preprocess"})}},processSketchEvents:function(I){var J=this.gobjectEventHandlers[I],K=J.getFrameIndex();if(J.hasSketchEvents()){this.focusPage.event("StartSketchFrame",{},{frameIndex:K});J.processSketchEvents();this.focusPage.event("EndSketchFrame",{},{frameIndex:K})}},triggerLoadPage:function(){var I=this.focusPage.metadata.id;if(!this.cacheSketchPagesLoaded[I]){this.event("LoadPage",{document:this,sQuery:this.focusPage.sQuery},{pageId:I})}this.cacheSketchPagesLoaded[I]=true},triggerDidChangeCurrentPage:function(I){this.event("DidChangeCurrentPage",{document:this,sQuery:this.focusPage.sQuery},{oldPageId:I,pageId:this.focusPage.metadata.id})},triggerWillChangeCurrentPage:function(J){var I=this.focusPage?this.focusPage.metadata.id:null;this.event("WillChangeCurrentPage",{document:this},{pageId:I,newPageId:J})},applyDeltaToActivePage:function(K){var I=this.focusPage.metadata.id;this.stopCurrentFocusedSketch();this.setPageDeltaObj(I,K);this.focusPage=null;var J=this.getCurrentPageSpec(I);this.focusPage=y.Sketch(this,J,this.docOptions);this.focusPage.attachToNode(this.canvasNode);this.triggerLoadPage(I);this.startCurrentFocusedSketch(true);this.sQuery=this.focusPage.sQuery},switchPage:function(I){var M=this.focusPage,J=M.metadata.id,L=I,K;if(L===J){return}while(M.hasTouchRegimes()){M.popTouchRegime()}this.recordActivePageDelta();K=this.getCurrentPageSpec(L);this.triggerWillChangeCurrentPage(L);this.stopCurrentFocusedSketch();this.focusPage=y.Sketch(this,K,this.docOptions);this.focusPage.attachToNode(this.canvasNode);this.triggerLoadPage(I);this.metadata["start-page"]=L;this.startCurrentFocusedSketch(true);this.sQuery=this.focusPage.sQuery;this.triggerDidChangeCurrentPage(J)},startCurrentFocusedSketch:function(){this.focusPage.start();this.event("StartCurrentPage",{document:this,sQuery:this.focusPage.sQuery},{pageId:this.focusPage.metadata.id})},stopCurrentFocusedSketch:function(){this.event("StopCurrentPage",{document:this},{pageId:this.focusPage.metadata.id});this.focusPage.stop()},start:function(){this.startCurrentFocusedSketch()},stop:function(){this.stopCurrentFocusedSketch();this.cleanUp()},cleanUp:function(){this.event("UnloadDocument",{document:this},{})},recordActivePageDelta:function(){var J=this.getFocusPage(),I=J&&J.metadata.id,L=this.getOrigPageSpec(I),K=y.getSketchDiff(L,J.toSpecObj());this.pageData[I].state=K},setPageDeltaObj:function(I,J){this.pageData[I].state=J},getPageDeltaObj:function(I){var J=this.getFocusPage(),K=J&&J.metadata.id,L,M;if(I===K){M=this.getOrigPageSpec(K);L=y.getSketchDiff(M,J.toSpecObj())}else{if(this.pageData[I].state){L=this.pageData[I].state}else{L=null}}return L},getCurrentSpecObject:function(){var J=g.extend(true,{},this.docSpec),I;g.extend(true,J.metadata,this.metadata);for(I=0;I<J.pages.length;++I){J.pages[I]=this.getCurrentPageSpec(this.getPageIdAtIndex(I))}return J},getDocumentJSON:function(){return JSONcanonical.stringify(this.getCurrentSpecObject(),h,2)},getDocumentDelta:function(){var I=y.getDocumentDiff(this.docSpec,this.getCurrentSpecObject());return JSONcanonical.stringify(I)},initModel:function(L,K){var I,J,M;this.docSpec=L;this.metadata=g.extend(true,{},L.metadata);this.resources=L.resources||{};this.docOptions=K||{};this.pageData={};if(L.pages){for(I=0;I<L.pages.length;I++){M=L.pages[I];J=(M&&M.metadata&&(M.metadata.id!=null))?M.metadata.id:String(I+1);M.metadata.id=J;this.pageData[J]={spec:M,state:null}}}if(L.tools){this.addTools(L.tools)}},addTools:function(J){var I=this;if(!I.tools){I.tools=[]}J.forEach(function(K){I.tools.push(y.Tool.createWithSpec(K))})},hasTools:function(){return this.tools&&this.tools.length>0},attachToolsToNode:function(O){var L=75;var K=this,I=L,N=0,M=K.focusPage.sQuery(),J;O.append(g('<div class="wsp-tool-container"><div class="wsp-tool-column"></div></div>'));J=g(".wsp-tool-column",O[0]);K.tools.forEach(function(Q){var R,T,P;R=g('<div class="wsp-tool"></div>');if(Q.metadata.image!==h){P=M.getResource("pictures",Q.metadata.image);T=g("<img>");T.attr(P);T.attr("title",Q.metadata.name);R.append(T)}else{R.text(Q.metadata.name)}R.on("touchstart mousedown",function(U){var V=K.focusPage&&K.focusPage.toolController;if(V&&V.toggleTool(Q)){U.preventDefault()}});Q.$element=R;J.append(R);var S=R.outerWidth();I=Math.max(S,I);R.css({width:"100%"});N+=R.outerHeight()});J.css({width:I+"px"})}};function E(I){var O=Number(y.version.major),M=Number(y.version.minor),Q=Number("4"),J=I&&I["wsp-version"],P=J&&J.split("."),N=P&&P.length>0?Number(P[0]):null,K=P&&P.length>1?Number(P[1]):0;function L(R){return y.signal({code:"GSP.Error.incompatibleSketchVersion",message:y.Strings.loc("GSP.Error.incompatibleSketchVersion",y.version.number,J),logType:R,sketchData:I})}if(O<N){return L("error")}if(O>N){return L(Q>N?"error":"warning")}if(O===N){if(M<K){return L("debug")}return}return y.signal({code:"GSP.Error.invalidSketchVersion",message:y.Strings.loc("GSP.Error.invalidSketchVersion",y.version.number,J),logType:"error",sketchData:I})}function F(I,J){return g.extend(true,{sizeParentToContent:J,responsiveSizing:J},I)}var D=function(L,M,K){var I,P,N,O,J;P=E(M.metadata);if(P&&P.logType==="error"){if(L){N=g('<div class="wsp-error-message"></div>');N.text(P.message);g(L).empty().append(N)}throw y.createError(P.message,P.code)}I=Object.create(H);I.initModel(M,F(K,g(L).hasClass("wsp-responsiveSizing")));I.id=G++;I.gobjectEventHandlers={};I.cacheSketchPagesLoaded={};J=I.getOrigPageSpec();O=y.Sketch(I,J,K);I.focusPage=O;I.sQuery=O.sQuery;if(L){I.attachToNode(L);O.attachToNode(L);I.event("LoadDocument",{document:I},{});I.triggerLoadPage();I.triggerDidChangeCurrentPage(null)}return I};return D}());y.Sketch=(function(){var D={EventToSketch:function(G){var F=this.canvasNode.convertPointFromPage(G.pageX,G.pageY,G.mouseEvent);var E=y.GeometricPoint(F.x,F.y);this.viewToPrimalTransform().transform(E);F.x=E.x;F.y=E.y;F.pageX=G.pageX;F.pageY=G.pageY;F.mouseEvent=G.mouseEvent;return F},autoplaceGObj:function(J){var O=this,N,F,G,L=this.sketchRect(),K=J.getAutoplacementMetrics(),I;function E(){var S;var P=false;var V={};do{S=true;V.left=I.x;V.right=V.left+K.rightIsolation;V.top=I.y;V.bottom=V.top+K.bottomIsolation;if(V.bottom>L.bottom){I.x+=(L.right-L.left)/5;if(I.x+K.rightIsolation>L.right){if(!P){S=false;I.x=L.left+K.sketchLeftMargin;I.y=L.top+K.sketchTopMargin;P=true}else{return false}}else{S=false;I.y=L.top+K.sketchTopMargin}}else{var U,T,R=O.gobjList.constraintList;for(var Q=R.length-1;Q>=0;--Q){U=R[Q];T=O.getGObjGeomBounds(U);if((U!==J)&&!U.style.hidden&&U.autoplacementType&&y.Geom.isIntersectRects(T,V)){S=false;I.x=Math.max(I.x,T.left);I.y=T.bottom+K.gObjTopMargin;break}}}}while(!S);return true}if(K){I=y.GeometricPoint(L.left,L.top);I.x+=K.sketchLeftMargin;I.y+=K.sketchTopMargin;var M=this.gobjList.constraintList;for(var H=M.length-1;H>=0;--H){N=M[H];if(N===J){continue}G=N.getAutoplacementMetrics();F=this.getGObjGeomBounds(N);if(G&&(N.autoplacementType===J.autoplacementType)&&(N.state&&N.state.exists)&&!N.style.hidden&&y.Geom.isIntersectRects(F,L)){I.x=F.left;I.y=F.bottom+K.gObjTopMargin;break}}if(!E()){I=y.GeometricPoint(L.left,L.top);I.x+=K.sketchLeftMargin;I.y+=K.sketchTopMargin}J.geom={loc:I}}},initGObjects:function(J,I){var E=y.gobjectsFromSpec(J,this.sQuery);var K=this;var H=this.gobjList;var L=I&&I.autoplace;var F=I&&I.speculative;function G(M){if(L){K.autoplaceGObj(M);M.invalidateGeom();K.renderPrepare();K.constrainAndRedraw()}if(F){M.setRenderState("speculative")}}H.addGObjects(E,(L||F)?G:h);return E},constructGObjects:function(F,E){var G=this.initGObjects(F,E);this.renderPrepare();return G},constrainDriveChain:function(E){var F,G;for(F=0;F<E.length;F++){G=E[F];if(G.checkParentsExist()){G.constrain(this)}if(G.state){G.state.constraintCache={}}}},getGObjGeomBounds:function(F){var E=(F.getGeomBounds&&F.getGeomBounds())||y.Geom.kInfiniteRect;if(!y.Geom.isValidRect(E)){y.signalErrorWithCode("GSP.Error.invalidGeomBounds",[F.id,F.kind]);E=y.Geom.kInfiniteRect}return E},presentGObjUI:function(G,F){if(G.presentUI){var E=this.renderRefCon.gobj[G.id];G.presentUI(E,F)}},getGObjLabelBounds:function(F){var E=this.renderRefCon.dcForGObjLabel||this.dcForGObjLabel(F);return(F.getLabelBounds&&F.getLabelBounds(E))||y.Geom.kInfiniteRect},updateSignificantBoundsWithGObj:function(F){if(F.style.hidden){return}var E=this.renderRefCon.gobj[F.id];this.significantBounds=y.Geom.unionRects(this.significantBounds,F.getSignificantBounds(E))},constrain:function(){this.monitor.stateChange("constrain");function F(G,I,K){var H,J;if(I.parentsList&&I.parentsList.length){for(H=0;H<I.parentsList.length;H++){J=I.parentsList[H];if(J.state.constraintFrame>I.state.constraintFrame){I.state.constraintFrame=J.state.constraintFrame;K.invalidateRect(K.renderRefCon.renderBounds[I.id]);K.invalidateRect(K.renderRefCon.labelBounds[I.id]);K.isDirty=true}}}}function E(H,J,K){var L,G;try{if((J.state.constraintFrame>=K.constraintFrame)&&J.checkParentsExist()){J.constrain(K);if(!J.style.hidden){G=K.dcForGObj(J);if(G&&G.preclear){K.invalidateRect(K.getGObjGeomBounds(J))}G=K.dcForGObjLabel(J);if(G&&G.preclear){K.invalidateRect(K.getGObjLabelBounds(J))}K.isDirty=true}if(J.state){J.state.constraintCache={}}if(J.constrainLabel){J.constrainLabel()}K.document.raiseSketchEvent(K.getCurrentPageId(),J.id,"update")}}catch(I){if(J.id){L=J.id}else{L="#"+H}I.code="GSP.Error.constraintException";I.message=y.Strings.loc("GSP.Error.touchStartException",L)+": "+I.message;y.signalCaughtError(I)}}this.eachGObj(this.gobjList.constraintList,F);this.eachGObj(this.gobjList.constraintList,E);this.constraintFrame++;if(this.isDirty){this.significantBounds=null;this.eachGObj(this.gobjList.constraintList,function(G,H,I){I.updateSignificantBoundsWithGObj(H)})}this.monitor.stateChange("idle")},invalidateRect:function(E){this.dirtyRect=y.Geom.unionRects(this.dirtyRect,E)},invalidateAppearance:function(E){this.invalidateRect(this.renderRefCon.renderBounds[E.id]);this.invalidateRect(this.renderRefCon.labelBounds[E.id]);this.isDirty=true;this.setNeedsDisplay()},invalidateGeom:function(E){if(E){E.state.constraintFrame=this.constraintFrame;this.invalidateAppearance(E)}return this},event:function(G,F,E){F=F||{};E=E||{};F.sketch=this;F.sQuery=this.sQuery;if(F.gobj){E.gObjectId=F.gobj.id}if(F.touch){E.touchIdentifier=F.touch.identifier}if(F.position){E.position={x:F.position.x,y:F.position.y}}if(F.sketch.document.focusPage.metadata.id){E.pageId=F.sketch.document.focusPage.metadata.id}this.document.event(G,F,E)},handleTouchStart:function(H){var F,J,I,G;if(!H||!H.changedTouches){y.signalErrorWithMessage("sketch.handleTouchEnd: missing e.changedTouches");return}for(F=0;F<H.changedTouches.length;F+=1){try{J=H.changedTouches[F];I=this.EventToSketch(J);G=this.currentTouchRegime().createTracker(J,I);if(G){y.TouchManager.registerTouchWithTracker(J.identifier,G);G.touchBegan(I,J);if(G.forwardTouchToSystem){return}}}catch(E){E.code="GSP.Error.touchStartException";E.message=y.Strings.loc("GSP.Error.touchStartException",J.identifier)+E.message;y.signalCaughtError(E)}}return false},handleTouchMove:function(H){var F,J,G,I;if(!H||!H.changedTouches){y.signalErrorWithMessage("sketch.handleTouchMove: missing e.changedTouches");return}for(F=0;F<H.changedTouches.length;F+=1){try{J=H.changedTouches[F];G=y.TouchManager.trackerForTouch(J.identifier);if(G){I=this.EventToSketch(J);G.touchMoved(I,J);if(G.forwardTouchToSystem){return}}}catch(E){E.code="GSP.Error.touchMoveException";E.message=y.Strings.loc("GSP.Error.touchMoveException",J.identifier)+E.message;y.signalCaughtError(E)}}return false},handleTouchEnd:function(H){var F,I,G;if(!H||!H.changedTouches){y.signalErrorWithMessage("sketch.handleTouchEnd: missing e.changedTouches");return}for(F=0;F<H.changedTouches.length;F+=1){try{I=H.changedTouches[F];G=y.TouchManager.trackerForTouch(I.identifier);if(G){G.touchEnded(I);if(G.forwardTouchToSystem){return}}y.TouchManager.deregisterTouch(I.identifier)}catch(E){E.code="GSP.Error.touchEndException";E.message=y.Strings.loc("GSP.Error.touchEndException",I.identifier)+E.message;y.signalCaughtError(E)}}return false},_deferredGObjCalls:null,addDeferredCall:function(F,H){var G=this;if(!G._deferredGObjCalls[F.id]){G._deferredGObjCalls[F.id]=[]}var E=G.jobScheduler.addJob(function(){H.apply(F,[G])},{done:function(){var J,I=G._deferredGObjCalls[F.id];for(J=0;J<I.length;++J){if(I[J]===E){I.splice(J,1);break}}}});G._deferredGObjCalls[F.id].push(E)},cancelDeferredCall:function(E){var F=this;this._deferredGObjCalls[E.id].forEach(function(G){F.jobScheduler.clearJob(G);F._deferredGObjCalls[E.id]=h})},getRenderList:function(){return this.gobjList.renderList},standardGraphicsEngine:function(){var E=this.getOption("graphics-engine");return this.draw.engines[E]||this.draw.engines.canvas},dcForGObj:function(G,H){var F;if("traced"===H){return this.draw.engines.trace}var I=this.renderRefCon.dcForGObj,E=I[G.id];if(E){return E}F=y.layerInfo(G);if(F.engine==="standard"){E=I[G.id]=this.standardGraphicsEngine();return E}E=I[G.id]=this.draw.engines[F.engine];return E},dcForGObjLabel:function(G){if(this.renderRefCon.dcForGObjLabel){return this.renderRefCon.dcForGObjLabel}var F=this.getOption("label-engine"),E=this.draw.engines[F];this.renderRefCon.dcForGObjLabel=E||this.draw.engines.html;return this.renderRefCon.dcForGObjLabel},translateTraceLayer:function(F,E){if(this.traces.saturation>0){if(!this.traces.translate){this.traces.translate={dx:0,dy:0}}this.traces.translate.dx+=F;this.traces.translate.dy+=E}},realizeTraceLayerTranslation:function(){if((this.traces.saturation>0)&&this.traces.translate&&(this.traces.translate.dx||this.traces.translate.dy)){this.draw.translate(this.traces.translate.dx,this.traces.translate.dy);this.traces.translate.dx=0;this.traces.translate.dy=0}},fadeTraces:function(){var E=Number(new Date()),H,F,G;H=(E-this.traces.fadeStartTime)/1000;F=Math.exp(-H*(Math.log(2)/this.preferences.fadeHalfLife));G=F/this.traces.appliedAlpha;G+=(Math.random()*2*0.2-0.2);if(G<0){G=0}if(G<1){this.draw.fade(G);this.traces.saturation*=G;this.traces.appliedAlpha*=G}},clearTraces:function(){this.draw.fade(0);this.traces.saturation=0;this.traces.appliedAlpha=1;this.traces.fadeStartTime=0},renderGObj:function(G,F){var H=F.traced?"traced":"normal",E=this.dcForGObj(G,H);if(E){G.render(E,this.renderRefCon.gobj[G.id],F)}},renderBounds:function(G,J,K){try{var L=K.getGObjGeomBounds(J),I=K.getGObjLabelBounds(J),F={rect:L},E=K.standardGraphicsEngine();if(!J.style.hidden){if(L&&E.drawRectangle){F={rect:L};E.drawRectangle(K.renderRefCon.geomBounds[J.id]||this,F)}if(I&&E.drawRectangle){F={rect:I};E.drawRectangle(K.renderRefCon.geomBounds[J.id]||this,F)}}}catch(H){H.code="GSP.Error.renderBoundsException";H.message=y.Strings.loc("GSP.Error.renderBoundsException",J.id,J.kind)+H.message;y.signalCaughtError(H)}},renderGObjLabel:function(G,F){var H=F.traced?"traced":"normal",E=this.dcForGObjLabel(G,H);if(G.hasLabel){if(E){G.renderLabel(E,this.renderRefCon.label[G.id]||this,F)}}},_fadeTracesJob:null,render:function(){var I=this.getRenderList(),L=false,G=false,K=this;this.monitor.stateChange("render");function H(M,R,S){var P=S.dcForGObj(R),O=P&&P.preclear,Q;try{if(!G&&R.style.traced&&(R.state.traceConstraintFrame!==R.state.constraintFrame)){S.renderGObj(R,{traced:true});L=true;R.state.traceConstraintFrame=R.state.constraintFrame}if(O&&!R.style.hidden){Q=S.getGObjGeomBounds(R);S.renderRefCon.renderBounds[R.id]=Q}if(!O||y.Geom.isIntersectValidRects(S.dirtyRect,Q)){S.renderGObj(R,{drag:G})}}catch(N){N.code="GSP.Error.renderObjectException";N.message=y.Strings.loc("GSP.Error.renderObjectException",R.id,R.kind,N);y.signalCaughtError(N)}}function E(M,R,S){var O=S.dcForGObjLabel(R),N=O&&O.preclear,P;try{if(N&&!R.style.hidden){P=S.getGObjLabelBounds(R);S.renderRefCon.labelBounds[R.id]=P}if(!N||y.Geom.isIntersectValidRects(S.dirtyRect,P)){S.renderGObjLabel(R,{sketch:S,drag:G})}}catch(Q){Q.code="GSP.Error.renderLabelException";Q.message=y.Strings.loc("GSP.Error.renderLabelException",R.id,R.kind,Q.message);y.signalCaughtError(Q)}}function J(M){return((M.state.renderState==="unmatchedGiven")||(M.state.renderState==="matchedGiven")||(M.state.renderState==="targetHighlit"))}if(this.isDirty){this.realizeTraceLayerTranslation();this.draw.prepareFrame(this.dirtyRect,this.primalToViewTransform());this.eachGObj(I,function(M,N,O){if(!J(N)){H(M,N,O)}});if(L){this.traces.saturation=1;if(this.traces.appliedAlpha<this.preferences.fadeSaturationFloor){this.traces.appliedAlpha=1;this.traces.fadeStartTime=Number(new Date())}var F={repeat:true,done:function(){K._fadeTracesJob=null}};if(this.preferences.fadeTraces&&!y.JobScheduler.isActive(this._fadeTracesJob)){this._fadeTracesJob=this.jobScheduler.addJob(function(){var M=true;K.monitor.stateChange("fade");if(K.traces.saturation>K.preferences.fadeSaturationFloor){K.fadeTraces()}else{K.clearTraces();M=false}K.setNeedsDisplay();K.monitor.stateChange("idle");return M},F)}}this.eachGObj(I,E);G=true;this.eachGObj(I,function(M,N,O){if(N.state.isDragging||J(N)){H(M,N,O)}});if(this.getOption("debug-geom-bounds")){this.eachGObj(I,this.renderBounds)}this.draw.cleanupFrame(this.dirtyRect);this.dirtyRect=null;this.isDirty=false}this.monitor.stateChange("idle")},renderPrepare:function(){var E=g.grep(this.gobjList.renderList,function(G){return G.needsRenderInit});function F(H,J,K){var G;try{G=K.dcForGObj(J);if(G){K.renderRefCon.gobj[J.id]=J.renderPrepare(G,{})}if(J.hasLabel){G=K.dcForGObjLabel(J);if(G){K.renderRefCon.label[J.id]=J.renderLabelPrepare(G,{})}}J.needsRenderInit=false}catch(I){I.code="GSP.Error.renderPrepareException";I.message=y.Strings.loc("GSP.Error.renderPrepareException",J.id,J.kind,I);y.signalCaughtError(I)}}this.eachGObj(E,F)},renderCleanupGObj:function(G){var H=this;try{var E=H.dcForGObj(G);if(E){G.renderCleanup(E,H.renderRefCon.gobj[G.id])}if(G.hasLabel){E=H.dcForGObjLabel(G);if(E){G.renderLabelCleanup(E,H.renderRefCon.label[G.id])}}if(H.renderRefCon.gobj[G.id]){delete H.renderRefCon.gobj[G.id]}if(H.renderRefCon.label[G.id]){delete H.renderRefCon.label[G.id]}if(H.renderRefCon.dcForGObj[G.id]){delete H.renderRefCon.dcForGObj[G.id]}if(H.renderRefCon.geomBounds[G.id]){delete H.renderRefCon.geomBounds[G.id]}if(H.renderRefCon.renderBounds[G.id]){delete H.renderRefCon.renderBounds[G.id]}if(H.renderRefCon.labelBounds[G.id]){delete H.renderRefCon.labelBounds[G.id]}}catch(F){F.code="GSP.Error.renderCleanupException";F.message=y.Strings.loc("GSP.Error.renderCleanupException",G.id,G.kind,F);y.signalCaughtError(F)}},renderCleanUp:function(){var E=this;this.eachGObj(this.getRenderList(),function(F,G){E.renderCleanupGObj(G)},{direction:"reverse"})},getName:function(){var E=this.spec.metadata;return E.title},toSpecObj:function(){var G={},E=this.gobjList.gobjects;G.metadata=g.extend(true,{},this.metadata);G.preferences=g.extend(true,{},this.spec.preferences);G.objects={};for(var F in E){if(E.hasOwnProperty(F)){G.objects[F]=E[F].toSpecObj()}}return G},cleanUp:function(){if(this.draw===null){return}this.event("UnloadPage",{document:this});this.eachGObj(function(F,G,H){try{if(G.destroy){G.destroy()}}catch(E){E.code="GSP.Error.destroyObjectException";E.message=y.Strings.loc("GSP.Error.destroyObjectException",G&&G.id,G&&G.kind,E);y.signalCaughtError(E)}},{direction:"reverse"});if(this.canvasNode){this.canvasNode.unbind()}this.renderCleanUp();if(this.draw){this.draw.destroy()}this.gobjList=null;this.draw=null;y.logPerf(this.monitor.report(this.getName(),"final"))},constrainAndRedraw:function(){this.constrain();this.render()},_displayJob:null,setNeedsDisplay:function(){var E=this;if(!y.JobScheduler.isActive(E._displayJob)){E._displayJob=this.jobScheduler.addJob(function(){E.constrain();E.render();E._displayJob=null;return false},{priority:"render"})}},onLoad:function(F){var E;if(this.gobjList.constraintList){for(E=0;E<this.gobjList.constraintList.length;E+=1){this.gobjList.constraintList[E].onLoad(this,F)}}},onUnload:function(){var E;if(this.gobjList.constraintList){for(E=0;E<this.gobjList.constraintList.length;E+=1){this.gobjList.constraintList[E].onUnload()}}},start:function(E){var F=this;if(F.state!=="started"){F.state="started";F.constrainAndRedraw();y.logPerf(F.monitor.report(F.getName(),"init"));F.monitor=new y.PerfMonitor();F.onLoad(E);if(F.getOption("perfTestMode")){F.jobScheduler.addJob(function(){F.dirtyRect=y.Geom.kInfiniteRect;F.isDirty=true;F.setNeedsDisplay()},{repeat:true})}}else{y.signalErrorWithCode("GSP.Error.invalidSketchStart")}return this},getCurrentPageId:function(){return this.metadata.id},stop:function(){if(this.state!=="stopped"){this.jobScheduler.clearAllJobs();this._displayJob=null;this.onUnload();this.state="stopped";this.cleanUp()}else{y.signalErrorWithCode("GSP.Error.invalidSketchStop")}return this},pause:function(){this.jobScheduler.clearAllJobs();this._displayJob=null;y.log("Paused sketch.");return this},resume:function(){this.setNeedsDisplay();y.log("Resumed sketch.");return this},cloneGObjects:function(K){var I,G,L,H,J=[],F={},E;for(I=0;I<K.length;I++){L=Object.create(K[I]);F[L.id]=L;J.push(L);L.isClone=true}for(I=0;I<J.length;I++){L=J[I];H=L.parents;L.parents={};for(G in H){E=H[G];L.parents[G]=F[E.id]?F[E.id]:E}H=L.parentsList;L.parentsList=[];for(G=0;G<H.length;G++){E=H[G];L.parentsList.push(F[E.id]?F[E.id]:E)}L.initializeClone(K[I])}return J},getDisplayObjForGObj:function(E){return this.renderRefCon.gobj[E.id]},hitGObj:function(L,N){N=N||{};var E=false,I=[],J=N.hotSpot,H=N.maxResults||1,M=N.gobjArray||this.gobjList.renderList,G=N.filter,K={};function F(O,P){if(G&&(G(P)===false)){return}if(P.isHittable()&&y.Geom.isIntersectRects(P.getGeomBounds(),L)){E=P.hitTest(L,J);if(E){I.push(P);if(I.length===H){return false}}}}this.eachGObj(M,F,{direction:"reverse"});if(N.maxResults===h){K.hitGObj=I[0];if(E!==true){K.customTracker=E}}else{K.hitArray=I}return K},eachGObj:function(F,L,M){var E,G,I,J,H,K=this;if(!g.isArray(F)){M=L;L=F;F=K.gobjList.constraintList}E=g.extend({direction:"forward"},M);H=E.direction==="forward";for(G=0;G<F.length;G++){I=H?F[G]:F[F.length-G-1];J=L.call(I,G,I,K);if(false===J){break}}return this},findExistingCoordSys:function(J){var I=null,E=-1,F=6,G,H;if(J){G=J.xAxisTrig?"trigonometric":"decimal";H=J.yAxisTrig?"trigonometric":"decimal"}this.eachGObj(function(L,M){var K=0;if(M.constraint==="CoordSys"&&M.state.exists){if(M.isVisible()){K+=4}if(M.getParent("axisX").style.tickNumbering===G){K+=1}if(M.getParent("axisY").style.tickNumbering===H){K+=1}if(K===F){I=M;return false}if(K>E){I=M;E=K}}});return I},verifyFromSpec:function(F){var E={success:true,failures:{}},G={};this.eachGObj(function(H,I,L){var K,M;function J(O){try{return I.verificationString(O)}catch(N){return"Verification Failed: "+String(N)}}I.eachParent(function(N,O){if(G[O.id]){G[I.id]=true;return false}});if(!G[I.id]){M=L.spec.objects[I.id].debug;K=M?J(M):"no expected data";if(K==="NO_VERIFICATION"){G[I.id]=true}else{if(K!==""){E.success=false;E.failures[I.id]=K;G[I.id]=true}}}});return E},selector:function(E){return g(E,this.canvasNode)},getOption:function(F){var E=this.options[F];return E!==h?E:y.gOptions[F]},translate:function(Q,P,K){var M,L;if(K){if(this.preferences.limitScrolling){var I=this.metadata.sketchRect,G=this.spec.metadata.sketchRect,O=I.right-I.left,F=I.bottom-I.top,H=G.right-G.left,J=G.bottom-G.top;L=g.extend(true,{},I);if(H>O){L.left=G.left;L.right=G.right}if(J>F){L.top=G.top;L.bottom=G.bottom}}else{L=g.extend(true,{},this.significantBounds);var E=this.metadata.sketchRect.right-this.metadata.sketchRect.left,N=this.metadata.sketchRect.bottom-this.metadata.sketchRect.top;L=y.Geom.insetRect(L,-E/2,-N/2)}if(Q<0){M=L.left-this.metadata.sketchRect.left;Q=(M>Q)?M:Q}else{if(Q>0){M=L.right-this.metadata.sketchRect.right;Q=(M<Q)?M:Q}}if(P<0){M=L.top-this.metadata.sketchRect.top;P=(M>P)?M:P}else{if(P>0){M=L.bottom-this.metadata.sketchRect.bottom;P=(M<P)?M:P}}}this.translateTraceLayer(Q,P);if(!((Q===0)&&(P===0))){this.metadata.sketchRect.left+=Q;this.metadata.sketchRect.right+=Q;this.metadata.sketchRect.top+=P;this.metadata.sketchRect.bottom+=P;this.invalidateRect(this.sketchRect());this.isDirty=true;this.setNeedsDisplay()}},primalToViewTransform:function(){return new y.AffineTransform({m00:1,m01:0,m10:0,m11:1,m20:-this.metadata.sketchRect.left,m21:-this.metadata.sketchRect.top})},viewToPrimalTransform:function(){return new y.AffineTransform({m00:1,m01:0,m10:0,m11:1,m20:this.metadata.sketchRect.left,m21:this.metadata.sketchRect.top})},sketchRect:function(){return g.extend(true,{},this.metadata.sketchRect)},pushTouchRegime:function(E){this._touchRegimes.push(E);E.isPushed=true},popTouchRegime:function(){var E=this._touchRegimes.pop();E.isPushed=false;if(E.delegate&&E.delegate.regimeDidPop){E.delegate.regimeDidPop(E)}return E},popAllTouchRegimesIncluding:function(F){if(!F.isPushed){return}var E;do{E=this.popTouchRegime()}while(E!==F)},hasTouchRegimes:function(){return this._touchRegimes.length>0},currentTouchRegime:function(){var E=this._touchRegimes.length-1;if(E<0){throw y.createError("currentTouchRegime called with no touch regime active")}return this._touchRegimes[E]},init:function(E,G,H){var F=this;F.document=E;F.state="created";F.Bap=new y.Bap(F);F.MotionManager=new y.MotionManager(F);F.labelPool=y.LabelPool.createInSketch(F);F.toolController=y.ToolController.createInSketch(F);F.Scroll=y.Scroll(F);F.options=g.extend(true,{},H,G.options);F.metadata=g.extend(true,{},G.metadata);F.preferences=g.extend(true,{},y.Prefs,G.preferences);if(!F.preferences.colorableComponents.Background["composite-mode"]){F.preferences.colorableComponents.Background["composite-mode"]=F.preferences.colorableComponents.Background.color==="white"?"destination":"source-over"}F.config={};if(G.config){g.extend(F.config,G.config)}F.sQuery=y.SQuery(F);F.gobjList=new y.GObjList();F.monitor=new y.PerfMonitor();F.spec=G;F.jobScheduler=y.JobScheduler.create();F._deferredGObjCalls={};y.log("Initializing gobjs");F.initGObjects(F.spec.objects);F.constraintFrame=0},attachToNode:function(G){var M=this,K=M.document,J=K.docSpec.metadata.width,N=K.docSpec.metadata.height,E,L,F,H,I={};M._touchRegimes=[];M.pushTouchRegime(y.DisplayRegime.createInSketch(M));H=g(".wsp-sketch-container",G[0]);H.empty();H.append('<div class="wsp-clip-node"></div>');F=M.canvasNode=g(".wsp-clip-node",G[0]);F.css({width:J,height:N});M.drawRefCon={};M.anchorNode=G;M.baseNode=g(".wsp-base-node",G);I.clip="rect(auto, auto, auto, auto)";E=parseInt(G.css("width"),10);L=parseInt(G.css("height"),10);if(M.metadata.sketchRect===h){M.metadata.sketchRect={top:0,left:0}}else{E=M.metadata.sketchRect.right-M.metadata.sketchRect.left;L=M.metadata.sketchRect.bottom-M.metadata.sketchRect.top}M.metadata.sketchRect.bottom=M.metadata.sketchRect.top+L;M.metadata.sketchRect.right=M.metadata.sketchRect.left+E;if(M.preferences.colorableComponents.Background["composite-mode"]==="source-over"){I["background-color"]=M.preferences.colorableComponents.Background.color}F.css(I);M.draw=y.draw.create({rootNode:F,width:J,height:N});M.traces={saturation:1,appliedAlpha:1,fadeStartTime:0};M.renderRefCon={gobj:{},label:{},dcForGObj:{},geomBounds:{},renderBounds:{},labelBounds:{}};M.isDirty=false;M.dirtyRect=null;if(!K.gobjectEventHandlers[M.getCurrentPageId()]){K.createSketchEventHandlersForPage(this.getCurrentPageId(),this)}M.canvasNode.mousetouch();M.canvasNode.bind("touchstart",function(O){return M.handleTouchStart(O)});M.canvasNode.bind("touchmove",function(O){return M.handleTouchMove(O)});M.canvasNode.bind("touchend touchcancel",function(O){return M.handleTouchEnd(O)});M.renderPrepare();y.registerEditable(M)}};return function(E,F,G){var I=null;if(typeof F==="string"){try{F=JSON.parse(F)}catch(H){y.signalErrorWithCode("GSP.Error.invalidSketch");return null}}I=Object.create(D);I.init(E,F,G);return I}}());y.Sketch.allConstraints=function(){var D,F,E=[];for(D in y.gConstraints){if(y.gConstraints.hasOwnProperty(D)){F=y.gConstraints[D];if(F.doc&&F.doc.usage&&!F.doc.usage["abstract"]){E.push(D)}}}return E};y.Sketch.supportCheck=function(N,L){var K={count:0,supportedCount:0,unsupported:{},constraints:{},support:"full",message:'All Sketch Objects: <span class="expected">Supported</span>'},I=N.objects,F,D;for(F in I){if(I.hasOwnProperty(F)){var M=I[F],G=y.getKindObj(M.kind),E=y.getConstraintObj(M.constraint),J=G&&G.kindSupportsSpecObj(M,I),H=E&&E.constraintSupportsSpecObj(M,I);K.count++;if(!J||!H){D={};if(!J){D.kind=M.kind}if(!H){D.constraint=M.constraint}K.unsupported[F]=D}else{K.constraints[M.constraint]=K.constraints[M.constraint]||0;K.constraints[M.constraint]++;K.supportedCount++}}}if(K.supportedCount!==K.count){K.support="none";K.message='Some Sketch Objects: <span class="error">Not Supported</span>'}return K};y.ControlList=(function(){var D=["gobj","isController","isDragRoot","isTransformParent","controlIndex"];function E(G){var I="{",F,H;for(F=0;F<D.length;F++){H=G[D[F]];if(D[F]==="gobj"){if(typeof(H)==="object"){H=H.id}}if(F>0){I+=","}I+='"'+D[F]+'":'+H}I+="}";return I}return{fromExternalList:function(G,J){var H=[],F,I;for(F=0;F<G.length;F++){I=g.extend(true,{},G[F]);I.gobj=J.gobjList.gobjects[I.gobj];H.push(I)}return H},toString:function(G){var F,H="";for(F=0;F<G.length;F++){if(F>0){H+=","}H+=E(G[F])}return H}}}());y.BapEdgeInfo={Free:{Default:{edgeType:"dEdge",sortIndex:0}},PictureFree:{Default:{edgeType:"dEdge",sortIndex:0}},Midpoint:{path:{edgeType:"dEdge",sortIndex:0}},Segment:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},CircleFromTwoPoints:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},CircleByRadius:{p0:{edgeType:"dEdge",sortIndex:0},radius:{edgeType:"iEdge",sortIndex:1}},Perpendicular:{p0:{edgeType:"dEdge",sortIndex:0},line:{edgeType:"iEdge",sortIndex:1}},Parallel:{p0:{edgeType:"dEdge",sortIndex:0},line:{edgeType:"iEdge",sortIndex:1}},AngleBisector:{A:{edgeType:"dEdge",sortIndex:0},B:{edgeType:"dEdge",sortIndex:1},C:{edgeType:"dEdge",sortIndex:2}},PolygonFromPoints:{Default:{edgeType:"dEdge",sortIndex:0}},Intersection:{line0:{edgeType:"dEdge",sortIndex:0},line1:{edgeType:"dEdge",sortIndex:1}},CircleInterior:{circle:{edgeType:"dEdge",sortIndex:0}},Intersection1:{obj:{edgeType:"dEdge",sortIndex:0},circle:{edgeType:"dEdge",sortIndex:1}},Intersection2:{obj:{edgeType:"dEdge",sortIndex:0},circle:{edgeType:"dEdge",sortIndex:1}},PointOnPath:{path:{edgeType:"iEdge",sortIndex:0}},PointOnPolygonEdge:{path:{edgeType:"iEdge",sortIndex:0}},IterateMap:{Default:{edgeType:"zEdge",sortIndex:0}},IterateMapByParametricDepth:{parameter:{edgeType:"zEdge",sortIndex:0},Default:{edgeType:"zEdge",sortIndex:1}},IterateImage:{source:{edgeType:"dEdge",sortIndex:0},map:{edgeType:"dEdge",sortIndex:1}},PointTerminalIteration:{image:{edgeType:"dEdge",sortIndex:0}},TranslateVector:{source:{edgeType:"rEdge",sortIndex:0},p0:{edgeType:"iEdge",sortIndex:1},p1:{edgeType:"iEdge",sortIndex:2}},TranslateFixXFixY:{source:{edgeType:"rEdge",sortIndex:0}},TranslateFixXMeasureY:{source:{edgeType:"rEdge",sortIndex:0},measure:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureXFixY:{source:{edgeType:"rEdge",sortIndex:0},measure:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureXMeasureY:{source:{edgeType:"rEdge",sortIndex:0},measureX:{edgeType:"mEdge",sortIndex:1},measureY:{edgeType:"mEdge",sortIndex:2}},TranslateFixDistFixAngle:{source:{edgeType:"rEdge",sortIndex:0}},TranslateFixDist3PtAngle:{source:{edgeType:"rEdge",sortIndex:0},A:{edgeType:"iEdge",sortIndex:1},B:{edgeType:"iEdge",sortIndex:2},C:{edgeType:"iEdge",sortIndex:3}},TranslateFixDistMeasureAngle:{source:{edgeType:"rEdge",sortIndex:0},measure:{edgeType:"mEdge",sortIndex:1}},TranslateFixDistAngleMarker:{source:{edgeType:"rEdge",sortIndex:0},marker:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureDistFixAngle:{source:{edgeType:"rEdge",sortIndex:0},distance:{edgeType:"mEdge",sortIndex:1}},TranslateMeasureDist3PtAngle:{source:{edgeType:"rEdge",sortIndex:0},A:{edgeType:"iEdge",sortIndex:1},B:{edgeType:"iEdge",sortIndex:2},C:{edgeType:"iEdge",sortIndex:3},distance:{edgeType:"mEdge",sortIndex:4}},TranslateMeasureDistMeasureAngle:{source:{edgeType:"rEdge",sortIndex:0},angle:{edgeType:"mEdge",sortIndex:1},distance:{edgeType:"mEdge",sortIndex:2}},TranslateMeasureDistAngleMarker:{source:{edgeType:"rEdge",sortIndex:0},marker:{edgeType:"mEdge",sortIndex:1},distance:{edgeType:"mEdge",sortIndex:2}},Rotate:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1}},Rotate3:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},A:{edgeType:"iEdge",sortIndex:2},B:{edgeType:"iEdge",sortIndex:3},C:{edgeType:"iEdge",sortIndex:4}},RotateMeasureAngle:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},angle:{edgeType:"mEdge",sortIndex:2}},RotateAngleMarker:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},angle:{edgeType:"tEdge",sortIndex:2}},DilateFixFactor:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1}},Dilate2SegRatio:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},seg0:{edgeType:"mEdge",sortIndex:2},seg1:{edgeType:"mEdge",sortIndex:3}},Dilate3PtRatio:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},A:{edgeType:"iEdge",sortIndex:2},B:{edgeType:"iEdge",sortIndex:3},C:{edgeType:"iEdge",sortIndex:4}},DilateMeasureFactor:{source:{edgeType:"rEdge",sortIndex:0},center:{edgeType:"tEdge",sortIndex:1},measure:{edgeType:"mEdge",sortIndex:2}},Reflect:{source:{edgeType:"rEdge",sortIndex:0},mirror:{edgeType:"tEdge",sortIndex:1}},GeomLocus:{drivenObject:{edgeType:"dEdge",sortIndex:0},domainObject:{edgeType:"iEdge",sortIndex:1},driverObject:{edgeType:"iEdge",sortIndex:2},Default:{edgeType:"iEdge",sortIndex:3}},MeasurementLength:{path:{edgeType:"zEdge",sortIndex:0}},MeasurementDistance:{p0:{edgeType:"zEdge",sortIndex:0},obj0:{edgeType:"zEdge",sortIndex:1}},MeasurementPerimeter:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementCircumference:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementAngle:{p0:{edgeType:"zEdge",sortIndex:0},p1:{edgeType:"zEdge",sortIndex:1},p2:{edgeType:"zEdge",sortIndex:2}},MeasurementAngleMarker:{marker:{edgeType:"zEdge",sortIndex:0}},MeasurementArea:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementArcAngle:{arc:{edgeType:"zEdge",sortIndex:0}},MeasurementArcOnCircleAngle:{circle:{edgeType:"zEdge",sortIndex:0},p0:{edgeType:"zEdge",sortIndex:1},p1:{edgeType:"zEdge",sortIndex:2},p2:{edgeType:"zEdge",sortIndex:3}},MeasurementArcLength:{arc:{edgeType:"zEdge",sortIndex:0}},MeasurementArcOnCircleLength:{circle:{edgeType:"zEdge",sortIndex:0},p0:{edgeType:"zEdge",sortIndex:1},p1:{edgeType:"zEdge",sortIndex:2},p2:{edgeType:"zEdge",sortIndex:3}},GeometricSlope:{straight:{edgeType:"zEdge",sortIndex:0}},MeasurementRadius:{shape:{edgeType:"zEdge",sortIndex:0}},MeasurementRatio:{obj0:{edgeType:"zEdge",sortIndex:0},obj1:{edgeType:"zEdge",sortIndex:1},obj2:{edgeType:"zEdge",sortIndex:2}},Calculation:{Default:{edgeType:"zEdge",sortIndex:0}},MeasurementRectCoordinates:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},LinearEquationM_C:{Default:{edgeType:"zEdge",sortIndex:0}},QuadraticEquationM_C:{Default:{edgeType:"zEdge",sortIndex:0}},HorizontalUnitPoint:{origin:{edgeType:"iEdge",sortIndex:0}},VerticalUnitPoint:{origin:{edgeType:"iEdge",sortIndex:0}},UnitPointInternalSquare:{unitPoint:{edgeType:"rEdge",sortIndex:0}},UnitPointInternalRectangle:{unitPoint:{edgeType:"iEdge",sortIndex:0}},UnitPointExternalSquare:{axis:{edgeType:"dEdge",sortIndex:0}},UnitPointExternalRectangle:{axis:{edgeType:"iEdge",sortIndex:0}},AxisInternalDist:{origin:{edgeType:"dEdge",sortIndex:0},unitPoint:{edgeType:"dEdge",sortIndex:1}},AxisExternalDist:{origin:{edgeType:"dEdge",sortIndex:0},unitDistance:{edgeType:"mEdge",sortIndex:1}},AxisUnitCircle:{circle:{edgeType:"dEdge",sortIndex:0}},CoordSys:{axisX:{edgeType:"dEdge",sortIndex:0},axisY:{edgeType:"dEdge",sortIndex:1}},ActionButton:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonToggleHideShow:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonHide:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonShow:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonAnimate:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonMove:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonScroll:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonLinkPage:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonLinkURL:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonPresentSequentially:{Default:{edgeType:"nEdge",sortIndex:0}},ActionButtonPresentSimultaneously:{Default:{edgeType:"nEdge",sortIndex:0}},Line:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},Ray:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1}},MeasurementAbscissa:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},MeasurementOrdinate:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},MeasurementPolarDistance:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},MeasurementPolarDirection:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},PlotFixedXFixedY:{coordSys:{edgeType:"dEdge",sortIndex:0}},PlotFixedXMarkedY:{coordY:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedXFixedY:{coordX:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedXMarkedY:{coordX:{edgeType:"mEdge",sortIndex:0},coordY:{edgeType:"mEdge",sortIndex:1},coordSys:{edgeType:"dEdge",sortIndex:2}},PlotFixedRhoFixedTheta:{coordSys:{edgeType:"dEdge",sortIndex:0}},PlotFixedRhoMarkedTheta:{coordTheta:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedRhoFixedTheta:{coordRho:{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},PlotMarkedRhoMarkedTheta:{coordRho:{edgeType:"mEdge",sortIndex:0},coordTheta:{edgeType:"mEdge",sortIndex:1},coordSys:{edgeType:"dEdge",sortIndex:2}},Function:{Default:{edgeType:"zEdge",sortIndex:0}},FunctionPlot:{"function":{edgeType:"mEdge",sortIndex:0},coordSys:{edgeType:"dEdge",sortIndex:1}},CompositeText:{Default:{edgeType:"zEdge",sortIndex:0}},MeasurementPolarCoordinates:{point:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},ColorizeUnivariate:{source:{edgeType:"dEdge",sortIndex:0},color:{edgeType:"oEdge",sortIndex:1}},ColorizeTrivariate:{source:{edgeType:"dEdge",sortIndex:0},blue:{edgeType:"oEdge",sortIndex:1},green:{edgeType:"oEdge",sortIndex:2},red:{edgeType:"oEdge",sortIndex:3}},Derivative_C:{Default:{edgeType:"zEdge",sortIndex:0}},ArcOnCircle:{circle:{edgeType:"dEdge",sortIndex:0},p0:{edgeType:"dEdge",sortIndex:1},p1:{edgeType:"dEdge",sortIndex:2}},ArcAroundPoint:{center:{edgeType:"dEdge",sortIndex:0},p0:{edgeType:"dEdge",sortIndex:1},p1:{edgeType:"dEdge",sortIndex:2}},Arc3Points:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},ArcSector:{arc:{edgeType:"dEdge",sortIndex:0}},ArcSegment:{arc:{edgeType:"dEdge",sortIndex:0}},PictureHungOnOnePoint:{p0:{edgeType:"dEdge",sortIndex:0}},PictureCenteredOnOnePoint:{p0:{edgeType:"dEdge",sortIndex:0}},PictureBetweenTwoPoints:{p1:{edgeType:"dEdge",sortIndex:0},p0:{edgeType:"dEdge",sortIndex:1}},PictureAcrossThreePoints:{p2:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p0:{edgeType:"dEdge",sortIndex:2}},PictureCroppedByInterior:{source:{edgeType:"dEdge",sortIndex:0},cropInterior:{edgeType:"dEdge",sortIndex:1}},PictureFunction_C:{Default:{edgeType:"zEdge",sortIndex:0}},MeasurementCoordinateDistance:{p0:{edgeType:"zEdge",sortIndex:0},p1:{edgeType:"zEdge",sortIndex:1},coordSys:{edgeType:"zEdge",sortIndex:2}},MeasurementAnalyticSlope:{seg:{edgeType:"zEdge",sortIndex:0},coordSys:{edgeType:"zEdge",sortIndex:1}},Pegged:{p0:{edgeType:"dEdge",sortIndex:0},text:{edgeType:"iEdge",sortIndex:1}},UserTabulation_C:{Default:{edgeType:"zEdge",sortIndex:0}},IteratedValuesTable_C:{Default:{edgeType:"zEdge",sortIndex:0}},InterRayPolgon_C:{Default:{edgeType:"dEdge",sortIndex:0}},ParametricLocus:{drivenObject:{edgeType:"dEdge",sortIndex:0},driverObject:{edgeType:"iEdge",sortIndex:1},Default:{edgeType:"iEdge",sortIndex:2}},MeasurementValueOfPointOnPath:{point:{edgeType:"zEdge",sortIndex:0},path:{edgeType:"zEdge",sortIndex:1}},PlotValueOnPath:{param:{edgeType:"mEdge",sortIndex:0},path:{edgeType:"dEdge",sortIndex:1}},PlotFixedValueOnPath:{path:{edgeType:"dEdge",sortIndex:0}},InterApproxPathStitchedPath_C:{Default:{edgeType:"dEdge",sortIndex:0}},CustomTransformedPicture_C:{Default:{edgeType:"iEdge",sortIndex:0}},CustomTransformedPoint_C:{Default:{edgeType:"iEdge",sortIndex:0}},CustomTransformedPath:{drivenObject:{edgeType:"iEdge",sortIndex:0},domainObject:{edgeType:"dEdge",sortIndex:1},driverObject:{edgeType:"iEdge",sortIndex:2},Default:{edgeType:"iEdge",sortIndex:3}},AngleMarker_Simple:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},AngleMarker_Reflex:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},AngleMarker_CCW:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},AngleMarker_CW:{p0:{edgeType:"dEdge",sortIndex:0},p1:{edgeType:"dEdge",sortIndex:1},p2:{edgeType:"dEdge",sortIndex:2}},PathMarker:{path:{edgeType:"dEdge",sortIndex:0}},ParametricCartesianCurvePlot_C:{Default:{edgeType:"mEdge",sortIndex:0}},ParametricPolarCurvePlot_C:{Default:{edgeType:"mEdge",sortIndex:0}}};y.Bap=(function(){function E(K,H){var J=y.BapEdgeInfo[K.constraint],I,G;if(!J){y.signalErrorWithMessage("BAP [getEdgeForParentAtIndex] No edge info for constraint: "+K.constraint);return}for(I in J){if(J.hasOwnProperty(I)){if(J[I].sortIndex===H){G=J[I].edgeType;break}}}return G||J.Default.edgeType}function D(S,Y){var M={},U=[],V=[],G=[],O;function T(ae){M[ae.id]={gobj:ae,action:"none",transCode:0}}function W(ak,ag,al,am){var ai=ag,ae,af=E(ak,0);if(h===M[ak.id]){T(ak);if(ai==="selected"){if(("zEdge"!==af)&&("nEdge"!==af)){ai="controller"}else{M[ak.id].isSelectedZ=true}}}ae=M[ak.id].action;if(ae==="selected"){M[ak.id].action=ai;M[ak.id].transCode=al;ae=ai}if((ai===ae)&&(al===M[ak.id].transCode)){return}if((ai==="controller")&&M[ak.id].isController){return}if(ae&&ae!=="none"){if(("constrain"===ai)&&M[ak.id].isLink&&(am&&M[ak.id].transCode===M[am.id].transCode)){if(M[am.id].isLink){return}if(!M[ak.id].isController){ai="link"}}var ah={},aj={none:0,controller:1,link:2,constrained:3,follower:4,selected:5};ah[ae]=true;ah[ai]=true;if(ah.hasOwnProperty("link")&&ah.hasOwnProperty("constrained")&&((-1===al)||al===M[ak.id].transCode)){ai="link"}else{if(ah.hasOwnProperty("constrained")&&(ah.hasOwnProperty("link")||ah.hasOwnProperty("controller"))){ai="follower";al=0}}if(aj[ai]<aj[ae]){return}}else{U.push(ak)}M[ak.id].action=ai;if(0<=al){M[ak.id].transCode=al}}function L(ai,af,ah,ae,aj){var ag=function(am,an){var al=E(ai,am),ak=true;if(!af||af[al]){if(al==="zEdge"){if((!M[an.id]||(an.constraint==="Free"))&&an.kind==="Expression"){ak=false}else{if(!M[an.id]&&(ai.kind==="Expression"||!aj)){ak=false}}}else{if(al==="mEdge"&&!aj){ak=M[an.id]?true:false}}if(ak){if("link"===ah){if(!M[an.id]){T(an)}M[an.id].controller=ai}W(an,ah,ae)}}return true};ai.eachParent(ag,true)}function Z(ag){var ae={},af=function(aj,ak){var ah=M[ak.id],ai=E(ag,aj);if(ah&&!ah.isSelectedZ){switch(ai){case"rEdge":if(M[ak.id].controller!==ag){ae.incompatibleParent=true}break;case"dEdge":case"iEdge":case"tEdge":if(ah.transCode!==M[ag.id].transCode){ae.incompatibleParent=true}break}if(ae[ai]===h){ae[ai]="allAffected"}else{if(ae[ai]==="noneAffected"){ae[ai]="someAffected"}}}else{if(ae[ai]===h){ae[ai]="noneAffected"}else{if(ae[ai]==="allAffected"){ae[ai]="someAffected"}}}return true};ag.eachParent(af,true);return ae}var P=[];function ab(ah){var af,ae;function ai(al,ak){var aj=true;if(al.parents.length!==ak.parents.length){return false}al.eachParent(function(am,an){if("rEdge"!==E(al,am)){if(an!==ak.parentsList[am]){aj=false;return false}}return true},true);return aj}function ag(ao,am){var ak,aj,an,al;ak=ao.getTransformer();aj=am.getTransformer();an=ak.getAffineTransform();al=aj.getAffineTransform();return an.isEqual(al)}for(af=0;af<P.length;af++){ae=P[af];if((ae===ah)&&(M[ae.id].isLink)){return af+1}if((M[ae.id].transCode===M[ah.id].transCode)&&(M[ae.id].isLink)&&(ae.constraint===ah.constraint)&&ai(ae,ah)&&ag(ae,ah)){return af+1}}P.push(ah);return af+1}function I(ah,ae){var ag={zEdge:true,dEdge:true},af=true;if(ae.iEdge&&(ae.iEdge!=="noneAffected")){ag.iEdge=true;ag.rEdge=true;ag.tEdge=true}if((ae.iEdge==="noneAffected")||(ae.mEdge==="noneAffected")||(ae.mEdge==="someAffected")){af=false}if((ae.rEdge&&(ae.rEdge!=="noneAffected")&&ae.incompatibleParent)||(ae.tEdge&&(ae.tEdge!=="noneAffected"))){ag.tEdge=true;ag.rEdge=true}if(ae.tEdge==="noneAffected"){af=false}if(ae.mEdge&&(ae.mEdge!=="noneAffected")){ag.tEdge=true;ag.mEdge=true;ag.rEdge=true}if(af&&((!ae.mEdge)||ae.mEdge==="allAffected")){M[ah.id].completeFollower=true}L(ah,ag,"controller",-1,af)}function H(af,ae){if(M[af.id].isLink&&(M[af.id].controller)){W(M[af.id].controller,"follower",0,af)}M[af.id].transCode=0;M[af.id].controller=h;M[af.id].isConstrained=false;M[af.id].isLink=false;M[af.id].isDragRoot=false;M[af.id].isController=false;M[af.id].isFollower=true;L(af,{zEdge:true,dEdge:true},"controller",0);I(af,ae)}function ad(ag,ae){if(M[ag.id].isLink){var af=function(){var ai=(ae.iEdge==="someAffected")||(ae.iEdge==="allAffected")||(ae.mEdge==="someAffected")||(ae.mEdge==="allAffected")||(ae.tEdge==="someAffected")||(ae.tEdge==="allAffected");if(!ai){if(ae.dEdge){ag.eachParent(function(ak,al){if(("dEdge"===E(ag,ak))&&M[al.id]){if((M[al.id].transCode!==M[ag.id].transCode)||(!M[al.id].isLink)){ai=true;return false}}return true},true)}else{if(ae.rEdge){var ah=ab(ag),aj=ag.parentsList[0];ai=((ah!==0)&&aj&&(ah!==M[aj.id].transCode))}}}return ai};if(af()){H(ag,ae)}}else{if(M[ag.id].isFollower&&!M[ag.id].completeFollower){I(ag,ae)}}if(M[ag.id].isSelectedZ&&!M[ag.id].isConstrained){M[ag.id].kidsAreConstrained=false}M[ag.id].isConstrained=true}function ac(af,ae){if(!ae.incompatibleParent&&!ae.dEdge&&!ae.rEdge&&(!ae.iEdge||ae.iEdge==="noneAffected")&&(!ae.tEdge||ae.tEdge==="noneAffected")&&(!ae.mEdge||ae.mEdge==="noneAffected")){M[af.id].isLink=true;if("zEdge"!==E(af,0)){M[af.id].isDragRoot=true}else{L(af,{zEdge:true},"link",M[af.id].transCode)}}else{if((ae.tEdge&&ae.tEdge!=="noneAffected")||((ae.iEdge&&ae.iEdge!=="noneAffected")&&ae.rEdge)){return H(af,ae)}else{if(ae.incompatibleParent){return H(af,ae)}else{M[af.id].isLink=true;if(!M[af.id].transCode){M[af.id].isFollower=true}L(af,{dEdge:true},"link",M[af.id].transCode);if(ae.rEdge==="noneAffected"){L(af,{rEdge:true},"link",ab(af))}if(ae.iEdge&&ae.iEdge!=="noneAffected"){L(af,{tEdge:true,iEdge:true},"link",M[af.id].transCode);if((0===M[af.id].transCode)&&(!ae.mEdge||ae.mEdge==="allAffected")){M[af.id].completeFollower=true}}else{if(ae.tEdge&&ae.tEdge!=="noneAffected"){L(af,{tEdge:true},"link",M[af.id].transCode);if((0===M[af.id].transCode)&&(!ae.mEdge||ae.mEdge==="allAffected")&&!ae.iEdge){M[af.id].completeFollower=true}}else{if(!ae.iEdge&&!ae.tEdge&&(!ae.mEdge||ae.mEdge==="allAffected")&&(0===M[af.id].transCode)){M[af.id].completeFollower=true}}}if(ae.mEdge&&ae.mEdge!=="noneAffected"){L(af,{mEdge:true},"link",M[af.id].transCode)}}}}}function R(ai,ae){var ah=true,af;if("zEdge"===E(ai,0)){L(ai,{zEdge:true},"controller",0);ah=false}else{if((ae.iEdge&&(ae.iEdge!=="noneAffected"))||(ae.tEdge&&(ae.tEdge!=="noneAffected"))||(ae.mEdge&&(ae.mEdge!=="noneAffected"))){ah=false}else{if(ae.dEdge){L(ai,{dEdge:true},"controller",0);ah=false}else{if(ae.rEdge==="allAffected"){af=ai.parentsList[0];if(af&&(M[af.id].controller!==ai)){ah=false}}}}}if(!ah){return H(ai,ae)}if(M[ai.id].controller){W(M[ai.id].controller,"follower",0,ai);M[ai.id].controller=h}M[ai.id].isController=true;M[ai.id].isLink=true;M[ai.id].isFollower=true;if(!(ae.iEdge||ae.tEdge||ae.mEdge)){M[ai.id].completeFollower=true}M[ai.id].isDragRoot=(!(ae.rEdge)||(ae.dEdge))?true:false;if(ae.rEdge){var ag=ab(ai);af=ai.parentsList[0];if((ae.rEdge==="noneAffected")&&(!M[af.id]||(M[af.id].transCode!==ag))){if(!M[af.id]){T(af)}M[af.id].transCode=ag;M[af.id].controller=ai;L(ai,{rEdge:true},"link",ag)}}}function X(aj){var af;function ak(al,am){am.eachParent(function(ao,an){if(an===al){af=E(am,ao);return false}return true});return af}var ah,ag,ae,ai;for(ah=aj.children.length-1;ah>=0;ah--){ai=-1;ae=aj.children[ah];ag=ak(aj,ae);if("nEdge"!==ag){if("dEdge"===ag){ai=M[aj.id].transCode}W(ae,"constrained",ai,aj)}}M[aj.id].kidsAreConstrained=true}function K(){var ag,af,ae,ah;ag=U.shift();while(ag){af=M[ag.id];if(!af.addedToProcessed){V.push(ag);M[ag.id].addedToProcessed=true;if(af.action!=="selected"){af.isConstrained=true}}ae=Z(ag);ah=af.action;af.action="none";switch(ah){case"constrained":ad(ag,ae);break;case"link":ac(ag,ae);break;case"controller":R(ag,ae);break;case"follower":H(ag,ae);break}if((!af.isSelectedZ)&&(!af.kidsAreConstrained)&&(ag.constraint!=="Free"||ag.kind!=="Expression")){X(ag)}ag=U.shift()}}function Q(){var ai,al=[],am=[],ah,ag,aj;function af(){var ao=0,an,ap;function aq(ar,at){if(M[at.id]&&!M[at.id].hasBeenAddedToOrderedList&&!M[at.id].isSelectedZ){ap=false;return false}return true}while(V.length>0){ap=true;an=V[ao];an.eachParent(aq,true);if(ap){am.push(an);V.splice(ao,1);M[an.id].hasBeenAddedToOrderedList=true}else{ao++}if(ao===V.length){ao=0}}}function ak(ap){var ao,an;for(ao=0;ao<al.length;ao++){if(al[ao].gobj===ap){an=ao}}return an}function ae(){var ap,an,aq,ao;for(ap=0;ap<al.length;ap++){if((al[ap].controlRefs===0)&&!al[ap].isDragRoot){aq=al[ap].controlIndex;for(an=ap+1;an<al.length;an++){if(al[an].controlIndex>ap){al[an].controlIndex--}}ao=al.slice(ap+1);al.splice(ap);al=al.concat(ao);if(aq>=0){al[aq].controlRefs--;ap=aq-1}else{ap--}}}}af();for(ah=am.length-1;ah>=0;ah--){ai=am[ah];ag=M[ai.id];if(ag.isController||ag.isLink||ag.isDragRoot||ag.isSelectedZ){if(ag.isSelectedZ){ag.isController=true;ag.isDragRoot=true}aj={gobj:ai,isController:ag.isController?true:false,isDragRoot:ag.isDragRoot?true:false,controlRefs:0};if(aj.isController){aj.controlIndex=-1;aj.isTransformParent=false}else{aj.controlIndex=ak(ag.controller);aj.isTransformParent=(M[ag.controller.id].transCode!==ag.transCode);al[aj.controlIndex].controlRefs++}al.push(aj)}}ae();return al}function aa(){var af,ae=[];for(O=0;O<S.length;O++){af=S[O].parentsList;if((S[O].constraint==="GeomLocus")&&(af[0]===af[af.length-1])){ae.push({gobj:S[O],parent:S[O].parentsList.pop()})}}return ae}function N(ae){var af;if(ae){for(af=0;af<ae.length;af++){ae[af].gobj.parentsList.push(ae[af].parent)}}}var J=aa();for(O=0;O<S.length;O++){W(S[O],"selected",0)}K();G=Q();N(J);return G}var F={createControlList:function(I){var G,H=I[0];if(this.sketch.getOption("bap-useDebugControlList")&&I.length===1&&H.debug&&H.debug.controlList){G=y.ControlList.fromExternalList(H.debug.controlList,this.sketch)}else{G=D(I,this.sketch)}return G}};return function(H){var G=Object.create(F);G.sketch=H;return G}}());if(typeof l.btoa==="undefined"){var o={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(F){var D="";var M,K,I,L,J,H,G;var E=0;F=o._utf8_encode(F);while(E<F.length){M=F.charCodeAt(E++);K=F.charCodeAt(E++);I=F.charCodeAt(E++);L=M>>2;J=((M&3)<<4)|(K>>4);H=((K&15)<<2)|(I>>6);G=I&63;if(isNaN(K)){H=G=64}else{if(isNaN(I)){G=64}}D=D+this._keyStr.charAt(L)+this._keyStr.charAt(J)+this._keyStr.charAt(H)+this._keyStr.charAt(G)}return D},decode:function(F){var D="";var M,K,I;var L,J,H,G;var E=0;F=F.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(E<F.length){L=this._keyStr.indexOf(F.charAt(E++));J=this._keyStr.indexOf(F.charAt(E++));H=this._keyStr.indexOf(F.charAt(E++));G=this._keyStr.indexOf(F.charAt(E++));M=(L<<2)|(J>>4);K=((J&15)<<4)|(H>>2);I=((H&3)<<6)|G;D=D+String.fromCharCode(M);if(H!=64){D=D+String.fromCharCode(K)}if(G!=64){D=D+String.fromCharCode(I)}}D=o._utf8_decode(D);return D},_utf8_encode:function(E){E=E.replace(/\r\n/g,"\n");var D="";for(var G=0;G<E.length;G++){var F=E.charCodeAt(G);if(F<128){D+=String.fromCharCode(F)}else{if((F>127)&&(F<2048)){D+=String.fromCharCode((F>>6)|192);D+=String.fromCharCode((F&63)|128)}else{D+=String.fromCharCode((F>>12)|224);D+=String.fromCharCode(((F>>6)&63)|128);D+=String.fromCharCode((F&63)|128)}}}return D},_utf8_decode:function(D){var E="";var F=0;var G=c1=c2=0;while(F<D.length){G=D.charCodeAt(F);if(G<128){E+=String.fromCharCode(G);F++}else{if((G>191)&&(G<224)){c2=D.charCodeAt(F+1);E+=String.fromCharCode(((G&31)<<6)|(c2&63));F+=2}else{c2=D.charCodeAt(F+1);c3=D.charCodeAt(F+2);E+=String.fromCharCode(((G&15)<<12)|((c2&63)<<6)|(c3&63));F+=3}}}return E}};y.btoa=function(D){return o.encode(D)}}else{y.btoa=function(D){return l.btoa(D)}}y.Scroll=function(E){var D=y.makeClass(y.TouchTracker,{primalLoc:null,touchBegan:function(G,F){E.event("StartScroll",{touch:F,position:G});this.primalLoc=y.GeometricPoint(G.x,G.y)},touchMoved:function(J,I){var G=y.GeometricPoint(J.x,J.y),H=this.primalLoc.subtract(G),F=this.primalLoc.copy();E.event("MoveScroll",{touch:I,position:J});E.primalToViewTransform().transform(F);E.translate(H.x,H.y,true);this.primalLoc=F.subtract(H);E.viewToPrimalTransform().transform(this.primalLoc)},touchEnded:function(F){E.event("EndScroll",{touch:F});this.primalLoc=null}});return{isScrolling:function(){return !!D.primalLoc},createTracker:function(){if(!this.isScrolling()){return D}},translate:function(H,G){var F,I=this.isScrolling();if(I){F=D.primalLoc.copy();E.primalToViewTransform().transform(F)}E.translate(H,G,false);if(I){E.viewToPrimalTransform().transform(F);D.primalLoc=F}}}};y.MotionManager=(function(){function E(I,G){var J=[],H,F;if(I.isValueChangingMotion!==G.isValueChangingMotion){return false}if(!(I.controlList&&G.controlList)){y.signalErrorWithMessage("motionsConflict finds motion without a control list");return false}for(H=I.controlList.length-1;H>=0;H--){if(I.controlList[H].isDragRoot){J.push(I.controlList[H].gobj)}}for(H=G.controlList.length-1;H>=0;H--){if(G.controlList[H].isDragRoot){for(F=0;F<J.length;F++){if(J[F]===G.controlList[H].gobj){return true}}}}return false}var D={_motionJob:null,StartMotion:function(F,K){var L=this.motionID++,H,G=this;this.motionSet[L]={motion:F,state:"active",refCon:K};for(H=0;H<this.motionList.length;H++){if(E(this.motionSet[this.motionList[H]].motion,F)){y.log("found conflicting motions, canceling "+this.motionList[H]+", keeping "+L);this.EndMotion(this.motionList[H])}}this.motionList.push(L);function J(){return G.ApplyCurrent()}var I={repeat:true,done:function(){G._motionJob=null}};if(!y.JobScheduler.isActive(G._motionJob)){G._motionJob=G.sketch.jobScheduler.addJob(J,I)}return L},UpdateRefCon:function(G,F){this.motionSet[G].refCon=F},GetRefCon:function(F){return this.motionSet[F].refCon},EndMotion:function(F){this.motionSet[F].state="cancelled"},StopAllMotions:function(){var F=this.sketch;F.sQuery("Button").forEach(function(G){if(((G.constraint==="ActionButtonMove")||(G.constraint==="ActionButtonAnimate"))&&G.state.isActive){G.press(F)}})},ApplyCurrent:function(){var G,J,I=this;for(G=0;G<this.motionList.length;G++){J=this.motionSet[this.motionList[G]];if(J.state==="active"){try{J.motion.applyMotion(J.refCon)}catch(F){}}}for(G in this.motionList){J=this.motionSet[this.motionList[G]];if(J.state==="cancelled"){try{J.motion.completeMotion(J.refCon)}catch(H){}delete this.motionSet[this.motionList[G]]}}this.motionList=g.grep(this.motionList,function(K){return h!==I.motionSet[K]});if(this.motionList.length===0){return false}},ApplyTransformToControlList:function(P,G,S,M){var J,R,L,O=M&&M.snapPoints&&P.preferences.snapToGrid,K,H;if(O){K=P.findExistingCoordSys()}for(J=0;J<S.length;J++){R=S[J];L=R.gobj;H=K;if(O&&!H&&L.style.snapToGrid){H=L.getGObjRef(L.style.snapToGrid)}if(R.isController){R.transform=G}else{R.transform=S[R.controlIndex].transform}if(R.isTransformParent){var I=S[R.controlIndex],N=I.gobj.getTransformer(),Q=N.getAffineTransform(),F;F=Q.inverse();if(null!==F){R.transform=Q.compose(I.transform).compose(F)}}if(R.isDragRoot&&L.state.exists){if(M&&M.onPathTracksIdealLoc&&R.gobj.kind==="Point"){if(!R.idealLocation){R.idealLocation={loc:R.gobj.geom.loc.copy()}}R.idealLocation.loc=R.transform.transform(R.idealLocation.loc);L.transform(P,{geom:(R.idealLocation),affine:y.AffineTransform.Identity})}else{L.transform(P,{geom:R.gobj.geom,affine:R.transform})}if((L.kind==="Point")&&H){if(H.snapPoint&&H.state.exists&&!L.hasDescendant(H)){H.snapPoint(L.geom.loc)}}L.sQuery.sketch.invalidateGeom(L)}}}};return function(G){var F=Object.create(D);F.motionList=[];F.sketch=G;F.motionID=0;F.motionSet={};return F}}());y.registerEditable=function(F){function I(){try{if(!r.activeElement&&typeof(r.body.setActive)==="function"){r.body.setActive()}}catch(J){}}function H(){return F.currentTouchRegime().name!=="BackClickRegime"}var G=F.sQuery;function E(L,N,K){var M=G().get(N),J=L.data("wsp-numfield-ctl");J.click(K,M);I();M.state.selected=true;return false}function D(J){var K=g(this),L=K.parents(".wsp-Expression").attr("wsp-id");if(!H()){return}return E(K,L,J)}g(F.canvasNode).on("click",".mfs-input",D);g(F.canvasNode).on("keypress",".mfs-input",function(J){var K=J.which;if(!H()){return}if(K===13){g(this).blur();return false}})};y.GeometricPoint=(function(){var D={transformClass:"GeometricPoint",getX:function(){return this.x},getY:function(){return this.y},toString:function(){return"{ x:"+this.x+", y:"+this.y+"}"},equals:function(E,F){if(typeof F==="undefined"){F=0}if(E){return(Math.abs(this.x-E.x)<=F&&Math.abs(this.y-E.y)<=F)}else{return false}},negate:function(){return y.GeometricPoint(-this.x,-this.y)},round:function(){return y.GeometricPoint(Math.round(this.x),Math.round(this.y))},add:function(E){return y.GeometricPoint(this.x+E.getX(),this.y+E.getY())},subtract:function(E){return y.GeometricPoint(this.x-E.getX(),this.y-E.getY())},multiply:function(E){return y.GeometricPoint(this.x*E,this.y*E)},dot:function(E){return(this.x*E.getX())+(this.y*E.getY())},vLength:function(){return Math.sqrt(this.dot(this))},distance:function(E){return this.subtract(E).vLength()},vLength2:function(){return this.dot(this)},l1Norm:function(){return Math.abs(this.x)+Math.abs(this.y)},isZeroLength:function(){return(this.x===0&&this.y===0)},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},isDefined:function(){return !isNaN(this.x)&&!isNaN(this.y)},rotate:function(F,J){var I=this.subtract(F);var H=Math.cos(J);var G=Math.sin(J);var E=y.GeometricPoint(H*I.x-G*I.y,G*I.x+H*I.y);return E.add(F)},unit:function(){return this.multiply(1/this.vLength())},scale:function(E,F){return this.subtract(E).multiply(F).add(E)},copy:function(){return this.multiply(1)}};return function(E,G){var F;if(typeof E==="string"){E=Number(E)}if(typeof E!=="number"){E=NaN}if(typeof G==="string"){G=Number(G)}if(typeof G!=="number"){G=NaN}F=Object.create(D);F.x=E;F.y=G;return F}}());y.GeometricPoint.ORIGIN=y.GeometricPoint(0,0);y.GeometricPoint.INFINITY=y.GeometricPoint(Infinity,Infinity);y.GeometricPoint.UNDEFINED=y.GeometricPoint(h,h);y.GeometricPoint.FromCenterRadiusAngle=function(E,D,F){return y.GeometricPoint(E.x+D*Math.cos(F),E.y+D*Math.sin(F))};y.GeometricPoint.threePointAngle=function(F,D,J){var H,E,G,I;H=F.subtract(D);G=J.subtract(D);E=new y.GeometricPoint(G.dot(H),G.y*H.x-G.x*H.y);H=new y.GeometricPoint(H.dot(H),0);if(Math.abs(H.x)<0.0004){return h}if(Math.abs(E.x)<0.0004){if(Math.abs(E.y)<0.0004){return h}else{if(E.y>0){I=Math.PI/2}else{I=-Math.PI/2}}}else{if(Math.abs(E.y)<0.0004){I=(E.x>=0)?0:Math.PI}else{I=Math.atan(E.y/E.x);if(E.x<0){if(E.y>=0){I+=Math.PI}else{I-=Math.PI}}}}return I};y.GeometricPoint.threePointFlippedAngle=function(E,D,G){var F=y.GeometricPoint.threePointAngle(E,D,G);if((Math.abs(F)>0)&&(Math.abs(F)<Math.PI)){F=-F}return F};y.GeometricPoint.expect=function(F,E,D){if((F===h)!==(E===h)){return false}if((F===null)!==(E===null)){return false}return y.math.expect(F.getX(),E.getX(),D,true)&&y.math.expect(F.getY(),E.getY(),D,true)};y.GeometricPoint.mapPointToLine=function(K,J,I,F){var D,G,H,E={};D=I.subtract(K);G=J.subtract(K);H=D.dot(G)/G.dot(G);if(F){if(F.clampP0&&H<0){H=0}if(F.clampP1&&H>1){H=1}if(F.returnPoint){E.point=K.add(G.multiply(H))}}E.param=H;return E};y.GeometricPoint.curryFunction=function(D){var E=Array.prototype.slice.call(arguments,1);return function(F){return F[D].apply(F,E)}};(function(){var H,D,F=["m00","m10","m20","m01","m11","m21"],G=6;function E(K,J){var I=K,L=J;if(L===h){I=K.hasOwnProperty("dx")?K.dx:K.x;L=K.hasOwnProperty("dy")?K.dy:K.y}return{x:I,y:L}}H={transformClass:"AffineTransform",toString:function(){var I="[";I+="[m00: "+this.m00+" m10: "+this.m10+" m20: "+this.m20+"]";I+="[m01: "+this.m01+" m11: "+this.m11+" m21: "+this.m21+"]";I+="]";return I},toStringCSS:function(){return"matrix("+this.m00+","+this.m01+","+this.m10+","+this.m11+","+this.m20+","+this.m21+")"},transform:function(J){var I,K,L;if(J.getX&&J.getY){K=this.m00*J.getX()+this.m10*J.getY()+this.m20;L=this.m01*J.getX()+this.m11*J.getY()+this.m21;J.x=K;J.y=L;return J}else{if(typeof(J)==="object"){for(I in J){this.transform(J[I])}}}},compose:function(I){return new D({m00:I.m00*this.m00+I.m10*this.m01,m10:I.m00*this.m10+I.m10*this.m11,m20:I.m00*this.m20+I.m10*this.m21+I.m20,m01:I.m01*this.m00+I.m11*this.m01,m11:I.m01*this.m10+I.m11*this.m11,m21:I.m01*this.m20+I.m11*this.m21+I.m21})},translate:function(J,I){var K=E(J,I);return new D({m00:this.m00,m10:this.m10,m20:this.m20+K.x,m01:this.m01,m11:this.m11,m21:this.m21+K.y})},scale:function(K,I){var J=E(K,I);return new D({m00:this.m00*J.x,m10:this.m10*J.x,m20:this.m20*J.x,m01:this.m01*J.y,m11:this.m11*J.y,m21:this.m21*J.y})},rotate:function(K){var J=Math.cos(K),I=Math.sin(K);return new D({m00:J*this.m00-I*this.m01,m10:J*this.m10-I*this.m11,m20:J*this.m20-I*this.m21,m01:I*this.m00+J*this.m01,m11:I*this.m10+J*this.m11,m21:I*this.m20+J*this.m21})},inverse:function(){var I=this.m00*this.m11-this.m10*this.m01;if(!I){return null}return new D({m00:this.m11/I,m10:-this.m10/I,m20:(-this.m11*this.m20+this.m10*this.m21)/I,m01:-this.m01/I,m11:this.m00/I,m21:(this.m01*this.m20-this.m00*this.m21)/I})},copy:function(){return new D(this)},isEqual:function(I){return(this.m00===I.m00)&&(this.m10===I.m10)&&(this.m20===I.m20)&&(this.m01===I.m01)&&(this.m11===I.m11)&&(this.m21===I.m21)},isTranslation:function(){return(this.m00===1)&&(this.m10===0)&&(this.m01===0)&&(this.m11===1)},packIntoSampleArray:function(J,I){var K=G*I;J[K]=this.m00;J[K+1]=this.m10;J[K+2]=this.m20;J[K+3]=this.m01;J[K+4]=this.m11;J[K+5]=this.m21}};D=function(J){var L=Object.create(H),I,K;for(I in F){K=F[I];L[K]=J.hasOwnProperty(K)?J[K]:0}return L};D.Identity=new D({m00:1,m11:1});D.KeyNames=F;D.fromPointTransform=function(M){var N=M(y.GeometricPoint(0,0)),K=M(y.GeometricPoint(1,0)),I=M(y.GeometricPoint(0,1)),L=N.getX(),J=N.getY();return new D({m00:K.getX()-L,m01:K.getY()-J,m10:I.getX()-L,m11:I.getY()-J,m20:L,m21:J})};D.fromPointMapping=function(M,O){var I=M[2].subtract(M[1]),L=M[2].subtract(M[0]),K=I.getY()*L.getX()+I.getX()*(-L.getY()),N,J=null;if(K!==0){N=function(Q){var T=Q.subtract(M[2]),S=(-I.getY()*T.getX()+I.getX()*T.getY())/K,R=(L.getY()*T.getX()+-L.getX()*T.getY())/K,P=1-S-R;return O[0].multiply(S).add(O[1].multiply(R)).add(O[2].multiply(P))};J=y.AffineTransform.fromPointTransform(N)}return J};D.fromPackedSampleArray=function(K,I){var L=I*G,J={m00:K[L],m10:K[L+1],m20:K[L+2],m01:K[L+3],m11:K[L+4],m21:K[L+5]};return new D(J)};D.packedSampleSize=G;y.AffineTransform=D}());(function(F){var I=F,E,H,D;E={transformClass:function(G){if(typeof(G)==="number"){return"distance"}return G.transformClass},transformGeometricArc:function(K){var G=this;function J(){var N=G.point?G.point(K.initialPoint):K.initialPoint,M=G.point?G.point(K.finalPoint):K.finalPoint;return y.GeometricArc.FromStraightEndpoints(N,M)}function L(){var Q=G.point?G.point(K.initialPoint):K.initialPoint,P=G.point?G.point(K.middlePoint):K.middlePoint,O=G.point?G.point(K.finalPoint):K.finalPoint,N=y.Geom.ThreePointCollinear(K.initialPoint,K.finalPoint,K.middlePoint),M=y.GeometricArc.FromThreePoints(Q,P,O);if(K.orientation!==N.orientation){M.orientation*=-1}return M}return(K.orientation===0)?J():L()},doOneTransform:function(J,G){if(G===h){G=this.transformClass(J)}switch(G){case"distance":return this.distance?this.distance(J):J;case"GeometricPoint":return this.point?this.point(J):J.copy();case"AffineTransform":return J.compose(this.getAffineTransform());case"GeometricArc":return this.transformGeometricArc(J)}},getAffineTransform:function(){if(this.affineTransform){return this.affineTransform}if(this.point){return y.AffineTransform.fromPointTransform(this.point)}return y.AffineTransform.Identity},transformGeom:function(K,O){var M,L,J,G,N;for(L in K){if(K.hasOwnProperty(L)){N=K[L];M=this.transformClass(N);if(M){O[L]=this.doOneTransform(N,M)}else{if(g.isArray(N)){G=[];for(J=0;J<N.length;J+=1){G.push(this.doOneTransform(N[J]))}O[L]=G}else{O[L]=K[L]}}}}}};H=function(G){var J=Object.create(E);J.distance=null;J.point=h;J.affineTransform=h;if("function"===typeof(G)){J.point=G}else{g.extend(J,G)}return J};D=new H({distance:0});H.copyGeom=function(G,J){D.transformGeom(G,J)};I.GeomTransformer=H}(y));(function(){var D={};D.kInfiniteRect={left:Number.NEGATIVE_INFINITY,top:Number.NEGATIVE_INFINITY,right:Number.POSITIVE_INFINITY,bottom:Number.POSITIVE_INFINITY};D.isFiniteRect=function(F){return F&&(isFinite(F.top)&&isFinite(F.left)&&isFinite(F.bottom)&&isFinite(F.right))};D.isValidRect=function(F){return F&&(F.left!=null)&&(F.left===F.left)&&(F.top!=null)&&(F.top===F.top)&&(F.right!=null)&&(F.right===F.right)&&(F.bottom!=null)&&(F.bottom===F.bottom)&&(F.left<=F.right)&&(F.top<=F.bottom)};D.isEmptyRect=function(F){return !D.isValidRect(F)||(F.left===F.right)||(F.top===F.bottom)};D.containsRect=function(G,F){return D.isValidRect(G)&&D.isValidRect(F)&&(G.left<=F.left)&&(G.top<=F.top)&&(G.right>=F.right)&&(G.bottom>=F.bottom)};D.isIntersectRects=function(G,F){return D.isValidRect(G)&&D.isValidRect(F)&&(G.left<=F.right)&&(F.left<=G.right)&&(G.top<=F.bottom)&&(F.top<=G.bottom)};D.isIntersectValidRects=function(G,F){return G&&F&&(G.left<=F.right)&&(F.left<=G.right)&&(G.top<=F.bottom)&&(F.top<=G.bottom)};D.intersectRects=function(G,F){if(!D.isValidRect(G)||!D.isValidRect(F)){return null}var H={left:Math.max(G.left,F.left),top:Math.max(G.top,F.top),right:Math.min(G.right,F.right),bottom:Math.min(G.bottom,F.bottom)};return D.isValidRect(H)?H:null};D.unionRects=function(H,G){var F=D.isValidRect(H),I=D.isValidRect(G);if(!F&&I){return G}if(F&&!I){return H}if(!F&&!I){return null}return{left:Math.min(H.left,G.left),top:Math.min(H.top,G.top),right:Math.max(H.right,G.right),bottom:Math.max(H.bottom,G.bottom)}};D.insetRect=function(G,I,H){var F=(I!=null?I:1),J=(H!=null?H:F);return{left:G.left+F,top:G.top+J,right:G.right-F,bottom:G.bottom-J}};D.offsetRect=function(H,I,F){var G=I||0,J=F||G;return{left:H.left+G,top:H.top+J,right:H.right+G,bottom:H.bottom+J}};D.boundingRect=function(){var L,J,K,H,I,F,M,G;if(arguments.length===1){G=arguments[0]}else{G=arguments}for(I=0;I<G.length;I++){F=G[I].x;M=G[I].y;if(F<L||L===h){L=F}if(F>J||J===h){J=F}if(M<K||K===h){K=M}if(M>H||H===h){H=M}}return{left:L,right:J,top:K,bottom:H}};D.PointInRect=function(G,F){return((G.getX()>=F.left)&&(G.getX()<=F.right)&&(G.getY()>=F.top)&&(G.getY()<=F.bottom))};D.OctAngleUtil=function(I,J){var G=J.copy().subtract(I),H=y.GeometricPoint(Math.abs(G.getX()),Math.abs(G.getY())),F;if((G.getX()===0)&&(G.getY()===0)){return h}if(H.getX()>H.getY()){F=H.getY()/H.getX()}else{F=2-H.getX()/H.getY()}if(G.getX()<0){if(G.getY()<=0){F+=4}else{F=4-F}}else{if(G.getY()<0){F=8-F}}return F};D.RectIntersectsCurve=function(Q,I){var X=I.curve.center,J=I.curve.radius,P={top:Q.top-X.getY(),bottom:Q.bottom-X.getY(),left:Q.left-X.getX(),right:Q.right-X.getX()},W=J*J,F=P.left*P.left,U=P.right*P.right,L=P.top*P.top,N=P.bottom*P.bottom,G,H,K,T,R=y.GeometricPoint(0,0);var V=function(){var Z=!((I.type==="circle")||(I.type==="arc")),Y;if(P.right<0){if(P.top>0){Y=(U+L<W)}else{if(P.bottom<0){Y=(U+N<W)}else{Y=((-P.right)<J)}}}else{if(P.left>0){if(P.top>0){Y=(F+L<W)}else{if(P.bottom<0){Y=(F+N<W)}else{Y=(P.left<J)}}}else{if(P.top>0){Y=(P.top<J)}else{if(P.bottom<0){Y=((-P.bottom)<J)}else{Y=true}}}}if(Y&&!Z){Y=(F+L>W)||(F+N>W)||(U+L>W)||(U+N>W)}return Y};var M=function(){var Y=function(){var Z=D.OctAngleUtil(R,T);if(Z<H){Z+=8}if(Z<=K){return true}return false};if(D.PointInRect(I.curve.initialPoint,Q)){return true}if(D.PointInRect(I.curve.finalPoint,Q)){return true}while(H<0){H+=8}while(K<H){K+=8}if(L<=W){T=y.GeometricPoint(Math.sqrt(W-L),P.top);if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}T=y.GeometricPoint(T.getX()*-1,T.getY());if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}}if(N<=W){T=y.GeometricPoint(Math.sqrt(W-N),P.bottom);if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}T=y.GeometricPoint(T.getX()*-1,T.getY());if((P.left<=T.getX())&&(P.right>=T.getX())){if(Y()){return true}}}if(F<=W){T=y.GeometricPoint(P.left,Math.sqrt(W-F));if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}T=y.GeometricPoint(T.getX(),T.getY()*-1);if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}}if(U<=W){T=y.GeometricPoint(P.right,Math.sqrt(W-U));if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}T=y.GeometricPoint(T.getX(),T.getY()*-1);if((P.top<=T.getY())&&(P.bottom>=T.getY())){if(Y()){return true}}}return false};var O=function(){var ad,ab,Z=I.curve.center,ac=I.curve.initialPoint,Y=I.curve.finalPoint,aa;if(L<=W){ad=y.GeometricPoint(Q.left,Q.top);ab=y.GeometricPoint(Q.right,Q.top);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(N<=W){ad=y.GeometricPoint(Q.left,Q.bottom);ab=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(F<=W){ad=y.GeometricPoint(Q.left,Q.top);ab=y.GeometricPoint(Q.left,Q.bottom);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(U<=W){ad=y.GeometricPoint(Q.right,Q.top);ab=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ad,ab,Z,ac)){return true}if(D.SegmentSectsSegment(ad,ab,Z,Y)){return true}}if(L+F<W){T=y.GeometricPoint(P.left,P.top);aa=D.OctAngleUtil(R,T);if(aa<H){aa+=8}return aa<=K}return false};var S=function(){var ac,aa,ab=I.curve.initialPoint,Y=I.curve.finalPoint;if(L<=W){ac=y.GeometricPoint(Q.left,Q.top);aa=y.GeometricPoint(Q.right,Q.top);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}if(N<=W){ac=y.GeometricPoint(Q.left,Q.bottom);aa=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}if(F<=W){ac=y.GeometricPoint(Q.left,Q.top);aa=y.GeometricPoint(Q.left,Q.bottom);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}if(U<=W){ac=y.GeometricPoint(Q.right,Q.top);aa=y.GeometricPoint(Q.right,Q.bottom);if(D.SegmentSectsSegment(ac,aa,ab,Y)){return true}}T=y.GeometricPoint(Q.left,Q.top);var Z=(L+F)<=W;return Z&&(D.ThreePointCollinear(ab,Y,T).orientation>0)};if(I.curve.orientation===0){return D.SegmentSectsRect(Q,I.curve.initialPoint,I.curve.finalPoint)}G=V();if(!G){return false}if((I.type==="circle")||(I.type==="circleInterior")){return G}H=D.OctAngleUtil(I.curve.center,I.curve.initialPoint);K=D.OctAngleUtil(I.curve.center,I.curve.finalPoint);if(M()){return true}if(I.type==="arc"){G=false}else{if(I.type==="arcSector"){G=O()}else{if(I.type==="arcSegment"){G=S()}else{y.signalErrorWithMessage("Unexpected curve type: RectIntersectsCurve should only see arcs here.")}}}return G};D.RectsIntersect=function(G,F){var J,K,I,H;J=(G.left>F.left)?G.left:F.left;H=(G.top>F.top)?G.top:F.top;K=(G.right>F.right)?G.right:F.right;I=(G.bottom>F.bottom)?G.bottom:F.bottom;return((J<=K)&&(H<=I))};D.SegmentSectsSegment=function(Q,O,N,M){var K=Q.getX(),I=Q.getY(),T=O.getX(),S=O.getY(),H=N.getX(),G=N.getY(),L=M.getX(),J=M.getY(),W=T-K,V=S-I,U=J-G,R,P=K*U,F=P+T*(-U)+H*(-V)+L*V;if((0===F)||isNaN(F)){return null}P=(P+H*(I-J)+L*(G-I))/F;if((P<0)||(P>1)){return null}R=-(K*(G-S)+T*(I-G)+H*V)/F;if((R<0)||(R>1)){return null}return y.GeometricPoint(K+(W*P),I+(V*P))};D.SegmentSectsRect=function(F,H,G){var K=D.PointInRect(H,F)||D.PointInRect(G,F),M,I,N,L;function J(){var P=H.x,O=H.y,R=G.x,Q=G.y;if((P<F.left)&&(R<F.left)){return false}if((P>F.right)&&(R>F.right)){return false}if((O<F.top)&&(Q<F.top)){return false}if((O>F.bottom)&&(Q>F.bottom)){return false}return true}if(!K&&J()){M=y.GeometricPoint(F.left,F.top);I=y.GeometricPoint(F.right,F.top);N=y.GeometricPoint(F.left,F.bottom);L=y.GeometricPoint(F.right,F.bottom);K=D.SegmentSectsSegment(H,G,M,I)||D.SegmentSectsSegment(H,G,M,N)||D.SegmentSectsSegment(H,G,I,L)||D.SegmentSectsSegment(H,G,N,L)}return(!!K)};D.IntersectionsOfRectAndSegment=function(F,I,H){var O=y.GeometricPoint(F.left,F.top),J=y.GeometricPoint(F.right,F.top),P=y.GeometricPoint(F.left,F.bottom),L=y.GeometricPoint(F.right,F.bottom),M=y.Geom.SegmentSectsSegment(I,H,O,J),G=y.Geom.SegmentSectsSegment(I,H,P,L),Q=y.Geom.SegmentSectsSegment(I,H,O,P),N=y.Geom.SegmentSectsSegment(I,H,J,L),K=[];if(M){K.push(M)}if(G){K.push(G)}if(Q){K.push(Q)}if(N){K.push(N)}return K};D.PointInParallelogram=function(H,I,G,F){function L(Q,P){return Q.getX()*P.getY()-Q.getY()*P.getX()}var K=I.subtract(G),J=F.subtract(G),N=H.subtract(G),M=L(K,J),O;if(M===0){return false}O=-L(N,K)/M;if((O<0)||(1<O)){return false}O=L(N,J)/M;if((O<0)||(1<O)){return false}return true};D.ParallelogramSectsRect=function(G,F,J,I){var H;if(D.PointInParallelogram(y.GeometricPoint(G.left,G.top),F,J,I)){return true}if(D.SegmentSectsRect(G,J,F)){return true}if(D.SegmentSectsRect(G,J,I)){return true}H=J.add(F.subtract(J)).add(I.subtract(J));if(D.SegmentSectsRect(G,F,H)){return true}if(D.SegmentSectsRect(G,I,H)){return true}return false};D.ThreePointCollinear=function(N,M,L){var H=N.subtract(M),O=L.subtract(M),F=y.GeometricPoint(O.x*H.x+O.y*H.y,O.y*H.x-O.x*H.y),K=H.vLength(),G,J;function I(P){var Q=0.0004;return((P>-Q)&&(P<Q))}G=(I(F.y)?0:y.math.sign(F.y));if(G===0){J=(H.dot(O)>0)?"fullCircle":"halfCircle"}return{exists:!I(K),orientation:G,isStraight:J}};D.AngleFromPoint=function(G){var F=Math.atan2(G.y,G.x);if(F<=-Math.PI){F+=(2*Math.PI)}return F};D.CenterFromThreePoints=function(X,Q,O){var J=Q.subtract(X),I=O.subtract(X),H=O.subtract(Q),K=X.add(Q),L=X.add(O);var Y=J.dot(K),T=I.dot(L),P=2*(J.x*H.y-J.y*H.x),N=(I.y*Y-J.y*T)/P,M=(J.x*T-I.x*Y)/P;return y.GeometricPoint(N,M)};function E(K,I){var G,F,J,H;G=I.y-K.y;F=K.x-I.x;J=G*I.x+F*I.y;H=function(){return"["+this.a+"x + "+this.b+"y = "+J+"]"};return{a:G,b:F,c:J,p0:K,p1:I,toString:H}}D.LineLineIntersection=function(G,F,M){var I=E(G.getZeroPoint(),G.getUnitPoint());var H=E(F.getZeroPoint(),F.getUnitPoint());var N=y.GeometricPoint(null,null),L,K;var J=(I.a*H.b-H.a*I.b);if(h===M){M=1e-8}if(Math.abs(J)>M){L=(H.b*I.c-I.b*H.c)/J;K=(I.a*H.c-H.a*I.c)/J;N=y.GeometricPoint(L,K)}if(N.isDefined()&&(!G.pointIsInBounds(N)||!F.pointIsInBounds(N))){N=y.GeometricPoint(NaN,NaN)}return N};D.CircleStraightIntersection=function(H,N){var X=N.getP0();var K=N.getP1();var T=H.center;var G=H.radius;var Q,F,Z,Y,V,U,S=0.001,ab,aa,W,R=0.0002,P=1e-9,O=G-R,I=G+R,M,L,J;Q=[];F=K.subtract(X);Z=F.dot(F);if(Math.abs(Z)<S){return Q}Y=2*F.dot(X.subtract(T));J=Y*Y;W=T.dot(T)+X.dot(X)-(2*T.dot(X));L=W-(I*I);U=J-4*Z*L;if(U<0){return Q}M=W-(O*O);U=J-4*Z*M;if(U<0){U=0}else{V=W-(G*G);U=J-4*Z*V}ab=X.add(F.multiply((-Y-Math.sqrt(U))/(2*Z)));if(ab.isDefined()&&N.pointIsInBounds(ab,P)){Q.push(ab)}aa=X.add(F.multiply((-Y+Math.sqrt(U))/(2*Z)));if(aa.isDefined()&&N.pointIsInBounds(aa,P)){Q.push(aa)}if(Q.length===1){Q.push(Q[0])}return Q};D.CircleCircleIntersection=function(K,I){var L=K.center;var O=K.radius;var G=I.center;var N=I.radius;var Q,H,P,M,R,J,F;Q=[];H=G.subtract(L);P=H.vLength();if(P>O+N){return Q}if(P<Math.abs(O-N)){return Q}M=((O*O)-(N*N)+(P*P))/(2*P);R=L.add(H.multiply(M/P));J=Math.sqrt((O*O)-(M*M));F=y.GeometricPoint(-H.y,H.x).multiply(J/P);Q.push(R.add(F));Q.push(R.add(F.negate()));return Q};D.RectSectsPolygon=function(K,J){var I,H,F;function G(M,Q){var L=M.x,S=M.y,R=-1,P,O,N=Q.length;P=Q[0];O=Q[Q.length-1];while(N--){if((((P.y<=S)&&(S<O.y))||((O.y<=S)&&(S<P.y)))&&((L-P.x<(O.x-P.x)*(S-P.y)/(O.y-P.y)))){R*=-1}O=P;P=Q[Q.length-N]}return(1===R)}if(G(y.GeometricPoint(K.left,K.top),J)){return true}for(F=0;F<J.length;F+=1){H=J[F];I=J[(F+1)%J.length];if(y.Geom.SegmentSectsRect(K,I,H)){return true}}return false};D.unionRectPoint=function(H,F){var G={};if(!H){G.left=G.right=F.x;G.top=G.bottom=F.y}else{G.left=Math.min(H.left,F.x);G.right=Math.max(H.right,F.x);G.top=Math.min(H.top,F.y);G.bottom=Math.max(H.bottom,F.y)}return G};y.Geom=D}());y.GeometricArc=(function(){var F=30000,E=7,G={transformClass:"GeometricArc",center:y.GeometricPoint.UNDEFINED,radius:h,initialAngle:h,finalAngle:h,initialPoint:y.GeometricPoint.UNDEFINED,middlePoint:y.GeometricPoint.UNDEFINED,finalPoint:y.GeometricPoint.UNDEFINED,orientation:h,exists:false,arcAngle:h,getZeroPoint:function(){return this.initialPoint},getUnitPoint:function(){return this.finalPoint},getP0:function(){return this.initialPoint},getP1:function(){return this.finalPoint},updateSecondaryGeometery:function(){var H=[],I=this;this.arcAngle=this.finalAngle-this.initialAngle;if(this.arcAngle<0){this.arcAngle+=2*Math.PI}if(0===this.orientation){this.arcLength=this.finalPoint.subtract(this.initialPoint).vLength()}else{this.arcLength=this.radius*this.arcAngle}H.push(this.initialPoint.x,this.initialPoint.y,this.finalPoint.x,this.finalPoint.y);if(this.orientation!==0){H.push(this.radius,this.center.x,this.center.y)}g.each(H,function(K,J){if(Math.abs(J)>F){I.exists=false;return false}})},getCache:function(I){var H;if(!this.cache){this.cache={}}if(this.cache[I]){return this.cache[I]}H={halfChordLength:0,perimeterLength:0,initialParam:0,finalParam:0};if(0===this.orientation){H.arcLength=this.finalPoint.subtract(this.initialPoint).vLength();H.perimeterLength=H.arcLength}else{if("ArcSegment"===I){H.halfChordLength=this.finalPoint.subtract(this.initialPoint).vLength()/2}else{if("ArcSector"===I){H.halfChordLength=this.radius}}H.perimeterLength=this.arcLength+2*H.halfChordLength}if(0!==H.perimeterLength){H.initialParam=H.halfChordLength/H.perimeterLength}H.finalParam=1-H.initialParam;this.cache[I]=H;return H},pointIsInBounds:function(H){var I,J=1e-7;if(this.orientation===0){var K=y.GeometricPoint.mapPointToLine(this.initialPoint,this.finalPoint,H).param;return(K>=-J&&K<=1+J)}if(this.arcAngle===2*Math.PI){return true}I=y.Geom.AngleFromPoint(H.subtract(this.center));if(I<(this.initialAngle-J)){I+=2*Math.PI}return((I>=(this.initialAngle-J))&&(I<=(this.initialAngle+this.arcAngle)+J))},mapPointToArc:function(I,N,L){var J=this.getCache(N),M=y.Geom.AngleFromPoint(I.subtract(this.center)),H=this.initialAngle+this.arcAngle,K={};if(M<this.initialAngle){M+=2*Math.PI}K.param=J.initialParam;if(L.returnPoint){K.point=this.initialPoint}if(M<=H){K.param=(M-this.initialAngle)/(H-this.initialAngle);K.param=J.initialParam+K.param*(J.finalParam-J.initialParam);if(L.returnPoint){K.point=y.GeometricPoint.FromCenterRadiusAngle(this.center,this.radius,M)}}else{if(M-H<this.initialAngle-(M-2*Math.PI)){K.param=J.finalParam;if(L.returnPoint){K.point=this.finalPoint}}}return K},mapPositionToPathValue:function(I,M){var K,L,N=[],O,H;function J(S,P){var U,T,Q=Infinity,R;if(S.length===1){return S[0]}for(R=0;R<S.length;R++){T=S[R].point.subtract(P).vLength2();if(T<Q){Q=T;U=S[R]}}return U}if(0===this.orientation){K=y.GeometricPoint.mapPointToLine(this.initialPoint,this.finalPoint,I,{clampP0:true,clampP1:true});return K.param}N.push(this.mapPointToArc(I,M,{returnPoint:M!=="SimpleArc"}));if("SimpleArc"!==M){L=this.getCache(M);H=("ArcSector"===M)?this.center:this.initialPoint.add(this.finalPoint).multiply(0.5);K=y.GeometricPoint.mapPointToLine(H,this.initialPoint,I,{clampP0:true,clampP1:true,returnPoint:true});K.param*=L.initialParam;N.push(K);K=y.GeometricPoint.mapPointToLine(H,this.finalPoint,I,{clampP0:true,clampP1:true,returnPoint:true});K.param=1-K.param*L.initialParam;N.push(K)}O=J(N,I);return(this.orientation===1)?O.param:1-O.param},mapPathValueToPosition:function(P,R,K){var Q,O=1e-10,H,N,S,J,I=this.orientation,L,M;if(0===I){Q=this.finalPoint.subtract(this.initialPoint);if(K){K.derivative=y.GeometricPoint(Q.x,Q.y)}return this.initialPoint.add(Q.multiply(P))}if(-1===I){P=1-P}H=this.getCache(R);if(P>=H.initialParam-O&&P<=H.finalParam+O){if(P<=H.initialParam){M=this.initialPoint;Q=M.subtract(this.center)}else{if(P>=H.finalParam){M=this.finalPoint;Q=M.subtract(this.center)}else{J=this.initialAngle+this.arcAngle*(P-H.initialParam)/(H.finalParam-H.initialParam);Q=y.GeometricPoint(this.radius*Math.cos(J),this.radius*Math.sin(J));M=y.GeometricPoint(this.center.x+Q.x,this.center.y+Q.y)}}if(K){K.derivative=y.GeometricPoint(-Q.y,Q.x).multiply(I*this.arcAngle/(H.finalParam-H.initialParam))}}else{if(P===1&&1===I){P=0}if(P===0&&-1===I){P=1}if("ArcSector"===R){N=this.center}else{N=this.initialPoint.add(this.finalPoint).multiply(0.5)}if(P<H.initialParam){S=this.initialPoint;L=H.initialParam}else{S=this.finalPoint;P=1-P;L=1-H.finalParam;I*=-1;L=H.initialParam}P/=H.initialParam;M=N.add(S.subtract(N).multiply(P));if(K){K.derivative=y.GeometricPoint(I*(S.x-N.x)/L,I*(S.y-N.y)/L)}}return M},packIntoSampleArray:function(I,H){var J=E*H;I[J]=this.orientation;I[J+1]=this.initialPoint.x;I[J+2]=this.initialPoint.y;I[J+3]=this.finalPoint.x;I[J+4]=this.finalPoint.y;I[J+5]=this.center.x;I[J+6]=this.center.y}};function D(){var H=Object.create(G);return H}return{FromStraightEndpoints:function(J,I){var H=new D();H.orientation=0;H.initialPoint=J;H.middlePoint=y.GeometricPoint((J.getX()+I.getX())/2,(J.getY()+I.getY())/2);H.finalPoint=I;H.exists=true;H.updateSecondaryGeometery();return H},FromThreePoints:function(O,N,M){var H,J=y.Geom.ThreePointCollinear(O,M,N),L,I,K;if(!J.exists||N.equals(O)||N.equals(M)){return new D()}if(J.orientation===0){return y.GeometricArc.FromStraightEndpoints(O,M)}K=(J.orientation===-1);H=new D();H.center=y.Geom.CenterFromThreePoints(O,N,M);L=O.subtract(H.center);I=M.subtract(H.center);H.radius=L.vLength();H.initialAngle=y.Geom.AngleFromPoint(K?I:L);H.finalAngle=y.Geom.AngleFromPoint(K?L:I);H.orientation=J.orientation;H.initialPoint=K?M:O;H.middlePoint=N;H.finalPoint=K?O:M;H.exists=true;if(H.radius>F||Math.abs(H.center.x)>F||Math.abs(H.center.y)>F){return y.GeometricArc.FromStraightEndpoints(O,M)}H.updateSecondaryGeometery();return H},FromCenterAndEndpoints:function(N,P,O,I){var H=new D(),M=P.subtract(N),L=O.subtract(N),J,K,Q=1e-7;if(P.equals(O,Q)||P.equals(N,Q)||O.equals(N,Q)){H.exists=false;return H}if(h===I){I=1}K=(-1===I);H.center=N;H.radius=M.vLength();H.initialAngle=y.Geom.AngleFromPoint(K?L:M);H.finalAngle=y.Geom.AngleFromPoint(K?M:L);H.orientation=I;H.initialPoint=K?O:P;J=(H.initialAngle+H.finalAngle)/2;if(H.initialAngle>H.finalAngle){J+=Math.PI}H.middlePoint=y.GeometricPoint(Math.cos(J),Math.sin(J)).multiply(H.radius).add(H.center);H.finalPoint=K?P:O;H.exists=true;H.updateSecondaryGeometery();return H},FromCenterAndRadius:function(K,I){var H=new D(),J=K.add(y.GeometricPoint(K.x+I,K.y));H.center=K;H.radius=I;H.initialAngle=0;H.finalAngle=2*Math.PI;H.orientation=1;H.initialPoint=J;H.middlePoint=J;H.finalPoint=J;H.exists=true;H.updateSecondaryGeometery();return H},FromPackedSampleArray:function(O,R){var H=R*E,I=O[H],Q=O[H+1],P=O[H+2],K=O[H+3],J=O[H+4],M=O[H+5],L=O[H+6],T=y.GeometricPoint(Q,P),S=y.GeometricPoint(K,J),N;if(I===0){return y.GeometricArc.FromStraightEndpoints(T,S)}else{N=y.GeometricPoint(M,L);return y.GeometricArc.FromCenterAndEndpoints(N,T,S,1)}},packedSampleSize:E}}());y.labels={};y.labels.parseLabelExpression=function(I,G){var E=G||(G===h);function J(O){var M=0,N=O.length,K=N,P,L={before:"",inside:"",after:""};while(M<O.length){if(O[M]==="["){break}M+=1}K=M+1;P=1;while(K<N){if(O[K]==="]"){P-=1}else{if(O[K]==="["){P+=1}}if(P===0){break}K+=1}if(K===N||(K-M===1)||((M===0)&&(K+1===N))){M=N}else{N=K}L.before=O.substr(0,M);L.inside=O.substr(M+1,N-M-1);L.after=O.substr(N+1);return L}function D(P){if(!P){P=""}var M=/([()\[\]|<>{},\s.\/\-]+)/,O=P.split(M),K,L=[];for(K=0;K<O.length;K+=1){var N=O[K];L.push(y.mfs.makeTextMFS(N,E&&/[a-zA-Zα-ω]/.test(N[0])))}if(O.length>1){return y.mfs.makeHorizontalMFS.apply(this,L)}else{return L[0]}}function H(M){var K=[],L;if(M){L=J(M);if(L.inside){K.push({type:"sub",value:[H(L.before),H(L.inside)]});if(L.after){K.push(H(L.after))}}else{K.push(D(L.before))}}return K.length===1?K[0]:y.mfs.makeHorizontalMFS.apply(this,K)}try{return H(I)}catch(F){throw y.createError('Error parsing label "'+I+'": '+F)}};(function(){var F={Parameter:"t",Function:"fghqrstuvw",Point:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",Straight:"jklmnopqrstuvwxyzabcdefghi",Circle:"c",Polygon:"P",CircleInterior:"C",Sampler:"L",Measure:"m",CoordSys:"S",Axis:"xy",Button:"",Arc:"a",ArcInterior:"A",Map:"",IterateImage:"",Picture:"",Table:"",AngleMarker:"",Kind:""};function H(I,K){if(I.kind==="Expression"){if(K==="Function"){return"Function"}if(K==="ScalarParameter"){return"Parameter"}}var L=I.kind;var J=I.baseKinds.slice();while(L){if(F.hasOwnProperty(L)){return L}L=J.pop()}}var G={generate:function(L,K){var I=this.counters[L];var M=F[L];if(!I){this.counters[L]={index:0,subscript:0};I=this.counters[L];if(M.length<=1){I.subscript=1}}else{if(M.length){I.index+=1;if(I.index>=M.length){I.index=0;I.subscript+=1}}else{I.subscript+=1}}var J="";if(M.length){J+=M[I.index];if(I.subscript>0){J+="[";J+=I.subscript;J+="]"}}return J},copy:function(){var I=Object.create(G);I.counters=g.extend(true,{},this.counters);return I}};function E(){var I=Object.create(G);I.counters={};return I}var D={curGenerator:function(){return this.generators[this.generators.length-1]},generateLabel:function(M,L){var J;var I=y.gObjects[M];var O=H(I,L);var N=true;function K(P,Q){if((O===H(Q,Q.genus))&&(J===Q.label)){N=true;return false}}while(N){N=false;J=this.curGenerator().generate(O);this.sketch.eachGObj(K)}return J},saveState:function(){this.generators.push(this.curGenerator().copy())},restoreSavedState:function(){if(this.generators.length<2){throw y.createError("LabelPool.restoreSavedState() called without calling saveState()")}this.generators.pop()},forgetSavedState:function(){if(this.generators.length<2){throw y.createError("LabelPool.forgetSavedState() called without calling saveState()")}this.generators.splice(this.generators.length-2,1)}};y.LabelPool={createInSketch:function(J){var I=Object.create(D);I.sketch=J;I.generators=[];I.generators.push(E());return I}}}());(function(){var ag={};y.mfs={};y.mfs.binaryOperatorPrecedence={"^":3,"*":2,"/":2,"+":1,"-":1};y.mfs.symMap={"20":"\u0020","21":"\u0021","22":"\u2200","23":"\u0023","24":"\u2203","25":"\u0025","26":"\u0026","27":"\u220B","28":"\u0028","29":"\u0029","2A":"\u2217","2B":"\u002B","2C":"\u002C","2D":"\u2212","2E":"\u002E","2F":"\u002F","30":"\u0030","31":"\u0031","32":"\u0032","33":"\u0033","34":"\u0034","35":"\u0035","36":"\u0036","37":"\u0037","38":"\u0038","39":"\u0039","3A":"\u003A","3B":"\u003B","3C":"\u003C","3D":"\u003D","3E":"\u003E","3F":"\u003F","40":"\u2245","41":"\u0391","42":"\u0392","43":"\u03A7","44":"\u0394","45":"\u0395","46":"\u03A6","47":"\u0393","48":"\u0397","49":"\u0399","4A":"\u03D1","4B":"\u039A","4C":"\u039B","4D":"\u039C","4E":"\u039D","4F":"\u039F","50":"\u03A0","51":"\u0398","52":"\u03A1","53":"\u03A3","54":"\u03A4","55":"\u03A5","56":"\u03C2","57":"\u03A9","58":"\u039E","59":"\u03A8","5A":"\u0396","5B":"\u005B","5C":"\u2234","5D":"\u005D","5E":"\u22A5","5F":"\u005F","61":"\u03B1","62":"\u03B2","63":"\u03C7","64":"\u03B4","65":"\u03B5","66":"\u03C6","67":"\u03B3","68":"\u03B7","69":"\u03B9","6A":"\u03D5","6B":"\u03BA","6C":"\u03BB","6D":"\u00B5","6E":"\u03BD","6F":"\u03BF","70":"\u03C0","71":"\u03B8","72":"\u03C1","73":"\u03C3","74":"\u03C4","75":"\u03C5","76":"\u03D6","77":"\u03C9","78":"\u03BE","79":"\u03C8","7A":"\u03B6","7B":"\u007B","7C":"\u007C","7D":"\u007D","7E":"\u223C",A0:"\u20AC",A1:"\u03D2",A2:"\u2032",A3:"\u2264",A4:"\u2044",A5:"\u221E",A6:"\u0192",A7:"\u2663",A8:"\u2666",A9:"\u2665",AA:"\u2660",AB:"\u2194",AC:"\u2190",AD:"\u2191",AE:"\u2192",AF:"\u2193",B0:"\u00B0",B1:"\u00B1",B2:"\u2033",B3:"\u2265",B4:"\u00D7",B5:"\u221D",B6:"\u2202",B7:"\u2022",B8:"\u00F7",B9:"\u2260",BA:"\u2261",BB:"\u2248",BC:"\u2026",BF:"\u21B5",C0:"\u2135",C1:"\u2111",C2:"\u211C",C3:"\u2118",C4:"\u2297",C5:"\u2295",C6:"\u2205",C7:"\u2229",C8:"\u222A",C9:"\u2283",CA:"\u2287",CB:"\u2284",CC:"\u2282",CD:"\u2286",CE:"\u2208",CF:"\u2209",D0:"\u2220",D1:"\u2207",D5:"\u220F",D6:"\u221A",D7:"\u22C5",D8:"\u00AC",D9:"\u2227",DA:"\u2228",DB:"\u21D4",DC:"\u21D0",DD:"\u21D1",DE:"\u21D2",DF:"\u21D3",E0:"\u25CA",E1:"\u2329",E5:"\u2211",F1:"\u232A",F2:"\u222B",F3:"\u2320",F5:"\u2321","100":"\u2299","101":"\u2225","102":"\u25B3","103":"\u2212","176":"\u00B0","177":"\u00B1"};y.mfs.makeFunctionFromParsedInfix=function(ay){var az,aA,au,ak={};function ap(aG){var aE=""+aG.index,aF=az[aG.type],aD;if(aG.refCount===1){return aF(aG)}if(ak[aE]){return ak[aE]}aD="m["+aE+"]";ak[aE]=aD;return"("+aD+"="+aF(aG)+")"}var am={pi:"Math.PI",e:"Math.E"};var av={sin:"GSP.math.sin",cos:"GSP.math.cos",tan:"GSP.math.tan",Arcsin:"GSP.math.asin",Arccos:"GSP.math.acos",Arctan:"GSP.math.atan",abs:"GSP.math.abs",sqrt:"GSP.math.sqrt",ln:"GSP.math.ln",log:"GSP.math.log",sgn:"GSP.math.sign",round:"GSP.math.round",trunc:"GSP.math.trunc",isDefined:"GSP.math.isDefined"};function an(aE){var aF=ap(aE.children.left);if(aE.children.left.type==="binary-expr"){aF="("+aF+")"}var aD=ap(aE.children.right);if(aE.operator==="^"){return"GSP.math.pow("+aF+","+aD+")"}else{if(aE.children.right.type==="binary-expr"){aD="("+aD+")"}return aF+aE.operator+aD}}function aq(aD){var aE=ap(aD.children.child);if((aD.children.child.type==="unary-expr")||(aD.children.child.type==="binary-expr")){aE="("+aE+")"}return"("+aD.operator+aE+")"}function aw(aE){var aD;if(aE.subtype==="sys"){aD=av[aE.name];return aD+"("+ap(aE.children.arg)+", unitMap)"}else{return ap(aE.children.name)+"("+ap(aE.children.arg)+")"}}function al(aE){var aF=aE.children.value,aD=aE.children.unit;if(typeof aD!=="undefined"){return"GSP.units.convertToDocUnits(unitMap, "+ap(aF)+", "+ap(aD)+")"}else{return ap(aF)}}function ar(aD){var aE=aD.value;if(aD.subtype==="numeric"){return aE.replace(/^0+(?=[^0])/,"")}else{return am[aE]}}function aC(aD){return'"'+aD.name+'"'}function ax(aD){return'parentArray["'+aD.name+'"].uValue'}function aB(aD){return'parentArray["'+aD.name+'"]'}function at(aD){return ap(aD.children.expr)}function ao(aD){return NaN}az={blank:ao,equation:at,"binary-expr":an,"unary-expr":aq,"function":aw,constant:ar,primary:al,unit:aC,variable:aB,reference:ax};aA="";au=ap(ay);if(!g.isEmptyObject(ak)){aA+="var m={};"}aA+="return "+au+";";return new Function("parentArray","unitMap",aA)};y.mfs.getParsedInfixAndFunction=function I(al){var ak=ag[al]||{};if(!ak.parsedInfix){ak.parsedInfix=y.infixExpressionParser.parse(al);ak.func=y.mfs.makeFunctionFromParsedInfix(ak.parsedInfix);ag[al]=ak}return ak};y.mfs.getParsedInfix=function Z(al){var ak=ag[al]||{};if(!ak.parsedInfix){ak.parsedInfix=y.infixExpressionParser.parse(this.expression);ag[al]=ak}return ak.parsedInfix};y.mfs.makeMathMLFromParseTree=function(ay){var az={"+":"+","-":"&minus;","*":"&#x22c5;"};var am={pi:"&pi;",e:"e"};var au,aA;function ap(aF){var aE=aA[aF.type];return aE(aF)}function ao(aF){var aG=ap(aF.children.left);if(aF.children.left.type==="binary-expr"){aG='<mfenced separators="">'+aG+"</mfenced>"}else{if(aF.children.left.type==="unary-expr"||aF.children.left.type==="function"){aG="<mrow>"+aG+"</mrow>"}}var aE=ap(aF.children.right);if(aF.children.right.type==="binary-expr"){aE='<mfenced separators="">'+aE+"</mfenced>"}else{if(aF.children.right.type==="unary-expr"||aF.children.right.type==="function"){aE="<mrow>"+aE+"</mrow>"}}if(aF.operator==="^"){return"<msup>"+aG+aE+"</msup>"}if(aF.operator==="/"){return"<mfrac>"+aG+aE+"</mfrac>"}else{return aG+"<mo>"+az[aF.operator]+"</mo>"+aE}}function aq(aE){var aF=ap(aE.children.child);if(aE.children.child.type==="binary-expr"){aF="<mrow>"+aF+"</mrow>"}return"<mo>"+az[aE.operator]+"</mo>"+aF}function aB(aF,aE){return"<mi>"+aF+"</mi><mfenced><mrow>"+aE+"</mrow></mfenced>"}function aw(aF,aE){return'<mfenced open="|" close="|" separators=""><mrow>'+aE+"</mrow></mfenced>"}function an(aF,aE){return"<msqrt><mrow>"+aE+"</mrow></msqrt>"}function av(aF){var aE=au[aF.name];if(aE===h){aE=aB}if(aF.subtype==="sys"){return aE(aF.name,ap(aF.children.arg))}else{return aE(ap(aF.children.name),ap(aF.children.arg))}}function ak(aE){return ap(aE.children.value)}function ar(aE){var aF;if(aE.subtype==="numeric"){aF=aE.value}else{aF=am[aE.value]}return"<mn>"+aF+"</mn>"}function aD(aE){return"<mi>"+aE.name+"</mi>"}function ax(aE){return"<mi>"+aE.name+"</mi>"}function aC(aE){return"<mi>"+aE.name+"</mi>"}function at(aE){if(aE.children.expr){return ap(aE.children.expr)}else{return ap(aE.children.expr)}}au={sin:aB,cos:aB,tan:aB,Arcsin:aB,Arccos:aB,Arctan:aB,abs:aw,sqrt:an,ln:aB,log:aB,sgn:aB,round:aB,trunc:aB};aA={equation:at,"binary-expr":ao,"unary-expr":aq,"function":av,constant:ar,primary:ak,unit:aD,variable:aC,reference:ax};function al(aE){return"<math>"+ap(aE)+"</math>"}return al(ay)};function ad(ak){return(ak.type==="unary-expr")||((ak.type==="primary")&&ak.children.unit)}function ah(ao){var ar,al=ao.length,aq,an=0,ap=" +-*/()\u2212\u22c5",am=false,ak=false;for(ar=0;ar<al;++ar){aq=ao[ar];am=am||(ap.indexOf(aq)>=0);if(aq==="("){++an}else{if(an&&(aq===")")){--an}else{if(!an){ak=true}}}if(am&&ak){return true}}return an>0}function G(ak){return(ak.kind==="Expression")&&(ak.genus==="ScalarParameter")}function aj(ak){return ak.style.nameOrigin==="namedFromLabel"}function S(al,ak){var am;if(al.type!=="reference"){return false}if(!ak){throw new y.createError("reference without parents!")}am=ak[al.name];if(G(am)||aj(am)){return am.label?ah(am.label):false}if(am.parsedInfix&&am.parsedInfix.type==="blank"){return false}if(am.parsedInfix){throw new y.createError("non-blank parsed infix not expected in isTextuallyComplexReference")}return true}function K(ak){return ak.type==="reference"}function Q(al,ak){var an={expr:al,fnReferences:ak};if(!K(al)){return an}var am=ak[al.name];if(G(am)||!am.parsedInfix||am.parsedInfix.type==="blank"||aj(am)){return an}if(!am.parsedInfix||!am.parsedInfix.children){throw new y.createError("expected parsedInfix with children")}return Q(am.parsedInfix.children.expr,am.parentsList)}function T(al,ak){return ad(al)||S(al,ak)}function H(al,ak){if(al.operator!=="^"){return false}return T(ak.expr,ak.fnReferences)}function O(am,al){var ak=am.operator==="/";return !ak&&al.expr.type==="binary-expr"}function R(al,am){var ak=al.operator==="/";return !ak&&am.expr.type==="binary-expr"}function E(al,am){var ak=al.operator==="/";return ak&&am.expr.operator==="/"}function af(am,al){var ak=y.mfs.binaryOperatorPrecedence[am.operator],an=y.mfs.binaryOperatorPrecedence[al.expr.operator];return(an<ak)||((an===ak)&&(am.operator==="^"))}var P={"+":true,"*":true};function M(al,an){var ak=y.mfs.binaryOperatorPrecedence[al.operator],am=y.mfs.binaryOperatorPrecedence[an.expr.operator];if(al.operator===an.expr.operator&&P[al.operator]){return false}return(am<=ak)&&(al.operator!=="^")&&an.expr.operator!=="/"}var W={pi:"\u03C0",e:"e"};function X(al,ak){var am;if(al.subtype==="numeric"){am=al.value}else{am=W[al.value]}return ak(am)}function Y(al,ak,am){if(al.children.declaration&&!am){return ak(al.children.declaration)}else{return ak(al.children.expr)}}function ac(am,al){var ak=y.units.findUnit(am.name);return al(ak.symbol)}y.mfs.makeMFSFromParsedInfix=function(ay,aw,aE,aB){var az={"+":"+","-":"\u2212","*":"\u22c5"};var at,aA;function aq(aG){var aF=aA[aG.type];return aF(aG)}function al(aG){var aH=aq(aG.children.left),aF=aq(aG.children.right),aI=Q(aG.children.right,aw);if(aI.expr.operator==="/"){aF=y.mfs.makeParenthesisMFS(aF)}return{type:"fraction",value:[aH,aF]}}function ao(aH){var aI,aF;if(aH.operator==="/"){return al(aH)}aI=aq(aH.children.left);aF=Q(aH.children.left,aw);if(H(aH,aF)){aI=y.mfs.makeParenthesisMFS(aI)}else{if(O(aH,aF)){aI=af(aH,aF)?y.mfs.makeParenthesisMFS(aI):y.mfs.makeHorizontalMFS(aI)}else{if(aH.children.left.type==="unary-expr"||aH.children.left.type==="function"){aI=y.mfs.makeHorizontalMFS(aI)}}}var aG=aq(aH.children.right);var aJ=Q(aH.children.right,aw);if(R(aH,aJ)){aG=M(aH,aJ)?y.mfs.makeParenthesisMFS(aG):y.mfs.makeHorizontalMFS(aG)}else{if(aH.children.right.type==="unary-expr"||aH.children.right.type==="function"){aG=y.mfs.makeHorizontalMFS(aG)}}if(aH.operator==="^"){return{type:"super",value:[aI,aG]}}else{if(aH.operator==="*"){return y.mfs.makeHorizontalMFS(aI,y.mfs.makeTextMFS(az[aH.operator]),aG)}else{return y.mfs.makeHorizontalMFS(aI,y.mfs.makeTextMFS(" "+az[aH.operator]+" "),aG)}}}function ar(aG){var aH=aq(aG.children.child),aF=Q(aG.children.child,aw);if((aF.expr.type==="unary-expr")||(aF.expr.type==="binary-expr")||T(aF.expr,aF.fnReferences)){aH=(aF.expr.operator==="^")?y.mfs.makeHorizontalMFS(aH):{type:"paren",value:[aH]}}return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(az[aG.operator]),aH)}function aC(aG,aF){return y.mfs.makeHorizontalMFS(aG,{type:"paren",value:[aF]})}function av(aG,aF){return{type:"abs",value:[aF]}}function an(aG,aF){return{type:"root",value:[aF]}}function au(aH){var aG=at[aH.name];if(aG===h){aG=aC}var aF=aH.subtype==="sys"?y.mfs.makeTextMFS(aH.name):aq(aH.children.name);return aG(aF,aq(aH.children.arg))}function ak(aF){var aG=[aq(aF.children.value)];if(aF.children.unit){aG.push(aq(aF.children.unit))}return y.mfs.makeHorizontalMFS.apply(this,aG)}function ax(aF){var aG;if(aw){aG=aw[aF.name];if(aG.kind==="Expression"&&aG.isFunction()){return y.mfs.makeTextMFS(aG.label,true)}else{return aG.getNameMFS()}}else{return y.mfs.makeTextMFS(aF.name)}}function aD(aF){return y.mfs.makeTextMFS(aF.name,aB)}function am(aG){var aF=y.mfs.makeTextMFS(aG.argument,true);if(aG.name){return aC(y.mfs.makeTextMFS(aG.name,true),aF)}else{return aF}}function ap(){return y.mfs.makeTextMFS(" ")}at={abs:av,sqrt:an};aA={blank:ap,equation:function(aF){return Y(aF,aq,aE)},declaration:am,"binary-expr":ao,"unary-expr":ar,"function":au,constant:function(aF){return X(aF,y.mfs.makeTextMFS)},primary:ak,unit:function(aF){return ac(aF,y.mfs.makeTextMFS)},variable:aD,reference:ax};return aq(ay)};y.mfs.renderMathquillFromParsedInfix=function(aB,am,ay,aE){function an(aF){az("(");ar(aF);am.ascendTwo();az(")")}var av,aC;function ar(aG){var aF=aC[aG.type];return aF(aG)}function az(aF){am.insertAtCursor(aF,true)}function au(aG){for(var aF=0;aF<aG.length;aF++){am.insertAtCursor(aG.charAt(aF),true)}}function ap(aG){var aF=Q(aG.children.left,ay),aH;if(H(aG,aF)){an(aG.children.left)}else{if(O(aG,aF)){if(af(aG,aF)){an(aG.children.left)}else{ar(aG.children.left)}}else{if(aG.operator==="/"){am.renderAndSelect(function(){ar(aG.children.left)})}else{ar(aG.children.left)}}}az(aG.operator);aH=Q(aG.children.right,ay);if(E(aG,aH)){an(aG.children.right)}else{if(R(aG,aH)){if(M(aG,aH)){an(aG.children.right)}else{ar(aG.children.right)}}else{ar(aG.children.right)}}if(aG.operator==="^"||aG.operator==="/"){am.ascendTwo()}}function at(aH){var aG=Q(aH.children.child,ay),aF=(aG.expr.type==="unary-expr")||(aG.expr.type==="binary-expr")||T(aG.expr,aG.fnReferences);az(aH.operator);if(aF&&(aG.expr.operator!=="^")){an(aH.children.child)}else{ar(aH.children.child)}}function ax(aF){am.renderOnLeft(function(){am.renderAndSelect(function(){ar(aF)});az("|")})}function ao(aF){az("\\sqrt");ar(aF);am.ascendTwo()}function aw(aG){var aF=av[aG.name];if(aF===h){aF=an;if(aG.name){am.writeLiteral(aG.name)}}if(aG.subtype!=="sys"){ar(aG.children.name)}aF(aG.children.arg)}function ak(aF){ar(aF.children.value);if(aF.children.unit){ar(aF.children.unit)}}function aA(aI){var aJ,aG,aH=g("<span>").addClass("wsp-ref").attr("wsp-ref",aI.name);function aF(){var aK=aH[0].outerHTML.replace(/\\/g,"\\\\");am.writeLatex("\\blob"+aK+"\\endBlob")}if(ay){aJ=ay[aI.name];if(aJ.kind==="Expression"&&aJ.isFunction()){aH.text(aJ.label)}else{if(!aJ.parsedInfix||aJ.isParameter()){aG=aJ.getNameMFS()}else{aG=y.mfs.makeMFSFromParsedInfix(aJ.parsedInfix,aJ.parentsList,true,false)}y.mfs.makeHTMLFromMFSParseTree(aG,aH,{},{})}aF()}else{az(aI.name)}}function aD(aF){az(aF.name);am.registerIndependentVariable()}function al(aG){var aF=aG.argument;if(aG.name){az(aG.name);an(aF)}else{az(aF)}}function aq(aF){}av={abs:ax,sqrt:ao};aC={blank:aq,equation:function(aF){return Y(aF,ar,aE)},declaration:al,"binary-expr":ap,"unary-expr":at,"function":aw,constant:function(aF){return X(aF,au)},primary:ak,unit:function(aF){return ac(aF,az)},variable:aD,reference:aA};return ar(aB)};y.mfs.makeItalicMFS=function J(ak){return{type:"style",value:[{code:"fontStyle",value:"2"},ak]}};y.mfs.makeTextMFS=function ae(am,al){if(typeof am==="object"){throw y.createError("Can't make text from objects")}var ak={type:"text",value:String(am)};return al?y.mfs.makeItalicMFS(ak):ak};y.mfs.isEmptyTextMFS=function D(ak){return ak.type==="text"&&ak.value===""};y.mfs.makeParenthesisMFS=function(ak){return{type:"paren",value:[ak]}};y.mfs.makeHorizontalMFS=function L(){return{type:"horizontal",value:Array.prototype.slice.call(arguments,0)}};y.mfs.parentsHorizontalOverbar=function(ak,am){var al={type:"horizontal",value:[]};g.each(am,function(ao,an){var ap=ak.getParent(an);if(ap){al.value.push(ap.getNameMFS())}});return{type:"overbar",variant:5,value:al}};y.mfs.isSimpleExpression=function(al){var am={};function ak(ap){var ao=am[ap.type],an=g.type(ao);if(an==="boolean"){return ao}else{if(an==="function"){return ao(ap)}else{return false}}}am.equation=function(an){return(typeof an.children.declaration!=="undefined")||ak(an.children.expr)};am["unary-expr"]=function(an){return ak(an.children.child)};am.primary=function(an){return ak(an.children.value)};am.constant=true;am.blank=true;return ak(al)};y.mfs.determineUnit=function(am,al,ap){var ak={},an=y.units,ao={};function aq(aw){var au=aw.index,av=ak[aw.type];if(av){if(!ao[au]){ao[au]=av(aw)}return ao[au]}else{y.signalErrorWithMessage("GSP.mfs.determineUnit: missing typeMap: "+aw.type)}}function at(aw,av){var au=true;y.units.eachUnitDimension(aw,function(ay,ax){if(ax!==av[ay]){au=false;return false}});y.units.eachUnitDimension(av,function(ay,ax){if(ax!==aw[ay]){au=false;return false}});return au}function ar(au){var av=aq(au);y.units.eachUnitDimension(av,function(ax,aw){if(aw%2===0){av[ax]*=0.5}else{av={};return false}});return av}ak.equation=function(au){return aq(au.children.expr)};ak["binary-expr"]=function(aA){var az=aq(aA.children.left),aB=aq(aA.children.right),ay,ax,aw,av,au={};if(aA.subtype==="power"){az=aq(aA.children.left);if(aA.children.right.type==="primary"){av=Number(aA.children.right.children.value.value);if(av%1===0){for(ax in az){if(az.hasOwnProperty(ax)){au[ax]=az[ax]*av}}}}return au}else{if(aA.subtype==="multiplicative"){ay=1;if(aA.operator==="/"){ay=-1}az=g.extend({},az);for(ax in aB){if(aB.hasOwnProperty(ax)){aw=az[ax];if(aw===h){az[ax]=0}az[ax]+=(ay*aB[ax])}}return az}else{if(aA.subtype==="additive"){if(at(az,aB)){return az}else{return{}}}}}};ak["unary-expr"]=function(au){return aq(au.children.child)};ak["function"]=function(au){if(au.name==="Arcsin"||au.name==="Arccos"||au.name==="Arctan"){return{angle:1}}else{if(au.name==="abs"||au.name==="round"||au.name==="trunc"){return aq(au.children.arg)}else{if(au.name==="sqrt"){return ar(au.children.arg)}else{if(au.subtype==="custom"){var av=al[au.children.name.name];return av.getUnitPowers(aq(au.children.arg))}else{return{}}}}}};ak.primary=function(au){if(au.children.unit){return aq(au.children.unit)}else{return{}}};ak.constant=function(au){return{}};ak.unit=function(av){var aw={};var au=an.getUnitFamily(av.name);if(au&&au!=="scalar"){aw[an.getUnitFamily(av.name)]=1}return aw};ak.reference=function(av){var aw,au;if(al){aw=al[av.name];if(aw){au=g.extend(true,{},aw.unitPowers)}}return au};ak.variable=function(av){var au=ap?ap:{};return au};ak.blank=function(au){return{}};return aq(am)};y.mfs.findByType=function(an,al){function ak(ar,ao,aq){var ap;if(ar.children){for(ap in ar.children){if(ar.children.hasOwnProperty(ap)){ak(ar.children[ap],ao,aq)}}}if(ar.type===ao){aq.push(ar)}}var am=[];ak(an,al,am);return am};y.mfs.replaceNodes=function F(ao,am,aq){var al,ap,ak=(ao.type===am)?aq(ao):ao,an=(g.isArray(ak.value))?ak.value.length:0;for(al=0;al<an;++al){ap=ak.value[al];ak.value[al]=F(ap,am,aq)}return ak};y.mfs.realizeParamNodes=function(ak,al){y.mfs.replaceNodes(ak,"parameter",function(am){return al[am.value]})};y.mfs.walkNode=function N(al,ak,am){y.mfs.replaceNodes(al,ak,function(an){am(an);return an})};y.mfs.flattenVerticalNode=function U(an){if(an.type!=="vertical"){y.signalErrorWithMessage("GSP.mfs.flattenVerticalNode should only be called on vertical nodes");return an}an.type="horizontal";var al=an.value;var am;for(var ak=al.length-1;ak>0;--ak){am=y.mfs.makeTextMFS(" ");al.splice(ak,0,am)}return an};var ab={Times:{"default":"1"},"Times New Roman":{"16px":"1.1","24px":"1.1","36px":"1.1","default":"normal"},Arial:{"16px":"1.1","24px":"1.1","36px":"1.1","default":"normal"},Geneva:{"16px":"1.3","24px":"1.35","36px":"1.35","default":"normal"},"ReportSchoolRg-Regular":{"16px":"1.15","24px":"1.15","36px":"1.15","default":"normal"},"Report School":{"16px":"1.15","24px":"1.15","36px":"1.15","default":"normal"},"Proxima Nova":{"16px":"1.2","24px":"1.2","36px":"1.2","default":"normal"}};y.mfs.extractFirstFontFamily=function(al){var ak=al||"";ak=ak.split(",")[0];ak=ak.replace(/'/g,'"');return ak.replace(/^"(.*)"$/,"$1")};y.mfs.getLineHeight=function(ak,an){var am=y.mfs.extractFirstFontFamily(ak);var al=ab[am];if(al){return al[an]||al[an+"px"]||al["default"]}else{return null}};var aa={"Proxima Nova Bold":{fallbackFamilies:["Proxima Nova"],sets:{"font-weight":"bold"}},"Proxima Nova Italic":{fallbackFamilies:["Proxima Nova"],sets:{"font-style":"italic"}},"Proxima Nova Bold It":{fallbackFamilies:["Proxima Nova"],sets:{"font-weight":"bold","font-style":"italic"}},"ReportSchoolRg-Bold":{fallbackFamilies:["Report School Rg","ReportSchoolRg-Regular"],sets:{"font-weight":"bold"}},"ReportSchoolRg-Italic":{fallbackFamilies:["Report School Rg","ReportSchoolRg-Regular"],sets:{"font-style":"italic"}},"ReportSchoolRg-BoldItalic":{fallbackFamilies:["Report School Rg","ReportSchoolRg-Regular"],sets:{"font-weight":"bold","font-style":"italic"}},"Report School Rg":{fallbackFamilies:["ReportSchoolRg-Regular"]},"ReportSchoolRg-Regular":{fallbackFamilies:["Report School Rg"]},"SRA Sans 1.0 Book":{fallbackFamilies:["SRA Sans 1.0"]},"SRA Sans 1.0 Bold":{fallbackFamilies:["SRA Sans 1.0"],sets:{"font-weight":"bold"}},"SRA Sans 1.0 Italic":{fallbackFamilies:["SRA Sans 1.0"],sets:{"font-style":"italic"}},"SRA Sans 1.0 Bold Italic":{fallbackFamilies:["SRA Sans 1.0"],sets:{"font-weight":"bold","font-style":"italic"}}};y.mfs.normalizeFont=function(ar,ak){var ap=y.mfs.extractFirstFontFamily(ar);var av=aa[ap];if(!av){return}var an=av.fallbackFamilies,au,aq,al=[];var ao=av.sets;if(ao){for(au in ao){if(ao.hasOwnProperty(au)){ak(au,ao[au])}}}var at=ar.split(",");for(var am=0;am<an.length;am++){aq=an[am];aq=aq.match(/\s|\d|[?:;!@#$%^&*()<>/+{}]/)?('"'+aq+'"'):aq;al.push(aq)}at.splice(1,0,al.join(","));ak("font-family",at.join(","))};var ai=[{type:"",cssClass:"",template:""},{type:"",cssClass:"",template:""},{type:"segment",cssClass:"mfs-overbar-seg",template:'<svg version="1.1" viewBox="0 0 128 50" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 0 7 L 128 7 " stroke="@@color@@" fill="@@color@@" stroke-width="3"/></svg>'},{type:"ray",cssClass:"mfs-overbar-ray",template:'<svg version="1.1" viewBox="0 0 128 40" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 7 20 l 114 0M 121 20l -21 -20L 121 20l -21 20" stroke="@@color@@" fill="none" stroke-width="10"/></svg>'},{type:"line",cssClass:"mfs-overbar-line",template:'<svg version="1.1" viewBox="0 0 128 40" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 7 20 l 21 -20 L 7 20 l 21 20 M 7 20 l 114 0M 121 20l -21 -20L 121 20l -21 20" stroke="@@color@@" fill="none" stroke-width="8"/></svg>'},{type:"arc",cssClass:"mfs-overbar-arc",template:'<svg version="1.1" viewBox="0 0 128 50" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M 12 50 Q 70 0 128 50 M 128 50 Q 70 9 12 50 " stroke="@@color@@" fill="@@color@@" stroke-width="1"/></svg>'}];function V(al){if(typeof al==="number"){return ai[al]}var ak;for(ak=0;ak<ai.length;ak++){if(al===ai[ak].type){return ai[ak]}}return null}y.mfs.createOverbarDOM=function(ak,al){var am=V(ak),an;an=g("<div>");an.addClass("mfs-overbar");if(am.cssClass){an.addClass(am.cssClass)}if(am.factory){an.css("background-image",am.factory(al))}return an};y.mfs.makeHTMLFromMFSParseTree=(function(){function ao(ar){return function(au){var at=y.btoa(ar.replace(/@@color@@/g,au));return'url("data:image/svg+xml;base64,'+at+'")'}}for(var al=0;al<ai.length;al++){var an=ai[al].template;ai[al].factory=an?ao(an):null}function ak(at,aB,ax){var aA="",ay,au,az;for(var aw=0;aw<ax.length;aw++){au=ax[aw];ay=au[0];az=au[1];aA+=ay+" ";for(var av=0;av<az.length;av++){aA+=Math.round(az[av]*10)/10+" "}}var ar='<svg version="1.1" viewBox="0 0 '+at+" "+aB+'" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="'+aA+'" stroke="@@color@@" fill="@@color@@" stroke-width="1"/></svg>';return ar}var aq=(function(){var au=40,aB=70;var ar=aB*0.9;var ay=aB-ar;var az=ay+(ar-ay)/2;var av=0.5;var at=0.2;var aA=au*0.17;function ax(){var aC=0;var aF=aC+aA;var aE=au*(1+at);var aD=au*(1+av);return ak(au,aB,[["M",[aC,ay]],["L",[aF,ay]],["Q",[aD,az,aF,ar]],["M",[aF,ar]],["L",[aC,ar]],["Q",[aE,az,aC,ay]]])}function aw(){var aD=au;var aC=aD-aA;var aF=-(au*at);var aE=-(au*av);return ak(au,aB,[["M",[aD,ay]],["L",[aC,ay]],["Q",[aE,az,aC,ar]],["M",[aC,ar]],["L",[aD,ar]],["Q",[aF,az,aD,ay]]])}return{left:ao(aw()),right:ao(ax())}})();var am=(function(){var au=40,ar=70;function at(){var aw=0,az=0;var ay=au,ax=ar*0.03;return ak(au,ar,[["M",[aw,az]],["L",[ay,az]],["L",[ay,ax]],["L",[aw,ax]],["L",[aw,az]]])}function av(){var az=0;var aC=ar*0.06;var aD=au*0.05;var aw=ar*0.55;var aG=aw+aC/3;var aI=au*0.25;var ay=aI+(au*0.2);var ax=ar*0.87;var aF=au-(aD*3);var aH=au;var aE=0;var aA=aE+aC/2;var aB=ax+aC;return ak(au,ar,[["M",[az,aw]],["L",[aI,aw]],["L",[ay,ax]],["L",[aF,aE]],["L",[aH,aE]],["L",[aH,aA]],["L",[aF+(aD/2),aA]],["L",[ay,aB]],["L",[aI-aD,aG]],["L",[az,aG]],["L",[az,aw]]])}return{left:ao(av()),right:ao(at())}})();var ap=(function(){var au=20,ar=70;function at(){var av=8,ay=4;var ax=12,aw=ar-4;return ak(au,ar,[["M",[av,ay]],["L",[ax,ay]],["L",[ax,aw]],["L",[av,aw]],["L",[av,ay]]])}return ao(at())})();return function(aJ,aw,aA,av){var aH={},au={},at=[];g.each(av,function(aO,aP){if(aO!=="font-size"&&aO!=="fontSize"){ax(aO,aP)}});function aG(){at.push({type:"marker"})}function ax(aO,aP){at.push({type:"style",name:aO,value:aP})}function aL(){var aO=at.pop();while(aO.type!=="marker"){aO=at.pop()}}function aK(aP){var aQ={};g.each(at,function(aS,aR){if(aR.type==="style"){aQ[aR.name]=aR.value}});var aO=y.mfs.getLineHeight(aQ.fontFamily||aP.css("font-family"),aQ.fontSize||aP.css("font-size"));if(aO){aQ.lineHeight=aO}return aQ}function aN(){var aO=[];g.each(at,function(aQ,aP){if(aP.type==="class"){aO.push(aP.name)}});return aO.join(" ")}function ay(aP,aO){aP.append(aO);var aQ=aP[0].lastChild;return g(aQ)}function aC(aQ,aP){var aR,aO;aO=au[aQ.type];if(aO){aR=aO(aQ,aP);return aR}else{y.signalErrorWithMessage("GSP.mfs.makeHTMLFromMFSParseTree: No handler for node:"+aQ.type);return aP}}function aE(aO){return String(aO).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#47;")}function aD(aO){return(aO.type==="text")||(aO.type==="symbol")}function aF(aP){var aO=aP.value,aQ="\xA0";if(aP.type==="symbol"){return y.mfs.symMap[aO.toUpperCase()]||"x"}if((aP.type==="text")&&aO.match(/ $/)){aO=aO.substring(0,aO.length-1)+aQ}return aO}function aM(aO,aQ){var aP=aK(aO);return ay(aO,'<div class="mfs-text"/>').css(aP).addClass(aN).append(aE(aQ))}function ar(aQ){var aP,aO=[];g.each(aQ,function(aR,aS){if(aP&&aD(aP)&&aD(aS)){aP.value+=aF(aS)}else{if(aS.type==="symbol"){aS.value=aF(aS);aS.type="text"}aO.push(aS);aP=aS}});return aO}function aI(aP,aQ){var aO;if(aQ.value.length>0){aQ.value=ar(aQ.value)}for(aO=0;aO<aQ.value.length;aO+=1){aC(aQ.value[aO],aP)}}function az(aP,aQ,aO){var aR=ay(aO,'<div class="'+aP+'"/>');aI(aR,aQ);return aR}function aB(aQ,aO,aS){var aW=y.Strings.format('<td class="%@"></td>',[aS.leftClass]),aP=g(aW).append("<span>"),aU=y.Strings.format('<table class="%@"><tbody><tr><td></td></tr></tbody></table>',[aS.tableClass]),aX=ay(aO,g(aU)),aT=g(">tbody >tr",aX),aY=g(">tbody >tr >td",aX),aV;if(aS.middleClass){aY.addClass(aS.middleClass)}aI(aY,aQ);var aR=aK(aO).color||aO.css("color")||"black";aP.css("background-image",aS.leftSVGFactory(aR));aT.prepend(aP);if(aS.middleClass){aY.css("background-image",aS.middleSVGFactory(aR))}if(aS.rightClass){aV=g(y.Strings.format('<td class="%@"></td>',[aS.rightClass])).append("<span>");aV.css("background-image",aS.rightSVGFactory(aR));aT.append(aV)}return aX}au.abs=function(aP,aO){return aB(aP,aO,{tableClass:"mfs-abs",leftClass:"mfs-abs-bar",rightClass:"mfs-abs-bar",leftSVGFactory:ap,rightSVGFactory:ap})};au.bracket=function(aP,aO){return az("mfs-bracket",aP,aO)};au.curly=function(aP,aO){return az("mfs-curly",aP,aO)};au.fraction=function(aP,aO){var aQ=ay(aO,'<div class="mfs-frac"/>');aC(aP.value[0],aQ).addClass("mfs-numr mfs-responsive-borderwidth");aC(aP.value[1],aQ).addClass("mfs-denm");return aQ};au.horizontal=function(aP,aO){if(aP.value.length>0){aP.value=ar(aP.value)}if(aP.value.length===1){return aC(aP.value[0],aO)}return az("mfs-horizontal",aP,aO)};au.input=function(aQ,aP){var aR=g("<div>").addClass("mfs-input mfs-responsive-borderwidth"),aS;aR.append("%"+aQ.value);aP.append(aR);aS=aH[aQ.value];if(!aS){aS=[];aH[aQ.value]=aS}aS.push(aR);var aO=y.getConfigValue("NumberpadManager.delegates.registerElement");aO(aR);return aR};au.parameter=function(aP,aO){var aQ,aR;aQ=ay(aO,'<div class="mfs-param">');aQ.css(aK(aO));aQ.append("%"+aP.value);aR=aH[aP.value];if(!aR){aR=[];aH[aP.value]=aR}aR.push(aQ);return aQ};au.paren=function(aP,aO){return aB(aP,aO,{tableClass:"mfs-paren",leftClass:"mfs-left-paren",rightClass:"mfs-right-paren",leftSVGFactory:aq.left,rightSVGFactory:aq.right})};au.root=function(aP,aO){return aB(aP,aO,{tableClass:"mfs-root",leftClass:"mfs-left-root",leftSVGFactory:am.left,middleClass:"mfs-right-root",middleSVGFactory:am.right})};au.style=function(aU,aR){var aV,aT=aR,aO,aW,aX,aQ,aY={},aP=[];for(aV=0;aV<aU.value.length;aV+=1){if(aU.value[aV].code){aY[aU.value[aV].code]=aU.value[aV].value}else{if(aU.value[aV].type){aP.push(aU.value[aV])}}}aG();if(aY.fontFamily){if(aA){aQ=aA[parseInt(aY.fontFamily,16)];var aS=function(aZ,a2){switch(aZ){case"font-family":aQ=a2;break;case"font-weight":var a0={normal:1,bold:2};aY.fontWeight=a0[a2];break;case"font-style":var a1={normal:1,italic:2};aY.fontStyle=a1[a2];break;default:break}};y.mfs.normalizeFont(aQ,aS);if(aQ){ax("fontFamily",aQ)}}}if(Number(aY.fontWeight)===1){ax("fontWeight","normal")}if(Number(aY.fontWeight)===2){ax("fontWeight","bold")}if(Number(aY.fontStyle)===1){ax("fontStyle","normal")}if(Number(aY.fontStyle)===2){ax("fontStyle","italic")}if(aY.red||aY.green||aY.blue){aO=aY.red?parseInt(aY.red,16)-1:0;aW=aY.green?parseInt(aY.green,16)-1:0;aX=aY.blue?parseInt(aY.blue,16)-1:0;ax("color","rgb("+aO+","+aW+","+aX+")")}if(Number(aY.underbar)===1){ax("text-decoration","none")}if(Number(aY.underbar)===2){ax("text-decoration","underline")}if(Number(aY.tightness)===1){ax("letter-spacing","normal")}if(Number(aY.tightness)===2){ax("letter-spacing","-1px")}if(Number(aY.tightness)===3){ax("letter-spacing","1px")}if(aP.length===1){aT=aC(aP[0],aT);if(aY.fontSize){aT.css("fontSize",parseInt(aY.fontSize,16)+"px")}}else{throw y.createError("Malformed Style Node: Too many children")}aL();return aT};au.sub=function(aP,aO){var aQ=ay(aO,'<div class="mfs-sub-group"/>');aC(aP.value[0],aQ);aC(aP.value[1],aQ).addClass("mfs-subscript");return aQ};au["super"]=function(aP,aO){var aQ=ay(aO,'<div class="mfs-super-group"/>');aC(aP.value[0],aQ);aC(aP.value[1],aQ).addClass("mfs-exponent");return aQ};au.symbol=function(aP,aO){return aM(aO,aF(aP))};au["switch"]=function(aQ,aP){var aO=aQ.visibleNode;if(aO&&(aO>0)){return aC(aQ.value[aO-1],aP)}};au.text=function(aP,aO){return aM(aO,aF(aP))};au.vertical=function(aS,aP){var aO,aU,aR={L:"left",C:"center",R:"right"},aT=aS.alignment&&aR[aS.alignment],aQ=aT?'style="text-align:'+aT+';"':"";if(aS.value.length>1){aU=ay(aP,'<div class="mfs-vertical-group" '+aQ+"/>");for(aO=0;aO<aS.value.length;aO+=1){if(aS.value[aO].type!=="future"){if(y.mfs.isEmptyTextMFS(aS.value[aO])){ay(aU,"<br>")}else{aC(aS.value[aO],aU)}}}return aU}else{return aC(aS.value[0],aP)}};au.future=function(aP,aO){return aO};au.overbar=function(aQ,aP){var aO=aK(aP).color||aP.css("color")||"black";var aR=ay(aP,y.mfs.createOverbarDOM(Number(aQ.variant),aO));aC(aQ.value,aR);return aR};aC(aJ,aw);return aH}})();y.mfs.makeMFSFromMFSParseTree=function(am){var an={};function al(ap){var ao;ao=an[ap.type];if(ao){return ao(ap)}else{y.signalErrorWithMessage("GSP.mfs.makeMFSFromMFSParseTree: No handler for node:"+ap.type);return""}}function ak(ao){var aq,ar=ao.length,ap="";for(aq=0;aq<ar;aq++){ap+=al(ao[aq])}return ap}an.abs=function(ao){return"<|"+al(ao.value[0])+">"};an.bracket=function(ao){return"<["+al(ao.value[0])+">"};an.curly=function(ao){return"<{"+al(ao.value[0])+">"};an.fraction=function(ao){return"</"+al(ao.value[0])+al(ao.value[1])+">"};an.horizontal=function(ao){return"<H"+ak(ao.value)+">"};an.parameter=function(ao){return"<%"+ao.value+">"};an.paren=function(ao){return"<("+al(ao.value[0])+">"};an.root=function(ao){return"<R"+al(ao.value[0])+">"};an.style=function(au){var ap="",ao,aq={green:"G",blue:"L",fontFamily:"P",red:"R",fontStyle:"S",tightness:"T",underbar:"U",fontWeight:"W",fontSize:"#","diminish-size":"+"};for(var ar=0,at=au.value.length-1;ar<at;++ar){ao=au.value[ar];ap+=aq[ao.code];ap+=ao.value}return"<S"+ap+al(au.value[au.value.length-1])+">"};an.sub=function(ao){return"<-"+al(ao.value[0])+al(ao.value[1])+">"};an["super"]=function(ao){return"<+"+al(ao.value[0])+al(ao.value[1])+">"};an.symbol=function(ao){return"<!"+ao.value+">"};an["switch"]=function(ao){var ap=ao.visibleNode?ao.visibleNode.toString(16):"";return"<?"+ap+"x"+ao.refCon+ak(ao.value)+">"};an.text=function(ao){return"<T'"+ao.value.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'>"};an.vertical=function(ao){var ap=ao.alignment?ao.alignment:"";return"<V"+ap+ak(ao.value)+">"};an.future=function(ao){return"<F"+ao.value+">"};an.overbar=function(ap,ao){return"<O"+ap.variant+al(ap.value)+">"};return al(am)}}());y.units={};y.units.unitFamilies={length:{baseUnit:"pixels"},angle:{baseUnit:"radians"},scalar:{baseUnit:"scalar"}};y.units.units=[{unitFamily:"scalar",conversionFromBase:1,pluralName:"",singularName:"",symbol:""},{unitFamily:"length",conversionFromBase:1,pluralName:"pixels",singularName:"pixel",shortName:"pix",digraph:"px",symbol:" pixels"},{unitFamily:"length",conversionFromBase:1/72,pluralName:"inches",singularName:"inch",shortName:"in.",digraph:"in",symbol:" in."},{unitFamily:"length",conversionFromBase:1/(72*0.393700787401575),pluralName:"centimeter",singularName:"centimeter",shortName:"cm",digraph:"cm",symbol:" cm"},{unitFamily:"angle",conversionFromBase:1,pluralName:"radians",singularName:"radian",shortName:"rad",digraph:"rd",symbol:" radians"},{unitFamily:"angle",conversionFromBase:180/Math.PI,pluralName:"degrees",singularName:"degree",shortName:"deg",digraph:"dg",symbol:"\u00B0"},{unitFamily:"angle",conversionFromBase:180/Math.PI,pluralName:"degrees",singularName:"degree",shortName:"signed deg",digraph:"dg",symbol:"\u00B0"}];y.units.makeUnitMap=function(F){var D,G,E={};for(D=0;D<F.length;D+=1){G=F[D];if(G.pluralName!==h){E[G.pluralName]=G}if(G.singularName!==h){E[G.singularName]=G}if(G.shortName!==h){E[G.shortName]=G}if(G.digraph!==h){E[G.digraph]=G}if(G.symbol!==h){E[G.symbol]=G}if(G.unitFamily==="scalar"){E.scalar=G}}return E};y.units.unitMap=y.units.makeUnitMap(y.units.units);y.units.findUnit=function(D,E){if(typeof D==="undefined"){D="scalar"}return this.unitMap[D]};y.units.convert=function(J,F,K,H){var I=this.findUnit(F),G=this.findUnit(K),D=I.unitFamily,E;if(H===h){H=1}if(!I){y.signalErrorWithMessage("GSP.units.convert: unknown fromUnit: "+F);return J}if(!G){y.signalErrorWithMessage("GSP.units.convert: unknown toUnit: "+K);return J}D=I.unitFamily;if(G.unitFamily!==D){y.signalErrorWithMessage("GSP.units.convert: can't convert between unit families: "+F+"/"+K);return J}E=(I.pluralName===D.baseUnit)?J:J/Math.pow(I.conversionFromBase,H);return E*Math.pow(G.conversionFromBase,H)};y.units.eachUnitDimension=function(D,F){var E;for(E in D){if(D.hasOwnProperty(E)&&D[E]&&(E!=="scalar")){if(false===F(E,D[E])){return}}}};y.units.makeUnitObjectFromUnitsAndPowers=function(E,D){var F={};y.units.eachUnitDimension(D,function(H,G){F[H]={unit:E[H],power:G}});return F};y.units.convertFromBaseToUnitObject=function(E,D){var F=E;y.units.eachUnitDimension(D,function(G,H){F=y.units.convertFromBaseValue(F,H.unit,H.power)});return F};y.units.convertToBaseFromUnitObject=function(E,D){var F=E;y.units.eachUnitDimension(D,function(G,H){F=y.units.convertToBaseValue(F,H.unit,H.power)});return F};y.units.convertFromBaseValue=function(G,H,F){var E=this.findUnit(H),D;if(E===h){y.signalErrorWithMessage("GSP.units.convert: unknown toUnit: "+H);return G}D=E.unitFamily;return this.convert(G,this.unitFamilies[D].baseUnit,H,F)};y.units.convertToBaseValue=function(H,E,F){var G=this.findUnit(E),D;if(G===h){y.signalErrorWithMessage("GSP.units.convert: unknown toUnit: "+G);return H}D=G.unitFamily;return this.convert(H,E,this.unitFamilies[D].baseUnit,F)};y.units.getMFSForUnitObject=function(E){var D=null;y.units.eachUnitDimension(E,function(F,G){if(G.power!==0){if(D){return null}else{if(G.power===1){D=y.mfs.makeTextMFS(y.units.findUnit(G.unit).symbol)}else{D={type:"super",value:[y.mfs.makeTextMFS(y.units.findUnit(G.unit).symbol),y.mfs.makeTextMFS(G.power)]}}}}});return D};y.units.getUnitFamily=function(D){var E=this.findUnit(D);if(E===h){E=this.findUnit("scalar")}return E.unitFamily};y.units.convertToDocUnits=function(F,H,G){if(typeof G==="undefined"){return H}var E=this.findUnit(G);var D=F[E.unitFamily];return this.convert(H,G,D,1)};y.math={angleToRadians:function(D,E){return y.units.convert(E,D,"radians",1)},sin:function(E,D){return Math.sin(this.angleToRadians(D.angle,E))},cos:function(E,D){return Math.cos(this.angleToRadians(D.angle,E))},tan:function(E,D){return Math.tan(this.angleToRadians(D.angle,E))},asin:function(E,D){return y.units.convertToDocUnits(D,Math.asin(E),"radians")},acos:function(E,D){return y.units.convertToDocUnits(D,Math.acos(E),"radians")},atan:function(E,D){return y.units.convertToDocUnits(D,Math.atan(E),"radians")},abs:Math.abs,sqrt:Math.sqrt,ln:Math.log,log:function(D){return D>=1?Math.log(D)*Math.LOG10E:Math.log(10*D)*Math.LOG10E-1},pow:function(E,D){return E<0?y.math.powerOfNegativeBase(E,D):Math.pow(E,D)},sign:function(D){return D===D?(D===0?0:(D<0?-1:1)):NaN},isDefined:function(D){return isNaN(D)?0:1},round:Math.round,trunc:function(D){return Math[D>0?"floor":"ceil"](D)},mod:function(D,E){return((D%E)+E)%E},powerOfNegativeBase:function(J,G){var F=1e-13,D=3,H,I,K,E;for(K=0;K<5;++K){H=G*D;I=Math.round(H);if(Math.abs(H-I)<=(2*F)){E=(I%2!==0)?-1:1;return E*Math.pow(-J,G)}D+=2}return Math.pow(J,G)},expect:function(K,H,L,J){var G=isNaN(K)||(K===h),F=isNaN(H)||(H===h),D=!isFinite(K)&&!isNaN(K)&&((K>0)?"posInfinity":"negInfinity"),I=((H==="inf")&&"posInfinity")||((H==="-inf")&&"negInfinity"),E;if(h===L){L=0.00001}if(K===H){return true}if(D||I){return D===I}if(G||F){return G===F}E=Math.abs(K-H);if(J&&((K+L)!==K)){return E<L}if(Math.abs(K)+Math.abs(H)<2*1e-12){return true}return(E<=L*Math.abs(K))&&(E<=L*Math.abs(H))},isFiniteScalar:function(D){return(D!=null)&&isFinite(D)},gcd:function(E,D){if((E!==~~E)||(D!==~~D)){return 0}if((0===E)||(0===D)){return 0}var F;while(D){F=E%D;E=D;D=F}return E},reduceFraction:function(D,F){var E=this.gcd(D,F);if(E>1){return{numerator:D/E,denominator:F/E}}return{numerator:D,denominator:F}},getSimplePiFraction:function(H){if(H===Math.floor(H)){return false}var F=12*H/Math.PI,E=Math.round(F),G=Math.abs(F-E);if((0!==E)&&(G<0.001)){var D=y.math.reduceFraction(Math.abs(E),12);if(E<0){D.numerator=-D.numerator}return D}return false},parameterDeltaForSecant:function(F,D){var E=1.05367121e-8,I,H,G;I=Math.abs(D.x);if(Math.abs(D.y)>I){I=Math.abs(D.y)}H=E*I;G=F+H;H=G-F;return(H>0?H:E)},secantApproximationToDerivative:function(G,D,F){var E,H=y.math.parameterDeltaForSecant(G,D);E=F(G+H);if(E.isDefined()){return y.GeometricPoint((E.x-D.x)/H,(E.y-D.y)/H)}E=F(G-H);if(E.isDefined()){return y.GeometricPoint((E.x-D.x)/-H,(E.y-D.y)/-H)}return y.GeometricPoint.UNDEFINED}};y.math.PI=Math.PI;y.math.TWO_PI=2*Math.PI;y.math.SIMPLE_PI_THRESHOLD=(Math.PI*0.9999999999);y.infixExpressionParser=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(bz){var ce=arguments.length>1?arguments[1]:{},a2={},O={start:cD},ca=cD,aU=[],aT=function(){return a8(M({kind:"blank",type:"blank",children:{}}))},aS=a2,aR=null,aQ="=",aO={type:"literal",value:"=",description:'"="'},aN=function(cQ,cP){var cO={kind:"equation",type:"equation",children:{expr:cP}};if(cQ){cO.children.declaration=cQ[1]}return a8(M(cO))},aM=/^[a-z]/,aK={type:"class",value:"[a-z]",description:"[a-z]"},aJ="(",cA={type:"literal",value:"(",description:'"("'},cz=/^[xyr\u03B8]/,cx={type:"class",value:"[xyr\\u03B8]",description:"[xyr\\u03B8]"},cw=")",cv={type:"literal",value:")",description:'")"'},cu=function(cR,cQ){var cP=cR.join(""),cO={kind:"declaration:"+cP,type:"declaration",children:{},name:cP,argument:cQ};return M(cO)},ct=function(cP){var cO={kind:"declaration:"+cP,type:"declaration",children:{},argument:cP};return M(cO)},cs="+",cr={type:"literal",value:"+",description:'"+"'},cq="-",co={type:"literal",value:"-",description:'"-"'},cm=function(cR,cP){var cO,cQ,cS;cO=cR;for(cQ=0;cQ<cP.length;cQ++){cS=cP[cQ][0];cO=M({kind:"binary-expr:"+cS,type:"binary-expr",children:{left:cO,right:cP[cQ][2]},subtype:"additive",operator:cS})}return cO},cl="/",ck={type:"literal",value:"/",description:'"/"'},cj="*",ci={type:"literal",value:"*",description:'"*"'},ch=function(cR,cP){var cO,cQ,cS;cO=cR;for(cQ=0;cQ<cP.length;cQ++){cS=cP[cQ][0];cO=M({kind:"binary-expr:"+cS,type:"binary-expr",children:{left:cO,right:cP[cQ][2]},subtype:"multiplicative",operator:cS})}return cO},cg="^",cf={type:"literal",value:"^",description:'"^"'},cd=function(cQ,cR){if(cR){var cP=cR[2];var cO;cO={kind:"binary-expr:^",type:"binary-expr",children:{left:cQ,right:cP},subtype:"power",operator:"^"};return M(cO)}else{return cQ}},cb=function(cO){return cO},b9=function(cO){return cO},b8=function(cO){return M({kind:"unary-expr:-",type:"unary-expr",children:{child:cO},operator:"-"})},b7=function(cO){return M({kind:"unary-expr:-",type:"unary-expr",children:{child:cO},operator:"-"})},b5=function(cO,cP){return M({kind:"function:"+cO,type:"function",children:{arg:cP},subtype:"sys",name:cO})},b4=function(cO,cP){return M({kind:"function:custom",type:"function",children:{name:cO,arg:cP},subtype:"custom"})},b3="sin",b2={type:"literal",value:"sin",description:'"sin"'},b1="cos",b0={type:"literal",value:"cos",description:'"cos"'},bV="tan",bU={type:"literal",value:"tan",description:'"tan"'},bT="Arcsin",bS={type:"literal",value:"Arcsin",description:'"Arcsin"'},bR="Arccos",bQ={type:"literal",value:"Arccos",description:'"Arccos"'},bP="Arctan",bO={type:"literal",value:"Arctan",description:'"Arctan"'},bN="abs",bM={type:"literal",value:"abs",description:'"abs"'},bK="sqrt",bI={type:"literal",value:"sqrt",description:'"sqrt"'},bH="ln",bG={type:"literal",value:"ln",description:'"ln"'},bF="log",bE={type:"literal",value:"log",description:'"log"'},bD="sgn",bC={type:"literal",value:"sgn",description:'"sgn"'},bB="round",bA={type:"literal",value:"round",description:'"round"'},bw="trunc",bv={type:"literal",value:"trunc",description:'"trunc"'},bu="isDefined",bt={type:"literal",value:"isDefined",description:'"isDefined"'},bq=function(cO,cP){return M({kind:"primary",type:"primary",children:{value:cO,unit:cP}})},bp=function(cO){return M({kind:"primary",type:"primary",children:{value:cO},unit:h})},bo=function(cO){return cO},bn=function(cO){return cO},bm=".",bl={type:"literal",value:".",description:'"."'},bi="e",bh={type:"literal",value:"e",description:'"e"'},bg=function(cP){var cO=cP.join("");return M({kind:"constant:numeric:"+cO,type:"constant",children:{},subtype:"numeric",value:cO})},bf="pi",be={type:"literal",value:"pi",description:'"pi"'},bd="\u03C0",bc={type:"literal",value:"\u03C0",description:'"\\u03C0"'},bb=function(cQ){var cO={pi:"pi","π":"pi",e:"e"},cP=cO[cQ]?cO[cQ]:cQ;return M({kind:"constant:symbolic:"+cP,type:"constant",children:{},subtype:"symbolic",value:cP})},ba=/^[0-9]/,a9={type:"class",value:"[0-9]",description:"[0-9]"},aI=function(cO){return cO.join("")},aH="pixels",aG={type:"literal",value:"pixels",description:'"pixels"'},aF="pixel",aE={type:"literal",value:"pixel",description:'"pixel"'},aC="px",aB={type:"literal",value:"px",description:'"px"'},aA="pix",az={type:"literal",value:"pix",description:'"pix"'},ay="cm",ak={type:"literal",value:"cm",description:'"cm"'},aj="centimeter",ai={type:"literal",value:"centimeter",description:'"centimeter"'},ah="inches",ag={type:"literal",value:"inches",description:'"inches"'},af="inch",ad={type:"literal",value:"inch",description:'"inch"'},ac="in.",ab={type:"literal",value:"in.",description:'"in."'},Z="in",a7={type:"literal",value:"in",description:'"in"'},a6=function(cO){return M({kind:"unit:"+cO,type:"unit",children:{},subtype:"distance",name:cO})},a5="radians",a4={type:"literal",value:"radians",description:'"radians"'},a3="radian",a1={type:"literal",value:"radian",description:'"radian"'},a0="rad",aZ={type:"literal",value:"rad",description:'"rad"'},aX="rd",aV={type:"literal",value:"rd",description:'"rd"'},ax="degrees",aw={type:"literal",value:"degrees",description:'"degrees"'},au="deg",at={type:"literal",value:"deg",description:'"deg"'},ar="\xB0",aq={type:"literal",value:"\xB0",description:'"\\xB0"'},ap="signed deg",ao={type:"literal",value:"signed deg",description:'"signed deg"'},an=function(cO){return M({kind:"unit:"+cO,type:"unit",children:{},subtype:"angle",name:cO})},am="@",Y={type:"literal",value:"@",description:'"@"'},X=/^[0-9a-zA-Z_]/,W={type:"class",value:"[0-9a-zA-Z_]",description:"[0-9a-zA-Z_]"},V=function(cO){var cP=cO.join("");return M({kind:"reference:"+cP,type:"reference",children:{},name:cP})},U="x",T={type:"literal",value:"x",description:'"x"'},S="y",R={type:"literal",value:"y",description:'"y"'},Q="\u03B8",P={type:"literal",value:"\u03B8",description:'"\\u03B8"'},N="r",L={type:"literal",value:"r",description:'"r"'},K=function(cO){return M({kind:"variable:"+cO,type:"variable",children:{},name:cO})},J={type:"other",description:"whitespace"},I=/^[ \t\n\r]/,H={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},bL=0,cN=0,cF=0,aP={line:1,column:1,seenCR:false},bj=0,bk=[],cB=0,by;if("startRule" in ce){if(!(ce.startRule in O)){throw new Error("Can't start parsing from rule \""+ce.startRule+'".')}ca=O[ce.startRule]}function cn(){return bz.substring(cN,bL)}function cJ(){return cN}function cy(){return ae(cN).line}function cK(){return ae(cN).column}function cM(cO){throw cI(null,[{type:"other",description:cO}],cN)}function cH(cO){throw cI(cO,null,cN)}function ae(cP){function cO(cS,cR,cQ){var cU,cT;for(cU=cR;cU<cQ;cU++){cT=bz.charAt(cU);if(cT==="\n"){if(!cS.seenCR){cS.line++}cS.column=1;cS.seenCR=false}else{if(cT==="\r"||cT==="\u2028"||cT==="\u2029"){cS.line++;cS.column=1;cS.seenCR=true}else{cS.column++;cS.seenCR=false}}}}if(cF!==cP){if(cF>cP){cF=0;aP={line:1,column:1,seenCR:false}}cO(aP,cF,cP);cF=cP}return aP}function cp(cO){if(bL<bj){return}if(bL>bj){bj=bL;bk=[]}bk.push(cO)}function cI(cQ,cP,cU){function cT(cW){var cV=1;cW.sort(function(cY,cX){if(cY.description<cX.description){return -1}else{if(cY.description>cX.description){return 1}else{return 0}}});while(cV<cW.length){if(cW[cV-1]===cW[cV]){cW.splice(cV,1)}else{cV++}}}function cO(cZ,c0){function cV(c5){function c6(c7){return c7.charCodeAt(0).toString(16).toUpperCase()}return c5.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(c7){return"\\x0"+c6(c7)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(c7){return"\\x"+c6(c7)}).replace(/[\u0180-\u0FFF]/g,function(c7){return"\\u0"+c6(c7)}).replace(/[\u1080-\uFFFF]/g,function(c7){return"\\u"+c6(c7)})}var cW=new Array(cZ.length),c4,cX,cY;for(cY=0;cY<cZ.length;cY++){cW[cY]=cZ[cY].description}c4=cZ.length>1?cW.slice(0,-1).join(", ")+" or "+cW[cZ.length-1]:cW[0];cX=c0?'"'+cV(c0)+'"':"end of input";return"Expected "+c4+" but "+cX+" found."}var cS=ae(cU),cR=cU<bz.length?bz.charAt(cU):null;if(cP!==null){cT(cP)}return new D(cQ!==null?cQ:cO(cP,cR),cP,cR,cU,cS.line,cS.column)}function cD(){var cO;cO=bs();if(cO===a2){cO=aL()}return cO}function aL(){var cP,cO;cP=bL;cO=[];if(cO!==a2){cN=cP;cO=aT()}cP=cO;return cP}function bs(){var cT,cS,cR,cQ,cP,cO,cU;cT=bL;cS=bL;cR=bJ();if(cR!==a2){cQ=cc();if(cQ!==a2){cP=bJ();if(cP!==a2){if(bz.charCodeAt(bL)===61){cO=aQ;bL++}else{cO=a2;if(cB===0){cp(aO)}}if(cO!==a2){cU=bJ();if(cU!==a2){cR=[cR,cQ,cP,cO,cU];cS=cR}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}if(cS===a2){cS=aR}if(cS!==a2){cR=br();if(cR!==a2){cQ=bJ();if(cQ!==a2){cN=cT;cS=aN(cS,cR);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}return cT}function cc(){var cW,cV,cU,cT,cS,cR,cQ,cP,cO;cW=bL;cV=bJ();if(cV!==a2){cU=[];if(aM.test(bz.charAt(bL))){cT=bz.charAt(bL);bL++}else{cT=a2;if(cB===0){cp(aK)}}if(cT!==a2){while(cT!==a2){cU.push(cT);if(aM.test(bz.charAt(bL))){cT=bz.charAt(bL);bL++}else{cT=a2;if(cB===0){cp(aK)}}}}else{cU=aS}if(cU!==a2){cT=bJ();if(cT!==a2){if(bz.charCodeAt(bL)===40){cS=aJ;bL++}else{cS=a2;if(cB===0){cp(cA)}}if(cS!==a2){cR=bJ();if(cR!==a2){if(cz.test(bz.charAt(bL))){cQ=bz.charAt(bL);bL++}else{cQ=a2;if(cB===0){cp(cx)}}if(cQ!==a2){cP=bJ();if(cP!==a2){if(bz.charCodeAt(bL)===41){cO=cw;bL++}else{cO=a2;if(cB===0){cp(cv)}}if(cO!==a2){cN=cW;cV=cu(cU,cQ);cW=cV}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}if(cW===a2){cW=bL;cV=bJ();if(cV!==a2){if(cz.test(bz.charAt(bL))){cU=bz.charAt(bL);bL++}else{cU=a2;if(cB===0){cp(cx)}}if(cU!==a2){cT=bJ();if(cT!==a2){cN=cW;cV=ct(cU);cW=cV}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}return cW}function br(){var cX,cW,cV,cU,cT,cS,cR,cQ,cP,cO;cX=bL;cW=bJ();if(cW!==a2){cV=al();if(cV!==a2){cU=bJ();if(cU!==a2){cT=[];cS=bL;if(bz.charCodeAt(bL)===43){cR=cs;bL++}else{cR=a2;if(cB===0){cp(cr)}}if(cR===a2){if(bz.charCodeAt(bL)===45){cR=cq;bL++}else{cR=a2;if(cB===0){cp(co)}}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=al();if(cP!==a2){cO=bJ();if(cO!==a2){cR=[cR,cQ,cP,cO];cS=cR}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}while(cS!==a2){cT.push(cS);cS=bL;if(bz.charCodeAt(bL)===43){cR=cs;bL++}else{cR=a2;if(cB===0){cp(cr)}}if(cR===a2){if(bz.charCodeAt(bL)===45){cR=cq;bL++}else{cR=a2;if(cB===0){cp(co)}}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=al();if(cP!==a2){cO=bJ();if(cO!==a2){cR=[cR,cQ,cP,cO];cS=cR}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}if(cT!==a2){cN=cX;cW=cm(cV,cT);cX=cW}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}return cX}function al(){var cX,cW,cV,cU,cT,cS,cR,cQ,cP,cO;cX=bL;cW=bJ();if(cW!==a2){cV=bx();if(cV!==a2){cU=bJ();if(cU!==a2){cT=[];cS=bL;if(bz.charCodeAt(bL)===47){cR=cl;bL++}else{cR=a2;if(cB===0){cp(ck)}}if(cR===a2){if(bz.charCodeAt(bL)===42){cR=cj;bL++}else{cR=a2;if(cB===0){cp(ci)}}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=bx();if(cP!==a2){cO=bJ();if(cO!==a2){cR=[cR,cQ,cP,cO];cS=cR}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}while(cS!==a2){cT.push(cS);cS=bL;if(bz.charCodeAt(bL)===47){cR=cl;bL++}else{cR=a2;if(cB===0){cp(ck)}}if(cR===a2){if(bz.charCodeAt(bL)===42){cR=cj;bL++}else{cR=a2;if(cB===0){cp(ci)}}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=bx();if(cP!==a2){cO=bJ();if(cO!==a2){cR=[cR,cQ,cP,cO];cS=cR}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}if(cT!==a2){cN=cX;cW=ch(cV,cT);cX=cW}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}return cX}function bx(){var cW,cV,cU,cT,cS,cR,cQ,cP,cO;cW=bL;cV=bJ();if(cV!==a2){cU=bZ();if(cU!==a2){cT=bJ();if(cT!==a2){cS=bL;if(bz.charCodeAt(bL)===94){cR=cg;bL++}else{cR=a2;if(cB===0){cp(cf)}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=bx();if(cP!==a2){cO=bJ();if(cO!==a2){cR=[cR,cQ,cP,cO];cS=cR}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}}else{bL=cS;cS=aS}if(cS===a2){cS=aR}if(cS!==a2){cN=cW;cV=cd(cU,cS);cW=cV}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}}else{bL=cW;cW=aS}return cW}function bZ(){var cT,cS,cR,cQ,cP,cO,cV,cU;cT=b6();if(cT===a2){cT=bL;cS=bJ();if(cS!==a2){if(bz.charCodeAt(bL)===40){cR=aJ;bL++}else{cR=a2;if(cB===0){cp(cA)}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=br();if(cP!==a2){cO=bJ();if(cO!==a2){if(bz.charCodeAt(bL)===41){cV=cw;bL++}else{cV=a2;if(cB===0){cp(cv)}}if(cV!==a2){cU=bJ();if(cU!==a2){cN=cT;cS=cb(cP);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}if(cT===a2){cT=bL;cS=bJ();if(cS!==a2){cR=av();if(cR!==a2){cQ=bJ();if(cQ!==a2){cN=cT;cS=b9(cR);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}}return cT}function b6(){var cT,cS,cR,cQ,cP,cO;cT=aW();if(cT===a2){cT=bL;cS=bJ();if(cS!==a2){if(bz.charCodeAt(bL)===45){cR=cq;bL++}else{cR=a2;if(cB===0){cp(co)}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=b6();if(cP!==a2){cO=bJ();if(cO!==a2){cN=cT;cS=b8(cP);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}if(cT===a2){cT=bL;cS=bJ();if(cS!==a2){if(bz.charCodeAt(bL)===45){cR=cq;bL++}else{cR=a2;if(cB===0){cp(co)}}if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=bx();if(cP!==a2){cO=bJ();if(cO!==a2){cN=cT;cS=b7(cP);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}}return cT}function aW(){var cX,cW,cV,cU,cT,cS,cR,cQ,cP,cO;cX=bL;cW=bJ();if(cW!==a2){cV=aD();if(cV!==a2){cU=bJ();if(cU!==a2){if(bz.charCodeAt(bL)===40){cT=aJ;bL++}else{cT=a2;if(cB===0){cp(cA)}}if(cT!==a2){cS=bJ();if(cS!==a2){cR=br();if(cR!==a2){cQ=bJ();if(cQ!==a2){if(bz.charCodeAt(bL)===41){cP=cw;bL++}else{cP=a2;if(cB===0){cp(cv)}}if(cP!==a2){cO=bJ();if(cO!==a2){cN=cX;cW=b5(cV,cR);cX=cW}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}if(cX===a2){cX=bL;cW=bJ();if(cW!==a2){cV=bY();if(cV!==a2){cU=bJ();if(cU!==a2){if(bz.charCodeAt(bL)===40){cT=aJ;bL++}else{cT=a2;if(cB===0){cp(cA)}}if(cT!==a2){cS=bJ();if(cS!==a2){cR=br();if(cR!==a2){cQ=bJ();if(cQ!==a2){if(bz.charCodeAt(bL)===41){cP=cw;bL++}else{cP=a2;if(cB===0){cp(cv)}}if(cP!==a2){cO=bJ();if(cO!==a2){cN=cX;cW=b4(cV,cR);cX=cW}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}else{bL=cX;cX=aS}}return cX}function aD(){var cO;if(bz.substr(bL,3)===b3){cO=b3;bL+=3}else{cO=a2;if(cB===0){cp(b2)}}if(cO===a2){if(bz.substr(bL,3)===b1){cO=b1;bL+=3}else{cO=a2;if(cB===0){cp(b0)}}if(cO===a2){if(bz.substr(bL,3)===bV){cO=bV;bL+=3}else{cO=a2;if(cB===0){cp(bU)}}if(cO===a2){if(bz.substr(bL,6)===bT){cO=bT;bL+=6}else{cO=a2;if(cB===0){cp(bS)}}if(cO===a2){if(bz.substr(bL,6)===bR){cO=bR;bL+=6}else{cO=a2;if(cB===0){cp(bQ)}}if(cO===a2){if(bz.substr(bL,6)===bP){cO=bP;bL+=6}else{cO=a2;if(cB===0){cp(bO)}}if(cO===a2){if(bz.substr(bL,3)===bN){cO=bN;bL+=3}else{cO=a2;if(cB===0){cp(bM)}}if(cO===a2){if(bz.substr(bL,4)===bK){cO=bK;bL+=4}else{cO=a2;if(cB===0){cp(bI)}}if(cO===a2){if(bz.substr(bL,2)===bH){cO=bH;bL+=2}else{cO=a2;if(cB===0){cp(bG)}}if(cO===a2){if(bz.substr(bL,3)===bF){cO=bF;bL+=3}else{cO=a2;if(cB===0){cp(bE)}}if(cO===a2){if(bz.substr(bL,3)===bD){cO=bD;bL+=3}else{cO=a2;if(cB===0){cp(bC)}}if(cO===a2){if(bz.substr(bL,5)===bB){cO=bB;bL+=5}else{cO=a2;if(cB===0){cp(bA)}}if(cO===a2){if(bz.substr(bL,5)===bw){cO=bw;bL+=5}else{cO=a2;if(cB===0){cp(bv)}}if(cO===a2){if(bz.substr(bL,9)===bu){cO=bu;bL+=9}else{cO=a2;if(cB===0){cp(bt)}}}}}}}}}}}}}}}return cO}function av(){var cT,cS,cR,cQ,cP,cO;cT=bL;cS=bJ();if(cS!==a2){cR=aa();if(cR!==a2){cQ=bJ();if(cQ!==a2){cP=cC();if(cP!==a2){cO=bJ();if(cO!==a2){cN=cT;cS=bq(cR,cP);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}if(cT===a2){cT=bL;cS=bJ();if(cS!==a2){cR=aa();if(cR!==a2){cQ=bJ();if(cQ!==a2){cN=cT;cS=bp(cR);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}if(cT===a2){cT=bL;cS=bJ();if(cS!==a2){cR=bY();if(cR!==a2){cQ=bJ();if(cQ!==a2){cN=cT;cS=bo(cR);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}if(cT===a2){cT=bL;cS=bJ();if(cS!==a2){cR=bW();if(cR!==a2){cQ=bJ();if(cQ!==a2){cN=cT;cS=bn(cR);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}}}return cT}function aa(){var cW,cV,cU,cT,cS,cR,cQ,cP,cO;cW=bL;cV=bL;if(bz.charCodeAt(bL)===45){cU=cq;bL++}else{cU=a2;if(cB===0){cp(co)}}if(cU===a2){cU=aR}if(cU!==a2){cT=cG();if(cT!==a2){if(bz.charCodeAt(bL)===46){cS=bm;bL++}else{cS=a2;if(cB===0){cp(bl)}}if(cS!==a2){cR=cG();if(cR!==a2){if(bz.charCodeAt(bL)===101){cQ=bi;bL++}else{cQ=a2;if(cB===0){cp(bh)}}if(cQ!==a2){if(bz.charCodeAt(bL)===45){cP=cq;bL++}else{cP=a2;if(cB===0){cp(co)}}if(cP===a2){cP=aR}if(cP!==a2){cO=cG();if(cO!==a2){cU=[cU,cT,cS,cR,cQ,cP,cO];cV=cU}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}if(cV===a2){cV=bL;if(bz.charCodeAt(bL)===45){cU=cq;bL++}else{cU=a2;if(cB===0){cp(co)}}if(cU===a2){cU=aR}if(cU!==a2){cT=cG();if(cT!==a2){if(bz.charCodeAt(bL)===46){cS=bm;bL++}else{cS=a2;if(cB===0){cp(bl)}}if(cS!==a2){cR=cG();if(cR!==a2){cU=[cU,cT,cS,cR];cV=cU}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}if(cV===a2){cV=bL;if(bz.charCodeAt(bL)===45){cU=cq;bL++}else{cU=a2;if(cB===0){cp(co)}}if(cU===a2){cU=aR}if(cU!==a2){cT=cG();if(cT!==a2){if(bz.charCodeAt(bL)===46){cS=bm;bL++}else{cS=a2;if(cB===0){cp(bl)}}if(cS!==a2){cU=[cU,cT,cS];cV=cU}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}if(cV===a2){cV=bL;if(bz.charCodeAt(bL)===45){cU=cq;bL++}else{cU=a2;if(cB===0){cp(co)}}if(cU===a2){cU=aR}if(cU!==a2){if(bz.charCodeAt(bL)===46){cT=bm;bL++}else{cT=a2;if(cB===0){cp(bl)}}if(cT!==a2){cS=cG();if(cS!==a2){cU=[cU,cT,cS];cV=cU}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}if(cV===a2){cV=bL;if(bz.charCodeAt(bL)===45){cU=cq;bL++}else{cU=a2;if(cB===0){cp(co)}}if(cU===a2){cU=aR}if(cU!==a2){cT=cG();if(cT!==a2){cU=[cU,cT];cV=cU}else{bL=cV;cV=aS}}else{bL=cV;cV=aS}}}}}if(cV!==a2){cN=cW;cV=bg(cV)}cW=cV;if(cW===a2){cW=bL;if(bz.substr(bL,2)===bf){cV=bf;bL+=2}else{cV=a2;if(cB===0){cp(be)}}if(cV===a2){if(bz.charCodeAt(bL)===960){cV=bd;bL++}else{cV=a2;if(cB===0){cp(bc)}}if(cV===a2){if(bz.charCodeAt(bL)===101){cV=bi;bL++}else{cV=a2;if(cB===0){cp(bh)}}}}if(cV!==a2){cN=cW;cV=bb(cV)}cW=cV}return cW}function cG(){var cQ,cP,cO;cQ=bL;cP=[];if(ba.test(bz.charAt(bL))){cO=bz.charAt(bL);bL++}else{cO=a2;if(cB===0){cp(a9)}}if(cO!==a2){while(cO!==a2){cP.push(cO);if(ba.test(bz.charAt(bL))){cO=bz.charAt(bL);bL++}else{cO=a2;if(cB===0){cp(a9)}}}}else{cP=aS}if(cP!==a2){cN=cQ;cP=aI(cP)}cQ=cP;return cQ}function cC(){var cO;cO=aY();if(cO===a2){cO=cL()}return cO}function aY(){var cP,cO;cP=bL;if(bz.substr(bL,6)===aH){cO=aH;bL+=6}else{cO=a2;if(cB===0){cp(aG)}}if(cO===a2){if(bz.substr(bL,5)===aF){cO=aF;bL+=5}else{cO=a2;if(cB===0){cp(aE)}}if(cO===a2){if(bz.substr(bL,2)===aC){cO=aC;bL+=2}else{cO=a2;if(cB===0){cp(aB)}}if(cO===a2){if(bz.substr(bL,3)===aA){cO=aA;bL+=3}else{cO=a2;if(cB===0){cp(az)}}if(cO===a2){if(bz.substr(bL,2)===ay){cO=ay;bL+=2}else{cO=a2;if(cB===0){cp(ak)}}if(cO===a2){if(bz.substr(bL,10)===aj){cO=aj;bL+=10}else{cO=a2;if(cB===0){cp(ai)}}if(cO===a2){if(bz.substr(bL,6)===ah){cO=ah;bL+=6}else{cO=a2;if(cB===0){cp(ag)}}if(cO===a2){if(bz.substr(bL,4)===af){cO=af;bL+=4}else{cO=a2;if(cB===0){cp(ad)}}if(cO===a2){if(bz.substr(bL,3)===ac){cO=ac;bL+=3}else{cO=a2;if(cB===0){cp(ab)}}if(cO===a2){if(bz.substr(bL,2)===Z){cO=Z;bL+=2}else{cO=a2;if(cB===0){cp(a7)}}}}}}}}}}}if(cO!==a2){cN=cP;cO=a6(cO)}cP=cO;return cP}function cL(){var cP,cO;cP=bL;if(bz.substr(bL,7)===a5){cO=a5;bL+=7}else{cO=a2;if(cB===0){cp(a4)}}if(cO===a2){if(bz.substr(bL,6)===a3){cO=a3;bL+=6}else{cO=a2;if(cB===0){cp(a1)}}if(cO===a2){if(bz.substr(bL,3)===a0){cO=a0;bL+=3}else{cO=a2;if(cB===0){cp(aZ)}}if(cO===a2){if(bz.substr(bL,2)===aX){cO=aX;bL+=2}else{cO=a2;if(cB===0){cp(aV)}}if(cO===a2){if(bz.substr(bL,7)===ax){cO=ax;bL+=7}else{cO=a2;if(cB===0){cp(aw)}}if(cO===a2){if(bz.substr(bL,3)===au){cO=au;bL+=3}else{cO=a2;if(cB===0){cp(at)}}if(cO===a2){if(bz.charCodeAt(bL)===176){cO=ar;bL++}else{cO=a2;if(cB===0){cp(aq)}}if(cO===a2){if(bz.substr(bL,10)===ap){cO=ap;bL+=10}else{cO=a2;if(cB===0){cp(ao)}}}}}}}}}if(cO!==a2){cN=cP;cO=an(cO)}cP=cO;return cP}function bY(){var cT,cS,cR,cQ,cP,cO,cU;cT=bL;cS=bJ();if(cS!==a2){cR=bL;if(bz.charCodeAt(bL)===64){cQ=am;bL++}else{cQ=a2;if(cB===0){cp(Y)}}if(cQ!==a2){cP=bJ();if(cP!==a2){cO=[];if(X.test(bz.charAt(bL))){cU=bz.charAt(bL);bL++}else{cU=a2;if(cB===0){cp(W)}}if(cU!==a2){while(cU!==a2){cO.push(cU);if(X.test(bz.charAt(bL))){cU=bz.charAt(bL);bL++}else{cU=a2;if(cB===0){cp(W)}}}}else{cO=aS}if(cO!==a2){cQ=[cQ,cP,cO];cR=cQ}else{bL=cR;cR=aS}}else{bL=cR;cR=aS}}else{bL=cR;cR=aS}if(cR!==a2){cQ=bJ();if(cQ!==a2){cN=cT;cS=V(cO);cT=cS}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}}else{bL=cT;cT=aS}return cT}function bW(){var cP,cO;cP=bL;if(bz.charCodeAt(bL)===120){cO=U;bL++}else{cO=a2;if(cB===0){cp(T)}}if(cO===a2){if(bz.charCodeAt(bL)===121){cO=S;bL++}else{cO=a2;if(cB===0){cp(R)}}if(cO===a2){if(bz.charCodeAt(bL)===952){cO=Q;bL++}else{cO=a2;if(cB===0){cp(P)}}if(cO===a2){if(bz.charCodeAt(bL)===114){cO=N;bL++}else{cO=a2;if(cB===0){cp(L)}}}}}if(cO!==a2){cN=cP;cO=K(cO)}cP=cO;return cP}function bJ(){var cP,cO;cB++;cP=[];cO=bX();while(cO!==a2){cP.push(cO);cO=bX()}cB--;if(cP===a2){cO=a2;if(cB===0){cp(J)}}return cP}function bX(){var cO;if(I.test(bz.charAt(bL))){cO=bz.charAt(bL);bL++}else{cO=a2;if(cB===0){cp(H)}}return cO}var cE=0,G={};function M(cR){var cP=cR.kind,cO;for(var cQ in cR.children){if(cR.children.hasOwnProperty(cQ)){cP+=":"+cQ+":"+cR.children[cQ].index}}cO=G[cP];if(cO){return cO}cR.index=cE;cR.refCount=0;G[cP]=cR;cE++;return cR}function a8(cO){var cP;for(cP in cO.children){a8(cO.children[cP])}cO.refCount++;return cO}by=ca();if(by!==a2&&bL===bz.length){return by}else{if(by!==a2&&bL<bz.length){cp({type:"end",description:"end of input"})}throw cI(null,bk,bj)}}return{SyntaxError:D,parse:E}})();y.jskParser=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(T){var b3=arguments.length>1?arguments[1]:{},cR={},eb={start:fo},aw=fo,dy=[],dx=cR,dv=null,du=";",dt={type:"literal",value:";",description:'";"'},ds=function(fM,fL,fN){var fO=++dw;return{id:fO,type:fM,argGroups:fL,opts:fN?fN:[]}},dq=function(fL){return fL},dp="[",dn={type:"literal",value:"[",description:'"["'},dm=",",fB={type:"literal",value:",",description:'","'},fz="]",fw={type:"literal",value:"]",description:'"]"'},fv=function(fO,fM){var fL,fN=[];fN.push(fO);for(fL=0;fL<fM.length;fL+=1){fN.push(fM[fL][3])}return fN},fu="(",ft={type:"literal",value:"(",description:'"("'},fs=")",fr={type:"literal",value:")",description:'")"'},fq=function(){return[]},fp=function(fN,fL){var fM,fO=[];fO.push(fN);for(fM=0;fM<fL.length;fM+=1){fO.push(fL[fM][3])}return fO},fe="Point on object",fc={type:"literal",value:"Point on object",description:'"Point on object"'},fa="Point",e9={type:"literal",value:"Point",description:'"Point"'},e8="FixedPoint",e7={type:"literal",value:"FixedPoint",description:'"FixedPoint"'},e5="Midpoint",e4={type:"literal",value:"Midpoint",description:'"Midpoint"'},e3="Intersect1",e2={type:"literal",value:"Intersect1",description:'"Intersect1"'},eX="Intersect2",eW={type:"literal",value:"Intersect2",description:'"Intersect2"'},eV="Intersect",eU={type:"literal",value:"Intersect",description:'"Intersect"'},eT="PlotXY",eR={type:"literal",value:"PlotXY",description:'"PlotXY"'},eQ="PlotFixedXY",eP={type:"literal",value:"PlotFixedXY",description:'"PlotFixedXY"'},eO="UnitPoint",eN={type:"literal",value:"UnitPoint",description:'"UnitPoint"'},eL="SquareUnitPoint",eJ={type:"literal",value:"SquareUnitPoint",description:'"SquareUnitPoint"'},eI="RectangularUnitPoint",eH={type:"literal",value:"RectangularUnitPoint",description:'"RectangularUnitPoint"'},eG="DriverPoint",eF={type:"literal",value:"DriverPoint",description:'"DriverPoint"'},eE="Segment",eD={type:"literal",value:"Segment",description:'"Segment"'},eC="Ray",eB={type:"literal",value:"Ray",description:'"Ray"'},ey="Line",ex={type:"literal",value:"Line",description:'"Line"'},ew="Perpendicular",ev={type:"literal",value:"Perpendicular",description:'"Perpendicular"'},eu="Parallel",et={type:"literal",value:"Parallel",description:'"Parallel"'},es="AxisX",er={type:"literal",value:"AxisX",description:'"AxisX"'},eq="AxisY",ep={type:"literal",value:"AxisY",description:'"AxisY"'},en="Bisector",el={type:"literal",value:"Bisector",description:'"Bisector"'},ek="HorizontalAxis",ej={type:"literal",value:"HorizontalAxis",description:'"HorizontalAxis"'},ei="VerticalAxis",eh={type:"literal",value:"VerticalAxis",description:'"VerticalAxis"'},ef="Polygon",ee={type:"literal",value:"Polygon",description:'"Polygon"'},ed="Circle interior",ec={type:"literal",value:"Circle interior",description:'"Circle interior"'},ea="Circle by radius",d9={type:"literal",value:"Circle by radius",description:'"Circle by radius"'},d8="Circle",d7={type:"literal",value:"Circle",description:'"Circle"'},d6="Reflection",d5={type:"literal",value:"Reflection",description:'"Reflection"'},d4="Dilation/SegmentRatio",d3={type:"literal",value:"Dilation/SegmentRatio",description:'"Dilation/SegmentRatio"'},d2="Dilation/3PtRatio",d1={type:"literal",value:"Dilation/3PtRatio",description:'"Dilation/3PtRatio"'},dZ="Dilation/MarkedRatio",dX={type:"literal",value:"Dilation/MarkedRatio",description:'"Dilation/MarkedRatio"'},dV="Dilation",dU={type:"literal",value:"Dilation",description:'"Dilation"'},dT="Rotation/MarkedAngle",dS={type:"literal",value:"Rotation/MarkedAngle",description:'"Rotation/MarkedAngle"'},dR="Rotation/MeasuredAngle",dP={type:"literal",value:"Rotation/MeasuredAngle",description:'"Rotation/MeasuredAngle"'},dO="Rotation",dN={type:"literal",value:"Rotation",description:'"Rotation"'},dK="VectorTranslation",dJ={type:"literal",value:"VectorTranslation",description:'"VectorTranslation"'},dI="Translation/FixedAngle/MarkedDistance",dH={type:"literal",value:"Translation/FixedAngle/MarkedDistance",description:'"Translation/FixedAngle/MarkedDistance"'},dF="PolarTranslation",dE={type:"literal",value:"PolarTranslation",description:'"PolarTranslation"'},dD="Translation/MarkedAngle/FixedDistance",dC={type:"literal",value:"Translation/MarkedAngle/FixedDistance",description:'"Translation/MarkedAngle/FixedDistance"'},dB="Translation/MarkedAngle/MarkedDistance",dA={type:"literal",value:"Translation/MarkedAngle/MarkedDistance",description:'"Translation/MarkedAngle/MarkedDistance"'},dh="Translation",dg={type:"literal",value:"Translation",description:'"Translation"'},df="Colorized_Spectrum",de={type:"literal",value:"Colorized_Spectrum",description:'"Colorized_Spectrum"'},dd="Colorized_Grayscale",dc={type:"literal",value:"Colorized_Grayscale",description:'"Colorized_Grayscale"'},da="Colorized_RGB",c9={type:"literal",value:"Colorized_RGB",description:'"Colorized_RGB"'},c8="Colorized_HSV",c7={type:"literal",value:"Colorized_HSV",description:'"Colorized_HSV"'},c6="Image",c5={type:"literal",value:"Image",description:'"Image"'},c4="ImageOnPoint",c0={type:"literal",value:"ImageOnPoint",description:'"ImageOnPoint"'},cZ="ImageBetweenPoints",cX={type:"literal",value:"ImageBetweenPoints",description:'"ImageBetweenPoints"'},cW="Length",cV={type:"literal",value:"Length",description:'"Length"'},cT="Angle",cS={type:"literal",value:"Angle",description:'"Angle"'},cP="Perimeter",cO={type:"literal",value:"Perimeter",description:'"Perimeter"'},cN="Circumference",cM={type:"literal",value:"Circumference",description:'"Circumference"'},cK="Radius",cJ={type:"literal",value:"Radius",description:'"Radius"'},cI="Area",cH={type:"literal",value:"Area",description:'"Area"'},cG="Slope",cF={type:"literal",value:"Slope",description:'"Slope"'},cA="Distance",cz={type:"literal",value:"Distance",description:'"Distance"'},cy="Ratio/Segments",cx={type:"literal",value:"Ratio/Segments",description:'"Ratio/Segments"'},cv="Ratio/Points",cu={type:"literal",value:"Ratio/Points",description:'"Ratio/Points"'},ct="Coordinates",cs={type:"literal",value:"Coordinates",description:'"Coordinates"'},cr="Abscissa",cq={type:"literal",value:"Abscissa",description:'"Abscissa"'},co="Ordinate",cn={type:"literal",value:"Ordinate",description:'"Ordinate"'},cm="CoordinateDistance",cl={type:"literal",value:"CoordinateDistance",description:'"CoordinateDistance"'},ck="Calculate",cj={type:"literal",value:"Calculate",description:'"Calculate"'},ci="Parameter",ch={type:"literal",value:"Parameter",description:'"Parameter"'},cg="ToggleVisibilityButton",cf={type:"literal",value:"ToggleVisibilityButton",description:'"ToggleVisibilityButton"'},cd="ShowButton",cc={type:"literal",value:"ShowButton",description:'"ShowButton"'},cb="HideButton",ca={type:"literal",value:"HideButton",description:'"HideButton"'},b9="MoveButton",b8={type:"literal",value:"MoveButton",description:'"MoveButton"'},b7="AnimateButton",b6={type:"literal",value:"AnimateButton",description:'"AnimateButton"'},b5="SimultaneousButton",b4={type:"literal",value:"SimultaneousButton",description:'"SimultaneousButton"'},b1="CoordSysByAxes",b0={type:"literal",value:"CoordSysByAxes",description:'"CoordSysByAxes"'},bZ="Origin&Unit",bY={type:"literal",value:"Origin&Unit",description:'"Origin&Unit"'},bX="UnitCircle",bW={type:"literal",value:"UnitCircle",description:'"UnitCircle"'},bV="Locus",bU={type:"literal",value:"Locus",description:'"Locus"'},bS="FunctionPlot",bQ={type:"literal",value:"FunctionPlot",description:'"FunctionPlot"'},bE="Function",bD={type:"literal",value:"Function",description:'"Function"'},bC="FixedText",bB={type:"literal",value:"FixedText",description:'"FixedText"'},bA="PeggedText",bz={type:"literal",value:"PeggedText",description:'"PeggedText"'},by="ConcatText",bw={type:"literal",value:"ConcatText",description:'"ConcatText"'},bu="red",bs={type:"literal",value:"red",description:'"red"'},bh="green",bg={type:"literal",value:"green",description:'"green"'},bf="blue",be={type:"literal",value:"blue",description:'"blue"'},bd="black",bc={type:"literal",value:"black",description:'"black"'},ba="magenta",a9={type:"literal",value:"magenta",description:'"magenta"'},a7="white",a5={type:"literal",value:"white",description:'"white"'},aU="cyan",aT={type:"literal",value:"cyan",description:'"cyan"'},aS="yellow",aR={type:"literal",value:"yellow",description:'"yellow"'},aQ="color(",aP={type:"literal",value:"color(",description:'"color("'},aN=function(fN,fM,fL){return"color("+[fN,fM,fL].join()+")"},aM="hairline",aJ={type:"literal",value:"hairline",description:'"hairline"'},aH="thin",bT={type:"literal",value:"thin",description:'"thin"'},bR="mediumLine",bP={type:"literal",value:"mediumLine",description:'"mediumLine"'},bN="thick",bM={type:"literal",value:"thick",description:'"thick"'},bK="dashed",bJ={type:"literal",value:"dashed",description:'"dashed"'},bI="dotted",bH={type:"literal",value:"dotted",description:'"dotted"'},bG="solid",bv={type:"literal",value:"solid",description:'"solid"'},bt="dot",br={type:"literal",value:"dot",description:'"dot"'},bq="small",bo={type:"literal",value:"small",description:'"small"'},bn="mediumPoint",bm={type:"literal",value:"mediumPoint",description:'"mediumPoint"'},bl="large",bk={type:"literal",value:"large",description:'"large"'},bj="hidden",a8={type:"literal",value:"hidden",description:'"hidden"'},a6="suffix(",a4={type:"literal",value:"suffix(",description:'"suffix("'},a3=function(fL){return"suffix('"+fL+"')"},a2="auto",a1={type:"literal",value:"auto",description:'"auto"'},a0="label(",aX={type:"literal",value:"label(",description:'"label("'},aW=function(fL){return"label('"+fL+"')"},aV="layer(",aK={type:"literal",value:"layer(",description:'"layer("'},aI=function(fL){return"layer("+fL+")"},aG="traced",aF={type:"literal",value:"traced",description:'"traced"'},aE="image(",aC={type:"literal",value:"image(",description:'"image("'},aB=function(fL){return"image('"+fL+"')"},aA="bold",az={type:"literal",value:"bold",description:'"bold"'},ay="italic",av={type:"literal",value:"italic",description:'"italic"'},au="plain",at={type:"literal",value:"plain",description:'"plain"'},ar="justifyLeft",aq={type:"literal",value:"justifyLeft",description:'"justifyLeft"'},ap="justifyRight",ao={type:"literal",value:"justifyRight",description:'"justifyRight"'},an="justifyCenter",am={type:"literal",value:"justifyCenter",description:'"justifyCenter"'},al="font(",aj={type:"literal",value:"font(",description:'"font("'},ai=function(fL){return"font('"+fL+"')"},ah="size(",ag={type:"literal",value:"size(",description:'"size("'},af=function(fL){return"size("+fL+")"},ad="digits(",ac={type:"literal",value:"digits(",description:'"digits("'},ab=function(fL){return"digits('"+fL+"')"},aa="medium",Y={type:"literal",value:"medium",description:'"medium"'},S="-",R={type:"literal",value:"-",description:'"-"'},Q=".",P={type:"literal",value:".",description:'"."'},O="e",N={type:"literal",value:"e",description:'"e"'},M=function(fO,fM,fP,fQ){var fN="",fL="";if(fQ){fN=fQ.join("")}if(fP){fL="."+(fP[1]?fP[1]:"")}fO=fO?fO:"";return fO+fM+fL+fN},L=function(fN,fO,fP){var fM="",fL="";if(fP){fM=fP.join("")}fL="."+fO[1];fN=fN?fN:"";return fN+fL+fM},K="'",J={type:"literal",value:"'",description:'"\'"'},fK=function(fL){return fL[1].join("")},fJ=/^[^']/,fI={type:"class",value:"[^']",description:"[^']"},fH="''",fG={type:"literal",value:"''",description:"\"''\""},fF=function(){return"&apos;"},fE=function(){return""},fD="{",fC={type:"literal",value:"{",description:'"{"'},fA=/^[^}]/,fm={type:"class",value:"[^}]",description:"[^}]"},fl="}",fk={type:"literal",value:"}",description:'"}"'},fj=" ",fi={type:"literal",value:" ",description:'" "'},fh="\t",fg={type:"literal",value:"\t",description:'"\\t"'},ff="\n",fd={type:"literal",value:"\n",description:'"\\n"'},fb=/^[0-9]/,e0={type:"class",value:"[0-9]",description:"[0-9]"},eZ=function(fL){return fL.join("")},bO=0,dY=0,fy=0,ae={line:1,column:1,seenCR:false},W=0,cD=[],cC=0,cw;if("startRule" in b3){if(!(b3.startRule in eb)){throw new Error("Can't start parsing from rule \""+b3.startRule+'".')}aw=eb[b3.startRule]}function eY(){return T.substring(dY,bO)}function cp(){return dY}function V(){return H(dY).line}function dl(){return H(dY).column}function e6(fL){throw I(null,[{type:"other",description:fL}],dY)}function dQ(fL){throw I(fL,null,dY)}function H(fM){function fL(fP,fO,fN){var fR,fQ;for(fR=fO;fR<fN;fR++){fQ=T.charAt(fR);if(fQ==="\n"){if(!fP.seenCR){fP.line++}fP.column=1;fP.seenCR=false}else{if(fQ==="\r"||fQ==="\u2028"||fQ==="\u2029"){fP.line++;fP.column=1;fP.seenCR=true}else{fP.column++;fP.seenCR=false}}}}if(fy!==fM){if(fy>fM){fy=0;ae={line:1,column:1,seenCR:false}}fL(ae,fy,fM);fy=fM}return ae}function cY(fL){if(bO<W){return}if(bO>W){W=bO;cD=[]}cD.push(fL)}function I(fN,fM,fR){function fQ(fT){var fS=1;fT.sort(function(fV,fU){if(fV.description<fU.description){return -1}else{if(fV.description>fU.description){return 1}else{return 0}}});while(fS<fT.length){if(fT[fS-1]===fT[fS]){fT.splice(fS,1)}else{fS++}}}function fL(fW,fX){function fS(fZ){function f0(f1){return f1.charCodeAt(0).toString(16).toUpperCase()}return fZ.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(f1){return"\\x0"+f0(f1)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(f1){return"\\x"+f0(f1)}).replace(/[\u0180-\u0FFF]/g,function(f1){return"\\u0"+f0(f1)}).replace(/[\u1080-\uFFFF]/g,function(f1){return"\\u"+f0(f1)})}var fT=new Array(fW.length),fY,fU,fV;for(fV=0;fV<fW.length;fV++){fT[fV]=fW[fV].description}fY=fW.length>1?fT.slice(0,-1).join(", ")+" or "+fT[fW.length-1]:fT[0];fU=fX?'"'+fS(fX)+'"':"end of input";return"Expected "+fY+" but "+fU+" found."}var fP=H(fR),fO=fR<T.length?T.charAt(fR):null;if(fM!==null){fQ(fM)}return new D(fN!==null?fN:fL(fM,fO),fM,fO,fR,fP.line,fP.column)}function fo(){var fL;fL=cB();return fL}function cB(){var fM,fL;fM=[];fL=bx();while(fL!==cR){fM.push(fL);fL=bx()}return fM}function bx(){var fT,fS,fR,fQ,fP,fO,fN,fM,fL;fT=bO;fS=dr();if(fS!==cR){fR=ez();if(fR!==cR){fQ=dr();if(fQ!==cR){fP=dz();if(fP!==cR){fO=dr();if(fO!==cR){fN=db();if(fN===cR){fN=dv}if(fN!==cR){if(T.charCodeAt(bO)===59){fM=du;bO++}else{fM=cR;if(cC===0){cY(dt)}}if(fM!==cR){fL=dr();if(fL!==cR){dY=fT;fS=ds(fR,fP,fN);fT=fS}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}return fT}function ez(){var fM,fL;fM=bO;fL=bL();if(fL===cR){fL=G();if(fL===cR){fL=cQ();if(fL===cR){fL=di();if(fL===cR){fL=eS();if(fL===cR){fL=ce();if(fL===cR){fL=X();if(fL===cR){fL=dj();if(fL===cR){fL=Z();if(fL===cR){fL=aD();if(fL===cR){fL=eK();if(fL===cR){fL=cU();if(fL===cR){fL=bF()}}}}}}}}}}}}if(fL!==cR){dY=fM;fL=dq(fL)}fM=fL;return fM}function dz(){var fM,fL;fM=[];fL=dG();if(fL!==cR){while(fL!==cR){fM.push(fL);fL=dG()}}else{fM=dx}return fM}function db(){var fV,fU,fS,fR,fQ,fP,fO,fN,fM,fL,fT;fV=bO;fU=dr();if(fU!==cR){if(T.charCodeAt(bO)===91){fS=dp;bO++}else{fS=cR;if(cC===0){cY(dn)}}if(fS!==cR){fR=dr();if(fR!==cR){fQ=cE();if(fQ!==cR){fP=[];fO=bO;fN=dr();if(fN!==cR){if(T.charCodeAt(bO)===44){fM=dm;bO++}else{fM=cR;if(cC===0){cY(fB)}}if(fM!==cR){fL=dr();if(fL!==cR){fT=cE();if(fT!==cR){fN=[fN,fM,fL,fT];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}while(fO!==cR){fP.push(fO);fO=bO;fN=dr();if(fN!==cR){if(T.charCodeAt(bO)===44){fM=dm;bO++}else{fM=cR;if(cC===0){cY(fB)}}if(fM!==cR){fL=dr();if(fL!==cR){fT=cE();if(fT!==cR){fN=[fN,fM,fL,fT];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}if(fP!==cR){if(T.charCodeAt(bO)===93){fO=fz;bO++}else{fO=cR;if(cC===0){cY(fw)}}if(fO!==cR){dY=fV;fU=fv(fQ,fP);fV=fU}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}}else{bO=fV;fV=dx}return fV}function dG(){var fT,fS,fR,fQ,fP,fO,fN,fM,fL;fT=bO;if(T.charCodeAt(bO)===40){fS=fu;bO++}else{fS=cR;if(cC===0){cY(ft)}}if(fS!==cR){fR=dr();if(fR!==cR){if(T.charCodeAt(bO)===41){fQ=fs;bO++}else{fQ=cR;if(cC===0){cY(fr)}}if(fQ!==cR){dY=fT;fS=fq();fT=fS}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}if(fT===cR){fT=bO;if(T.charCodeAt(bO)===40){fS=fu;bO++}else{fS=cR;if(cC===0){cY(ft)}}if(fS!==cR){fR=ak();if(fR!==cR){fQ=[];fP=bO;fO=dr();if(fO!==cR){if(T.charCodeAt(bO)===44){fN=dm;bO++}else{fN=cR;if(cC===0){cY(fB)}}if(fN!==cR){fM=dr();if(fM!==cR){fL=ak();if(fL!==cR){fO=[fO,fN,fM,fL];fP=fO}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}while(fP!==cR){fQ.push(fP);fP=bO;fO=dr();if(fO!==cR){if(T.charCodeAt(bO)===44){fN=dm;bO++}else{fN=cR;if(cC===0){cY(fB)}}if(fN!==cR){fM=dr();if(fM!==cR){fL=ak();if(fL!==cR){fO=[fO,fN,fM,fL];fP=fO}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}else{bO=fP;fP=dx}}if(fQ!==cR){if(T.charCodeAt(bO)===41){fP=fs;bO++}else{fP=cR;if(cC===0){cY(fr)}}if(fP!==cR){dY=fT;fS=fp(fR,fQ);fT=fS}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}else{bO=fT;fT=dx}}return fT}function ak(){var fL;fL=eM();if(fL===cR){fL=bb()}return fL}function bL(){var fL;if(T.substr(bO,15)===fe){fL=fe;bO+=15}else{fL=cR;if(cC===0){cY(fc)}}if(fL===cR){if(T.substr(bO,5)===fa){fL=fa;bO+=5}else{fL=cR;if(cC===0){cY(e9)}}if(fL===cR){if(T.substr(bO,10)===e8){fL=e8;bO+=10}else{fL=cR;if(cC===0){cY(e7)}}if(fL===cR){if(T.substr(bO,8)===e5){fL=e5;bO+=8}else{fL=cR;if(cC===0){cY(e4)}}if(fL===cR){if(T.substr(bO,10)===e3){fL=e3;bO+=10}else{fL=cR;if(cC===0){cY(e2)}}if(fL===cR){if(T.substr(bO,10)===eX){fL=eX;bO+=10}else{fL=cR;if(cC===0){cY(eW)}}if(fL===cR){if(T.substr(bO,9)===eV){fL=eV;bO+=9}else{fL=cR;if(cC===0){cY(eU)}}if(fL===cR){if(T.substr(bO,6)===eT){fL=eT;bO+=6}else{fL=cR;if(cC===0){cY(eR)}}if(fL===cR){if(T.substr(bO,11)===eQ){fL=eQ;bO+=11}else{fL=cR;if(cC===0){cY(eP)}}if(fL===cR){if(T.substr(bO,9)===eO){fL=eO;bO+=9}else{fL=cR;if(cC===0){cY(eN)}}if(fL===cR){if(T.substr(bO,15)===eL){fL=eL;bO+=15}else{fL=cR;if(cC===0){cY(eJ)}}if(fL===cR){if(T.substr(bO,20)===eI){fL=eI;bO+=20}else{fL=cR;if(cC===0){cY(eH)}}if(fL===cR){if(T.substr(bO,11)===eG){fL=eG;bO+=11}else{fL=cR;if(cC===0){cY(eF)}}}}}}}}}}}}}}return fL}function G(){var fL;if(T.substr(bO,7)===eE){fL=eE;bO+=7}else{fL=cR;if(cC===0){cY(eD)}}if(fL===cR){if(T.substr(bO,3)===eC){fL=eC;bO+=3}else{fL=cR;if(cC===0){cY(eB)}}if(fL===cR){if(T.substr(bO,4)===ey){fL=ey;bO+=4}else{fL=cR;if(cC===0){cY(ex)}}if(fL===cR){if(T.substr(bO,13)===ew){fL=ew;bO+=13}else{fL=cR;if(cC===0){cY(ev)}}if(fL===cR){if(T.substr(bO,8)===eu){fL=eu;bO+=8}else{fL=cR;if(cC===0){cY(et)}}if(fL===cR){if(T.substr(bO,5)===es){fL=es;bO+=5}else{fL=cR;if(cC===0){cY(er)}}if(fL===cR){if(T.substr(bO,5)===eq){fL=eq;bO+=5}else{fL=cR;if(cC===0){cY(ep)}}if(fL===cR){if(T.substr(bO,8)===en){fL=en;bO+=8}else{fL=cR;if(cC===0){cY(el)}}if(fL===cR){if(T.substr(bO,14)===ek){fL=ek;bO+=14}else{fL=cR;if(cC===0){cY(ej)}}if(fL===cR){if(T.substr(bO,12)===ei){fL=ei;bO+=12}else{fL=cR;if(cC===0){cY(eh)}}}}}}}}}}}return fL}function cQ(){var fL;if(T.substr(bO,7)===ef){fL=ef;bO+=7}else{fL=cR;if(cC===0){cY(ee)}}if(fL===cR){if(T.substr(bO,15)===ed){fL=ed;bO+=15}else{fL=cR;if(cC===0){cY(ec)}}}return fL}function di(){var fL;if(T.substr(bO,16)===ea){fL=ea;bO+=16}else{fL=cR;if(cC===0){cY(d9)}}if(fL===cR){if(T.substr(bO,6)===d8){fL=d8;bO+=6}else{fL=cR;if(cC===0){cY(d7)}}}return fL}function eS(){var fL;if(T.substr(bO,10)===d6){fL=d6;bO+=10}else{fL=cR;if(cC===0){cY(d5)}}if(fL===cR){if(T.substr(bO,21)===d4){fL=d4;bO+=21}else{fL=cR;if(cC===0){cY(d3)}}if(fL===cR){if(T.substr(bO,17)===d2){fL=d2;bO+=17}else{fL=cR;if(cC===0){cY(d1)}}if(fL===cR){if(T.substr(bO,20)===dZ){fL=dZ;bO+=20}else{fL=cR;if(cC===0){cY(dX)}}if(fL===cR){if(T.substr(bO,8)===dV){fL=dV;bO+=8}else{fL=cR;if(cC===0){cY(dU)}}if(fL===cR){if(T.substr(bO,20)===dT){fL=dT;bO+=20}else{fL=cR;if(cC===0){cY(dS)}}if(fL===cR){if(T.substr(bO,22)===dR){fL=dR;bO+=22}else{fL=cR;if(cC===0){cY(dP)}}if(fL===cR){if(T.substr(bO,8)===dO){fL=dO;bO+=8}else{fL=cR;if(cC===0){cY(dN)}}if(fL===cR){if(T.substr(bO,17)===dK){fL=dK;bO+=17}else{fL=cR;if(cC===0){cY(dJ)}}if(fL===cR){if(T.substr(bO,37)===dI){fL=dI;bO+=37}else{fL=cR;if(cC===0){cY(dH)}}if(fL===cR){if(T.substr(bO,16)===dF){fL=dF;bO+=16}else{fL=cR;if(cC===0){cY(dE)}}if(fL===cR){if(T.substr(bO,37)===dD){fL=dD;bO+=37}else{fL=cR;if(cC===0){cY(dC)}}if(fL===cR){if(T.substr(bO,38)===dB){fL=dB;bO+=38}else{fL=cR;if(cC===0){cY(dA)}}if(fL===cR){if(T.substr(bO,11)===dh){fL=dh;bO+=11}else{fL=cR;if(cC===0){cY(dg)}}}}}}}}}}}}}}}return fL}function ce(){var fL;if(T.substr(bO,18)===df){fL=df;bO+=18}else{fL=cR;if(cC===0){cY(de)}}if(fL===cR){if(T.substr(bO,19)===dd){fL=dd;bO+=19}else{fL=cR;if(cC===0){cY(dc)}}if(fL===cR){if(T.substr(bO,13)===da){fL=da;bO+=13}else{fL=cR;if(cC===0){cY(c9)}}if(fL===cR){if(T.substr(bO,13)===c8){fL=c8;bO+=13}else{fL=cR;if(cC===0){cY(c7)}}}}}return fL}function X(){var fL;if(T.substr(bO,5)===c6){fL=c6;bO+=5}else{fL=cR;if(cC===0){cY(c5)}}if(fL===cR){if(T.substr(bO,12)===c4){fL=c4;bO+=12}else{fL=cR;if(cC===0){cY(c0)}}if(fL===cR){if(T.substr(bO,18)===cZ){fL=cZ;bO+=18}else{fL=cR;if(cC===0){cY(cX)}}}}return fL}function dj(){var fL;if(T.substr(bO,6)===cW){fL=cW;bO+=6}else{fL=cR;if(cC===0){cY(cV)}}if(fL===cR){if(T.substr(bO,5)===cT){fL=cT;bO+=5}else{fL=cR;if(cC===0){cY(cS)}}if(fL===cR){if(T.substr(bO,9)===cP){fL=cP;bO+=9}else{fL=cR;if(cC===0){cY(cO)}}if(fL===cR){if(T.substr(bO,13)===cN){fL=cN;bO+=13}else{fL=cR;if(cC===0){cY(cM)}}if(fL===cR){if(T.substr(bO,6)===cK){fL=cK;bO+=6}else{fL=cR;if(cC===0){cY(cJ)}}if(fL===cR){if(T.substr(bO,4)===cI){fL=cI;bO+=4}else{fL=cR;if(cC===0){cY(cH)}}if(fL===cR){if(T.substr(bO,5)===cG){fL=cG;bO+=5}else{fL=cR;if(cC===0){cY(cF)}}if(fL===cR){if(T.substr(bO,8)===cA){fL=cA;bO+=8}else{fL=cR;if(cC===0){cY(cz)}}if(fL===cR){if(T.substr(bO,14)===cy){fL=cy;bO+=14}else{fL=cR;if(cC===0){cY(cx)}}if(fL===cR){if(T.substr(bO,12)===cv){fL=cv;bO+=12}else{fL=cR;if(cC===0){cY(cu)}}if(fL===cR){if(T.substr(bO,11)===ct){fL=ct;bO+=11}else{fL=cR;if(cC===0){cY(cs)}}if(fL===cR){if(T.substr(bO,8)===cr){fL=cr;bO+=8}else{fL=cR;if(cC===0){cY(cq)}}if(fL===cR){if(T.substr(bO,8)===co){fL=co;bO+=8}else{fL=cR;if(cC===0){cY(cn)}}if(fL===cR){if(T.substr(bO,18)===cm){fL=cm;bO+=18}else{fL=cR;if(cC===0){cY(cl)}}if(fL===cR){if(T.substr(bO,9)===ck){fL=ck;bO+=9}else{fL=cR;if(cC===0){cY(cj)}}if(fL===cR){if(T.substr(bO,9)===ci){fL=ci;bO+=9}else{fL=cR;if(cC===0){cY(ch)}}}}}}}}}}}}}}}}}return fL}function Z(){var fL;if(T.substr(bO,22)===cg){fL=cg;bO+=22}else{fL=cR;if(cC===0){cY(cf)}}if(fL===cR){if(T.substr(bO,10)===cd){fL=cd;bO+=10}else{fL=cR;if(cC===0){cY(cc)}}if(fL===cR){if(T.substr(bO,10)===cb){fL=cb;bO+=10}else{fL=cR;if(cC===0){cY(ca)}}if(fL===cR){if(T.substr(bO,10)===b9){fL=b9;bO+=10}else{fL=cR;if(cC===0){cY(b8)}}if(fL===cR){if(T.substr(bO,13)===b7){fL=b7;bO+=13}else{fL=cR;if(cC===0){cY(b6)}}if(fL===cR){if(T.substr(bO,18)===b5){fL=b5;bO+=18}else{fL=cR;if(cC===0){cY(b4)}}}}}}}return fL}function aD(){var fL;if(T.substr(bO,14)===b1){fL=b1;bO+=14}else{fL=cR;if(cC===0){cY(b0)}}if(fL===cR){if(T.substr(bO,11)===bZ){fL=bZ;bO+=11}else{fL=cR;if(cC===0){cY(bY)}}if(fL===cR){if(T.substr(bO,10)===bX){fL=bX;bO+=10}else{fL=cR;if(cC===0){cY(bW)}}}}return fL}function eK(){var fL;if(T.substr(bO,5)===bV){fL=bV;bO+=5}else{fL=cR;if(cC===0){cY(bU)}}if(fL===cR){if(T.substr(bO,12)===bS){fL=bS;bO+=12}else{fL=cR;if(cC===0){cY(bQ)}}}return fL}function cU(){var fL;if(T.substr(bO,8)===bE){fL=bE;bO+=8}else{fL=cR;if(cC===0){cY(bD)}}return fL}function bF(){var fL;if(T.substr(bO,9)===bC){fL=bC;bO+=9}else{fL=cR;if(cC===0){cY(bB)}}if(fL===cR){if(T.substr(bO,10)===bA){fL=bA;bO+=10}else{fL=cR;if(cC===0){cY(bz)}}if(fL===cR){if(T.substr(bO,10)===by){fL=by;bO+=10}else{fL=cR;if(cC===0){cY(bw)}}}}return fL}function cE(){var fL;fL=bp();if(fL===cR){fL=fn();if(fL===cR){fL=ax();if(fL===cR){fL=fx();if(fL===cR){fL=dW();if(fL===cR){fL=aO();if(fL===cR){fL=dL();if(fL===cR){fL=eg();if(fL===cR){fL=eA();if(fL===cR){fL=dM();if(fL===cR){fL=aZ();if(fL===cR){fL=cL();if(fL===cR){fL=U();if(fL===cR){fL=eo()}}}}}}}}}}}}}return fL}function bp(){var fL;if(T.substr(bO,3)===bu){fL=bu;bO+=3}else{fL=cR;if(cC===0){cY(bs)}}if(fL===cR){if(T.substr(bO,5)===bh){fL=bh;bO+=5}else{fL=cR;if(cC===0){cY(bg)}}if(fL===cR){if(T.substr(bO,4)===bf){fL=bf;bO+=4}else{fL=cR;if(cC===0){cY(be)}}if(fL===cR){if(T.substr(bO,5)===bd){fL=bd;bO+=5}else{fL=cR;if(cC===0){cY(bc)}}if(fL===cR){if(T.substr(bO,7)===ba){fL=ba;bO+=7}else{fL=cR;if(cC===0){cY(a9)}}if(fL===cR){if(T.substr(bO,5)===a7){fL=a7;bO+=5}else{fL=cR;if(cC===0){cY(a5)}}if(fL===cR){if(T.substr(bO,4)===aU){fL=aU;bO+=4}else{fL=cR;if(cC===0){cY(aT)}}if(fL===cR){if(T.substr(bO,6)===aS){fL=aS;bO+=6}else{fL=cR;if(cC===0){cY(aR)}}}}}}}}}return fL}function fn(){var fY,fX,fV,fT,fR,fP,fO,fN,fM,fL,fW,fU,fS,fQ;fY=bO;if(T.substr(bO,6)===aQ){fX=aQ;bO+=6}else{fX=cR;if(cC===0){cY(aP)}}if(fX!==cR){fV=dr();if(fV!==cR){fT=eM();if(fT!==cR){fR=dr();if(fR!==cR){if(T.charCodeAt(bO)===44){fP=dm;bO++}else{fP=cR;if(cC===0){cY(fB)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=eM();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===44){fL=dm;bO++}else{fL=cR;if(cC===0){cY(fB)}}if(fL!==cR){fW=dr();if(fW!==cR){fU=eM();if(fU!==cR){fS=dr();if(fS!==cR){if(T.charCodeAt(bO)===41){fQ=fs;bO++}else{fQ=cR;if(cC===0){cY(fr)}}if(fQ!==cR){dY=fY;fX=aN(fT,fN,fU);fY=fX}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}}else{bO=fY;fY=dx}return fY}function ax(){var fL;if(T.substr(bO,8)===aM){fL=aM;bO+=8}else{fL=cR;if(cC===0){cY(aJ)}}if(fL===cR){if(T.substr(bO,4)===aH){fL=aH;bO+=4}else{fL=cR;if(cC===0){cY(bT)}}if(fL===cR){if(T.substr(bO,10)===bR){fL=bR;bO+=10}else{fL=cR;if(cC===0){cY(bP)}}if(fL===cR){if(T.substr(bO,5)===bN){fL=bN;bO+=5}else{fL=cR;if(cC===0){cY(bM)}}if(fL===cR){if(T.substr(bO,6)===bK){fL=bK;bO+=6}else{fL=cR;if(cC===0){cY(bJ)}}if(fL===cR){if(T.substr(bO,6)===bI){fL=bI;bO+=6}else{fL=cR;if(cC===0){cY(bH)}}if(fL===cR){if(T.substr(bO,5)===bG){fL=bG;bO+=5}else{fL=cR;if(cC===0){cY(bv)}}}}}}}}return fL}function fx(){var fL;if(T.substr(bO,3)===bt){fL=bt;bO+=3}else{fL=cR;if(cC===0){cY(br)}}if(fL===cR){if(T.substr(bO,5)===bq){fL=bq;bO+=5}else{fL=cR;if(cC===0){cY(bo)}}if(fL===cR){if(T.substr(bO,11)===bn){fL=bn;bO+=11}else{fL=cR;if(cC===0){cY(bm)}}if(fL===cR){if(T.substr(bO,5)===bl){fL=bl;bO+=5}else{fL=cR;if(cC===0){cY(bk)}}}}}return fL}function dW(){var fL;if(T.substr(bO,6)===bj){fL=bj;bO+=6}else{fL=cR;if(cC===0){cY(a8)}}return fL}function aO(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,7)===a6){fP=a6;bO+=7}else{fP=cR;if(cC===0){cY(a4)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=a3(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function dL(){var fL;if(T.substr(bO,4)===a2){fL=a2;bO+=4}else{fL=cR;if(cC===0){cY(a1)}}return fL}function eg(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,6)===a0){fP=a0;bO+=6}else{fP=cR;if(cC===0){cY(aX)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=aW(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function eA(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,6)===aV){fP=aV;bO+=6}else{fP=cR;if(cC===0){cY(aK)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=em();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=aI(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function dM(){var fL;if(T.substr(bO,6)===aG){fL=aG;bO+=6}else{fL=cR;if(cC===0){cY(aF)}}return fL}function aZ(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,6)===aE){fP=aE;bO+=6}else{fP=cR;if(cC===0){cY(aC)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=aB(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function cL(){var fL;if(T.substr(bO,4)===aA){fL=aA;bO+=4}else{fL=cR;if(cC===0){cY(az)}}if(fL===cR){if(T.substr(bO,6)===ay){fL=ay;bO+=6}else{fL=cR;if(cC===0){cY(av)}}if(fL===cR){if(T.substr(bO,5)===au){fL=au;bO+=5}else{fL=cR;if(cC===0){cY(at)}}if(fL===cR){fL=bi();if(fL===cR){fL=e1();if(fL===cR){if(T.substr(bO,11)===ar){fL=ar;bO+=11}else{fL=cR;if(cC===0){cY(aq)}}if(fL===cR){if(T.substr(bO,12)===ap){fL=ap;bO+=12}else{fL=cR;if(cC===0){cY(ao)}}if(fL===cR){if(T.substr(bO,13)===an){fL=an;bO+=13}else{fL=cR;if(cC===0){cY(am)}}}}}}}}}return fL}function e1(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,5)===al){fP=al;bO+=5}else{fP=cR;if(cC===0){cY(aj)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=bb();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=ai(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function bi(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,5)===ah){fP=ah;bO+=5}else{fP=cR;if(cC===0){cY(ag)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=eM();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=af(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function U(){var fQ,fP,fO,fN,fM,fL;fQ=bO;if(T.substr(bO,7)===ad){fP=ad;bO+=7}else{fP=cR;if(cC===0){cY(ac)}}if(fP!==cR){fO=dr();if(fO!==cR){fN=eM();if(fN!==cR){fM=dr();if(fM!==cR){if(T.charCodeAt(bO)===41){fL=fs;bO++}else{fL=cR;if(cC===0){cY(fr)}}if(fL!==cR){dY=fQ;fP=ab(fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function eo(){var fL;if(T.substr(bO,6)===aa){fL=aa;bO+=6}else{fL=cR;if(cC===0){cY(Y)}}return fL}function eM(){var fL;fL=aY();if(fL===cR){fL=b2()}return fL}function aY(){var fQ,fP,fO,fN,fM,fL,fS,fR;fQ=bO;if(T.charCodeAt(bO)===45){fP=S;bO++}else{fP=cR;if(cC===0){cY(R)}}if(fP===cR){fP=dv}if(fP!==cR){fO=em();if(fO!==cR){fN=bO;if(T.charCodeAt(bO)===46){fM=Q;bO++}else{fM=cR;if(cC===0){cY(P)}}if(fM!==cR){fL=em();if(fL===cR){fL=dv}if(fL!==cR){fM=[fM,fL];fN=fM}else{bO=fN;fN=dx}}else{bO=fN;fN=dx}if(fN===cR){fN=dv}if(fN!==cR){fM=bO;if(T.charCodeAt(bO)===101){fL=O;bO++}else{fL=cR;if(cC===0){cY(N)}}if(fL!==cR){if(T.charCodeAt(bO)===45){fS=S;bO++}else{fS=cR;if(cC===0){cY(R)}}if(fS===cR){fS=dv}if(fS!==cR){fR=em();if(fR!==cR){fL=[fL,fS,fR];fM=fL}else{bO=fM;fM=dx}}else{bO=fM;fM=dx}}else{bO=fM;fM=dx}if(fM===cR){fM=dv}if(fM!==cR){dY=fQ;fP=M(fP,fO,fN,fM);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function b2(){var fQ,fP,fO,fN,fM,fL,fR;fQ=bO;if(T.charCodeAt(bO)===45){fP=S;bO++}else{fP=cR;if(cC===0){cY(R)}}if(fP===cR){fP=dv}if(fP!==cR){fO=bO;if(T.charCodeAt(bO)===46){fN=Q;bO++}else{fN=cR;if(cC===0){cY(P)}}if(fN!==cR){fM=em();if(fM!==cR){fN=[fN,fM];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}if(fO!==cR){fN=bO;if(T.charCodeAt(bO)===101){fM=O;bO++}else{fM=cR;if(cC===0){cY(N)}}if(fM!==cR){if(T.charCodeAt(bO)===45){fL=S;bO++}else{fL=cR;if(cC===0){cY(R)}}if(fL===cR){fL=dv}if(fL!==cR){fR=em();if(fR!==cR){fM=[fM,fL,fR];fN=fM}else{bO=fN;fN=dx}}else{bO=fN;fN=dx}}else{bO=fN;fN=dx}if(fN===cR){fN=dv}if(fN!==cR){dY=fQ;fP=L(fP,fO,fN);fQ=fP}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}}else{bO=fQ;fQ=dx}return fQ}function bb(){var fP,fO,fN,fM,fL;fP=bO;fO=bO;if(T.charCodeAt(bO)===39){fN=K;bO++}else{fN=cR;if(cC===0){cY(J)}}if(fN!==cR){fM=[];fL=dk();while(fL!==cR){fM.push(fL);fL=dk()}if(fM!==cR){if(T.charCodeAt(bO)===39){fL=K;bO++}else{fL=cR;if(cC===0){cY(J)}}if(fL!==cR){fN=[fN,fM,fL];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}if(fO!==cR){dY=fP;fO=fK(fO)}fP=fO;return fP}function dk(){var fM,fL;if(fJ.test(T.charAt(bO))){fM=T.charAt(bO);bO++}else{fM=cR;if(cC===0){cY(fI)}}if(fM===cR){fM=bO;if(T.substr(bO,2)===fH){fL=fH;bO+=2}else{fL=cR;if(cC===0){cY(fG)}}if(fL!==cR){dY=fM;fL=fF()}fM=fL}return fM}function dr(){var fN,fM,fL;fN=bO;fM=[];fL=aL();if(fL===cR){fL=d0()}while(fL!==cR){fM.push(fL);fL=aL();if(fL===cR){fL=d0()}}if(fM!==cR){dY=fN;fM=fE()}fN=fM;return fN}function aL(){var fO,fN,fM,fL;fO=bO;if(T.charCodeAt(bO)===123){fN=fD;bO++}else{fN=cR;if(cC===0){cY(fC)}}if(fN!==cR){fM=[];if(fA.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(fm)}}while(fL!==cR){fM.push(fL);if(fA.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(fm)}}}if(fM!==cR){if(T.charCodeAt(bO)===125){fL=fl;bO++}else{fL=cR;if(cC===0){cY(fk)}}if(fL!==cR){fN=[fN,fM,fL];fO=fN}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}}else{bO=fO;fO=dx}return fO}function d0(){var fL;if(T.charCodeAt(bO)===32){fL=fj;bO++}else{fL=cR;if(cC===0){cY(fi)}}if(fL===cR){if(T.charCodeAt(bO)===9){fL=fh;bO++}else{fL=cR;if(cC===0){cY(fg)}}if(fL===cR){if(T.charCodeAt(bO)===10){fL=ff;bO++}else{fL=cR;if(cC===0){cY(fd)}}}}return fL}function em(){var fN,fM,fL;fN=bO;fM=[];if(fb.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(e0)}}if(fL!==cR){while(fL!==cR){fM.push(fL);if(fb.test(T.charAt(bO))){fL=T.charAt(bO);bO++}else{fL=cR;if(cC===0){cY(e0)}}}}else{fM=dx}if(fM!==cR){dY=fN;fM=eZ(fM)}fN=fM;return fN}var dw=0;cw=aw();if(cw!==cR&&bO===T.length){return cw}else{if(cw!==cR&&bO<T.length){cY({type:"end",description:"end of input"})}throw I(null,cD,W)}}return{SyntaxError:D,parse:E}})();y.mfsParser=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(a2){var bH=arguments.length>1?arguments[1]:{},au={},H={start:b6},bD=b6,ap=function(cm){return cm},an=au,am="<|",al={type:"literal",value:"<|",description:'"<|"'},aj=[],ai=">",ah={type:"literal",value:">",description:'">"'},ag=function(cm){return{type:"abs",value:cm}},af="<[",ae={type:"literal",value:"<[",description:'"<["'},b3=function(cm){return{type:"bracket",value:cm}},b1="<{",b0={type:"literal",value:"<{",description:'"<{"'},bZ=function(cm){return{type:"curly",value:cm}},bY="</",bX={type:"literal",value:"</",description:'"</"'},bW=function(cn,cm){return{type:"fraction",value:[cn,cm]}},bV="<H",bU={type:"literal",value:"<H",description:'"<H"'},bT=function(cm){return{type:"horizontal",value:cm}},bQ="<%",bP={type:"literal",value:"<%",description:'"<%"'},bO=/^[a-zA-Z0-9_\-]/,bN={type:"class",value:"[a-zA-Z0-9_\\-]",description:"[a-zA-Z0-9_\\-]"},bM=function(cm){return{type:"parameter",value:cm.join("")}},bL="<I",bK={type:"literal",value:"<I",description:'"<I"'},bJ=function(cm){return{type:"input",value:cm.join("")}},bI="<(",bG={type:"literal",value:"<(",description:'"<("'},bE=function(cm){return{type:"paren",value:cm}},bC="<R",bB={type:"literal",value:"<R",description:'"<R"'},bA=function(cm){return{type:"root",value:cm}},bz="<S",by={type:"literal",value:"<S",description:'"<S"'},bx=function(cn,cm){if(cn){cn.push(cm)}return{type:"style",value:cn}},bw=/^[GLPRSTUW#+]/,bv={type:"class",value:"[GLPRSTUW#+]",description:"[GLPRSTUW#+]"},bu=/^[0-9a-fA-F]/,br={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},bq=function(cn,cm){var co={G:"green",L:"blue",P:"fontFamily",R:"red",S:"fontStyle",T:"tightness",U:"underbar",W:"fontWeight","#":"fontSize","+":"diminish-size"};if(!cm||cm.length===0){return{code:co[cn],value:"0"}}else{return{code:co[cn],value:cm.length===1?cm[0]:cm.join("")}}},bp="<-",bo={type:"literal",value:"<-",description:'"<-"'},bn=function(cn,cm){return{type:"sub",value:[cn,cm]}},bm="<+",bl={type:"literal",value:"<+",description:'"<+"'},bk=function(cn,cm){return{type:"super",value:[cn,cm]}},bj="<!",bi={type:"literal",value:"<!",description:'"<!"'},be=/^[0-9A-Fa-f]/,bd={type:"class",value:"[0-9A-Fa-f]",description:"[0-9A-Fa-f]"},bc=function(cm){return{type:"symbol",value:cm.join("")}},ba="<?",a8={type:"literal",value:"<?",description:'"<?"'},a7="x",a6={type:"literal",value:"x",description:'"x"'},a5=function(cn,cm,co){return{type:"switch",visibleNode:parseInt(cn,16),value:co,refCon:cm.join("")}},a4="<T''>",a3={type:"literal",value:"<T''>",description:"\"<T''>\""},aX=function(){return{type:"text",value:""}},aW='<T"">',aV={type:"literal",value:'<T"">',description:'"<T\\"\\">"'},aU="<T'",aS={type:"literal",value:"<T'",description:'"<T\'"'},aR="'>",aQ={type:"literal",value:"'>",description:'"\'>"'},aP=function(cm){return{type:"text",value:cm}},aN='<T"',aM={type:"literal",value:'<T"',description:'"<T\\""'},aJ='">',aI={type:"literal",value:'">',description:'"\\">"'},aH=function(cm){return cm.join("")},aG=/^[^'\\]/,aF={type:"class",value:"[^'\\\\]",description:"[^'\\\\]"},aE="\\\\",aD={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},aC=function(){return"\\"},aB="\\'",aA={type:"literal",value:"\\'",description:'"\\\\\'"'},ad=function(){return"'"},ac='\\"',ab={type:"literal",value:'\\"',description:'"\\\\\\""'},aa=function(){return'"'},Z=/^[^"\\]/,Y={type:"class",value:'[^"\\\\]',description:'[^"\\\\]'},X="<V",W={type:"literal",value:"<V",description:'"<V"'},V=null,U="L",T={type:"literal",value:"L",description:'"L"'},S="R",R={type:"literal",value:"R",description:'"R"'},Q="C",P={type:"literal",value:"C",description:'"C"'},O=function(cn,cm){return{type:"vertical",alignment:cn,value:cm}},L="<0>",K={type:"literal",value:"<0>",description:'"<0>"'},J=function(){return{type:"text",value:""}},I="<F",az={type:"literal",value:"<F",description:'"<F"'},ay=/^[^>]/,ax={type:"class",value:"[^>]",description:"[^>]"},aw=function(cm){return{type:"future",value:cm.join("")}},av="<O",at={type:"literal",value:"<O",description:'"<O"'},ar=function(cm,cn){return{type:"overbar",variant:parseInt(cm.join(""),16),value:cn}},bf=0,cl=0,b8=0,ak={line:1,column:1,seenCR:false},aK=0,aL=[],b5=0,a0;if("startRule" in bH){if(!(bH.startRule in H)){throw new Error("Can't start parsing from rule \""+bH.startRule+'".')}bD=H[bH.startRule]}function bR(){return a2.substring(cl,bf)}function cf(){return cl}function b2(){return N(cl).line}function cg(){return N(cl).column}function ck(cm){throw cd(null,[{type:"other",description:cm}],cl)}function cc(cm){throw cd(cm,null,cl)}function N(cn){function cm(cq,cp,co){var cs,cr;for(cs=cp;cs<co;cs++){cr=a2.charAt(cs);if(cr==="\n"){if(!cq.seenCR){cq.line++}cq.column=1;cq.seenCR=false}else{if(cr==="\r"||cr==="\u2028"||cr==="\u2029"){cq.line++;cq.column=1;cq.seenCR=true}else{cq.column++;cq.seenCR=false}}}}if(b8!==cn){if(b8>cn){b8=0;ak={line:1,column:1,seenCR:false}}cm(ak,b8,cn);b8=cn}return ak}function bS(cm){if(bf<aK){return}if(bf>aK){aK=bf;aL=[]}aL.push(cm)}function cd(co,cn,cs){function cr(cu){var ct=1;cu.sort(function(cw,cv){if(cw.description<cv.description){return -1}else{if(cw.description>cv.description){return 1}else{return 0}}});while(ct<cu.length){if(cu[ct-1]===cu[ct]){cu.splice(ct,1)}else{ct++}}}function cm(cx,cy){function ct(cA){function cB(cC){return cC.charCodeAt(0).toString(16).toUpperCase()}return cA.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(cC){return"\\x0"+cB(cC)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(cC){return"\\x"+cB(cC)}).replace(/[\u0180-\u0FFF]/g,function(cC){return"\\u0"+cB(cC)}).replace(/[\u1080-\uFFFF]/g,function(cC){return"\\u"+cB(cC)})}var cu=new Array(cx.length),cz,cv,cw;for(cw=0;cw<cx.length;cw++){cu[cw]=cx[cw].description}cz=cx.length>1?cu.slice(0,-1).join(", ")+" or "+cu[cx.length-1]:cu[0];cv=cy?'"'+ct(cy)+'"':"end of input";return"Expected "+cz+" but "+cv+" found."}var cq=N(cs),cp=cs<a2.length?a2.charAt(cs):null;if(cn!==null){cr(cn)}return new D(co!==null?co:cm(cn,cp),cn,cp,cs,cq.line,cq.column)}function b6(){var cn,cm;cn=bf;cm=aT();if(cm!==au){cl=cn;cm=ap(cm)}cn=cm;return cn}function aT(){var cm;cm=bF();if(cm===au){cm=ce();if(cm===au){cm=M();if(cm===au){cm=aq();if(cm===au){cm=a9();if(cm===au){cm=cj();if(cm===au){cm=bh();if(cm===au){cm=cb();if(cm===au){cm=G();if(cm===au){cm=bt();if(cm===au){cm=aO();if(cm===au){cm=ch();if(cm===au){cm=ca();if(cm===au){cm=bb();if(cm===au){cm=b9();if(cm===au){cm=a1();if(cm===au){cm=ci();if(cm===au){cm=aZ();if(cm===au){cm=aY()}}}}}}}}}}}}}}}}}}return cm}function cb(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===am){co=am;bf+=2}else{co=au;if(b5===0){bS(al)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=ag(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function bt(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===af){co=af;bf+=2}else{co=au;if(b5===0){bS(ae)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=b3(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function aO(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===b1){co=b1;bf+=2}else{co=au;if(b5===0){bS(b0)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bZ(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function ch(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bY){cp=bY;bf+=2}else{cp=au;if(b5===0){bS(bX)}}if(cp!==au){co=aT();if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bW(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function ce(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bV){co=bV;bf+=2}else{co=au;if(b5===0){bS(bU)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bT(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function bh(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bQ){co=bQ;bf+=2}else{co=au;if(b5===0){bS(bP)}}if(co!==au){cn=[];if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}while(cm!==au){cn.push(cm);if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bM(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function bb(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bL){co=bL;bf+=2}else{co=au;if(b5===0){bS(bK)}}if(co!==au){cn=[];if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}while(cm!==au){cn.push(cm);if(bO.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bN)}}}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bJ(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function cj(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bI){co=bI;bf+=2}else{co=au;if(b5===0){bS(bG)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bE(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function b9(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bC){co=bC;bf+=2}else{co=au;if(b5===0){bS(bB)}}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bA(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function M(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bz){cp=bz;bf+=2}else{cp=au;if(b5===0){bS(by)}}if(cp!==au){co=[];cn=ao();while(cn!==au){co.push(cn);cn=ao()}if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bx(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function ao(){var cp,co,cn,cm;cp=bf;if(bw.test(a2.charAt(bf))){co=a2.charAt(bf);bf++}else{co=au;if(b5===0){bS(bv)}}if(co!==au){cn=[];if(bu.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(br)}}while(cm!==au){cn.push(cm);if(bu.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(br)}}}if(cn!==au){cl=cp;co=bq(co,cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function aq(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bp){cp=bp;bf+=2}else{cp=au;if(b5===0){bS(bo)}}if(cp!==au){co=aT();if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bn(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function a9(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===bm){cp=bm;bf+=2}else{cp=au;if(b5===0){bS(bl)}}if(cp!==au){co=aT();if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=bk(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function a1(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===bj){co=bj;bf+=2}else{co=au;if(b5===0){bS(bi)}}if(co!==au){cn=[];if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}if(cm!==au){while(cm!==au){cn.push(cm);if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}}}else{cn=an}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=bc(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function ci(){var cr,cq,cp,co,cn,cm,cs;cr=bf;if(a2.substr(bf,2)===ba){cq=ba;bf+=2}else{cq=au;if(b5===0){bS(a8)}}if(cq!==au){cp=[];if(be.test(a2.charAt(bf))){co=a2.charAt(bf);bf++}else{co=au;if(b5===0){bS(bd)}}while(co!==au){cp.push(co);if(be.test(a2.charAt(bf))){co=a2.charAt(bf);bf++}else{co=au;if(b5===0){bS(bd)}}}if(cp!==au){if(a2.charCodeAt(bf)===120){co=a7;bf++}else{co=au;if(b5===0){bS(a6)}}if(co!==au){cn=[];if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}while(cm!==au){cn.push(cm);if(be.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(bd)}}}if(cn!==au){cm=[];cs=aT();while(cs!==au){cm.push(cs);cs=aT()}if(cm!==au){if(a2.charCodeAt(bf)===62){cs=ai;bf++}else{cs=au;if(b5===0){bS(ah)}}if(cs!==au){cl=cr;cq=a5(cp,cn,cm);cr=cq}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}}else{bf=cr;cr=an}return cr}function bF(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,5)===a4){co=a4;bf+=5}else{co=au;if(b5===0){bS(a3)}}if(co!==au){cl=cp;co=aX()}cp=co;if(cp===au){cp=bf;if(a2.substr(bf,5)===aW){co=aW;bf+=5}else{co=au;if(b5===0){bS(aV)}}if(co!==au){cl=cp;co=aX()}cp=co;if(cp===au){cp=bf;if(a2.substr(bf,3)===aU){co=aU;bf+=3}else{co=au;if(b5===0){bS(aS)}}if(co!==au){cn=bg();if(cn!==au){if(a2.substr(bf,2)===aR){cm=aR;bf+=2}else{cm=au;if(b5===0){bS(aQ)}}if(cm!==au){cl=cp;co=aP(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}if(cp===au){cp=bf;if(a2.substr(bf,3)===aN){co=aN;bf+=3}else{co=au;if(b5===0){bS(aM)}}if(co!==au){cn=b7();if(cn!==au){if(a2.substr(bf,2)===aJ){cm=aJ;bf+=2}else{cm=au;if(b5===0){bS(aI)}}if(cm!==au){cl=cp;co=aP(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}}}}return cp}function bg(){var co,cn,cm;co=bf;cn=[];cm=bs();if(cm!==au){while(cm!==au){cn.push(cm);cm=bs()}}else{cn=an}if(cn!==au){cl=co;cn=aH(cn)}co=cn;return co}function bs(){var cn,cm;if(aG.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(aF)}}if(cn===au){cn=bf;if(a2.substr(bf,2)===aE){cm=aE;bf+=2}else{cm=au;if(b5===0){bS(aD)}}if(cm!==au){cl=cn;cm=aC()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===aB){cm=aB;bf+=2}else{cm=au;if(b5===0){bS(aA)}}if(cm!==au){cl=cn;cm=ad()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===ac){cm=ac;bf+=2}else{cm=au;if(b5===0){bS(ab)}}if(cm!==au){cl=cn;cm=aa()}cn=cm}}}return cn}function b7(){var co,cn,cm;co=bf;cn=[];cm=b4();if(cm!==au){while(cm!==au){cn.push(cm);cm=b4()}}else{cn=an}if(cn!==au){cl=co;cn=aH(cn)}co=cn;return co}function b4(){var cn,cm;if(Z.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(Y)}}if(cn===au){cn=bf;if(a2.substr(bf,2)===aE){cm=aE;bf+=2}else{cm=au;if(b5===0){bS(aD)}}if(cm!==au){cl=cn;cm=aC()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===ac){cm=ac;bf+=2}else{cm=au;if(b5===0){bS(ab)}}if(cm!==au){cl=cn;cm=aa()}cn=cm;if(cn===au){cn=bf;if(a2.substr(bf,2)===aB){cm=aB;bf+=2}else{cm=au;if(b5===0){bS(aA)}}if(cm!==au){cl=cn;cm=ad()}cn=cm}}}return cn}function aZ(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===X){cp=X;bf+=2}else{cp=au;if(b5===0){bS(W)}}if(cp!==au){if(a2.charCodeAt(bf)===76){co=U;bf++}else{co=au;if(b5===0){bS(T)}}if(co===au){if(a2.charCodeAt(bf)===82){co=S;bf++}else{co=au;if(b5===0){bS(R)}}if(co===au){if(a2.charCodeAt(bf)===67){co=Q;bf++}else{co=au;if(b5===0){bS(P)}}}}if(co===au){co=V}if(co!==au){cn=[];cm=aT();while(cm!==au){cn.push(cm);cm=aT()}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=O(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}function G(){var cn,cm;cn=bf;if(a2.substr(bf,3)===L){cm=L;bf+=3}else{cm=au;if(b5===0){bS(K)}}if(cm!==au){cl=cn;cm=J()}cn=cm;return cn}function ca(){var cp,co,cn,cm;cp=bf;if(a2.substr(bf,2)===I){co=I;bf+=2}else{co=au;if(b5===0){bS(az)}}if(co!==au){cn=[];if(ay.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(ax)}}while(cm!==au){cn.push(cm);if(ay.test(a2.charAt(bf))){cm=a2.charAt(bf);bf++}else{cm=au;if(b5===0){bS(ax)}}}if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cp;co=aw(cn);cp=co}else{bf=cp;cp=an}}else{bf=cp;cp=an}}else{bf=cp;cp=an}return cp}function aY(){var cq,cp,co,cn,cm;cq=bf;if(a2.substr(bf,2)===av){cp=av;bf+=2}else{cp=au;if(b5===0){bS(at)}}if(cp!==au){co=[];if(be.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(bd)}}if(cn!==au){while(cn!==au){co.push(cn);if(be.test(a2.charAt(bf))){cn=a2.charAt(bf);bf++}else{cn=au;if(b5===0){bS(bd)}}}}else{co=an}if(co!==au){cn=aT();if(cn!==au){if(a2.charCodeAt(bf)===62){cm=ai;bf++}else{cm=au;if(b5===0){bS(ah)}}if(cm!==au){cl=cq;cp=ar(co,cn);cq=cp}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}}else{bf=cq;cq=an}return cq}a0=bD();if(a0!==au&&bf===a2.length){return a0}else{if(a0!==au&&bf<a2.length){bS({type:"end",description:"end of input"})}throw cd(null,aL,aK)}}return{SyntaxError:D,parse:E}})();y.squerySelector=(function(){function F(I,G){function H(){this.constructor=I}H.prototype=G.prototype;I.prototype=new H()}function D(J,I,K,L,G,H){this.message=J;this.expected=I;this.found=K;this.offset=L;this.line=G;this.column=H;this.name="SyntaxError"}F(D,Error);function E(a9){var ao=arguments.length>1?arguments[1]:{},a0={},R={start:M},aP=M,aK=a0,aI=[],aG=",",aE={type:"literal",value:",",description:'","'},aC=function(bj,bh){var bi=[],bg;if(bj){bi.push(bj)}for(bg=0;bg<bh.length;bg+=1){bi.push(bh[bg][1])}return bi},aA=null,ay=function(bi,bh){var bg={type:"selectorAnd"},bj=[];if(bi){bj.push(bi)}bj=bj.concat(bh);if(bj.length===1){return bj[0]}else{bg.parts=bj;return bg}},aw="*",au={type:"literal",value:"*",description:'"*"'},ar=function(){return{type:"global"}},G=function(bg){return{type:"kind",name:bg}},bf="#",bd={type:"literal",value:"#",description:'"#"'},bc=function(bg){return{type:"id",name:bg}},bb=".",ba={type:"literal",value:".",description:'"."'},a7=function(bg){return{type:"class",name:bg}},a6="[",a5={type:"literal",value:"[",description:'"["'},a4="]",a2={type:"literal",value:"]",description:'"]"'},a1=function(bg,bi,bh){return{type:"attr",name:bg,oper:bi,value:bh}},aZ="=",aY={type:"literal",value:"=",description:'"="'},aX=/^[0-9a-zA-Z_]/,aW={type:"class",value:"[0-9a-zA-Z_]",description:"[0-9a-zA-Z_]"},aV=function(bg){return bg.join("")},aT='"',aS={type:"literal",value:'"',description:'"\\""'},aR=/^[^\n\r\f\\"]/,aJ={type:"class",value:'[^\\n\\r\\f\\\\"]',description:'[^\\n\\r\\f\\\\"]'},aH="\\",aF={type:"literal",value:"\\",description:'"\\\\"'},aD=function(bg){return bg},aB=function(bg){return bg.join("")},az="'",ax={type:"literal",value:"'",description:'"\'"'},av=/^[^\n\r\f\\']/,at={type:"class",value:"[^\\n\\r\\f\\\\']",description:"[^\\n\\r\\f\\\\']"},aq="\n",am={type:"literal",value:"\n",description:'"\\n"'},al="\r\n",aj={type:"literal",value:"\r\n",description:'"\\r\\n"'},ah="\r",ag={type:"literal",value:"\r",description:'"\\r"'},ad="\f",ac={type:"literal",value:"\f",description:'"\\f"'},ab=/^[^\r\n\f0-9a-fA-F]/,aa={type:"class",value:"[^\\r\\n\\f0-9a-fA-F]",description:"[^\\r\\n\\f0-9a-fA-F]"},Z=function(bg){return bg},ap=0,ae=0,aU=0,H={line:1,column:1,seenCR:false},ai=0,a8=[],an=0,T;if("startRule" in ao){if(!(ao.startRule in R)){throw new Error("Can't start parsing from rule \""+ao.startRule+'".')}aP=R[ao.startRule]}function aQ(){return a9.substring(ae,ap)}function Q(){return ae}function P(){return aN(ae).line}function U(){return aN(ae).column}function N(bg){throw aO(null,[{type:"other",description:bg}],ae)}function aM(bg){throw aO(bg,null,ae)}function aN(bh){function bg(bk,bj,bi){var bm,bl;for(bm=bj;bm<bi;bm++){bl=a9.charAt(bm);if(bl==="\n"){if(!bk.seenCR){bk.line++}bk.column=1;bk.seenCR=false}else{if(bl==="\r"||bl==="\u2028"||bl==="\u2029"){bk.line++;bk.column=1;bk.seenCR=true}else{bk.column++;bk.seenCR=false}}}}if(aU!==bh){if(aU>bh){aU=0;H={line:1,column:1,seenCR:false}}bg(H,aU,bh);aU=bh}return H}function af(bg){if(ap<ai){return}if(ap>ai){ai=ap;a8=[]}a8.push(bg)}function aO(bi,bh,bm){function bl(bo){var bn=1;bo.sort(function(bq,bp){if(bq.description<bp.description){return -1}else{if(bq.description>bp.description){return 1}else{return 0}}});while(bn<bo.length){if(bo[bn-1]===bo[bn]){bo.splice(bn,1)}else{bn++}}}function bg(br,bs){function bn(bu){function bv(bw){return bw.charCodeAt(0).toString(16).toUpperCase()}return bu.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(bw){return"\\x0"+bv(bw)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(bw){return"\\x"+bv(bw)}).replace(/[\u0180-\u0FFF]/g,function(bw){return"\\u0"+bv(bw)}).replace(/[\u1080-\uFFFF]/g,function(bw){return"\\u"+bv(bw)})}var bo=new Array(br.length),bt,bp,bq;for(bq=0;bq<br.length;bq++){bo[bq]=br[bq].description}bt=br.length>1?bo.slice(0,-1).join(", ")+" or "+bo[br.length-1]:bo[0];bp=bs?'"'+bn(bs)+'"':"end of input";return"Expected "+bt+" but "+bp+" found."}var bk=aN(bm),bj=bm<a9.length?a9.charAt(bm):null;if(bh!==null){bl(bh)}return new D(bi!==null?bi:bg(bh,bj),bh,bj,bm,bk.line,bk.column)}function M(){var bg;bg=V();return bg}function V(){var bl,bk,bj,bi,bh,bg;bl=ap;bk=O();if(bk!==a0){bj=[];bi=ap;if(a9.charCodeAt(ap)===44){bh=aG;ap++}else{bh=a0;if(an===0){af(aE)}}if(bh!==a0){bg=O();if(bg!==a0){bh=[bh,bg];bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}while(bi!==a0){bj.push(bi);bi=ap;if(a9.charCodeAt(ap)===44){bh=aG;ap++}else{bh=a0;if(an===0){af(aE)}}if(bh!==a0){bg=O();if(bg!==a0){bh=[bh,bg];bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}}if(bj!==a0){ae=bl;bk=aC(bk,bj);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function O(){var bj,bi,bh,bg;bj=ap;bi=I();if(bi===a0){bi=S()}if(bi===a0){bi=aA}if(bi!==a0){bh=[];bg=ak();if(bg===a0){bg=L();if(bg===a0){bg=be()}}while(bg!==a0){bh.push(bg);bg=ak();if(bg===a0){bg=L();if(bg===a0){bg=be()}}}if(bh!==a0){ae=bj;bi=ay(bi,bh);bj=bi}else{ap=bj;bj=aK}}else{ap=bj;bj=aK}return bj}function I(){var bh,bg;bh=ap;if(a9.charCodeAt(ap)===42){bg=aw;ap++}else{bg=a0;if(an===0){af(au)}}if(bg!==a0){ae=bh;bg=ar()}bh=bg;return bh}function S(){var bh,bg;bh=ap;bg=K();if(bg!==a0){ae=bh;bg=G(bg)}bh=bg;return bh}function L(){var bi,bh,bg;bi=ap;if(a9.charCodeAt(ap)===35){bh=bf;ap++}else{bh=a0;if(an===0){af(bd)}}if(bh!==a0){bg=K();if(bg!==a0){ae=bi;bh=bc(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}return bi}function be(){var bi,bh,bg;bi=ap;if(a9.charCodeAt(ap)===46){bh=bb;ap++}else{bh=a0;if(an===0){af(ba)}}if(bh!==a0){bg=K();if(bg!==a0){ae=bi;bh=a7(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}return bi}function ak(){var bl,bk,bj,bi,bh,bg;bl=ap;if(a9.charCodeAt(ap)===91){bk=a6;ap++}else{bk=a0;if(an===0){af(a5)}}if(bk!==a0){bj=K();if(bj!==a0){bi=a3();if(bi!==a0){bh=Y();if(bh!==a0){if(a9.charCodeAt(ap)===93){bg=a4;ap++}else{bg=a0;if(an===0){af(a2)}}if(bg!==a0){ae=bl;bk=a1(bj,bi,bh);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function a3(){var bg;if(a9.charCodeAt(ap)===61){bg=aZ;ap++}else{bg=a0;if(an===0){af(aY)}}return bg}function K(){var bi,bh,bg;bi=ap;bh=[];if(aX.test(a9.charAt(ap))){bg=a9.charAt(ap);ap++}else{bg=a0;if(an===0){af(aW)}}if(bg!==a0){while(bg!==a0){bh.push(bg);if(aX.test(a9.charAt(ap))){bg=a9.charAt(ap);ap++}else{bg=a0;if(an===0){af(aW)}}}}else{bh=aK}if(bh!==a0){ae=bi;bh=aV(bh)}bi=bh;return bi}function Y(){var bg;bg=X();if(bg===a0){bg=W()}return bg}function X(){var bl,bk,bj,bi,bh,bg;bl=ap;if(a9.charCodeAt(ap)===34){bk=aT;ap++}else{bk=a0;if(an===0){af(aS)}}if(bk!==a0){bj=[];if(aR.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(aJ)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}while(bi!==a0){bj.push(bi);if(aR.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(aJ)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}}if(bj!==a0){if(a9.charCodeAt(ap)===34){bi=aT;ap++}else{bi=a0;if(an===0){af(aS)}}if(bi!==a0){ae=bl;bk=aB(bj);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function W(){var bl,bk,bj,bi,bh,bg;bl=ap;if(a9.charCodeAt(ap)===39){bk=az;ap++}else{bk=a0;if(an===0){af(ax)}}if(bk!==a0){bj=[];if(av.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(at)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}while(bi!==a0){bj.push(bi);if(av.test(a9.charAt(ap))){bi=a9.charAt(ap);ap++}else{bi=a0;if(an===0){af(at)}}if(bi===a0){bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){bg=aL();if(bg!==a0){ae=bi;bh=aD(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}if(bi===a0){bi=J()}}}if(bj!==a0){if(a9.charCodeAt(ap)===39){bi=az;ap++}else{bi=a0;if(an===0){af(ax)}}if(bi!==a0){ae=bl;bk=aB(bj);bl=bk}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}}else{ap=bl;bl=aK}return bl}function aL(){var bg;if(a9.charCodeAt(ap)===10){bg=aq;ap++}else{bg=a0;if(an===0){af(am)}}if(bg===a0){if(a9.substr(ap,2)===al){bg=al;ap+=2}else{bg=a0;if(an===0){af(aj)}}if(bg===a0){if(a9.charCodeAt(ap)===13){bg=ah;ap++}else{bg=a0;if(an===0){af(ag)}}if(bg===a0){if(a9.charCodeAt(ap)===12){bg=ad;ap++}else{bg=a0;if(an===0){af(ac)}}}}}return bg}function J(){var bi,bh,bg;bi=ap;if(a9.charCodeAt(ap)===92){bh=aH;ap++}else{bh=a0;if(an===0){af(aF)}}if(bh!==a0){if(ab.test(a9.charAt(ap))){bg=a9.charAt(ap);ap++}else{bg=a0;if(an===0){af(aa)}}if(bg!==a0){ae=bi;bh=Z(bg);bi=bh}else{ap=bi;bi=aK}}else{ap=bi;bi=aK}return bi}T=aP();if(T!==a0&&ap===a9.length){return T}else{if(T!==a0&&ap<a9.length){af({type:"end",description:"end of input"})}throw aO(null,a8,ai)}}return{SyntaxError:D,parse:E}})();(function(){var G={_forward:function(H){g.each(this.engines,function(I,J){if(J.engine[H]){J.engine[H](J.draw)}})},prepareFrame:function(I,H){g.each(this.engines,function(J,K){if(K.engine.prepareFrame){K.engine.prepareFrame(K.draw,I,K.preclear,H)}})},cleanupFrame:function(H){g.each(this.engines,function(I,J){if(J.engine.cleanupFrame){J.engine.cleanupFrame(J.draw,H)}})},translate:function(I,H){g.each(this.engines,function(J,K){if(K.trace){K.engine.translate(K.draw,I,H)}})},fade:function(H){g.each(this.engines,function(I,J){if(J.trace){J.engine.fade(J.draw,H)}})},destroy:function(){this._forward("destroy")}};function F(I,H){return function(J,K){return I(H,J,K)}}function D(){return function(H,I){}}function E(I,H){var J={},K,L;if(!I||!H){return null}J.engine=I;J.draw=H;for(K in I.primitives){if("function"===typeof I.primitives[K]){J["prepare"+K]=D();J["draw"+K]=F(I.primitives[K],J.draw);J["cleanup"+K]=D()}else{for(L in I.primitives[K]){J[L+K]=F(I.primitives[K][L],J.draw)}}}return J}y.draw={availableEngines:{},create:function(K){var N=y.draw,I=K.rootNode,L={},M,J;K.width=K.width||I.width();K.height=K.height||I.height();if(N.availableEngines.canvas){var H=function(P){var O=E(N.availableEngines.canvas,N.availableEngines.canvas.create(K));if(O){if(P){O.trace=true}else{O.preclear=true}}return O};L.trace=H(true);L.canvas=H(false)}if(N.availableEngines.html){M=E(N.availableEngines.html,N.availableEngines.html.create(K));if(M){L.html=M}}J=Object.create(G);for(M in L){if(L.hasOwnProperty(M)&&!L[M]){delete L[M]}}J.engines=L;return J}}}());(function(){var D=function(W,X){var V=new Image();V.src=W.src;if(X){V.onload=X}return V};function P(X,W,V){X.beginPath();X.moveTo(W.x,W.y);X.lineTo(V.x,V.y);X.stroke()}function G(al,aj,ak,Y,ad){var ae,Z,af=aj.length/2,V=false,ab,ah,ag,X,W,ac;al.beginPath();var aa=10000000;function ai(am){return Math.abs(am)<aa}for(ae=0,Z=0;ae<af;++ae,Z+=2){ah=aj[Z];ag=aj[Z+1];if(ai(ah)&&ai(ag)){if((ah===X)&&(ag===W)){ab=true;continue}if(ak&&ak[ae]){if(ab){al.stroke();al.fillStyle=al.strokeStyle;L(al,{x:X,y:W},al.lineWidth/2);al.beginPath()}V=false}ab=false;if(!V){al.moveTo(ah,ag);V=true}else{ac=Y&&Y[ae];if(ac&&ac!==""){al.strokeStyle=ac}al.lineTo(ah,ag);if(ac){al.stroke();al.beginPath();al.moveTo(ah,ag)}}}else{if(ab){al.stroke();al.fillStyle=al.strokeStyle;L(al,{x:X,y:W},al.lineWidth/2);al.beginPath()}V=false}X=ah;W=ag}if(ad&&V){if(!(ak&&ak[ae])){ah=aj[0];ag=aj[1];if(ai(ah)&&ai(ag)){al.lineTo(ah,ag)}}}al.stroke()}function L(V,X,W){V.beginPath();V.arc(X.x,X.y,W,0,Math.PI*2,true);V.fill()}function J(V,W){V.beginPath();if(W.orientation!==0){V.arc(W.center.x,W.center.y,W.radius,W.initialAngle,W.finalAngle,false)}else{V.moveTo(W.initialPoint.x,W.initialPoint.y);V.lineTo(W.finalPoint.x,W.finalPoint.y)}}function H(X,Y,aa,ab,ac){var Z,W,V;for(Z=0,W=0;Z<aa;++Z,W+=2){if(ac){X.fillStyle=ac[Z]}V={x:Y[W],y:Y[W+1]};L(X,V,ab)}}function E(W,ac,ab){if(ab.x===ab.y){W.beginPath();W.arc(ac.x,ac.y,ab.x,0,Math.PI*2,true);W.stroke();return}var Z=0.551784,Y=ab.x*Z,X=ab.y*Z,V=ac.x+ab.x,aa=ac.y+ab.y;W.beginPath();W.moveTo(ac.x-ab.x,ac.y);W.bezierCurveTo(ac.x-ab.x,ac.y-X,ac.x-Y,ac.y-ab.y,ac.x,ac.y-ab.y);W.bezierCurveTo(ac.x+Y,ac.y-ab.y,V,ac.y-X,V,ac.y);W.bezierCurveTo(V,ac.y+X,ac.x+Y,aa,ac.x,aa);W.bezierCurveTo(ac.x-Y,aa,ac.x-ab.x,ac.y+X,ac.x-ab.x,ac.y);W.stroke()}function K(V,W,X){V.beginPath();V.moveTo(W[0].x,W[0].y);V.lineTo(W[1].x,W[1].y);V.lineTo(W[2].x,W[2].y);V.closePath();V.fill();if(X){V.stroke()}}function T(ac,ab,Z){var X=10,aa=X,W=ab.subtract(ac),V=W.vLength(),Y=V-aa;if(V>X){return W.multiply(Y/V).add(ac)}else{return}}function M(Y,W,V,X){var Z;Z=Y-(W*X)/V;return Z}function R(ac,X,W){var aa=2,ab=((W/2)+aa)||aa,Z=[],V=X.subtract(ac).unit(),Y=new y.GeometricPoint(-V.y,V.x);Z.push(ac.add(Y.multiply(ab)));Z.push(X);Z.push(ac.add(Y.multiply(-ab)));return Z}function S(aj,aa,ab,V,ad,ah,an){if(aa.orientation===0){aj.beginPath();aj.moveTo(aa.initialPoint.x,aa.initialPoint.y);aj.lineTo(aa.finalPoint.x,aa.finalPoint.y);aj.closePath();return}var aq=10,ae=aa,ar=ae.center,Y=aa.orientation,am=aa.arcAngle,af=aa.initialAngle,al=aa.finalAngle,ai=af,at=al,ak=((ad==="tail")||(ad==="both")),ag=((ad==="head")||(ad==="both")),ap=0,ao=false,W=false,Z,au,ac,X;if(ag){ap+=aq;if(Y>0){W=true}else{ao=true}}if(ak){ap+=aq;if(Y<0){W=true}else{ao=true}}if(Math.abs(am*ab)<=ap){ao=W=false}if(ao){Z=new y.GeometricPoint(Math.cos(af),Math.sin(af)).multiply(ab).add(ar);ai=M(af,Y,ab,aq)}if(W){au=new y.GeometricPoint(Math.cos(al),Math.sin(al)).multiply(ab).add(ar);at=M(al,Y,ab,aq)}aj.beginPath();aj.arc(ar.x,ar.y,ab,ai,at,false);aj.stroke();if(ah){aj.beginPath();aj.arc(ar.x,ar.y,ab,af,al,false);aj.lineTo(ar.x,ar.y);aj.closePath();X=aj.globalAlpha;aj.globalAlpha*=an;aj.fill();aj.globalAlpha=X}if(ao){ac=new y.GeometricPoint(Math.cos(ai),Math.sin(ai)).multiply(ab).add(ar);K(aj,R(ac,Z,V))}if(W){ac=new y.GeometricPoint(Math.cos(at),Math.sin(at)).multiply(ab).add(ar);K(aj,R(ac,au,V))}}function Q(ao,ac,ad,V,ae,am,ap){var at=10,ai=ac,av=ai.center,ab=ai.orientation,aj=ai.initialAngle,au=y.GeometricPoint(Math.cos(aj),Math.sin(aj)).multiply(ad),af=y.GeometricPoint(-au.y,au.x),aq=au.add(af),Z=au.add(av),X=af.add(av),ah=Z,aw=X,ag=aq.add(av),an=((ae==="tail")||(ae==="both")),al=((ae==="head")||(ae==="both")),ar=false,W=false,ak,Y,aa;if(al){if(ab>0){W=true}else{ar=true}}if(an){if(ab<0){W=true}else{ar=true}}if(ad<=at){ar=W=false}if(W){Y=T(ag,X,V);if(Y){X=Y}}if(ar){ak=T(ag,Z,V);if(ak){Z=ak}}ao.beginPath();ao.moveTo(Z.x,Z.y);ao.lineTo(ag.x,ag.y);ao.lineTo(X.x,X.y);ao.stroke();if(am){ao.beginPath();ao.moveTo(ah.x,ah.y);ao.lineTo(ag.x,ag.y);ao.lineTo(aw.x,aw.y);ao.lineTo(av.x,av.y);ao.closePath();aa=ao.globalAlpha;ao.globalAlpha*=ap;ao.fill();ao.globalAlpha=aa}if(Y){K(ao,R(X,aw,V))}if(ak){K(ao,R(Z,ah,V))}}function I(X,V){var W={state:"error",id:V.id,onStateChange:V.onStateChange};W.imageSpec=V.image;if(V.image){W.state="loading";W.img=D(W.imageSpec,function(){W.state="ready";if(W.onStateChange){W.onStateChange()}})}return W}function N(V,Y,aa){var ad=V.context,ac=aa.transform,W=Y.imageSpec?Y.imageSpec.width:200,ab=Y.imageSpec?Y.imageSpec.height:100,X=aa.clipPolygon,Z;if(!aa.renderable){return}ad.save();ad.globalAlpha*=aa.opacity;if(X&&X.length>0){ad.beginPath();ad.moveTo(X[0].getX(),X[0].getY());for(Z=1;Z<X.length;Z++){ad.lineTo(X[Z].getX(),X[Z].getY())}ad.closePath();ad.clip()}ad.transform(ac.m00,ac.m01,ac.m10,ac.m11,ac.m20,ac.m21);if(Y.state==="ready"){ad.drawImage(Y.img,0,0)}else{if(Y.state==="loading"){ad.strokeStyle="black";ad.strokeRect(0,0,W,ab)}else{ad.strokeStyle="red";ad.strokeRect(0,0,W,ab);ad.beginPath();ad.moveTo(0,0);ad.lineTo(W,ab);ad.moveTo(W,0);ad.lineTo(0,ab);ad.closePath();ad.stroke()}}ad.restore()}function F(X,V,W){V.onStateChange=null}function U(ab,X){var W=ab,Y=X,aa,Z,V;V=l.devicePixelRatio;if(V){W*=V;Y*=V}aa=g("<canvas width="+W+" height="+Y+"></canvas>");Z=aa[0].getContext&&aa[0].getContext("2d");if(!Z){return null}if(!Z.setLineDash){Z.setLineDash=function(ac){};Z.getLineDash=function(){return([])}}if(V){Z.scale(V,V)}return{canvas:aa,context:Z,width:W,height:Y}}function O(V){V.backbuffer=U(V.canvas.width(),V.canvas.height())}y.draw.availableEngines.canvas={create:function(W){var V=U(W.width,W.height);if(!V){return V}V.canvas.css({position:"absolute",top:0,left:0,width:W.width,height:W.height,overflow:"hidden"});V.canvas.appendTo(W.rootNode);return V},destroy:function(V){if(V.canvas){V.canvas.remove()}},prepareFrame:function(ac,aa,Y,X){var W,ad,Z,ab,V;ac.context.save();ac.context.transform(X.m00,X.m01,X.m10,X.m11,X.m20,X.m21);if(!Y){return}if(!y.Geom.isValidRect(aa)){return}ad=y.GeometricPoint(0,0);Z=y.GeometricPoint(ac.canvas.width(),ac.canvas.height());V=X.inverse();V.transform(ad);V.transform(Z);ab={left:ad.x,top:ad.y,right:Z.x,bottom:Z.y};W=y.Geom.insetRect(aa,-1);W.left=Math.round(W.left);W.top=Math.round(W.top);W.right=Math.round(W.right);W.bottom=Math.round(W.bottom);W=y.Geom.intersectRects(W,ab);if(y.Geom.isEmptyRect(W)){W={left:-1,top:-1,right:-1,bottom:-1}}ac.context.beginPath();ac.context.rect(W.left,W.top,W.right-W.left,W.bottom-W.top);ac.context.clip();ac.context.clearRect(ad.x,ad.y,Z.x-ad.x,Z.y-ad.y)},cleanupFrame:function(W,V){W.context.restore()},clear:function(V){V.context.clearRect(0,0,V.canvas.width(),V.canvas.height())},translate:function(W,Y,X){var Z=W.canvas.width(),V=W.canvas.height();if(!W.backbuffer){O(W)}W.backbuffer.context.clearRect(0,0,Z,V);W.backbuffer.context.drawImage(W.canvas[0],-Y,-X,Z,V);W.context.clearRect(0,0,Z,V);W.context.drawImage(W.backbuffer.canvas[0],0,0,Z,V)},fade:function(V,W){if(!V.backbuffer){O(V)}V.backbuffer.context.save();V.backbuffer.context.clearRect(0,0,V.canvas.width(),V.canvas.height());V.backbuffer.context.globalAlpha=W;V.backbuffer.context.drawImage(V.canvas[0],0,0,V.canvas.width(),V.canvas.height());V.context.clearRect(0,0,V.canvas.width(),V.canvas.height());V.context.drawImage(V.backbuffer.canvas[0],0,0,V.canvas.width(),V.canvas.height());V.backbuffer.context.restore()},primitives:{Point:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.fillStyle=X.color;V.strokeStyle="black";V.lineWidth=X.lineWidth;if(X.dropShadow){V.shadowColor="black";V.shadowBlur=7;V.shadowOffsetX=3;V.shadowOffsetY=3}V.setLineDash([]);V.beginPath();V.arc(X.cx,X.cy,X.radius,0,Math.PI*2,true);V.fill();if(X.lineWidth>0){V.stroke()}V.closePath();V.restore()},String:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.fillStyle="black";V.strokeStyle="black";V.lineWidth=1;V.textAlign="center";V.textBaseline="middle";V.fillText(X.text,X.x,X.y);V.restore()},Circle:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.strokeStyle=X.color;V.lineWidth=X.width;V.setLineDash(X.lineDash||[]);V.beginPath();V.arc(X.cx,X.cy,X.r,0,Math.PI*2,true);V.stroke();V.restore()},Arc:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.strokeStyle=X.color;V.lineWidth=X.width;V.setLineDash(X.lineDash||[]);J(V,X.arc);V.stroke();V.restore()},CircleInterior:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.fillStyle=X.color;if(X.drawBorder){V.strokeStyle=X.borderColor;V.lineWidth=X.borderWidth;V.setLineDash(X.lineDash||[])}V.beginPath();V.arc(X.cx,X.cy,X.r,0,Math.PI*2,true);V.fill();if(X.drawBorder){V.stroke()}V.restore()},ArcInterior:function(Z,W,Y){var V=Z.context,X;if(!Y.renderable){return}V.save();V.globalAlpha*=Y.opacity;V.fillStyle=Y.color;if(Y.drawBorder){V.strokeStyle=Y.borderColor;V.lineWidth=Y.borderWidth;V.setLineDash(Y.lineDash||[])}X=Y.arc;J(V,Y.arc);if(Y.genus==="ArcSegment"){V.closePath()}else{V.lineTo(X.center.x,X.center.y);V.closePath()}V.fill();if(Y.drawBorder){V.stroke()}V.restore()},Polygon:function(aa,X,Z){var V=aa.context,Y,W;if(!Z.renderable){return}V.save();if(Z.drawBorder){W=V.globalAlpha;V.strokeStyle=Z.borderColor;V.lineWidth=Z.borderWidth;V.miterLimit=10/Z.borderWidth;V.setLineDash(Z.lineDash||[])}V.globalAlpha*=Z.opacity;V.fillStyle=Z.color;V.beginPath();V.moveTo(Z.points[0].x,Z.points[0].y);for(Y=1;Y<Z.points.length;Y++){V.lineTo(Z.points[Y].x,Z.points[Y].y)}V.closePath();V.fill("evenodd");if(Z.drawBorder){V.globalAlpha=W*Z.fadeOpacity;V.stroke()}V.restore()},Rectangle:function(ac,W,Z){function aa(af,ae,ad){return Math.max(Math.min(af,ad),ae)}var V=ac.context,ab=Z.rect,Y={left:-1,top:-1,right:ac.width+1,bottom:ac.height+1},X;X={left:Math.round(aa(ab.left,Y.left,Y.right))-0.5,top:Math.round(aa(ab.top,Y.top,Y.bottom))-0.5,right:Math.round(aa(ab.right,Y.left,Y.right))+0.5,bottom:Math.round(aa(ab.bottom,Y.top,Y.bottom))+0.5};V.save();V.globalAlpha*=Z.opacity;V.lineWidth=1;V.lineCap="butt";V.lineJoin="miter";V.strokeStyle=Z.color||"#999";V.beginPath();V.moveTo(X.left,X.top);V.lineTo(X.right,X.top);V.lineTo(X.right,X.bottom);V.lineTo(X.left,X.bottom);V.closePath();V.stroke();V.restore()},Segment:function(Y,W,X){var V=Y.context;if(!X.renderable){return}V.save();V.globalAlpha*=X.opacity;V.lineWidth=X.width;V.strokeStyle=X.color;V.setLineDash(X.lineDash||[]);V.beginPath();V.moveTo(X.p0x,X.p0y);V.lineTo(X.p1x,X.p1y);V.lineCap="round";V.stroke();V.closePath();V.setLineDash([]);V.restore()},Text:{prepare:function(W,V){return g.extend({},V)},draw:function(X,au,aa){var aj=X.context,al=18,an=0.7,ai=0.2,ag=Math.round(aa.x),ar=Math.round(aa.y)-4,ad=ag,ac=ar;if(!aa.renderable){return}function ab(av,aw){var ay="";function ax(aB,az,aA){if((h!==aB)&&(aB!==az)){if(ay.length>0){ay+=" "}ay+=aB;if(aA){ay+=aA}}}ax(aw["font-weight"],"normal");ax(aw["font-style"],"normal");ax(aw["font-size"],"","px");ax(aw["font-family"]);if(ay.length>0){av.font=ay}if(h!==aw.color){av.fillStyle=aw.color}}function ae(aA){var aw={ascent:0.1,descent:0.2,left:0,right:0},ax={zapfino:{ascent:1.2,descent:2.6,left:0.2,right:0.4}},av=aA["font-family"],ay=av&&av.toLowerCase(),az;g.each(ax,function(aC,aB){if(ay.indexOf(aC)>=0){az=aB;return false}});return az||aw}function at(av,aC,ax){var aA=aC["font-size"]||al,aB=ae(aC),az=aq(ax),ay,aw;av.save();ab(av,aC);ay=av.measureText(az.text);av.restore();aw=(az.maxSubscript+az.maxSuperscript)*ai;return{width:Math.round(ay.width*(1+aB.left+aB.right)),height:Math.round(aA*(1+aB.ascent+aB.descent+aw))}}function V(av,aA,ax,az){var aw=az["font-size"]||al,ay=ae(az);return{top:aA-Math.round((1+ay.ascent)*aw),bottom:aA+Math.round(ay.descent*aw),left:av-Math.round(ay.left*aw)-1,right:av+ax+Math.round(ay.right*aw)+2}}function af(aw,ax){var av=aw.value;if(aw.type==="symbol"){return y.mfs.symMap[av.toUpperCase()]||"x"}return av}function aq(az){var aA={},aC=0,ay=0,ax=0,av=0,aB="";function aw(aE){var aD;aD=aA[aE.type];if(aD){aD(aE)}}aA.horizontal=function(aE){for(var aD=0;aD<aE.value.length;++aD){aw(aE.value[aD])}};aA.style=function(aE){for(var aD=0;aD<aE.value.length;aD+=1){if(!aE.value[aD].code&&aE.value[aD].type){aw(aE.value[aD])}}};aA.sub=function(aD){if(av<++ax){av=ax}aw(aD.value[0]);aw(aD.value[1]);--ax};aA["super"]=function(aD){if(ay<++aC){ay=aC}aw(aD.value[0]);aw(aD.value[1]);--aC};aA.text=function(aD){aB+=af(aD)};aA.symbol=aA.text;aw(az);return{maxSubscript:av,maxSuperscript:ay,text:aB}}function ah(av,ay,aA){var az={},ax={left:ad,top:ac,right:ad,bottom:ac};function aw(aC,aD){var aB;aB=az[aC.type];if(aB){aB(aC,aD)}else{y.log("MFS-Canvas-Render does not support "+aC.type)}}az.horizontal=function(aC,aD){for(var aB=0;aB<aC.value.length;++aB){aw(aC.value[aB],aD)}};az.style=function(aE,aI){var aF,aD,aB,aG,aH,aJ=g.extend({},aI),aK={},aC=[];for(aF=0;aF<aE.value.length;aF+=1){if(aE.value[aF].code){aK[aE.value[aF].code]=aE.value[aF].value}else{if(aE.value[aF].type){aC.push(aE.value[aF])}}}if(aK.fontFamily){if(aI.fontTable){aD=aI.fontTable[parseInt(aK.fontFamily,16)];if(aD){aJ["font-family"]=aD}}}if(aK.fontSize){aJ["font-size"]=parseInt(aK.fontSize,16)+"px"}else{if(Number(aK.fontWeight)===2){aJ["font-weight"]="bold"}}if(Number(aK.fontStyle)===2){aJ["font-style"]="italic"}if(Number(aK.underbar)===2){aJ["text-decoration"]="underline"}if(aK.red||aK.green||aK.blue){aB=aK.red?parseInt(aK.red,16)-1:0;aG=aK.green?parseInt(aK.green,16)-1:0;aH=aK.blue?parseInt(aK.blue,16)-1:0;aJ.color="rgb("+aB+","+aG+","+aH+")"}av.save();ab(av,aJ);aw(aC[0],aJ);av.restore()};az.sub=function(aC,aE){var aB=g.extend({},aE),aD=Math.round(ai*aB["font-size"]);aw(aC.value[0],aB);ac+=aD;av.save();aB["font-size"]=Math.round(an*aB["font-size"]);ab(av,aB);aw(aC.value[1],aB);av.restore();ac-=aD};az["super"]=function(aC,aE){var aB=g.extend({},aE),aD=Math.round(ai*aB["font-size"]);aw(aC.value[0],aB);ac-=aD;av.save();aB["font-size"]=Math.round(an*aB["font-size"]);ab(av,aB);aw(aC.value[1],aB);av.restore();ac+=aD};az.text=function(aE,aG){var aD=af(aE),aC=av.measureText(aD),aB=V(ad,ac,aC.width,aG);av.fillText(aD,ad,ac);if(aG["text-decoration"]==="underline"){var aF=Math.round(ac+2)+0.5;P(av,{x:ad,y:aF},{x:ad+aC.width,y:aF});aB.bottom=Math.max(aB.bottom,aF+1)}ax=y.Geom.unionRects(ax,aB);ad+=aC.width};az.symbol=az.text;aw(ay,aA);return ax}function ao(){return{fontTable:au.fontTable,"font-weight":au["font-weight"],"font-style":au["font-style"],"text-decoration":au["text-decoration"],"font-size":au["font-size"],"font-family":au["font-family"],color:au.color}}var Y=aa.useDrawImage?null:aj,am=l.devicePixelRatio||1,W=au["font-size"]||al,ap,ak;if(aa.constraintFrame!==au.constraintFrame){if(aa.parsedMFS!==au.parsedMFS){au.parsedMFS=aa.parsedMFS;if(aa.useDrawImage){if(!au.mfsImage){au.mfsImage=r.createElement("canvas")}ap=ao();ak=at(aj,ap,au.parsedMFS);au.mfsImage.width=ak.width*am;au.mfsImage.height=ak.height*am;Y=au.mfsImage.getContext("2d");Y.scale(am,am)}}au.constraintFrame=aa.constraintFrame}if(au.parsedMFS&&Y){if(!ap){ap=ao()}var Z=ae(ap);if(aa.useDrawImage){au.imageOffset={x:Math.round(W*Z.left),y:Math.round(W*Z.ascent)};ad=au.imageOffset.x;ac=au.imageOffset.y}if(!aa.useDrawImage){aj.save();aj.globalAlpha*=aa.opacity}ab(Y,ap);Y.textBaseline="alphabetic";ac+=W;au.baseRenderBounds=ah(Y,au.parsedMFS,ap);if(!aa.useDrawImage){aj.restore()}}if(aa.useDrawImage&&au.mfsImage){ag-=au.imageOffset.x;ar-=au.imageOffset.y;aj.save();if(am!==1){aj.scale(1/am,1/am)}aj.drawImage(au.mfsImage,ag*am,ar*am);au.renderBounds=y.Geom.offsetRect(au.baseRenderBounds,ag,ar);aj.restore()}else{au.renderBounds=au.baseRenderBounds}},cleanup:function(X,V,W){}},Picture:{prepare:I,draw:N,cleanup:F},Axis:{prepare:function(W,V){},draw:function(Y,ay,ag){function ad(aE,aD){if(aD<=0){return aE}var aF=aE,aH=18,aB=0.8,aG=0.8,aC=6;if(aE>=aH){aF*=aB}for(;aD>0;--aD){aF*=aG}return Math.max(Math.round(aF),aC)}var ao=Y.context,ax,aA,ar,am,ap,at,aq=ag.tickSpacing.pixelsBetweenTicks*ag.tickSpacing.largeTickInterval,ah=Math.PI*ag.unitPixels,V=Math.round(ah/aq),ac=ad(ag["font-size"],1),W=ac+"px "+ag["font-family"],X=ac,au,aw="π",ab,ak,ai="−",af;if(ag.orientation==="horizontal"){ax=ag.sketchRect.left;aA=ag.sketchRect.right;ar=ag.origin.x;am=ag.origin.y}else{ax=ag.sketchRect.top;aA=ag.sketchRect.bottom;ar=ag.origin.y;am=ag.origin.x}ap=ax-1;at=aA+1;if(!ag.renderable){return}function Z(){ao.save();ao.setLineDash(ag.lineDash||[]);if(ag.orientation==="horizontal"){P(ao,{x:ap,y:am},{x:at,y:am})}else{P(ao,{x:am,y:ap},{x:am,y:at})}ao.restore()}function an(){var aC=ag.majorTickLength,aD,aF,aE,aB;aE=~~((ap-ar)/aq);aB=~~((at-ar)/aq);for(aF=aE;aF<=aB;++aF){aD=ar+aF*aq;if(aF!==0){if(ag.orientation==="horizontal"){P(ao,{x:aD,y:am-aC},{x:aD,y:am+aC})}else{P(ao,{x:am-aC,y:aD},{x:am+aC,y:aD})}}}}function az(aD,aC){if(aD!==~~aD){var aB=Math.pow(10,aC);return Math.round(aD*aB)/aB}return aD}function aa(aG){var aF=aG.toExponential(ag.precisionInfo.precision),aE=aF.indexOf("e"),aC=(+aF.substr(0,aE)).toString(),aB=aF[aE+1]==="+"?aE+2:aE+1,aD=aF.substr(aB);return{type:"exponential",primary:aC+"●10",secondary:aD.toString()}}function av(aI,aH){var aE=72,aJ=y.math.reduceFraction(Math.abs(aI),V),aD,aF,aB,aG;if((aJ.denominator>1)&&(aJ.denominator<=aE)){var aC="";if(aJ.numerator!==1){aC+=aJ.numerator}aG={type:"fraction",negative:aI<0,primary:aC,secondary:aJ.denominator.toString(),pi:true}}else{if(aJ.denominator<72){aD=az(aH/Math.PI,ag.precisionInfo.precision);aF=aD<0?"-":"";aD=Math.abs(aD);aB=aF;if(aD!==1){aB+=aD}aG={type:"simple",primary:aB,pi:true}}else{aD=az(aH,ag.precisionInfo.precision);aG={type:"simple",primary:aD.toString()}}}return aG}function aj(aF,aB){var aC=aB,aE=Math.abs(aC),aD;if((aE<ag.precisionInfo.smallExponentBound)||(aE>ag.precisionInfo.largeExponentBound)){aD=aa(aC)}else{if(ag.tickNumbering==="trigonometric"){aD=av(aF,aB)}else{aC=az(aC,ag.precisionInfo.precision);aD={type:"simple",primary:aC.toString()}}}if(aD.primary){aD.primary=aD.primary.replace("-",ai)}return aD}function ae(aF,aY,aP){var aE=aF.primary&&ao.measureText(aF.primary),aJ,aO=1,aD=2,aG,aW,aH=ao.textBaseline,aM,aK,aX={};if(aF.pi){if(!ab){ab=ac+"px Symbol"}if(!ak){ao.font=ab;ak=ao.measureText(aw);ao.font=W}}aG=aE?aE.width:0;if(aF.pi){if(aG){aG+=aO}aG+=ak.width}if(aF.type==="simple"){aW=ac;if(ag.orientation==="horizontal"){aX.x=aY;aX.y=Math.round(am+aP+aW/2)-0.5}else{aX.x=am-aP-aG/2;aX.y=Math.round(aY)-1.5}aM=aX.x-aG/2;aK=aX.y+ac/2+2;ao.textBaseline="bottom";if(aF.primary){ao.fillText(aF.primary,aM,aK);aM+=aE.width+aO}if(aF.pi){ao.font=ab;ao.fillText(aw,aM,aK);ao.font=W}}else{if(aF.type==="exponential"){var aC=ad(ag["font-size"],2),aN=1,aS={};if(!au){au=aC+"px "+ag["font-family"]}ao.font=au;aJ=ao.measureText(aF.secondary);aG+=aN+aJ.width;aW=ac+aC;if(ag.orientation==="horizontal"){aX.x=aY;aX.y=Math.round(am+aP+aW/2)+0.5}else{aX.x=am-aP-aG/2;aX.y=Math.round(aY)+0.5}ao.textBaseline="middle";aM=aX.x-aG/2;aS.x=aM+aE.width+aN;aS.y=aX.y-ac/2;ao.fillText(aF.secondary,aS.x,aS.y);ao.font=W;ao.fillText(aF.primary,aM,aX.y)}else{if(aF.type==="fraction"){if(!af&&aF.negative){af=ao.measureText(ai)}aJ=ao.measureText(aF.secondary);var aR=aG,aQ=aJ.width,aU=Math.max(aR,aQ)+2,aT,aB,aV,aZ=5,aL=(aU-aR)/2,aI=(aU-aQ)/2;aG=Math.max(aR,aQ)+2;if(aF.negative){aG+=af.width+aD}aW=2*(X+4);if(ag.orientation==="horizontal"){aX.x=aY;aX.y=Math.round(am+aP+aW/2)-1.5}else{aX.x=am-aP-aG/2-1;aX.y=Math.round(aY)+0.5}if(aF.negative){ao.textBaseline="middle";ao.fillText(ai,aX.x-aG/2,aX.y-1);aT=aX.x-aG/2+af.width+aD}else{aT=aX.x-aG/2}aB=aT+aU;aV=(aT+aB)/2;ao.lineWidth=1;P(ao,{x:aT,y:aX.y},{x:aB,y:aX.y});aM=aT+aL;aK=aX.y-aZ-1;ao.textBaseline="alphabetic";if(aF.primary){ao.fillText(aF.primary,aM,aK);aM+=aE.width+aO}if(aF.pi){ao.font=ab;ao.fillText(aw,aM,aK);ao.font=W}aM=aT+aI;aK=aX.y+aZ-Math.round(ac/6);ao.textBaseline="top";ao.fillText(aF.secondary,aM,aK)}}}ao.textBaseline=aH}function al(){var aJ=aq*ag.tickSpacing.largeIntervalsPerText,aC,aB,aD,aF,aE,aH,aI=ag.majorTickLength+3;aD=~~((ap-ar)/aJ)-1;aF=~~((at-ar)/aJ)+1;ao.font=W;ao.textAlign="left";for(aB=aD;aB<=aF;++aB){if(aB!==0){var aG=aB*ag.tickSpacing.largeIntervalsPerText;aC=ar+aB*aJ;aE=aB*aJ/ag.unitPixels;if(ag.isPolar){aG=Math.abs(aG);aE=Math.abs(aE)}else{if(ag.orientation==="vertical"){aG=-aG;aE=-aE}}aH=aj(aG,aE);ae(aH,aC,aI)}}}ao.save();if(h!==ag.width){ao.lineWidth=ag.width}if(h!==ag.color){ao.fillStyle=ag.color;ao.strokeStyle=ag.color}if(h!==ag.opacity){ao.globalAlpha*=ag.opacity}Z();an();if(ag.tickNumberStyle==="auto"){al()}ao.restore()},cleanup:function(X,V,W){}},CoordSys:{prepare:function(W,V){},draw:function(X,at,Y){var ao=X.context,aa=Y.sketchRect.left,ae=Y.sketchRect.right,ag=Y.sketchRect.top,aj=Y.sketchRect.bottom,af=aa-1,ah=ae+1,ak=ag-1,ap=aj+1,ac,W,Z,ad,ab,al,aq,ar;if(!Y.renderable){return}Z=~~((af-Y.origin.x)/Y.gridSpacing.x);ad=~~((ah-Y.origin.x)/Y.gridSpacing.x);aq=~~((ak-Y.origin.y)/Y.gridSpacing.y);ar=~~((ap-Y.origin.y)/Y.gridSpacing.y);ao.save();if(h!==Y.width){ao.lineWidth=Y.width}if(h!==Y.color){ao.strokeStyle=Y.color}if(h!==Y.opacity){ao.globalAlpha*=Y.opacity}function an(au){P(ao,{x:af,y:au},{x:ah,y:au})}function ai(au){for(W=Z;W<=ad;++W){ac=Y.origin.x+W*Y.gridSpacing.x;L(ao,{x:ac,y:au},Y.radius)}}function am(){if(Y.grid==="gridlines"){for(W=Z;W<=ad;++W){ac=Y.origin.x+W*Y.gridSpacing.x;P(ao,{x:ac,y:ak},{x:ac,y:ap})}}var au=an;if(Y.grid==="dotted"){au=ai;ao.fillStyle=Y.color}for(al=aq;al<=ar;++al){ab=Y.origin.y+al*Y.gridSpacing.y;au(ab)}}function V(){var aP=Math.max(Math.abs(Z),Math.abs(ad)),aF=Math.max(Math.abs(aq),Math.abs(ar)),aA=1,aE=aP+aF,aQ=aP*aP+aF*aF,aK=Y.gridSpacing.y/Y.gridSpacing.x,ax=(Z*ad<=0),av=(aq*ar<=0);while(aE*aE>aQ){--aE}++aE;if(!ax||!av){var aM=Math.min(Math.abs(Z),Math.abs(ad)),aD=Math.min(Math.abs(aq),Math.abs(ar));if(ax){aA=aD}else{if(av){aA=aM}else{var aw=aM*aM+aD*aD;while(aA*aA<=aw){++aA}--aA}}}function aO(aS,aR,aW){var aX,aU={x:0,y:0},aV=Y.radius,aT=[{cos:1,sin:0},{cos:0.96592582628907,sin:0.25881904510252},{cos:0.86602540378444,sin:0.5},{cos:0.70710678118655,sin:0.70710678118655},{cos:0.5,sin:0.86602540378444},{cos:0.25881904510252,sin:0.96592582628907},{cos:0,sin:1}];aS.fillStyle=Y.color;for(aX=0;aX<7;++aX){aU.x=aW.x*aT[aX].cos;aU.y=aW.y*aT[aX].sin;L(aS,{x:aR.x+aU.x,y:aR.y-aU.y},aV);if((aX>0)&&(aX<6)){L(aS,{x:aR.x-aU.x,y:aR.y-aU.y},aV)}L(aS,{x:aR.x-aU.x,y:aR.y+aU.y},aV);if((aX>0)&&(aX<6)){L(aS,{x:aR.x+aU.x,y:aR.y+aU.y},aV)}}}var aB=Y.grid==="dotted"?aO:E,aN;for(aN=1;aN<=aE;++aN){var aC={x:aN*Y.gridSpacing.x,y:aN*Y.gridSpacing.y};aB(ao,Y.origin,aC)}function au(aS,aT,aU,aR){if(aS===0){return(aR.min<=aT[0][aU])&&(aT[0][aU]<=aR.max)}else{if(aS>0){return aT[0][aU]>aR.max?aT[1][aU]<=aR.max:aT[0][aU]>=aR.min}else{if(aS<0){return aT[0][aU]<aR.min?aT[1][aU]>=aR.min:aT[0][aU]<=aR.max}}}}if(Y.grid==="gridlines"){var aI=Math.PI/12,aL=-2*aI,az={x:Y.origin.x,y:Y.origin.y},ay={x:Y.origin.x,y:Y.origin.y},aJ=[{x:az.x,y:az.y},{x:ay.x,y:ay.y}],aG,aH;az={x:af-Y.origin.x,y:Y.origin.y};aJ[0].x=af;ay.x=ah-Y.origin.x;aJ[1].x=ah;for(aN=0;aN<5;++aN){aG=aL+aN*aI;aH=-Math.tan(aG)*aK;aJ[0].y=Y.origin.y+az.x*aH;aJ[1].y=Y.origin.y+ay.x*aH;if(au(aG,aJ,"y",{min:ak,max:ap})){P(ao,aJ[0],aJ[1])}}aK=1/aK;az.y=ak-Y.origin.y;aJ[0].y=ak;ay.y=ap-Y.origin.y;aJ[1].y=ap;aL=3*aI;for(aN=0;aN<7;++aN){aG=aL-aN*aI;aH=-Math.tan(aG)*aK;aJ[0].x=Y.origin.x+az.y*aH;aJ[1].x=Y.origin.x+ay.y*aH;if(au(aG,aJ,"x",{min:af,max:ah})){P(ao,aJ[0],aJ[1])}}}}if(Y.shape==="polar"){V()}else{am()}ao.restore()},cleanup:function(X,V,W){}},AngleMarker:function(X,Z,ag){if(!ag.renderable){return}var ah=X.context,ae=ag.firstArc,W=ae.radius,af=ag.isRight,aa=af?Q:S,V=0.7071067811865475,ac=af?V:1,Y,ab,ad;ah.save();ah.globalAlpha*=ag.fadeOpacity;ah.strokeStyle=ag.color;ah.fillStyle=ag.color;ah.lineWidth=ag.width;ah.setLineDash(ag.lineDash||[]);for(Y=0;Y<ag.strokes;Y+=1){ab=W*ac+Y*(ag.radialSpacing+ag.width);ad="none";if(Y+1===ag.strokes&&ag["show-angle-direction"]){ad="head"}aa(ah,ae,ab,ag.width,ad,Y===0,ag.opacity)}ah.restore()},PathMarker:function(V,Z,ac){var ag=V.context,ad=ac["tick-mark-style"],Y=ac.metrics,X,W=Y.origin.copy(),af,ae,ab,aa;if(!ac.renderable){return}ag.save();ag.globalAlpha*=ac.opacity;ag.strokeStyle=ac.color;ag.fillStyle=ac.color;ag.lineWidth=ac.width;ag.setLineDash(ac.lineDash||[]);ag.lineCap="round";if(ad==="Crossbar"){for(X=0;X<ac.strokes;X+=1,W=W.add(Y.delta)){ag.beginPath();af=W.subtract(Y.normal);ae=W.add(Y.normal);ag.moveTo(af.x,af.y);ag.lineTo(ae.x,ae.y);ag.stroke()}}else{ab=y.GeometricPoint(-Y.normal.x-Y.normal.y,Y.normal.x-Y.normal.y);aa=y.GeometricPoint(-Y.normal.x+Y.normal.y,-Y.normal.x-Y.normal.y);for(X=0;X<ac.strokes;X+=1,W=W.add(Y.delta)){ag.beginPath();af=W.add(ab);ae=W.subtract(aa);ag.moveTo(af.x,af.y);ag.lineTo(W.x,W.y);ag.lineTo(ae.x,ae.y);if(ad==="OpenArrow"){ag.stroke()}else{if(ad==="HollowArrow"){ag.closePath();ag.stroke()}else{ag.fill()}}}}ag.restore()},ContinuousPointVector:function(V,X,ab){if(!ab.renderable){return}var ad=V.context,aa=ab.samples,ac=aa.length,ae,Y,Z=ac/2;function W(ag,af,am,al,aj,ah){var an=y.GeometricPoint(ag,af),ai=y.GeometricPoint(am,al),ak=ai.subtract(an).unit().multiply(aj);return R(an.add(ak),an,ah)}ad.save();ad.globalAlpha*=ab.opacity;ad.lineWidth=ab.width;if(ab.color){ad.strokeStyle=ab.color}G(ad,aa,ab.discontinuities,ab.colors,ab.closedPath);if(ab.leftEndpoint==="endpoint"){ae=y.GeometricPoint(aa[0],aa[1]);ad.fillStyle=ab.colors?ab.colors[0]:ab.color;L(ad,ae,ab.endpointRadius)}else{if(ab.leftEndpoint==="arrowhead"){ad.fillStyle=ab.colors?ab.colors[0]:ab.color;ad.strokeStyle=ab.colors?ab.colors[0]:ab.color;K(ad,W(aa[0],aa[1],aa[2],aa[3],ab.arrowheadRadius,ab.width),true)}}if(ab.rightEndpoint==="endpoint"){Y=y.GeometricPoint(aa[ac-2],aa[ac-1]);ad.fillStyle=ab.colors?ab.colors[Z-1]:ab.color;L(ad,Y,ab.endpointRadius)}else{if(ab.rightEndpoint==="arrowhead"){ad.fillStyle=ab.colors?ab.colors[Z-1]:ab.color;ad.strokeStyle=ab.colors?ab.colors[Z-1]:ab.color;K(ad,W(aa[ac-2],aa[ac-1],aa[ac-4],aa[ac-3],ab.arrowheadRadius,ab.width),true)}}ad.restore()},DiscretePointVector:function(Y,W,X){if(!X.renderable){return}var V=Y.context;V.save();V.globalAlpha*=X.opacity;if(X.color){V.fillStyle=X.color}H(V,X.samples,X.numSamples,X.radius,X.colors);V.restore()},SegmentVector:function(Y,Z,ae){if(!ae.renderable){return}var af=Y.context,ab,X=4,ad=ae.numSamples,ac,aa,W,V;af.save();af.globalAlpha*=ae.opacity;af.lineWidth=ae.width;af.strokeStyle=ae.color;af.setLineDash(ae.lineDash||[]);for(ab=0;ab<ad;ab++){ac=ae.samples[ab*X];aa=ae.samples[ab*X+1];W=ae.samples[ab*X+2];V=ae.samples[ab*X+3];if(ae.colors){af.strokeStyle=ae.colors[ab]}af.beginPath();af.moveTo(ac,aa);af.lineTo(W,V);af.lineCap="round";af.stroke()}af.setLineDash([]);af.restore()},ArcVector:function(V,X,ac){if(!ac.renderable){return}var ad=V.context,Y,W,Z=ac.numSamples,ab=ac.arcType,aa=(ab!=="arc");ad.save();ad.globalAlpha*=ac.opacity;if(aa){ad.fillStyle=ac.color}else{ad.lineWidth=ac.width;ad.strokeStyle=ac.color;ad.setLineDash(ac.lineDash||[])}for(Y=0;Y<Z;Y++){W=y.GeometricArc.FromPackedSampleArray(ac.samples,Y);if(ac.colors){if(aa){ad.fillStyle=ac.colors[Y]}else{ad.strokeStyle=ac.colors[Y]}}J(ad,W);if(ab==="arcSegment"){ad.closePath()}else{if(ab==="arcSector"){ad.lineTo(W.center.x,W.center.y);ad.closePath()}}if(aa){ad.fill()}else{ad.stroke()}}ad.setLineDash([]);ad.restore()},CircleVector:function(X,Z,af){if(!af.renderable){return}var ag=X.context,ab,V=3,ad=af.numSamples,ae=af.isInterior,W,aa,Y,ac;ag.save();ag.globalAlpha*=af.opacity;if(ae){ag.fillStyle=af.color}else{ag.lineWidth=af.width;ag.strokeStyle=af.color}ag.setLineDash(af.lineDash||[]);for(ab=0;ab<ad;ab++){W=ab*V;aa=af.samples[W];Y=af.samples[W+1];ac=af.samples[W+2];if(af.colors){if(ae){ag.fillStyle=af.colors[ab]}else{ag.strokeStyle=af.colors[ab]}}ag.beginPath();ag.arc(aa,Y,ac,0,Math.PI*2,true);if(ae){ag.fill()}else{ag.stroke()}}ag.setLineDash([]);ag.restore()},PolygonVector:function(W,X,ac){var ae=W.context,ab=ac.samples,ad,Z=ac.numVertices,aa=ac.numSamples,Y=0,V;if(!ac.renderable){return}ae.save();ae.fillStyle=ac.color;ae.globalAlpha*=ac.opacity;for(ad=0;ad<aa;ad++){if(ac.colors){ae.fillStyle=ac.colors[ad]}ae.beginPath();ae.moveTo(ab[Y],ab[Y+1]);Y+=2;for(V=1;V<Z;V++){ae.lineTo(ab[Y],ab[Y+1]);Y+=2}ae.closePath();ae.fill("evenodd")}ae.restore()},PictureVector:{prepare:I,draw:function(aa,V,Y){var Z=Y.transformSamples,W=Y.numSamples;for(var X=0;X<W;++X){Y.transform=y.AffineTransform.fromPackedSampleArray(Z,X);Y.clipPolygon=Y.clipPolygons&&Y.clipPolygons[X];N(aa,V,Y)}},cleanup:F}}}}());(function(){var J=b.userAgent.toLowerCase().indexOf("firefox")>-1,G={width:function(){return g(this.element).outerWidth()},height:function(){return g(this.element).outerHeight()},createAndAddElement:function(P,L){var N=I(P.layer,this.index);var O=L?' type="button"':"";var M=g('<div wsp-id="'+this.id+'" class="wsp-'+this.kind+'" data-index="'+this.index+'"'+O+"/>");var Q=M;if(L){Q=g('<div class="wsp-Button-label"></div>');Q.wrap('<div class="wsp-Button-label-frame"></div>');M.append(g('<span class="wsp-Button-row"><span class="wsp-Button-drag-handle"></span></span>').append(Q.parent()))}this.element=M;this.mfsElement=Q;M.css(this.css);M.hide();this.visible=false;M.appendTo(N);if(this.isEditableByCalculator){var K=y.getConfigValue("NumberpadManager.delegates.registerCalculatorElement");K(M)}return M},updateModelToViewTransform:function(K){var M=this.element,L;if(J&&K.isTranslation()){M.css({left:this.left+K.m20,top:this.top+K.m21})}else{L=K.toStringCSS();M.css({left:this.left,top:this.top,"-webkit-transform":L,"-ms-transform":L,transform:L})}},updateFromModel:function(L){var M,Q,P,K;if(L.parsedMFS&&(this.parsedMFS!==L.parsedMFS)){this.parsedMFS=L.parsedMFS;if(!g(".wsp-target",this.mfsElement).length&&L.isEditableByCalculator){K=g("<span/>").addClass("wsp-target");K.css({"z-index":1000,opacity:0,position:"absolute",left:0,top:0});this.mfsElement.append(K)}K=g(".wsp-target",this.mfsElement);K.width(0).height(0);this.mfsElement.children().not(".wsp-target").remove();this.valueMap=E(this.parsedMFS,this.mfsElement,this.fontTable,this.baseStyles)}if(L.MFSValues){H(this.valueMap,L.MFSValues,this.fontTable,this.baseStyles)}if(this.attrs["text-align"]==="center"){M=this.width()/2;P=L.x-M}else{P=L.x}if(this.attrs["vertical-align"]==="middle"){M=this.height()/2;Q=L.y-M}else{Q=L.y}if(this.attrs["vertical-align"]==="bottom"){var O=parseInt(g(this.element).css("padding-bottom"),10);var N=g(this.element).height();Q=L.y-(N-O)}this.left=P;this.top=Q}},F=Object.create(G);F.dragHandleWidth=function(){return g(".wsp-Button-drag-handle",this.element).outerWidth()};var D={createWithAttrs:function(N,M,K){var L=Object.create(K?F:G);L.id=N.id;L.index=M;L.kind=N.kind;L.isEditableByCalculator=N.isEditableByCalculator;L.fontTable=N.fontTable;L.attrs={"text-align":N["text-align"],"vertical-align":N["vertical-align"]};L.baseStyles={color:N.color,"font-family":N["font-family"],"line-height":N["line-height"],"font-style":N["font-style"],"font-weight":N["font-weight"],"font-size":N["font-size"],"text-decoration":N["text-decoration"],opacity:N.opacity};L.css={padding:N.padding};g.extend(L.css,L.baseStyles);if(K){L.attrs["highlight-color"]=N["highlight-color"];L.attrs["handle-color"]=N["background-color"]||"white"}return L}};function E(K,N,P,O){var L;try{L=y.mfs.makeHTMLFromMFSParseTree(K,N,P,O);return L}catch(M){y.signalCaughtError(M)}}function I(P,L){var N=g("*",P),K,M,O=P;for(K=0;K<N;K+=1){M=g(N[K]).data("index");if(M<L){O=N[K]}}return O}function H(M,K,N,P){var U,T,O,S=K.lastRealizedFrame,R=false,Q;if(M&&K){for(U in K){if(K.hasOwnProperty(U)&&M.hasOwnProperty(U)){T=M[U];for(O=0;O<T.length;O+=1){if(S&&S.hasOwnProperty(U)&&S[U]===K[U]){continue}if(K[U].type==="text"){Q=K[U].value;g(T[O]).text(Q)}else{T[O].empty();E(K[U],T[O],N,P)}R=true}}}}if(R){K.lastRealizedFrame=h;var L=g.extend(true,{},K);K.lastRealizedFrame=L}return R}y.draw.availableEngines.html={create:function(L){var K=L.rootNode,M=g('<div class="wsp-text-layer">').appendTo(g(K));M.css({width:"100%",height:"100%"});return{layer:M,textCt:0,modelToViewTransform:null}},destroy:function(K){},prepareFrame:function(M,L,N,K){M.modelToViewTransform=K},cleanupFrame:function(K){},clear:function(K){K.layer.remove()},primitives:{Text:{prepare:function(L,K){return D.createWithAttrs(K,L.textCt++)},draw:function(O,L,N){var M=L.element,K;if(!M&&(N.visibility==="visible")){M=L.createAndAddElement(O)}if(M){if(N.visibility==="visible"){if(N.constraintFrame!==L.constraintFrame){L.updateFromModel(N);L.constraintFrame=N.constraintFrame}L.updateModelToViewTransform(O.modelToViewTransform);M.toggleClass("wsp-text-target-highlight",N.targetHighlight===true);M.toggleClass("wsp-text-unmatched-given",N.pulse===true);M.css({opacity:N.opacity});if(!L.visible){M.show();L.visible=true}K=g(".wsp-target",M);K.width(M.width());K.height(M.height())}else{M.hide();L.visible=false}}},cleanup:function(M,K,L){g(K.element).remove()}},Button:{prepare:function(L,K){return D.createWithAttrs(K,L.textCt++,true)},draw:function(O,K,M){var L=K.element;if(!L&&(M.visibility==="visible")){L=K.createAndAddElement(O,true)}if(L){if(M.visibility==="visible"){if(M.constraintFrame!==K.constraintFrame){K.updateFromModel(M);K.constraintFrame=M.constraintFrame}K.updateModelToViewTransform(O.modelToViewTransform);L.toggleClass("wsp-appearance-active",!!M.isHighlight);L.toggleClass("wsp-appearance-pressed",!!M.inClick);L.toggleClass("wsp-appearance-drag",!!M.isDragging&&M.selectable);L.toggleClass("wsp-appearance-short",L.outerHeight()<28);L.toggleClass("wsp-appearance-unselectable",!M.selectable);L.css("opacity","");var N=L.css("opacity");N=N?parseFloat(N):1;N=isNaN(N)?1:N;L.css({opacity:M.opacity*N});g(".wsp-Button-drag-handle",L).css({"background-color":M["handle-color"]});if(!K.visible){L.show();K.visible=true}}else{L.hide();K.visible=false}}},cleanup:function(M,K,L){g(K.element).remove()}},Point:{prepare:function(M,L){var K={rendered:false,element:g('<div class="wsp-'+L.kind+'" id="'+L.id+'">&#x2b24;</div>')};K.element.css({visibility:"hidden"});return K},draw:function(R,M,O){var N=M.element,L=O.renderable?"visible":"hidden",Q,K,P;if(!M.rendered&&(L==="visible")){P=R.layer;M.rendered=true;g(P).append(N)}if(M.rendered){N.css({visibility:L})}if(O.renderable){Q=N.width();K=N.height();N.css({left:O.cx-(Q/2),top:O.cy-(K/2),color:O.color})}},cleanup:function(M,K,L){K.element.remove()}}}}}());y.Locale=(function(){return{current:null,locales:{}}})();y.Strings=(function(){return{format:function(D,G){var H=D,E,F=G.length;if(H&&F){for(E=0;E<F;++E){H=H.replace("%@",G[E])}}return H},fmt:function(D){var E=Array.prototype.slice.call(arguments,1);return y.Strings.format(D,E)},loc:function(E){var D=Array.prototype.slice.call(arguments,1),F=y.Locale.current&&y.Locale.current[E];if(F){F=y.Strings.format(F,D)}else{if(F==null){y.signalErrorWithMessage("Localized string "+E+" not found.","GSP.Error.localeStringNotFound");F=E}}return F}}})();y.Locale.locales.en={"GSP.Error.incompatibleSketchVersion":"Web Sketchpad version '%@' cannot load a document created for version '%@'.","GSP.Error.invalidSketchVersion":"Cannot compare WSP version '%@' with sketch version '%@'.","GSP.Error.invalidSketch":"The specified sketch appears to be empty or invalid.","GSP.Error.invalidSwitchPage":"The page requested doesn't exist.","GSP.Error.loadSketchFailed":"An error occurred when loading the sketch.","GSP.Error.invalidDocDelta":"The document delta could not be applied.","GSP.Error.invalidSketchDelta":"The sketch delta could not be applied.","GSP.Error.invalidGeomBounds":"Invalid geom bounds for object: %@ (%@)","GSP.Error.constraintException":"Error constraining object: %@ (%@)","GSP.Error.destroyObjectException":"Exception destroying object ('%@' (%@)): %@","GSP.Error.touchStartException":"Exception in Sketch.handleTouchStart (touch.identifier='%@')","GSP.Error.touchMoveException":"Exception in Sketch.handleTouchMove (touch.identifier='%@')","GSP.Error.touchEndException":"Exception in Sketch.handleTouchEnd (touch.identifier='%@')","GSP.Error.renderBoundsException":"Exception rendering object bounds ('%@' (%@))","GSP.Error.renderObjectException":"Exception rendering object ('%@' (%@)): %@","GSP.Error.renderLabelException":"Exception rendering object label ('%@' (%@)): %@","GSP.Error.renderPrepareException":"Exception in renderPrepare ('%@' (%@)): %@","GSP.Error.renderCleanupException":"Exception in renderCleanup ('%@' (%@)): %@","GSP.Error.invalidSketchStart":"Sketch.start called for running sketch","GSP.Error.invalidSketchResume":"Sketch.resume called for running sketch","GSP.Error.invalidSketchStop":"Sketch.stop called for stopped sketch","GSP.Measure.arcLength":"Length"};y.Locale.current=y.Locale.locales.en;y.Tool=(function(){function G(N,O){if(O.genus==="CoordSys"){O.kind="CoordSys";O.constraint="CoordSys"}var J=y.gobjPrototype(O.kind,O.constraint);var Q=J.createDefaultSpec&&J.createDefaultSpec(N,O);if(Q){var K=y.ObjectGraph.getNextFreeIdNumber(N.gobjList.constraintList);var P=y.ObjectGraph.convertObjectSpec(Q);P.forEach(function(R){R.id=""+K;++K});var I=y.ObjectGraph.createSpecFromGraph(P);var M=N.constructGObjects(I,{speculative:true,autoplace:true});g.each(M,function(R,S){S.invalidateGeom()});var L=P[P.length-1].id;return{constructedObjects:M,matched:M[L]}}}function E(N,I){var L=N.gobjList.constraintList;var M,J;if(I.genus==="CoordSys"){return N.findExistingCoordSys(I)}for(var K=L.length-1;K>=0;--K){J=L[K];if((J.genus===I.genus)&&(J.label===I.label)){if(!M&&J.style.hidden){M=J}else{return J}}}return M}var F={sketch:null,objectGraph:null,givenArray:null,completion:null,constructedObjects:null,resetPlayback:function(){var I=this;var K=y.ObjectGraph.copy(this.objectGraph);var L=K.filter(function(N){if(N.toolRole==="given"){delete N.toolRole;return true}return false});var J="toolplay"+Date.now();K.forEach(function(N){N.id+=J});if(!L||!L.length){throw y.createError("This tool has no givens")}this.givenArray=L;this.constructedObjects={};this.existingMatches={};var M=K.filter(function(N){if(N.toolRole==="assumed"){delete N.toolRole;return true}return false});M.forEach(function(O){var N=E(I.sketch,O);if(N){I.existingMatches[N.id]=N}else{var P=G(I.sketch,O);if(P){g.extend(I.constructedObjects,P.constructedObjects);N=P.matched}else{y.log("Missing non-constructable assumed");throw y.createError("Missing non-constructable assumed")}}O.id=N.id});this.assumedArray=M},_playGiven:function(O,J,Q,K){var V=g.extend(false,{},this.constructedObjects,this.existingMatches);var S=y.ObjectGraph.subgraphFromNode(O,V);var R={};if(J){S=S.filter(function(X){return X!==O})}var I=this.sketch.gobjList.constraintList;var P=y.ObjectGraph.getNextFreeIdNumber(I);S.forEach(function(X){X.id=""+P;R[X.id]=X;++P});var W=(!O.label)&&((O.genus==="Function")||(O.style.nameOrigin==="namedFromLabel"));if(W){O.label=this.sketch.labelPool.generateLabel(O.kind,O.genus);if(!this.generatedLabels){this.generatedLabels={}}this.generatedLabels[O.id]=true}var N={};var M=y.ObjectGraph.createSpecFromGraph(S);var U=O.id;if(!J){M[U].geom={loc:{x:Q.x,y:Q.y}};var T={};T[U]=M[U];delete M[U];N=this.sketch.constructGObjects(T,{autoplace:true})}var L=this.sketch.constructGObjects(M,{speculative:K,autoplace:true});g.extend(this.constructedObjects,N,L);return this.sketch.gobjList.gobjects[U]},playAssumeds:function(){var I=this.assumedArray.shift();while(I){this._playGiven(I,true,null,true);I=this.assumedArray.shift()}if(this.completion&&this.isComplete()){this.completion()}},getNextGiven:function(){return this.givenArray.shift()},playGiven:function(K,I,J){if(!this.labelStateSaved){this.sketch.labelPool.saveState();this.labelStateSaved=true}var L=this._playGiven(K,false,I,J);if(this.completion&&this.isComplete()){this.completion()}return L},addCompletionHandler:function(I){this.completion=I},getLegalMatchesForGiven:function(N,L){var K=N.kind,J=N.isFunction?N.isFunction():false;function I(P){if(!P){return false}switch(K){case"Point":return(P.kind==="Point")||P.isAPath();case"Expression":if(P.isOfKind("Measure")){var O=P.isFunction?P.isFunction():false;return O===J}if((P.constraint==="Pegged")&&(P.parents.text.isOfKind("Measure"))){return true}return false;default:return false}}var M=L||this.sketch.gobjList.renderList;return M.filter(I)},isComplete:function(){return this.givenArray.length===0},updateGivenId:function(J,I){if(this.constructedObjects[J]){this.constructedObjects[I]=this.constructedObjects[J];this.constructedObjects[I].id=I;delete this.constructedObjects[J]}},mergeGObjStyles:function(I,J){if(J.style.traced){I.style.traced=J.style.traced}},mergeGivenToExisting:function(J,I){if(J.constraint==="Pegged"){J=J.parents.text}this.sketch.gobjList.mergeToGObj(J,I,this.sketch);if(this.generatedLabels&&this.generatedLabels[I.id]){this.sketch.labelPool.restoreSavedState();this.sketch.labelPool.saveState();this.generatedLabels[I.id]=false}this.updateGivenId(I.id,J.id);this.mergeGObjStyles(J,I);J.invalidateGeom();return J},_mergeGObjToSpecGObj:function(N,J){var L=this.sketch.gobjList;var M={};var K=""+y.ObjectGraph.getNextFreeIdNumber(L.constraintList),I;M[K]=J;this.sketch.constructGObjects(M);I=L.gobjects[K];this.mergeGivenToExisting(I,N);I.invalidateGeom();return I},putGivenOnPath:function(L,J){var K=L.mapPositionToPathValue(J.geom.loc);var I={kind:"Point",genus:"PointOnPath",parents:{path:L.id},value:K,constraint:"PointOnPath",label:J.label,style:J.style};return this._mergeGObjToSpecGObj(J,I,this.sketch)},abortPlayback:function(){this.matchedGivens.forEach(function(I){I.clearAllExistingMatches()});this.sketch.gobjList.removeGObjects(this.constructedObjects,this.sketch);this.constructedObjects={};if(this.labelStateSaved){this.labelStateSaved=false;this.sketch.labelPool.restoreSavedState();this.generatedLabels=h}},confirmPlayback:function(){var I=this,J;this.matchedGivens.forEach(function(L){L.finalize(I)});this.matchedGivens=[];for(var K in this.constructedObjects){J=this.constructedObjects[K];J.setRenderState("none")}this.constructedObjects={};if(this.labelStateSaved){this.labelStateSaved=false;this.sketch.labelPool.forgetSavedState();this.generatedLabels=h}},putGivenOnIntersection:function(J,K){function L(O,N){var M={kind:"Point",constraint:O.constraint,genus:"Intersection",label:N.label,style:N.style};switch(O.constraint){case"Intersection":M.parents={line0:O.path1.id,line1:O.path2.id};break;case"Intersection1":case"Intersection2":M.parents={circle:O.path1.id,obj:O.path2.id};break;default:throw y.createError("tool.putGivenOnIntersection() asked to create unsupported intersection constraint")}return M}var I=L(J,K);return this._mergeGObjToSpecGObj(K,I,this.sketch)}};var H={objectGraph:null,$element:null,createSession:function(J){var I=Object.create(F);I.sketch=J;I.objectGraph=this.objectGraph;I.givenArray=[];I.constructedObjects={};I.matchedGivens=[];I.resetPlayback();return I}};var D={given:null,mergeCandidate:null,intersectInfo:null,clearAllExistingMatches:function(){if(this.intersectInfo){this.intersectInfo.path1.setRenderState("none");this.intersectInfo.path2.setRenderState("none");this.intersectInfo=null}if(this.mergeCandidate){this.mergeCandidate.setRenderState("none");this.mergeCandidate=null}},snapGivenValue:function(){var I;if(this.mergeCandidate.isOfKind("Measure")){I=this.mergeCandidate}else{if(this.mergeCandidate.constraint==="Pegged"){I=this.mergeCandidate.parents.text}}if(I){if(this.given.isParameter&&this.given.isParameter()){if(this.originalValue===h){this.originalValue=this.given.value;this.originalBlank=this.given.blank}this.given.updateValue(I.value);this.given.blank=I.blank}else{y.log("Function/Calculation matching does not yet support assuming appearance of tentative matches - cf WSP-1512")}}},unsnapGivenValue:function(){if(this.originalValue!==h){this.given.updateValue(this.originalValue);this.given.blank=this.originalBlank;this.originalValue=h;this.originalBlank=h}},setMergeCandidate:function(J){if(J===this.mergeCandidate){return}var I=this.given.isOfKind("Text");this.clearAllExistingMatches();if(J){if(J.isAPath()){this.given.setRenderState("matchedGiven")}else{this.given.setRenderState("invisible")}J.setRenderState("targetHighlit");this.mergeCandidate=J;if(I){this.snapGivenValue()}}else{this.given.setRenderState("matchedGiven");if(I){this.unsnapGivenValue()}}},setIntersectInfo:function(I){this.clearAllExistingMatches();I.path1.setRenderState("targetHighlit");I.path2.setRenderState("targetHighlit");this.intersectInfo=I},getSnappedPosition:function(I){if(this.intersectInfo){return this.intersectInfo.location}else{if(this.mergeCandidate){if(this.mergeCandidate.kind==="Point"){return this.mergeCandidate.geom.loc}else{if(this.mergeCandidate.isAPath()){return this.mergeCandidate.mapPathValueToPosition(this.mergeCandidate.mapPositionToPathValue(I))}else{if(this.mergeCandidate.isOfKind("Text")){return this.mergeCandidate.geom.loc}}}}}return I},completeMatch:function(){if(this.intersectInfo){this.intersectInfo.path1.setRenderState("none");this.intersectInfo.path2.setRenderState("none")}if(this.mergeCandidate){if(this.mergeCandidate.isAPath()){this.mergeCandidate.setRenderState("none")}else{this.mergeCandidate.setRenderState("matchedGiven")}}},finalize:function(J){if(this.intersectInfo){J.putGivenOnIntersection(this.intersectInfo,this.given)}else{if(this.mergeCandidate){var I=this.mergeCandidate;if(I.kind==="Point"||I.isOfKind("Text")){J.mergeGivenToExisting(I,this.given)}else{if(I.isAPath()){J.putGivenOnPath(I,this.given)}}}}this.clearAllExistingMatches()}};return{createWithSpec:function(I){var J=Object.create(H);var M=I.objects;J.metadata=g.extend(true,{},I.metadata);var L=false;for(var K in M){if(M.hasOwnProperty(K)&&(M[K].toolRole==="given")){L=true;break}}if(!L){throw new y.createError("Attempting to create a tool with no givens")}J.objectGraph=y.ObjectGraph.convertObjectSpec(g.extend(true,{},M));return J},createMatchedGiven:function(J){var I=Object.create(D);I.given=J;J.setRenderState("matchedGiven");return I}}}());y.ToolController=(function(){var D={_clearOutActiveTool:function(){if(this.activeTool){this.activeTool.$element.removeClass("wsp-tool-active");this.activeTool=null}this.sketch.canvasNode.toggleClass("wsp-tool-background",false);if(this.$closeBox){this.$closeBox.remove();this.$closeBox=null}if(this.$okBox){this.$okBox.remove();this.$okBox=null}},abortActiveTool:function(){var E=this.activeRegime;if(E){this.sketch.popAllTouchRegimesIncluding(E)}},confirmActiveTool:function(){if(this.activeTool){this.activeTool.$element.removeClass("wsp-tool-active");var E=this.activeRegime;if(E){E.toolplaySession.confirmPlayback();E.toolplaySession=null;this.sketch.popAllTouchRegimesIncluding(E)}else{y.log("confirmActiveTool called when there is no active tool regime")}}},regimeDidPop:function(E){if(E!==this.activeRegime){y.log("regimeDidPop called with wrong active regime");return}this.activeRegime=null;if(E.toolplaySession){E.toolplaySession.abortPlayback();E.toolplaySession=null}this._clearOutActiveTool()},setActiveTool:function(I){var K;this.activeTool=I;I.$element.addClass("wsp-tool-active");try{var G=this;var E=!this.$closeBox;K=y.ToolRegime.createWithTool(G.sketch,I);K.delegate=G;this.sketch.pushTouchRegime(K);this.activeRegime=K;if(E){var J=g("<div></div>");var F=this.sketch.baseNode.find(".wsp-transform-node");F.append(J);J.addClass("wsp-tool-cancel");J.on("click",function(){if(G.sketch.currentTouchRegime()!==K){return}G.abortActiveTool();y.blurDocumentActiveElement(G.sketch.baseNode)});this.$closeBox=J;var H=g("<div></div>");F.append(H);H.addClass("wsp-tool-ok");H.on("click",function(){if(G.sketch.currentTouchRegime()!==K){return}y.blurDocumentActiveElement(G.sketch.baseNode);G.confirmActiveTool()});this.$okBox=H}this.sketch.canvasNode.toggleClass("wsp-tool-background",true)}catch(L){if(K&&K.isPushed){this.abortActiveTool()}else{this._clearOutActiveTool()}}},toggleTool:function(E){var F=this.sketch.currentTouchRegime();var H=((F.name==="DisplayRegime")||(F.name==="ToolRegime"));if(!H){return false}y.blurDocumentActiveElement(this.sketch.baseNode);var G=this.activeTool;if(G){this.abortActiveTool();if(G===E){return true}}this.setActiveTool(E);return true}};return{createInSketch:function(F){var E=Object.create(D);E.sketch=F;return E}}}());y.Genus=(function(){return{}}());y.genera.Path=y.makeClass(y.Genus,{genus:"Path",mapPositionToPathValue:function(D){throw y.createError("mapPositionToPathValue not Implemented")},mapPathValueToPosition:function(D){throw y.createError("mapPathValueToPosition not Implemented")},mapVectorPathValuesToPositions:function(E){var G,D=E.length,F=[];for(G=0;G<D;G++){F[G]=this.mapPathValueToPosition(E[G])}return F},getAnimationRange:function(){return{min:0,max:1}},unitLength:function(){return this.pathLength()},constrainRange:function(D){return D},isValueInBounds:function(D){return y.math.isFiniteScalar(D)},pathLength:function(){throw y.createError("pathLength not Implemented")},constrainLabel:function(){var D=this.style.label,E=this.state,F=D.labelParam;if(typeof F==="undefined"){F=0.5}if(E.exists&&D.showLabel){this.labelSpec.location=this.mapPathValueToPosition(F);this.labelSpec.text=this.label||this.text||this.id}},setLineDash:function(D){y.modifyRenderAttrsForLineStyle(this.style["line-style"],D);return D},openMotionPathProto:{advance:function(F){var E=this.start,D=this.path.unitLength(),G=F/D;if(this.start<this.end){E=Math.min(this.end,this.start+G)}else{if(this.end<this.start){E=Math.max(this.end,this.start-G)}}return E},getDistance:function(){return Math.abs(this.end-this.start)*this.path.pathLength()}},closedMotionPathProto:{getArcLength:function(){var D=this.end-this.start;if(D>0.5){D-=1}if(D<-0.5){D+=1}return D},advance:function(G){var E=this.start,D=this.path.pathLength(),H=G/D,F=this.getArcLength();if(Math.abs(F)<H){E=this.end}else{if(F<0){E=E-H}else{E=E+H}}E-=Math.floor(E);return E},getDistance:function(){return Math.abs(this.getArcLength())*this.path.pathLength()}},makeMotionPath:function(F,D){var E=Object.create(this.closedPath?this.closedMotionPathProto:this.openMotionPathProto);E.path=this;E.start=F;E.end=D;return E},pathValidationString:function(D){var G="",F=this;function H(I){if(!I){return y.GeometricPoint.UNDEFINED}return y.GeometricPoint(I.x,I.y)}function E(M,K,I){var J=(M&&M.isDefined()&&M.isFinite()),L=(K&&K.isDefined()&&K.isFinite());if(J&&L){return y.GeometricPoint.expect(M,K,I)}else{return J===L}}[{name:"Zero",value:0,expectedPosition:D.zeroPosition,expectedDerivative:D.zeroDerivative},{name:"Middle",value:0.5,expectedPosition:D.middlePosition,expectedDerivative:D.middleDerivative},{name:"One",value:1,expectedPosition:D.onePosition,expectedDerivative:D.oneDerivative}].forEach(function(K){var N,M,J={},L=H(K.expectedPosition),I=H(K.expectedDerivative);N=F.mapPathValueToPosition(K.value,J);M=J.derivative;if(!E(N,L)){G+=K.name+' Path Position: <span class="error">'+N+'</span>(<span class="expected">'+L+"</span>)"}if(I&&I.l1Norm()<100&&!E(M,I,1)){G+=K.name+' Path Derivative: <span class="error">'+M+'</span>(<span class="expected">'+I+"</span>)"}});return G}});y.genera.Point=(function(){var D=Object.create(y.Genus);return D}());y.genera.Interior=y.makeClass(y.Genus,{genus:"Interior",modifyRenderAttrsForInterior:function(D){switch(this.state.renderState){case"speculative":D.color=y.speculativeColor;break;case"targetHighlit":D.drawBorder=true;D.borderColor=y.targetHighlightColor;D.borderWidth=3+y.targetHighlightPathBolding;break;default:break}}});y.mixins.labelBase={doc:{properties:{label:{description:"Text for the label, if any.",type:"String"},style:{properties:{label:{description:"Properties that influence the appearance of a Label. Overrides of the GObject style, and as follows.",properties:{color:{description:"The color of label text",type:"Color"},"font-family":{description:"The basis font family for text in this GObject. See GSP.getFontFamilyFromStyle() for supported formats.",type:"FontFamily"},"font-size":{description:"The basis font size for text in this GObject",type:"FontSize"},"font-style":{description:"The basis font style (slant) for text in this GObject",type:"FontStyle"},"font-weight":{description:"The basis font weight (boldness) for text in this GObject",type:"FontWeight"},labelOffsetX:{description:"Horizontal offset of the upper left corner of the label, in pixels.",type:"Number",required:false},labelOffsetY:{description:"Vertical offset of the upper left corner of the label, in pixels.",type:"Number",required:false},labelParam:{description:"Position on the path where a label will be placed.",type:"Number",required:false},"letter-spacing":{description:"The basis font letter spacing for text in this GObject",type:"LetterSpacing"},showLabel:{description:"Whether or not a label should accompany the gObject.",type:"Boolean"},"text-decoration":{description:"line-through, underlines, and other variations on the label text",type:"TextDecoration"}}}}}}},style:{label:{}}};y.mixins.label=y.makeClass(y.mixins.labelBase,{getLabelSpec:function(){return !g.isEmptyObject(this.labelSpec)?this.labelSpec:h},getLabelBounds:function(D){return this.labelRenderBounds||y.Geom.kInfiniteRect},renderLabelPrepare:function(G,F){if(!this.hasLabel){return}var E=y.getFontFamilyFromStyle(this.style.label,this.sQuery()),D=this.style.label;F.id=String(this.id)+"-label";F.kind="Label";F.color=D.color;F["font-family"]=E;F["font-style"]=D["font-style"];F["font-weight"]=D["font-weight"];F["font-size"]=D["font-size"];F["text-decoration"]=D["text-decoration"];F["text-align"]="left";return G.prepareText(F)},renderLabel:function(F,H,D){if(!this.hasLabel){return}var J=this.style.label,I=this.labelSpec.location||this.geom.loc,G=this.isRenderable()&&this.style.label.showLabel,E=G?"visible":"hidden",N=this.getMathItalicization(),M,L;if(G){M=I.x+J.labelOffsetX;L=I.y+J.labelOffsetY}if(G&&!this.parsedMFS){try{if(this.label){this.parsedMFS=y.labels.parseLabelExpression(this.label,N)}else{this.parsedMFS=this.getNameMFSForLabel()}}catch(K){K.message='Error parsing label: "'+this.label+'": '+K.message;y.signalCaughtError(K)}}F.drawText(H,{x:M,y:L,renderable:G,visibility:E,opacity:this.calculateFadeOpacity(),parsedMFS:this.parsedMFS,label:this.label,useDrawImage:false,constraintFrame:this.state.constraintFrame});if(G){this.labelRenderBounds=H.renderBounds}},renderLabelCleanup:function(E,D){E.cleanupText(D)}});y.mixins.transformable={doc:{},getTransform:function(){return function(D){return D.copy()}},getScalarTransform:function(){return function(D){return D}},getTransformer:function(){if(!this.state.transformer){this.state.transformer=this.getParent("source").createTransformer(this)}return this.state.transformer}};y.createFloatVector=function(D){if(D>0){return l.Float64Array?new Float64Array(D):new Array(D)}else{return[]}};y.mixins.vector={doc:{},createVectorContext:function(E,D,F){throw y.createError("createVectorContext not Implemented")},resetVectorSamples:function(D){D.geomBounds=null;D.filledSampleCount=0},fillSingleSample:function(E,D){throw y.createError("fillSingleSample not Implemented")},getGeomBoundsVector:function(D){return{left:Number.NEGATIVE_INFINITY,top:Number.NEGATIVE_INFINITY,right:Number.POSITIVE_INFINITY,bottom:Number.POSITIVE_INFINITY}},hitTestVector:function(E,D){throw y.createError("hitTestVector not Implemented")},getVectorRenderingLayer:function(D){throw y.createError("getVectorRenderingLayer not Implemented")},renderVector:function(H,D,E,G,F){throw y.createError("renderVector not Implemented")},prepareVectorRendering:function(F,E,D){throw y.createError("prepareVectorRendering not Implemented")},cleanupVectorRendering:function(E,D){throw y.createError("cleanupVectorRendering not Implemented")},positionToPathValueForVector:function(E,D){y.signalErrorWithMessage("path API called on a non-path object vector")},pathLengthForVector:function(D){y.signalErrorWithMessage("path API called on a non-path object vector")}};y.mixins.pointVector=y.makeClass(y.mixins.vector,{doc:{},isPathSampleGObj:true,createVectorContext:function(E,D,F){return{numSamples:E,samples:y.createFloatVector(E*2),colors:F?[]:null,lineWidth:D.style.width,radius:D.style.radius||4,endpointRadius:D.style.endpointRadius,arrowheadRadius:D.style.arrowheadRadius,closedPath:D.closedPath,isContinuous:true,isDiscrete:(D.kind==="IterateImage")?true:D.isDiscrete,discontinuities:[]}},fillSingleSample:function(F,D){var E=2*D;F.filledSampleCount++;if(this.state.exists){F.samples[E]=this.geom.loc.x;F.samples[E+1]=this.geom.loc.y;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRectPoint(F.geomBounds,this.geom.loc)}else{F.samples[E]=h;F.samples[E+1]=h}},getGeomForSample:function(F,D){var E=2*D;return{loc:y.GeometricPoint(F.samples[E],F.samples[E+1])}},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=Math.max(D,E.lineWidth/2)}if(E.radius){D=Math.max(D,E.radius)}if(E.endpointRadius){D=Math.max(D,E.endpointRadius)}if(E.arrowheadRadius){D=Math.max(D,E.arrowheadRadius)}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(G,F){function E(){var L,K=G.filledSampleCount,I=2,J=G.samples,H=G.radius||G.lineWidth/2;for(L=0;L<K;L++){var M={left:J[L*I]-H,right:J[L*I]+H,top:J[L*I+1]-H,bottom:J[L*I+1]+H};if(!(M.right<F.left||M.left>F.right||M.bottom<F.top||M.top>F.bottom)){return true}}return false}function D(){var M,L=G.filledSampleCount*2,O,J=G.samples,N=y.GeometricPoint(J[0],J[1]),I=G.discontinuities,K,H;K=N;if(y.Geom.PointInRect(K,F)){return true}for(M=2,O=1;M<L;M+=2,O++){H=y.GeometricPoint(J[M],J[M+1]);if(y.Geom.PointInRect(H,F)){return true}if(!I[O]&&K.isFinite()&&H.isFinite()&&y.Geom.SegmentSectsRect(F,K,H)){return true}K=H}if(G.closedPath&&!I[O]&&K.isFinite()&&N.isFinite()&&y.Geom.SegmentSectsRect(F,K,N)){return true}}if(G.isDiscrete){return E()}else{return D()}},getVectorRenderingLayer:function(D){if(D.isDiscrete){return"DiscretePointVectors"}else{return"LinesCurves"}},prepareVectorRendering:function(F,E,D){if(E.isDiscrete){return F.prepareDiscretePointVector(D)}else{return F.prepareContinuousPointVector(D)}},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=G.suppressParametricColor?h:H.colors;G.numSamples=H.filledSampleCount;G.radius=H.radius;if(H.isDiscrete){return I.drawDiscretePointVector(D,G)}else{G.discontinuities=H.discontinuities;G.closedPath=H.closedPath;G.width=F.width||1;return I.drawContinuousPointVector(D,G)}},cleanupVectorRendering:function(F,D,E){if(E.isDiscrete){return F.cleanupDiscretePointVector(D)}else{return F.cleanupContinuousPointVector(D)}},positionToPathValueForVector:function(G,M){var L=G.samples,K=G.numSamples,I=G.closedPath,N=I?K:K-1,E,J;function D(){var R,O,Q,T,S,P;for(R=0;R<K;R++){if(!(y.math.isFiniteScalar(L[R*2])&&y.math.isFiniteScalar(L[R*2+1]))){continue}T=L[R*2]-M.x;S=L[R*2+1]-M.y;O=T*T+S*S;if((Q===h)||(O<Q)){Q=O;P=R}}return{point:y.GeometricPoint(L[P*2],L[P*2+1]),index:P}}function F(R,Q){var P=R.getX()-Q.getX(),O=R.getY()-Q.getY();return P*P+O*O}function H(aa){var R=E.point,U=E.index,S=G.discontinuities,Q=1/N,Z,ac,Y,ab,X,T,O,W,P,V;O=M.subtract(aa);if(U>0){Z=(U-1)*2;P=U}else{if(I){Z=(K-1)*2;P=G.numSamples}}if((Z!==h)&&(!S[P])){Y=y.GeometricPoint(L[Z],L[Z+1]);if(Y.isFinite()){Y=Y.subtract(R)}else{Y=h}}if(U<(K-1)){ac=(U+1)*2;P=U+1}else{if(I){ac=0;P=K}}if((ac!==h)&&(!S[P])){ab=y.GeometricPoint(L[ac],L[ac+1]);if(ab.isFinite()){ab=ab.subtract(R)}else{ab=h}}if(ab&&Y){if(F(ab,O)<F(Y,O)){X=true}else{T=true}}else{if(ab){X=true}else{if(Y){T=true}}}if(X){W=ab.vLength2();if(W){V=ab.dot(O)/ab.vLength2();V=Math.min(Math.max(0,V),1)}}else{if(T){W=Y.vLength2();if(W){V=-Y.dot(O)/Y.vLength2();V=Math.min(Math.max(-1,V),0)}}}V=V?V:0;return V*Q}E=D();J=(E.index/N)+H(E.point);if(J<0){J+=1}return J},pathLengthForVector:function(D){var J=0,E,I=D.samples,G=D.numSamples,L,K,H=I[0],F=I[1],N,M;for(E=1;E<G;E++){L=I[2*E];K=I[2*E+1];if(!(y.math.isFiniteScalar(L)&&y.math.isFiniteScalar(K))){continue}N=L-H;M=K-F;J+=Math.sqrt(N*N+M*M);H=L;F=K}return J},isDiscontinuous:function(N,L,K,J){var E=N<0?-N:N,D=L<0?-L:L,H=K<0?-K:K,F=J<0?-J:J,M=25;if(!(((E>M)&&((N>0&&K<=0)||(N<0&&K>=0)||(H>0&&(H*8)<E)))||((D>M)&&((L>0&&J<=0)||(L<0&&J>=0)||(F>0&&(F*8)<D))))){return false}if(((H!==0)&&(E>10*H))||((F!==0)&&(D>10*F))){return true}if((H===0)&&(F===0)){return true}var I=N*K+L*J,G=L*K-N*J;G=G<0?-G:G;return(I<0)||(3*G>5*I)},recomputeDiscontinuities:function(G){if(G.isDiscrete){return}var J=G.samples,I=G.numSamples,H=[],L,K,R,Q,E,D,P,O,F,N,M=false;for(F=0;F<I;++F){L=J[2*F];K=J[2*F+1];N=!(isNaN(L)||isNaN(K));if(N){if(M){R=L-E;Q=K-D;if(this.isDiscontinuous(R,Q,P,O)){H[F]="discontinuous"}else{H[F]=false;if((H[F-1]!=="nonexisting")&&!this.isDiscontinuous(P,O,R,Q)){H[F-1]=false}else{H[F-1]="discontinuous"}}P=R;O=Q}else{P=0;O=0}M=true;E=L;D=K}else{H[F]="nonexisting";M=false;P=0;O=0}}if(G.closedPath){L=J[0];K=J[1];if(!(isNaN(L)||isNaN(K))&&M){R=L-E;Q=K-D;H[F]=this.isDiscontinuous(R,Q,P,O)}}G.discontinuities=H}});y.mixins.circleVector=y.makeClass(y.mixins.vector,{doc:{},createVectorContext:function(E,D,G){var F=(this.kind==="CircleInterior");return{numSamples:E,samples:y.createFloatVector(E*3),colors:G?[]:null,isInterior:F,lineWidth:F?h:D.style.width}},fillSingleSample:function(F,D){var E=3*D;F.filledSampleCount++;F.samples[E]=this.geom.c.x;F.samples[E+1]=this.geom.c.y;F.samples[E+2]=this.geom.r;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRects(F.geomBounds,y.Geom.insetRect({left:this.geom.c.x,top:this.geom.c.y,right:this.geom.c.x,bottom:this.geom.c.y},-this.geom.r))},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(J,O){var H,D=3,N=J.samples,K=J.filledSampleCount,M=J.isInterior,E,L,G,F,I;for(H=0;H<K;H++){E=H*D;G=N[E];F=N[E+1];I=N[E+2];L=y.GeometricPoint(G,F);if(y.Geom.RectIntersectsCurve(O,{type:M?"circleInterior":"circle",curve:y.GeometricArc.FromCenterAndRadius(L,I)})){return true}}return false},getVectorRenderingLayer:function(D){return D.isInterior?"ExternalImagesAndInteriors":"LineLoci"},prepareVectorRendering:function(F,E,D){return F.prepareCircleVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.isInterior=H.isInterior;G.numSamples=H.filledSampleCount;return I.drawCircleVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupCircleVector(D)}});y.mixins.arcVector=y.makeClass(y.mixins.vector,{doc:{},createVectorContext:function(E,D,G){var F;switch(this.genus){case"SimpleArc":F="arc";break;case"ArcSector":F="arcSector";break;case"ArcSegment":F="arcSegment";break}return{numSamples:E,samples:y.createFloatVector(E*y.GeometricArc.packedSampleSize),colors:G?[]:null,lineWidth:D.style.width,isInterior:(this.genus!=="SimpleArc"),type:F}},fillSingleSample:function(F,D){var E=this.geom.arc;E.packIntoSampleArray(F.samples,D);F.filledSampleCount++;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRects(F.geomBounds,this.getGeomBounds())},getGeomBoundsVector:function(E){var D=1.5;if(E.geomBounds){if(E.lineWidth){D+=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(J,I){var G,F,E=J.samples,D=J.filledSampleCount,H=J.type;for(G=0;G<D;G++){F=y.GeometricArc.FromPackedSampleArray(E,G);if(y.Geom.RectIntersectsCurve(I,{type:H,curve:F})){return true}}return false},getVectorRenderingLayer:function(D){return D.isInterior?"ExternalImagesAndInteriors":"LineLoci"},prepareVectorRendering:function(F,E,D){return F.prepareArcVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.arcType=H.type;G.numSamples=H.filledSampleCount;return I.drawArcVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupArcVector(D)}});y.TouchManager=(function(){var D={};return{registerTouchWithTracker:function(F,E){D[F]=E},trackerForTouch:function(E){return D[E]},deregisterTouch:function(E){D[E]=h}}}());y.TouchRegime=(function(){return{delegate:null,isPushed:false,createTracker:function(E,D){throw y.createError("Unimplemented required method: createTracker")},hitSlopForTouch:function(D){return(D.mouseEvent!==h)?5:15}}}());y.TouchTracker={forwardTouchToSystem:false,touchBegan:function(D){},touchMoved:function(D){},touchEnded:function(){},touchCancelled:function(D){}};(function(){var D=null;y.DoubleTapTracker={startTime:null,doubleTapClickLength:500,doubleTapDelay:500,registerAsPossibleDoubleTap:function(){this.startTime=new Date().getTime();if(D&&D.endTime&&!D.maybeDouble&&(D.endTime-D.startTime<this.doubleTapClickLength)&&(this.startTime-D.endTime<this.doubleTapDelay)){this.maybeDouble=true}D=this},isDoubleTap:function(){this.endTime=new Date().getTime();if(this.maybeDouble&&(this.endTime-this.startTime<this.doubleTapClickLength)){D=null;return true}return false}}})();y.DisplayRegime=(function(){var D=y.makeClass(y.TouchRegime,{sketch:null,name:"DisplayRegime",createTracker:function(J,I){var G,E,F,H=true;G=this.hitSlopForTouch(J);E=this.sketch.hitGObj({left:I.x-G,top:I.y-G,bottom:I.y+G,right:I.x+G},{hotSpot:I});if(E.customTracker&&E.customTracker.forwardTouchToSystem){H=false}if(H){y.blurDocumentActiveElement(this.sketch.baseNode)}F=E.hitGObj;if(F){return E.customTracker||y.DragTracker.create(F)}else{return this.sketch.Scroll.createTracker()}}});return{createInSketch:function(F){var E=Object.create(D);E.sketch=F;return E}}}());y.DragTracker=(function(){function D(K){var H,G=this.controlList,J=this.tracker.sketch,I=this.tracker.motionId;if(K){H=new y.AffineTransform({m00:1,m11:1,m20:K.transform.dx,m21:K.transform.dy});J.MotionManager.ApplyTransformToControlList(J,H,G,{snapPoints:true,onPathTracksIdealLoc:true});J.MotionManager.UpdateRefCon(I,null)}}function E(){var G=this;g.each(this.controlList,function(H,I){if(I.isController){I.gobj.transformComplete(I.gobj.sQuery.sketch,G.tracker);I.gobj.sQuery.sketch.invalidateGeom(I.gobj)}})}var F=y.makeClass([y.TouchTracker,y.DoubleTapTracker],{gobj:null,origX:null,origY:null,lastX:null,lastY:null,sketch:null,motionId:null,touchBegan:function(J,I){this.origX=this.lastX=J.x;this.origY=this.lastY=J.y;this.registerAsPossibleDoubleTap();var H=this.bap.createControlList([this.gobj]);var G={applyMotion:D,completeMotion:E,controlList:H,tracker:this};this.motionId=this.motionManager.StartMotion(G);this.sketch.event("StartDrag",{gobj:this.gobj,position:J,touch:I});this.sketch.invalidateGeom(this.gobj);this.gobj.dragDidStart()},touchMoved:function(K,J){var I={transform:{dx:K.x-this.lastX,dy:K.y-this.lastY},x:K.x,y:K.y},H=this.motionId,G=this.motionManager.GetRefCon(H);if(G){I.transform.dx+=G.transform.dx;I.transform.dy+=G.transform.dy}this.motionManager.UpdateRefCon(H,I);this.sketch.event("MoveDrag",{gobj:this.gobj,position:K,touch:J});this.lastX=K.x;this.lastY=K.y},touchEnded:function(G){this.sketch.event("EndDrag",{gobj:this.gobj,touch:G});this.motionManager.EndMotion(this.motionId);this.sketch.invalidateGeom(this.gobj);this.gobj.dragDidEnd();if(this.isDoubleTap()){this.gobj.doubleClicked(G)}}});return{create:function(I,H){var G=Object.create(F);var J=I.sQuery.sketch;G.gobj=I;G.sketch=J;G.bap=J.Bap;G.motionManager=J.MotionManager;G.element=H;return G}}}());y.ToolRegime=(function(){function H(O,N,P,M){var L,K={hotSpot:P,gobjArray:N};L=O.hitGObj({left:P.x-M,top:P.y-M,bottom:P.y+M,right:P.x+M},K);return L?L.hitGObj:null}function G(K){return K.isOfKind("Circle")||K.isOfKind("Straight")||K.isOfKind("Arc")}function D(ab,N,Q,S,Z){if(!G(N)){return}var R,O={hotSpot:S,gobjArray:Q.filter(function(ad){return ad!==N}),filter:G};R=ab.hitGObj({left:S.x-Z,top:S.y-Z,bottom:S.y+Z,right:S.x+Z},O);var M=R.hitGObj;if(M){var U=N.isOfKind("Straight");var V=M.isOfKind("Straight");var Y=U?N:N.getGeometricArc();var P=V?M:M.getGeometricArc();var X=U||(Y.orientation===0);var ac=V||(P.orientation===0);var L,W,T,aa,K;if(X){if(ac){L=y.Geom.LineLineIntersection(Y,P)}else{aa=true;W=y.Geom.CircleStraightIntersection(P,Y)}}else{if(ac){W=y.Geom.CircleStraightIntersection(Y,P)}else{W=y.Geom.CircleCircleIntersection(Y,P)}}if(W){if(W[0]&&(S.distance(W[0])<=Z)){L=W[0]}else{if(W[1]&&(S.distance(W[1])<=Z)){L=W[1];T=true}}}if(L&&L.isFinite()){if(U&&V){K="Intersection"}else{if(T){K="Intersection2"}else{K="Intersection1"}}return{path1:aa?M:N,path2:aa?N:M,location:L,constraint:K}}}}var F=y.makeClass([y.TouchTracker,y.DoubleTapTracker],{touchBegan:function(Q){var P=this.session.sketch,N,K,L,M,O;this.registerAsPossibleDoubleTap();N=H(P,this.unmatchedGivens,Q,this.hitSlop);if(N){this.unmatchedGivens.splice(this.unmatchedGivens.indexOf(N),1);L=y.Tool.createMatchedGiven(N);this.session.matchedGivens.push(L)}else{M=this.session.matchedGivens.map(function(R){return R.given});K=H(P,M,Q,this.hitSlop);if(K){L=this.session.matchedGivens[M.indexOf(K)]}}if(!L){return}this.matchedGiven=L;this.mergeCandidateList=this.session.getLegalMatchesForGiven(L.given,this.mergeCandidateList);if(L.given.kind==="Point"){this.isPointMatchedGiven=true;O=L.given.geom.loc}else{O=Q}this.dragTracker=y.DragTracker.create(L.given);this.dragTracker.touchBegan(O);this.touchMoved(Q)},touchMoved:function(Q){if(!this.matchedGiven){return}var P=this.session.sketch,L,O,M,N=y.GeometricPoint(Q.x,Q.y),K;if(this.isPointMatchedGiven&&P.preferences.snapToGrid&&(K=P.findExistingCoordSys())&&K.state.exists){K.snapPoint(Q)}L=H(P,this.mergeCandidateList,Q,this.hitSlop);if(L&&L.isAPath()){O=D(P,L,this.mergeCandidateList,N,this.hitSlop)}if(O){this.matchedGiven.setIntersectInfo(O)}else{this.matchedGiven.setMergeCandidate(L)}M=this.matchedGiven.getSnappedPosition(N);if(M){this.dragTracker.touchMoved(M)}},touchEnded:function(L){if(!this.matchedGiven){return}if(this.dragTracker){this.dragTracker.touchEnded()}var K=this.matchedGiven.given;this.matchedGiven.completeMatch();if(this.unmatchedGivens.length===0){this.session.sketch.toolController.confirmActiveTool()}if(K&&this.isDoubleTap()){K.doubleClicked(L)}}});var E=y.makeClass(y.TouchRegime,{name:"ToolRegime",createTracker:function(O,K){var N=this.toolplaySession;var M;y.blurDocumentActiveElement(N.sketch.baseNode);var L=N.sketch.currentTouchRegime();if(L!==this){M=L.createTracker(O,K)}else{M=Object.create(F);M.session=N;M.unmatchedGivens=this.sharedUnmatchedGivens;M.mergeCandidateList=this.sharedMergeCandidateList;M.hitSlop=this.hitSlopForTouch(O)}return M}});function J(X,ac){var L=X.filter(function(ah){return ah.kind==="Point"});var W=ac.metadata.sketchRect;var aa=L.map(function(ai){var ah={x:ai.geom.loc.x+W.left,y:ai.geom.loc.y+W.top};return ah});var Q=y.Geom.boundingRect(aa);var Y={};function T(ah){return""+ah.x+"+"+ah.y}ac.eachGObj(function(ah,ai){if(ai.kind==="Point"&&!ai.style.hidden){Y[T(ai.geom.loc)]=true}});function K(ah){return Y[T(ah)]===h}var ae=25;var Z=10;var U=W.right-W.left;var af=W.bottom-W.top;var V=Q.right-Q.left;var M=Q.bottom-Q.top;var P=0;var ad=0;function R(ai){var aj=ae;var ah=ae;if(Q.right+aj+Z>W.right){aj-=U-(V+Z*2);P++}if(Q.bottom+ah+Z>W.bottom){ah-=af-(M+Z*2);ad++}Q.left+=aj;Q.right+=aj;Q.top+=ah;Q.bottom+=ah;ai.forEach(function(ak){ak.x+=aj;ak.y+=ah})}var S=false;while(!S){S=aa.every(K);if((P>=2)&&(ad>=2)){break}if(!S){R(aa)}}if(!S){var O=Math.random()*ae;var N=Math.random()*ae;aa.forEach(function(ah){ah.x+=O;ah.y+=N})}var ag={};for(var ab=0;ab<L.length;++ab){ag[L[ab].id]=aa[ab]}return ag}function I(K,L){L.presentGObjUI(K,function(M){if(M==="changesAccepted"){L.toolController.confirmActiveTool()}else{L.toolController.abortActiveTool()}})}return{createWithTool:function(U,Q){var S=Q.createSession(U),V=U.gobjList.renderList.slice(),M,L,K=[],P=S.givenArray,O=(P.length===1)&&(S.objectGraph.length===1);S.playAssumeds();var N=J(P,U);var T;do{M=S.getNextGiven();if(M){T=N[M.id]||{x:0,y:0};L=S.playGiven(M,T,true);K.push(L);L.setRenderState("unmatchedGiven");L.invalidateGeom();if(O){I(L,U)}}}while(M);var R=Object.create(E);R.toolplaySession=S;R.sharedUnmatchedGivens=K;R.sharedMergeCandidateList=V;return R}}}());y.BackClickRegime=(function(){function G(H){return H.isOfKind("Expression")||H.isOfKind("Measure")}function F(L,N,M,K){var I,H={hotSpot:M,filter:function J(P){function O(R){var Q;if(P===R){return false}if(R.children===h||R.children.length===0){return true}for(Q=0;Q<R.children.length;Q++){if(!O(R.children[Q])){return false}}return true}if(!G(P)){return false}return O(N)}};I=L.hitGObj({left:M.x-K,top:M.y-K,bottom:M.y+K,right:M.x+K},H);return I?I.hitGObj:null}var E=y.makeClass(y.TouchTracker,{touchBegan:function(K){var I=this.regime.sketch,J=this.regime.editor.gobj,H=this.hitParent=F(I,J,K,this.hitSlop);if(H){this.regime.editor.insertParent(H);H.setRenderState("targetHighlit");H.invalidateAppearance()}else{this.forwardTouchToSystem=true}},touchMoved:function(H){},touchEnded:function(){var H=this.hitParent;if(H){this.regime.sketch.jobScheduler.addJob(function(){H.setRenderState("none")},{delay:90})}}});var D=y.makeClass(y.TouchRegime,{name:"BackClickRegime",createTracker:function(I){var H=Object.create(E);H.regime=this;H.hitSlop=this.hitSlopForTouch(I);return H}});return{createWithEditor:function(I){var H=Object.create(D);H.editor=I;H.sketch=I.gobj.sQuery.sketch;return H}}}());y.gObjects.Kind={doc:{description:"All Kinds have the following properties.",refspec:{},supported:true,properties:{kind:{description:"Kind of GObject.",required:true,type:"Name"},constraint:{description:"Name of constraint governing geometry of the GObject.",required:true,type:"Name"},genus:{description:"Genus of GObject",required:true,type:"Name"},toolRole:{description:"If this object is part of a tool, it may have a special role during playback(such as 'given' or 'assumed').",required:false,type:"String"},label:{description:"Text that may be used to name an object. Not required to be unique.",required:false,type:"String"},style:{description:"Properties that influence the appearance of a GObject. Generally, these properties do not affect the placement of the object in the plane, nor the placement of other, dependent, objects.",properties:{color:{description:"Foreground color of the GObject.",type:"Color",required:false},hidden:{description:"Whether the GObject is hidden.",type:"Boolean"},selectable:{description:"Whether the GObject is draggable.",type:"Boolean"},"text-align":{description:"The basis alignment (left, center, right) with respect to the text's bounding box for the text in this GObject.",type:"TextAlign"},traced:{description:"Whether the GObject should be traced.",type:"Boolean",required:false}}},description:{description:"a description of the role of the gobject in the sketch.",required:false,type:"String"}}},prepareToSerialize:function(){},toSpecObj:function(){var F=this;function E(J){var I={};g.each(J,function(L,K){I[L]=K.id});return I}function D(J,K){var I={};g.each(J,function(L,M){if(K[L]!==M){if(typeof M==="object"){I[L]=g.extend(true,{},M)}else{I[L]=M}}});return I}function G(K,J){var L=F.createDefaultStyle(),I;I=D(K,L);g.each(I,function(M){var N;if(J.hasOwnProperty(M)){N=J[M];if(N.suppressed){delete I[M]}}});if(K.label){I.label=D(K.label,L.label);if(g.isEmptyObject(I.label)){delete I.label}}if(g.isEmptyObject(I)){return}return I}function H(K,J){var I={};g.each(K,function(L,M){var N;if(J.hasOwnProperty(L)){N=J[L];if(N.suppressed){return}if((N["default"]!==h)&&(N["default"]===M)){return}if(L==="parents"){I[L]=E(M)}else{if(L==="style"){I[L]=G(M,N.properties)}else{if(L==="autostart"){I[L]=false}else{if(N.properties){I[L]=H(M,N.properties)}else{if(typeof M==="string"){I[L]=M}else{if(typeof M==="number"){I[L]=M}else{if(typeof M==="boolean"){I[L]=M}else{if(N.type==="Array"){I[L]=M.slice()}else{y.log("Omitted "+L)}}}}}}}}}});return I}return H(this,this.doc.properties)},toString:function(){function D(J,H){var E=[],G,F,I,K;for(G in J){if(J.hasOwnProperty(G)){K=H[G];I=J[G];if(typeof K!=="undefined"){F='"'+G+'":';if(K.properties){E.push(F+D(I,K.properties))}else{if(typeof I==="string"){E.push(F+'"'+I+'"')}else{if(typeof I==="number"){E.push(F+I)}else{if(typeof I==="boolean"){E.push(F+I)}}}}}}}return"{"+E.join()+"}"}return D(this,this.doc.properties)},kind:"kind",constraint:"constraint",genus:"genus",style:{hidden:false,selectable:true,"text-align":"center"},state:{exists:true,selectable:true,constraintFrame:0,supported:true},hasLabel:false,children:[],geom:{},labelSpec:{},getMathItalicization:function(){var E=this.sQuery.sketch.preferences,F=E&&E.text,D=F&&F.mathItalicization;return D},createDefaultStyle:function(){var G=this.getColorableComponent(),F=this.getTextType(),D=this.sQuery.sketch.preferences,E;E=g.extend(true,{},y.gobjPrototype(this.kind,this.constraint).style);if(G){g.extend(true,E,D.colorableComponents[G])}if(this.hasLabel){if(!E.label){E.label={}}g.extend(true,E.label,D.text.textTypes.Label)}if(F){g.extend(true,E,D.text.textTypes[F])}return E},doPostReadFromSpec:function m(){var D=this.createDefaultStyle();this.style=g.extend(true,D,this.style)},kindSupportsSpecObj:function(){return true},init:function x(){this.initKind();this.initConstraint();this.updateConstraintAncestry();this.updateLabel()},initKind:function j(){this.needsRenderInit=true},updateLabel:function(){this.updateLabelForKind();this.updateLabelForConstraint()},updateLabelForKind:function e(){},graphHasChanged:function(){this.updateConstraintAncestry();this.updateLabel();this.invalidateGeom()},descendentGraphHasChanged:function(){this.graphHasChanged();this.eachDescendant(function(){this.graphHasChanged()})},onLoad:function(E,D){},onUnload:function(D){},doubleClicked:function(){},isOfKind:function(D){return(D===this.kind)||(this.baseKinds&&(this.baseKinds.indexOf(D)>=0))},isOfGenus:function(D){return(D===this.genus)||(this.baseGenera&&(this.baseGenera.indexOf(D)>=0))},isAPath:function(){return this.isOfGenus("Path")},eachParent:function(H,E){var F,G,D;if(!this.parentsList||!this.parentsList.length){return this}if(E){for(F=this.parentsList.length-1;F>=0;F--){G=this.parentsList[F];D=H.call(G,F,G);if(D===false){break}}}else{for(F=0;F<this.parentsList.length;F++){G=this.parentsList[F];D=H.call(G,F,G);if(D===false){break}}}return this},eachChild:function(H,E){var F,G,D;if(!this.children||!this.children.length){return this}if(E){for(F=this.children.length-1;F>=0;F--){G=this.children[F];D=H.call(G,F,G);if(D===false){break}}}else{for(F=0;F<this.children.length;F++){G=this.children[F];D=H.call(G,F,G);if(D===false){break}}}return this},eachDescendant:function(J){var I={},G=this.sQuery.sketch.gobjList.constraintList,H,F,E;function D(){I[this.id]=true}this.eachChild(D);for(F=0;F<G.length;F++){H=G[F];if(I[H.id]){E=J.call(H,F,H);if(E===false){break}H.eachChild(D)}}return this},hasDescendant:function(D){var E=false;this.eachDescendant(function(F){if(F===D){E=true;return false}});return E},checkParentsExist:function(){var E,F,D=true;for(E=0;E<this.parentsList.length;E++){F=this.parentsList[E];if(F.state&&!F.state.exists){D=false;break}}this.state.exists=D;return D},initializeClone:function(D){if(!D){D=this.sQuery().get(this.id)}if(D.geom){this.geom={};y.GeomTransformer.copyGeom(D.geom,this.geom)}if(D.style){this.style=Object.create(D.style)}this.state={};this.state.exists=D.state.exists;this.state.supported=D.state.supported},invalidateAppearance:function(){this.sQuery.sketch.invalidateAppearance(this)},invalidateGeom:function(){this.sQuery.sketch.invalidateGeom(this)},getColorableComponent:function(){return h},getTextType:function(){return h},isRenderable:function(){return !this.style.hidden&&this.state.exists},isHittable:function(){return this.style.selectable&&this.isRenderable()},renderPrepare:function(E,D){return h},render:function(F,D,E){throw y.createError("Capability not implemented(render): id="+this.id)},renderCleanup:function(E,D){},calculateFadeOpacity:function(){var D=1;if(this.state.fade!==h){D*=(1-this.state.fade)}return D},calculateOpacity:function(){var D=this.style.opacity;if(h===D){D=1}D*=this.calculateFadeOpacity();return D},getGeomBounds:function(){if(this.state.exists){return{left:Number.NEGATIVE_INFINITY,top:Number.NEGATIVE_INFINITY,right:Number.POSITIVE_INFINITY,bottom:Number.POSITIVE_INFINITY}}},getSignificantBounds:function(E){var D=this.getGeomBounds(E);if(!y.Geom.isFiniteRect(D)){D=null}return D},hitTest:function(E,D){throw y.createError("Capability not implemented(hitTest): id="+this.id)},dragDidStart:function(){this.state.isDragging=true},dragDidEnd:function(){this.state.isDragging=false},transform:function(E,D){throw y.createError("Capability not implemented(transform): id="+this.id)},transformComplete:function(E,D){},createTransformer:function(D){return new y.GeomTransformer({distance:D.getScalarTransform(),point:D.getTransform()})},destroy:function(){},hide:function(){this.style.hidden=true;this.invalidateGeom()},show:function(){this.style.hidden=false;this.invalidateGeom()},toggleDisplay:function(){this.style.hidden=!this.style.hidden;this.invalidateGeom()},beginPulsing:function(){},stopPulsing:function(){},setRenderState:function(D){if(this.state.renderState==="unmatchedGiven"){this.stopPulsing()}this.state.renderState=D;if(D==="unmatchedGiven"){this.beginPulsing()}this.invalidateAppearance()},modifyRenderAttrsForCurrentState:function(D){switch(this.state.renderState){case"speculative":D.color=y.speculativeColor;D.suppressParametricColor=true;break;case"targetHighlit":D.color=y.targetHighlightColor;D.suppressParametricColor=true;if(this.isAPath()){D.width+=y.targetHighlightPathBolding}break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},getAutoplacementMetrics:function(){if(this.supportsAutoplacement()){return y.AutoplacementMetrics[this.autoplacementType]}},getMFSAppearanceForVariant:function(D){return D==="byLabel"?this.getNameMFSForLabel():this.getNameMFS()},getNameMFSForLabel:function(){return this.getNameMFS()},getStrippedMFSAppearanceForVariant:function(D){var F=this.getMFSAppearanceForVariant(D);if(F===null){return null}y.mfs.walkNode(F,"style",function E(G){G.value=G.value.filter(function(H){return(H.code!=="fontFamily"&&H.code!=="fontSize")})});return F},getLabelMFS:function(){var D=this.getMathItalicization();if(this.label){return y.labels.parseLabelExpression(this.label,D)}else{if(this.style&&this.style.label&&(this.style.label.text!==h)){return y.labels.parseLabelExpression(this.style.label.text,D)}}return null},getNameMFS:function(){return this.getLabelMFS()||this.getParentalNameMFS()},getGObjRef:function(D){return this.sQuery.sketch.gobjList.gobjects[D]},getParent:function(D){return this.parents[D]},testConsistency:function(E,G,D){var F=(G===D)||(G==null&&D==null);if(!F&&((typeof G==="number")&&(typeof D==="number"))){F=y.math.expect(G,D)}return !F?E+': <span class="error">'+G+'</span> (<span class="expected">'+D+"</span>)":""},verificationString:function(E,D){var G="";G+=this.testConsistency("exists",this.state.exists,E.exists);if(this.constraintVerificationString){G+=this.constraintVerificationString(E)}function F(K){var H,I="",J="",L="";if(K.debug&&K.debug.controlList){H=K.sQuery.sketch.Bap.createControlList([K]);J=y.ControlList.toString(K.debug.controlList);L=y.ControlList.toString(H)}if(J!==L){I+='bapCheck: <div class="error">'+L+'</div>(<div class="expected">'+J+"</div>)"}return I}if(this.debug&&this.debug.pathPositions){if(this.pathValidationString){G+=this.pathValidationString(this.debug.pathPositions)}else{y.signalErrorWithMessage("GObj verification expects a path object")}}G+=F(this);return G}};y.gObjects.Unknown=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"An unknown object generated as a result of some translation process. Will not be displayed.",inherits:"Kind",refspec:{msg:"A convenience of the design. No reference specification."},properties:{kind:{description:"Kind of GObject.",required:true,type:"Name"}}},kind:"Unknown",hitTest:function(E,D){return false},render:function(F,D,E){},transform:function(E,D){}});y.gObjects.Sampler=(function(){var E=(function(){var J=y.makeClass(y.TouchTracker,{functionPlot:null,dragWhichPoint:"",updateDriverDomain:function(K){this.functionPlot.driverDomain[this.dragWhichPoint]=K;this.functionPlot.rawSamples=null;this.functionPlot.invalidateGeom()},swap:function(){var K=this.functionPlot.driverDomain,L=K.low;K.low=K.high;K.high=L;this.dragWhichPoint=(this.dragWhichPoint==="low")?"high":"low"},shouldSwap:function(L){var K=this.functionPlot.driverDomain;return(this.dragWhichPoint==="low"&&L>K.high)||(this.dragWhichPoint==="high"&&L<K.low)},getAnchorNode:function(){return this.functionPlot.sQuery.sketch.anchorNode},touchBegan:function(){if(this.functionPlot.getFunctionType()==="XofY_FunctionExprType"){this.getAnchorNode().css({cursor:"ns-resize"})}else{this.getAnchorNode().css({cursor:"ew-resize"})}},touchEnded:function(){this.getAnchorNode().css({cursor:"default"})},touchMoved:function(N){var L=this.functionPlot.getParent("coordSys");var M=L.locatePoint(y.GeometricPoint(N.x,N.y));var K=(this.functionPlot.getFunctionType()==="XofY_FunctionExprType")?"y":"x";if(this.shouldSwap(M[K])){this.swap()}this.updateDriverDomain(M[K])}});return{create:function(M,L){var K=Object.create(J);K.functionPlot=M;K.dragWhichPoint=L;return K}}}());return y.makeClass([y.gObjects.Kind,y.mixins.label,y.genera.Path],{doc:{description:"A collection made by sampling some geometric or numeric function",inherits:"Kind",refspec:{gspKindRef:"SamplerKind"},usage:{},supported:true,properties:{numSamples:{description:"The number of samples of the underlying object",type:"Number"},driverDomain:{description:"The lower bound when sampling with a numeric driver",properties:{low:{description:"The lower bound of the domain when sampling",type:"Number"},high:{description:"The upper bound of the domain when sampling",type:"Number"}}},isDiscrete:{description:"For a point-based sampler, whether or not to connect the samples as a continuous path.",type:"Boolean"},showEndpoints:{description:"Whether to display endpoints/arrowheads of the locus",type:"Boolean"},style:{description:"Properties that influence the appearance of a GObject. Accepts style properties appropriate for the 'drivenObject' as well.",properties:{endpointRadius:{description:"",type:"Number",required:false},arrowheadRadius:{description:"",type:"Number",required:false}},regex:/^[a-zA-Z0-9-_]+$/}}},kind:"Sampler",hasLabel:true,state:{},renderPrepare:function(K,J){J.kind=this.kind;J.id=this.id;if(this.sampleGObj().prepareVectorRendering){return this.sampleGObj().prepareVectorRendering(K,this.vectorContext,J)}},renderCleanup:function(K,J){if(this.sampleGObj().cleanupVectorRendering){return this.sampleGObj().cleanupVectorRendering(K,J,this.vectorContext)}},render:function(N,J,K){var M,L={leftEndpoint:null,rightEndpoint:null,radius:this.style.radius,renderable:this.isRenderable(),opacity:this.calculateOpacity()};if(this.state.mergeTarget){L.width=this.style.width+y.targetHighlightPathBolding;L.color=y.targetHighlightColor;L.suppressParametricColor=true}else{L.width=this.style.width;L.color=this.style.color}if(this.showEndpoints){M=this.getParent("domainObject");if(M&&!M.closedPath){switch(M.genus){case"Segment":case"SimpleArc":L.leftEndpoint="endpoint";L.rightEndpoint="endpoint";L.endpointRadius=this.style.endpointRadius;break;case"Ray":case"Bisector":L.leftEndpoint="endpoint";L.rightEndpoint="arrowhead";L.endpointRadius=this.style.endpointRadius;L.arrowheadRadius=this.style.arrowheadRadius;break;default:L.leftEndpoint="arrowhead";L.rightEndpoint="arrowhead";L.arrowheadRadius=this.style.arrowheadRadius}}if(!M){L.leftEndpoint="arrowhead";L.rightEndpoint="arrowhead";L.arrowheadRadius=this.style.arrowheadRadius}}this.modifyRenderAttrsForCurrentState(L);this.setLineDash(L);if(this.sampleGObj().renderVector){return this.sampleGObj().renderVector(N,J,K,this.vectorContext,L)}},getColorableComponent:function(){if(this.constraint==="FunctionPlot"){return"Plot"}else{return"PointLocus"}},getGeomBounds:function(){if(this.sampleGObj().getGeomBoundsVector){return this.sampleGObj().getGeomBoundsVector(this.vectorContext)}},hitTest:function(M){var K=this;function J(){var N=K;function O(Q){var P=N.samplerPathValueToPosition(N.driverDomain[Q]);if(y.Geom.PointInRect(P,M)){return E.create(N,Q)}else{return false}}if(N.plottingInfo.polar){return false}else{return O("high")||O("low")||false}}function L(){if(K.sampleGObj().hitTestVector){return K.sampleGObj().hitTestVector(K.vectorContext,M)}}if(this.constraint==="FunctionPlot"){return J()||L()}else{return L()}},transform:function(K,J){},getRenderingLayer:function(){var J=this.sampleGObj&&this.sampleGObj();return J&&J.getVectorRenderingLayer?J.getVectorRenderingLayer(this.vectorContext):"NeverVisible"},initializeClone:function D(J){(D.base||arguments.callee.base).call(this,J);this.init()},isAPath:function(){var J=this.sampleGObj&&this.sampleGObj();return(J&&J.isPathSampleGObj)||false},mapPathValueToPosition:function I(K,J){if(this.samplerPathValueToPosition){return this.samplerPathValueToPosition(K,J)}y.signalErrorWithMessage("This sampler constraint does not implement the path API")},mapPositionToPathValue:function F(J){if(this.samplerPositionToPathValue){return this.samplerPositionToPathValue(J)}y.signalErrorWithMessage("This sampler constraint does not implement the path API")},constrainRange:function(L){if(this.samplerConstrainRange){return this.samplerConstrainRange(L)}var K=L,J=0,M=1;if(L>M){K=M}if(L<J){K=J}return K},isValueInBounds:function(J){if(this.samplerIsValueInBounds){return this.samplerIsValueInBounds(J)}return((J>=0)&&(J<=1))},constrainLabel:function G(){(G.base||arguments.callee.base).call(this)},pathLength:function(){if(this.samplerPathLength){return this.samplerPathLength()}},verificationString:function H(M,L){var Q=H.base.call(this,M,L),K=this.sampleGObj();if(this.state.exists&&M.exists&&K.getGeomForSample){var P=K.getGeomForSample(this.vectorContext,0),N=K.getGeomForSample(this.vectorContext,this.numSamples-1),O,J;if(M.firstSamplePoint!=="nonexisting"){O=y.GeometricPoint(M.firstSamplePoint.x,M.firstSamplePoint.y);if(!y.GeometricPoint.expect(P.loc,O)){Q+='firstSample: <span class="error">'+P.loc+'</span>(<span class="expected">'+O+"</span>)"}}if(M.lastSamplePoint!=="nonexisting"){J=y.GeometricPoint(M.lastSamplePoint.x,M.lastSamplePoint.y);if(!y.GeometricPoint.expect(N.loc,J)){Q+='lastSample: <span class="error">'+N.loc+'</span>(<span class="expected">'+J+"</span>)"}}}return Q}})}());y.gObjects.Map=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"A Map.",inherits:"Kind",refspec:{gspKindRef:"MapKind"},supported:true,usage:{},properties:{rerandomizePointsOnPaths:{description:"",required:false,type:"Boolean"},finalIterationOnly:{description:"",required:false,type:"Boolean"}}},kind:"Map",style:{},state:{},hasLabel:false,initializeClone:function v(D){(v.base||arguments.callee.base).call(this,D);this.init()},geom:{},getGeomBounds:function(){return},getColorableComponent:function(){return""},isHittable:function(){return false},hitTest:function(E,D){},render:function(F,D,E){},getRenderingLayer:function(){return"NeverVisible"},testConsistency:function t(E,F,D){return(E==="exists")?"":(t.base||arguments.callee.base).call(this)}});y.gObjects.IterateImage=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"",refspec:{gspRef:"IterateImageKind"},supported:true,properties:{description:{description:"a description of the role of the gobject in the sketch.",required:false,type:"String"},style:{description:"Properties that influence the appearance of a GObject. Accepts style properties appropriate for the 'source' as well.",regex:/^[a-zA-Z0-9-_]+$/}}},kind:"IterateImage",clonedGObj:h,initializeSampleBuffer:function(){var H=this.getParent("map"),G=this.clonedGObj,F=0;function E(L,M){var J,K,I;if(M===1){return L}else{I=0;J=M;for(K=0;K<L;K++){I+=J;J*=M}}return I}if(H.currentDepth){F=H.finalIterationOnly?Math.pow(H.numMaps,H.currentDepth):E(H.currentDepth,H.numMaps)}try{this.vectorContext=G.createVectorContext(F,this,G.constraintChangesColor)}catch(D){y.log("Object "+G.id+" failed to create vector context: "+D);this.state.exists=false}this.numSamples=F},getNameMFS:function A(){var D=(A.base||arguments.callee.base).call(this);return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Iterated Image "),D)},initializeClone:function v(D){(v.base||arguments.callee.base).call(this,D);this.init()},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;if(this.clonedGObj.prepareVectorRendering){return this.clonedGObj.prepareVectorRendering(E,this.vectorContext,D)}},renderCleanup:function(E,D){if(this.clonedGObj.cleanupVectorRendering){return this.clonedGObj.cleanupVectorRendering(E,D,this.vectorContext)}},render:function(G,D,E){var F={hidden:this.style.hidden,width:this.style.width,color:this.style.color,radius:this.style.radius,opacity:this.calculateOpacity(),renderable:true,constraintFrame:this.state.constraintFrame};if(this.style["line-style"]){y.modifyRenderAttrsForLineStyle(this.style["line-style"],F)}this.modifyRenderAttrsForCurrentState(F);if(this.clonedGObj.renderVector){return this.clonedGObj.renderVector(G,D,E,this.vectorContext,F)}},getGeomBounds:function(){if(this.clonedGObj.getGeomBoundsVector){return this.clonedGObj.getGeomBoundsVector(this.vectorContext)}},hitTest:function(D){if(this.clonedGObj.hitTestVector){return this.clonedGObj.hitTestVector(this.vectorContext,D)}},transform:function(E,D){},curSampleNum:0,clearSamples:function(){this.curSampleNum=0;this.terminalSampleIndex=h;if(this.clonedGObj.resetVectorSamples){this.clonedGObj.resetVectorSamples(this.vectorContext)}},sampleCountChanged:function(){this.initializeSampleBuffer()},collectSample:function(){if(this.clonedGObj.fillSingleSample&&this.clonedGObj.state.exists){this.clonedGObj.fillSingleSample(this.vectorContext,this.curSampleNum);this.curSampleNum++}},stampTerminalSample:function(){this.terminalSampleIndex=this.curSampleNum-1},getRenderingLayer:function(){var D=this.clonedGObj;return D.getVectorRenderingLayer?D.getVectorRenderingLayer(this.vectorContext):"NeverVisible"},getTerminalGeom:function(){var E=this.curSampleNum-1;var F=this.getParent("source");var D={};if(F.state.exists&&(this.terminalSampleIndex===-1)){y.GeomTransformer.copyGeom(F.geom,D);return D}if(this.clonedGObj.getGeomForSample&&(this.terminalSampleIndex===E)){return this.clonedGObj.getGeomForSample(this.vectorContext,this.terminalSampleIndex)}return null},verificationString:function(E,D){var F="";return F}});y.gObjects.Button=y.makeClass([y.gObjects.Kind,y.mixins.labelBase],(function(){var E=y.makeClass(y.TouchTracker,{sketch:null,button:null,touchBegan:function(){this.button.state.inClick=++this.button.state.inClick||1;this.sketch.invalidateGeom(this.button)},touchEnded:function(){this.button.state.inClick=--this.button.state.inClick;this.sketch.invalidateGeom(this.button);if(this.button.state.inClick<0){throw y.createError("ButtonPressTracker: press count went negative!  Should be impossible")}if(this.button.state.inClick===0){this.sketch.event("PressButton",{gobj:this.button},{buttonType:this.button.constraint});this.button.press(this.sketch)}}});function G(I){var H=Object.create(E);H.sketch=I.sQuery.sketch;H.button=I;return H}return{doc:{description:"A control that initiates some action.",inherits:"Kind",refspec:{gspKindRef:"ActionKind",msg:"Buttons have the appearance defined by their host browser. The appearance of buttons is meant to be familiar to browser users."},defaultConstraint:"ActionButton",existenceRule:"Exists regardless of existence of parent.",usage:{},properties:{geom:{description:"The basic geometry of the GObject",properties:{loc:{description:"The position of the GObject",properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"}}}}},style:{description:"",properties:{autostart:{description:"Whether the button should be executed at sketch start time.",type:"Boolean"},color:{description:"The background color. Text color is described by the label.color property.",type:"Color"},"highlight-color":{description:"",type:"Color",required:false},label:{properties:{showLabel:{description:"The label for a button is the text on the button. It's always shown, so the value of showLabel is ignored.",required:false}}}}}}},kind:"Button",style:{autostart:false},state:{isActive:false},autoplacementType:"Button",createDefaultStyle:function D(){var J=this.getColorableComponent(),H=this.sQuery.sketch.preferences,I=(D.base||arguments.callee.base).call(this);if(J&&H.colorableComponents[J].color){I.color=H.colorableComponents[J].color}return I},doPostReadFromSpec:function F(){(F.base||arguments.callee.base).call(this);this.geom.loc=y.GeometricPoint(this.geom.loc.x,this.geom.loc.y)},onLoad:function(I,H){if(this.style.autostart&&!H){this.press(I)}this.state.firstTime=false},getColorableComponent:function(){return"ActionButton"},getTextType:function(){return"Action"},modifyRenderAttrsForCurrentState:function(H){switch(this.state.renderState){case"speculative":H.opacity=y.speculativeOpacity;break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},renderPrepare:function(K,J){var I=this.style.label||{},H=y.getFontFamilyFromStyle(I,this.sQuery());J.id=this.id;J.kind=this.kind;J.color=I.color||this.style.color;J["background-color"]=this.style.color;J["font-family"]=H;J["font-style"]=I["font-style"];J["font-weight"]=I["font-weight"];J["font-size"]=I["font-size"];J["text-decoration"]=I["text-decoration"];J["text-align"]="left";J["vertical-align"]="top";J["highlight-color"]=this.style["highlight-color"];return K.prepareButton(J)},renderCleanup:function(I,H){I.cleanupButton(H)},render:function(J,L,H){var P=0,O=0,K=this.isRenderable(),I=K?"visible":"hidden",N=L,Q={visibility:I,constraintFrame:this.state.constraintFrame};if(K){P=this.geom.loc.getX();if(isNaN(P)){P=0}O=this.geom.loc.getY();if(isNaN(O)){O=0}Q.x=P;Q.y=O;if(this.oldText!==this.label){try{this.parsedMFS=y.labels.parseLabelExpression(this.label,false)}catch(M){M.message="On Button "+this.id+": "+M.message;y.signalCaughtError(M)}Q.text=this.label;Q.parsedMFS=this.parsedMFS;this.oldText=this.label}Q.isHighlight=this.state.isActive;Q.inClick=this.state.inClick;Q.isDragging=this.state.isDragging;Q.selectable=this.style.selectable;Q["handle-color"]=this.style.color;Q.opacity=this.calculateOpacity()}this.modifyRenderAttrsForCurrentState(Q);J.drawButton(N,Q)},checkParentsExist:function(){return true},isHittable:function(){return this.isRenderable()},hitTest:function(L,J){var K=this.sQuery.sketch.getDisplayObjForGObj(this),N,I,O,M=false,H=false;if(K){N={left:this.geom.loc.getX(),top:this.geom.loc.getY(),width:K.width(),height:K.height()};I={left:N.left,right:N.left+N.width,top:N.top,bottom:N.top+N.height};if(J){M=(J.x>=I.left)&&(J.x<=I.right)&&(J.y>=I.top)&&(J.y<=I.bottom);if(M){I.right=N.left+K.dragHandleWidth();H=(J.x<=I.right)}}else{O={left:Math.max(L.left,I.left),right:Math.min(L.right,I.right),top:Math.max(L.top,I.top),bottom:Math.min(L.bottom,I.bottom)};M=(O.left<O.right&&O.top<O.bottom)}}if(H&&this.style.selectable){return true}if(M){return G(this)}return false},getGeomBounds:function(){function H(J,L){var K={left:J.getX(),top:J.getY(),width:L.width(),height:L.height()};if(L.attrs&&(L.attrs["text-align"]==="center")){K.left-=K.width/2}if(L.attrs&&(L.attrs["vertical-align"]==="middle")){K.top-=K.height/2}return{left:K.left,right:K.left+K.width,top:K.top,bottom:K.top+K.height}}var I=this.sQuery.sketch.getDisplayObjForGObj(this);return I&&H(this.geom.loc,I)},transform:function(I,H){this.geom.loc=H.geom.loc.copy();H.affine.transform(this.geom.loc)},updateLabel:function(){}}}()));y.gObjects.Circle=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.circleVector,y.genera.Path],{doc:{description:"The curve describing the limits of a circle.",inherits:"Kind",refspec:{gspKindRef:"CircleKind"},usage:{},properties:{style:{description:"",properties:{"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false},width:{description:"The width of the curve line in pixels.",type:"Number"}}}}},kind:"Circle",style:{hidden:false,width:3,selectable:true},hasLabel:true,geom:{},getGeometricArc:function(){if(!this.state.constraintCache){this.state.constraintCache={}}if(!this.state.constraintCache.arc){this.state.constraintCache.arc=y.GeometricArc.FromCenterAndRadius(this.geom.c,this.geom.r)}return this.state.constraintCache.arc},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.c=y.GeometricPoint.ORIGIN;this.geom.r=0},getColorableComponent:function(){return"Curves"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareCircle(D)},renderCleanup:function(E,D){return E.cleanupCircle(D)},render:function(J,E,G){var I=this.isRenderable();var D=-100,K=-100,H=-100;if(I){D=Number(this.geom.c.x);if(isNaN(D)){D=0}K=Number(this.geom.c.y);if(isNaN(K)){K=0}H=Number(this.geom.r);if(isNaN(H)){H=0}}var F={renderable:I,cx:D,cy:K,r:H,color:this.style.color,width:this.style.width,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(F);this.setLineDash(F);J.drawCircle(E,F)},getGeomBounds:function(){var D,E=this.style.width/2||1.5;if(this.state.exists){D=y.Geom.insetRect({left:this.geom.c.x,top:this.geom.c.y,right:this.geom.c.x,bottom:this.geom.c.y},-this.geom.r-E)}return D},hitTest:function(E,D){return y.Geom.RectIntersectsCurve(E,{type:"circle",curve:y.GeometricArc.FromCenterAndRadius(this.geom.c,this.geom.r)})},transform:function(E,D){},createTransformer:function(D){var E=D.getTransform(),F=D.getScalarTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(G,H){H.c=E(G.c);H.r=F(G.r)}}},mapPositionToPathValue:function(F){var G=F.subtract(this.geom.c);var E=Math.atan2(-G.getY(),G.getX());var D=(E/(2*Math.PI));if(D<0){D+=1}return D},mapPathValueToPosition:function(G,E){var F=G*2*Math.PI,D=y.GeometricPoint(this.geom.r*Math.cos(F),-this.geom.r*Math.sin(F));if(E){E.derivative=y.GeometricPoint(D.y,-D.x)}return this.geom.c.add(D)},getAnimationRange:function(){return{min:0,max:1-(1e-7)}},area:function(){return Math.PI*this.geom.r*this.geom.r},circumference:function(){return 2*Math.PI*this.geom.r},pathLength:function(){return this.circumference()},radius:function(){return this.geom.r},closedPath:true,verificationString:function f(F,D){var G=(f.base||arguments.callee.base).call(this,F,D),H,E;if(G===""&&this.state.exists){H=y.GeometricPoint(F.c.x,F.c.y);E=F.r;if(!y.GeometricPoint.expect(H,this.geom.c)){G+='center: <span class="error">'+this.geom.c+'</span>(<span class="expected">'+H+"</span>)"}if(!y.math.expect(E,this.geom.r)){G+='radius: <span class="error">'+this.geom.r+'</span>(<span class="expected">'+E+"</span>)"}}return G}});y.gObjects.Picture=y.makeClass([y.gObjects.Kind,y.Genus,y.mixins.vector],(function(){function D(N,M,L,J){var I,H,O,K;I=L.transform(y.GeometricPoint(0,M.height));H=L.transform(y.GeometricPoint(0,0));O=L.transform(y.GeometricPoint(M.width,0));K=y.Geom.ParallelogramSectsRect(N,I,H,O);if(K&&J){K=y.Geom.RectSectsPolygon(N,J)}return K}return{doc:{description:"An Image.",inherits:"Kind",refspec:{gspKindRef:"PictureKind",msg:"An embedded picture"},usage:{},properties:{image:{description:"The source image of the picture",required:false,type:"Image"},style:{description:"",properties:{layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)","default":"0.5",type:"Number"}}}}},kind:"Picture",style:{opacity:0.5},state:{},doPostReadFromSpec:function G(){(G.base||arguments.callee.base).call(this);if(this.geom.transform){this.geom.transform=y.AffineTransform(this.geom.transform)}},getColorableComponent:function(){return"Picture"},modifyRenderAttrsForCurrentState:function(H){switch(this.state.renderState){case"speculative":H.opacity=y.speculativeOpacity;break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},renderPrepare:function(I,H){H.kind=this.kind;H.id=this.id;H.image=this.getImage();H.onStateChange=(function(J){return function(){J.sQuery().invalidateGeom(J)}}(this));return I.preparePicture(H)},renderCleanup:function(I,H){return I.cleanupPicture(H)},render:function(K,H,J){var I={renderable:this.isRenderable(),transform:this.geom.transform,opacity:this.calculateOpacity(),clipPolygon:this.geom.clipVertices};this.modifyRenderAttrsForCurrentState(I);K.drawPicture(H,I)},getGeomBounds:function(){var H,K=[],I,J={};if(!this.state.exists){return}H=this.getImage();if(!H){return}I=this.geom.transform;K.push(I.transform(y.GeometricPoint(0,H.height)));K.push(I.transform(y.GeometricPoint(0,0)));K.push(I.transform(y.GeometricPoint(H.width,0)));K.push(I.transform(y.GeometricPoint(H.width,H.height)));g.each(K,function(M,L){if((J.left===h)||L.x<J.left){J.left=L.x}if((J.right===h)||L.x>J.right){J.right=L.x}if((J.top===h)||L.y<J.top){J.top=L.y}if((J.bottom===h)||L.y>J.bottom){J.bottom=L.y}});return y.Geom.insetRect(J,-1)},hitTest:function(I){var H=this.getImage();return D(I,H,this.geom.transform,this.geom.clipVertices)},transform:function(I,H){this.geom.transform=H.geom.transform.compose(H.affine)},constrainLabel:function(){},getImage:function(){if((this.image==null)&&this.parents&&this.parents.source){return this.getParent("source").getImage()}return(typeof(this.image)==="number")?this.sQuery().getResource("pictures",this.image):this.image},verificationString:function F(J,I){var K=(F.base||arguments.callee.base).call(this,J,I),H=this;if(K===""&&this.state.exists){g.each(y.AffineTransform.KeyNames,function(){if(h!==J[this]&&!y.math.expect(H.geom.transform[this],J[this])){K+=this+': <span class="error">'+H.geom.transform[this]+'</span>(<span class="expected">'+J[this]+"</span>)"}})}return K},createVectorContext:function(J,I,K){var H={numSamples:J,parentSampler:I,samples:y.createFloatVector(J*y.AffineTransform.packedSampleSize)};if(this.geom.clipVertices){H.clipVerticesArray=[]}return H},fillSingleSample:function(J,H){var I=this.geom.transform;J.filledSampleCount++;I.packIntoSampleArray(J.samples,H);if(this.geom.clipVertices){J.clipVerticesArray[H]=this.geom.clipVertices}J.geomBounds=y.Geom.unionRects(J.geomBounds,this.getGeomBounds())},getNameMFS:function E(){var I=(E.base||arguments.callee.base).call(this);var H=this.genus==="Drawing"?"Drawing ":"Picture ";return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(H),I)},getGeomBoundsVector:function(H){return H.geomBounds},hitTestVector:function(O,M){var H=this.getImage(),K,N,J=O.samples,I=O.filledSampleCount;for(var L=0;L<I;++L){K=y.AffineTransform.fromPackedSampleArray(J,L);N=O.clipVerticesArray&&O.clipVerticesArray[L];if(D(M,H,K,N)){return true}}return false},getVectorRenderingLayer:function(H){return"ExternalImagesAndInteriors"},prepareVectorRendering:function(J,I,H){H.kind=this.kind;H.id=this.id;H.image=this.getImage();H.onStateChange=(function(K){return function(){K.sQuery().invalidateGeom(K)}}(I.parentSampler));return J.preparePictureVector(H)},renderVector:function(M,H,J,L,K){var I=g.extend(true,{},K);I.transformSamples=L.samples;I.clipPolygons=L.clipVerticesArray;I.numSamples=L.filledSampleCount;I.renderable=true;M.drawPictureVector(H,I)},cleanupVectorRendering:function(I,H){return I.cleanupPictureVector(H)}}}()));y.gObjects.Point=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.pointVector,y.Genus],{doc:{description:"A location in the Euclidean plane.",inherits:"Kind",refspec:{gspKindRef:"PointKind"},usage:{},properties:{style:{description:"",properties:{color:{description:"Foreground color of the Point.",type:"Color"},"drag-expansion":{description:"The Point expands by this number of pixels when dragged.",type:"Number"},radius:{description:"The radius of the filled circle that represents the Point.",type:"Number"},traced:{description:"Whether the point should be traced.",type:"Boolean"},tracedStyle:{description:"Style overrides for traced appearance.",required:false,properties:{color:{description:"Foreground color of the traced GObject.",type:"Color"},radius:{description:".",type:"Number"}}}}}}},kind:"Point",style:{"drag-expansion":5,hidden:false,label:{showLabel:false},radius:4,selectable:true,traced:false},state:{},hasLabel:true,_oldRadius:null,_pulsingJob:null,beginPulsing:function(){var F=this,G=3000,J=Math.random()*G,H=5,I=F.style.radius,D=F.style["drag-expansion"],K=Math.pow(2,H),E=J+Date.now();F._oldRadius=F.style.radius;F._pulsingJob=F.sQuery.sketch.jobScheduler.addJob(function(){var N=Date.now(),M=(N-E)/G,L=Math.pow(Math.sin(y.math.TWO_PI*M)+1,H)/K;F.style.radius=I+L*D;F.invalidateAppearance()},{repeat:true})},stopPulsing:function(){this.sQuery.sketch.jobScheduler.clearJob(this._pulsingJob);this.style.radius=this._oldRadius;this._oldRadius=null;this._pulsingJob=null},modifyRenderAttrsForCurrentState:function(D){switch(this.state.renderState){case"speculative":D.color=y.speculativeColor;break;case"matchedGiven":case"targetHighlit":D.dropShadow=true;D.radius=this.style.radius+this.style["drag-expansion"];break;case"unmatchedGiven":D.dropShadow=true;break;case"invisible":case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},geom:{loc:{x:0,y:0}},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.loc=y.GeometricPoint(this.geom.loc.x,this.geom.loc.y)},getColorableComponent:function(){return"Points"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.preparePoint(D)},renderCleanup:function(E,D){return E.cleanupPoint(D)},render:function(F,J,E){var G,P,K,H,L,I,Q,M=E.traced?true:false,N=1,O=this.calculateOpacity(),D=this.style;if(this.state.renderState==="invisible"){return}P=D.radius;K=D.color;H=D["drag-expansion"];G=this.isRenderable();if(G){L=this.geom.loc.getX();if(isNaN(L)){L=0}I=this.geom.loc.getY();if(isNaN(I)){I=0}}else{L=I=-100}if(E.drag){P+=H}if(M){P*=0.75;O*=0.5;N=0;D=D.tracedStyle;if(D){if(h!==D.radius){P=D.radius}if(h!==D.color){K=D.color}}}Q={renderable:G,cx:L,cy:I,radius:P,color:K,lineWidth:N,opacity:O};this.modifyRenderAttrsForCurrentState(Q);F.drawPoint(J,Q)},getGeomBounds:function(){var E,F=(this.style.radius+this.style["drag-expansion"]),D={};this.modifyRenderAttrsForCurrentState(D);if(D.dropShadow){F+=10}if(this.state.exists){E=y.Geom.insetRect({left:this.geom.loc.x,top:this.geom.loc.y,right:this.geom.loc.x,bottom:this.geom.loc.y},-F)}return E},constrainLabel:function(){this.labelSpec.location=this.geom.loc;this.labelSpec.text=this.label||this.text||this.style.label.text||this.id},hitTest:function(H,E){var D=this.geom.loc.getX(),I=this.geom.loc.getY(),G=this.style.radius,F={left:D-G,right:D+G,top:I-G,bottom:I+G};return !(F.right<H.left||F.left>H.right||F.bottom<H.top||F.top>H.bottom)},transform:function(E,D){this.geom.loc=D.geom.loc.copy();D.affine.transform(this.geom.loc)},createTransformer:function(D){var E=D.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(F,G){G.loc=E(F.loc)}}},createDefaultSpec:function(I,F){var H=(I.metadata.sketchRect.right-I.metadata.sketchRect.left)/2;var G=(I.metadata.sketchRect.bottom-I.metadata.sketchRect.top)/2;var E=(F&&F.style)||{};var D=(F&&F.label)||"";return{"1":{kind:"Point",genus:"OriginPoint",constraint:"Free",style:E,label:D,geom:{loc:{x:H,y:G}}}}},verificationString:function f(E,D){var F=(f.base||arguments.callee.base).call(this,E,D),G;if(F===""&&this.state.exists){G=y.GeometricPoint(E.loc.x,E.loc.y);if(!y.GeometricPoint.expect(G,this.geom.loc)){F+='loc: <span class="error">'+this.geom.loc+'</span>(<span class="expected">'+G+"</span>)"}}return F}});y.gObjects.Polygon=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.vector,y.genera.Path,y.genera.Interior],{doc:{description:"The planar area bound by connecting a series of points by straight line segments.",inherits:"Kind",refspec:{gspKindRef:"PolygonKind"},usage:{},properties:{style:{description:"",properties:{"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false},width:{description:"Width of the strokes in pixels",type:"Number",required:false},opacity:{description:"0 (transparent) to 1 (fully opaque)",type:"Number"},layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"},framePerimeter:{description:"Display with a frame that shows the perimeter",type:"Boolean",required:false}}}}},kind:"Polygon",style:{hidden:false,framePerimeter:false,opacity:0.5},state:{},hasLabel:true,getColorableComponent:function(){return"Interior"},modifyRenderAttrsForCurrentState:function(D){this.modifyRenderAttrsForInterior(D)},renderPrepare:function(E,D){return E.preparePolygon({})},renderCleanup:function(E,D){return E.cleanupPolygon(D)},render:function(H,D,F){var G=this.isRenderable(),E={renderable:G,points:this.geom.points,opacity:this.calculateOpacity(),color:this.style.color};if(this.style.framePerimeter){E.drawBorder=true;E.borderColor=this.style.color;E.borderWidth=this.style.width;E.fadeOpacity=this.calculateFadeOpacity()}this.modifyRenderAttrsForCurrentState(E);H.drawPolygon(D,E)},getNumVertices:function(){var D=this;while(D&&D.parents&&(D.parents.source!==h)){D=D.parents.source}return D.parentsList.length},getGeomBounds:function(){var G={},I,E,H,D,F=(this.style.width||0);if(!this.state.exists){return}g.each(this.geom.points,function(J,K){if(K.x!==h&&K.y!==h){if(I===h||K.x<I){I=K.x}if(H===h||K.y<H){H=K.y}if(E===h||K.x>E){E=K.x}if(D===h||K.y>D){D=K.y}}});if(G.left+G.top===h){return}G.left=I;G.top=H;G.right=E;G.bottom=D;return y.Geom.insetRect(G,-F)},hitTest:function(F,D){var E=this.geom.points;return y.Geom.RectSectsPolygon(F,E)},transform:function(E,D){D.affine.transform(this.geom.points)},createTransformer:function(D){var E=D.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(F,H){var G;if(!H.points){H.points=[]}for(G=0;G<F.points.length;G++){H.points[G]=E(F.points[G])}}}},mapPositionToPathValue:function(G){var O=Infinity,L=0;var K,I,N,D,F,E,J;var M=this.geom.points;var H=0;for(F=0;F<M.length;F+=1){I=M[F];K=M[(F+1)%M.length];N=I.subtract(K);D=N.vLength();E=y.GeometricPoint.mapPointToLine(I,K,G,{returnPoint:true,clampP0:true,clampP1:true});J=E.point.subtract(G).vLength2();if(J<O){L=H+E.param*D;O=J}H+=D}return L/H},mapPathValueToPosition:function(K,E){var J=this.perimeter();var I,H,M,D,F;var L=this.geom.points;var G=0;if(!this.isValueInBounds(K)){return y.GeometricPoint.UNDEFINED}K=K-Math.floor(K);K*=J;for(F=0;F<L.length;F+=1){H=L[F];I=L[(F+1)%L.length];M=I.subtract(H);D=M.vLength();if(K<=G+D){if(E){E.derivative=y.GeometricPoint(M.x/(D/J),M.y/(D/J))}return H.add(M.multiply((K-G)/D))}G+=D}if(E){E.derivative=y.GeometricPoint(M.x/(D/J),M.y/(D/J))}return H},mapPathValueToCharacteristic:function(J){var I=this.perimeter();var H,G,K,D,E;var L=this.geom.points;var F=0;J*=I;for(E=0;E<L.length;E+=1){G=L[E];H=L[(E+1)%L.length];K=H.subtract(G);D=K.vLength();if(J<F+D){return{baseVertex:E,baseValue:(J-F)/D}}F+=D}return{baseVertex:0,baseValue:1}},perimeter:function(){var F,E,I,D;var H=this.geom.points;var G=0;for(D=0;D<H.length;D+=1){E=H[D];F=H[(D+1)%H.length];I=F.subtract(E).vLength();G+=I}return G},pathLength:function(){return this.perimeter()},getAnimationRange:function(){return{min:0,max:1-(1e-7)}},area:function(){var G,F,I,E;var H=this.geom.points;var D=0;for(E=0;E<H.length;E+=1){F=H[E];G=H[(E+1)%H.length];I=(F.x*G.y)-(F.y*G.x);D+=I}return Math.abs(D/2)},closedPath:true,getVertices:function(){return this.geom.points},createVectorContext:function(E,D,G){var F=this.getNumVertices();return{numSamples:E,samples:y.createFloatVector(E*2*F),numVertices:F,colors:G?[]:null}},fillSingleSample:function(I,E){var F,G=I.numVertices,D=I.samples,H=2*E*G;I.filledSampleCount++;for(F=0;F<G;++F){D[H+(F*2)]=this.geom.points[F].x;D[H+(F*2)+1]=this.geom.points[F].y}if(I.colors){I.colors[E]=this.style.color}I.geomBounds=y.Geom.unionRects(I.geomBounds,this.getGeomBounds())},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(H,L){var G=[],E=0,K=H.samples,F,D,J=H.filledSampleCount,I=H.numVertices;for(F=0;F<J;++F){G=[];for(D=0;D<I;++D){G.push(y.GeometricPoint(K[E],K[E+1]));E+=2}if(y.Geom.RectSectsPolygon(L,G)){return true}}return false},getVectorRenderingLayer:function(D){return"ExternalImagesAndInteriors"},prepareVectorRendering:function(F,E,D){return F.preparePolygonVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.numVertices=H.numVertices;G.numSamples=H.filledSampleCount;return I.drawPolygonVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupPolygonVector(D)}});y.gObjects.Straight=y.makeClass([y.gObjects.Kind,y.mixins.label,y.genera.Path,y.mixins.vector],{doc:{description:"Any of the family of straight geometric figures: rays, segments, or lines.",inherits:"Kind",refspec:{gspKindRef:"StraightKind"},usage:{},properties:{style:{description:"",properties:{color:{type:"Color"},width:{description:"Width of the strokes in pixels",type:"Number"},"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false}}},debug:{properties:{p0:{description:"The first reference point defining the straight.",required:false,properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"}}},p1:{description:"The second reference point.",required:false,properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",required:true,type:"Number"}}}}}}},kind:"Straight",style:{hidden:false,width:3,"line-style":"solid"},hasLabel:true,geom:{},constrainRange:function(E){var D=E;switch(this.genus){case"Segment":if(E>1){D=1}if(E<0){D=0}break;case"Ray":if(E<0){D=0}break;default:}return D},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.p0=y.GeometricPoint.ORIGIN;this.geom.p1=y.GeometricPoint.ORIGIN},getColorableComponent:function(){return"Straights"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareSegment(D)},renderCleanup:function(E,D){return E.cleanupSegment(D)},render:function(H,J,E){function F(O){var N=Number(O);if(isNaN(O)){N=0}return N}var I=this.isRenderable(),L,K,G,D,M;if(I){L=F(this.geom.xp0.x);K=F(this.geom.xp0.y);G=F(this.geom.xp1.x);D=F(this.geom.xp1.y)}M={renderable:I,p0x:L,p0y:K,p1x:G,p1y:D,width:this.style.width,color:this.style.color,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(M);this.setLineDash(M);H.drawSegment(J,M)},getGeomBounds:function(){var G,K,J,F=this.style.width,I,E,H,D;if(this.state.exists){K=this.mapPathValueToPosition(this.constrainRange(Number.NEGATIVE_INFINITY));J=this.mapPathValueToPosition(this.constrainRange(Number.POSITIVE_INFINITY));K.x=(!isNaN(K.x))?K.x:this.geom.p0.x;K.y=(!isNaN(K.y))?K.y:this.geom.p0.y;J.x=(!isNaN(J.x))?J.x:this.geom.p1.x;J.y=(!isNaN(J.y))?J.y:this.geom.p1.y;I=Math.min(K.x,J.x);E=Math.max(K.x,J.x);H=Math.min(K.y,J.y);D=Math.max(K.y,J.y);G=y.Geom.insetRect({left:I,top:H,right:E,bottom:D},-F);if(!y.Geom.isValidRect(G)){return}}return G},hitTest:function(E,D){return y.Geom.SegmentSectsRect(E,this.geom.xp0,this.geom.xp1)},getSignificantBounds:function(){var E=null,K,J,G=this.style.width,I,F,H,D;if(this.state.exists){K=this.geom.p0;J=this.geom.p1;I=Math.min(K.x,J.x);F=Math.max(K.x,J.x);H=Math.min(K.y,J.y);D=Math.max(K.y,J.y);E=y.Geom.insetRect({left:I,top:H,right:F,bottom:D},-G)}return E},transform:function(E,D){},createTransformer:function(D){var E=D.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(E)},transformGeom:function(F,G){G.p0=E(F.p0);G.p1=E(F.p1);G.xp0=E(F.xp0);G.xp1=E(F.xp1)}}},getZeroPoint:function(){return this.geom.p0},getUnitPoint:function(){return this.geom.p1},getP0:function(){return this.geom.p0},getP1:function(){return this.geom.p1},mapPositionToPathValue:function(D){return this.constrainRange(this.mapPositionToExtendedPathValue(D))},mapPositionToExtendedPathValue:function(D){return y.GeometricPoint.mapPointToLine(this.getZeroPoint(),this.getUnitPoint(),D).param},mapPathValueToPosition:function(F,E){var H=this.getZeroPoint(),G=this.getUnitPoint(),D=G.subtract(H);if(E){E.derivative=this.getP1().subtract(this.getP0())}return D.multiply(F).add(H)},mapVectorPathValuesToPositions:function(E){var J=this.getZeroPoint(),H=this.getUnitPoint(),D=H.subtract(J),G,I=E.length,F=[];for(G=0;G<I;G++){F[G]=D.multiply(E[G]).add(J)}return F},getAnimationRange:function(){var K,F,J,E,D,I,G,H=(this.genus==="Ray")||(this.genus==="Bisector");if(this.genus==="Segment"){return{min:0,max:1}}K=this.sQuery.sketch;F=K.sketchRect();J=y.Geom.IntersectionsOfRectAndSegment(F,this.geom.xp0,this.geom.xp1);if(J.length>0){I=this.mapPositionToPathValue(J[0])}if(J.length===2){G=this.mapPositionToPathValue(J[1])}if((J.length===1)&&H){E=0;D=I}else{if(J.length===2){E=Math.min(I,G);D=Math.max(I,G)}else{E=H?0:-1;D=2}}return{min:E,max:D}},unitLength:function(){return this.getUnitPoint().subtract(this.getZeroPoint()).vLength()},pathLength:function(){var D=this.getAnimationRange(),E=this.mapPathValueToPosition(D.min),F=this.mapPathValueToPosition(D.max);return F.subtract(E).vLength()},getPointOnPath:function(D,E){return this.getPointOnLine(D,E)},getPointOnLine:function(E,G){var F,D;F=E.p1.subtract(E.p0);D=F.vLength();return F.multiply(G/D).add(E.p0)},getPointOnRay:function(E,G){var F,D;if(G<=0){return E.p0}else{F=E.p1.subtract(E.p0);D=F.vLength();return F.multiply(G/D).add(E.p0)}},getPointOnSegment:function(E,G){var F,D;if(G<=0){return E.p0}else{F=E.p1.subtract(E.p0);D=F.vLength();if(D<=G){return E.p1}else{return F.multiply(G/D).add(E.p0)}}},getClosestPointOnLine:function(G,F){var E,I,H,D;E=F.subtract(G.p0);I=G.p1.subtract(G.p0);if(!I.isZeroLength()){H=E.dot(I)/I.dot(I);D=I.multiply(H).add(G.p0)}else{D=G.p0}return D},pointIsInBounds:function(F,E){var G,D=(E===h)?1.5e-21:E;if(this.genus==="Segment"||this.genus==="Ray"){G=F.subtract(this.getP0()).vLength2();if(G<D){return true}}if(this.genus==="Segment"){G=F.subtract(this.getP1()).vLength2();if(G<D){return true}}return this.isValueInBounds(this.mapPositionToExtendedPathValue(F))},isValueInBoundsLineGenus:function(D){return true},isValueInBoundsSegmentGenus:function(E){var F=1.000000000000002,D=-2e-15;return(E>=D)&&(E<=F)},isValueInBoundsRayGenus:function(E){var D=-2e-15;return(E>=D)},isValueInBounds:function(E){var D={Bisector:this.isValueInBoundsRayGenus,Line:this.isValueInBoundsLineGenus,Axis:this.isValueInBoundsLineGenus,Parallel:this.isValueInBoundsLineGenus,Perpendicular:this.isValueInBoundsLineGenus,Ray:this.isValueInBoundsRayGenus,Segment:this.isValueInBoundsSegmentGenus}[this.genus];return y.math.isFiniteScalar(E)&&(D)?D.call(this,E):false},createVectorContext:function(E,D,F){return{numSamples:E,samples:y.createFloatVector(E*4),colors:F?[]:null,lineWidth:D.style.width}},fillSingleSample:function(F,D){var E=4*D;F.filledSampleCount++;F.samples[E]=this.geom.xp0.x;F.samples[E+1]=this.geom.xp0.y;F.samples[E+2]=this.geom.xp1.x;F.samples[E+3]=this.geom.xp1.y;if(F.colors){F.colors[D]=this.style.color}F.geomBounds=y.Geom.unionRectPoint(F.geomBounds,this.geom.xp0);F.geomBounds=y.Geom.unionRectPoint(F.geomBounds,this.geom.xp1)},getGeomBoundsVector:function(E){var D=0;if(E.geomBounds){if(E.lineWidth){D=E.lineWidth/2}return y.Geom.insetRect(E.geomBounds,-D)}},hitTestVector:function(G,J){var F,L,K,H=G.filledSampleCount,I=G.samples,D=4,E;for(F=0;F<H;F++){E=D*F;L=y.GeometricPoint(I[E],I[E+1]);K=y.GeometricPoint(I[E+2],I[E+3]);if(y.Geom.SegmentSectsRect(J,L,K)){return true}}return false},getVectorRenderingLayer:function(D){return"LineLoci"},prepareVectorRendering:function(F,E,D){return F.prepareSegmentVector(D)},renderVector:function(I,D,E,H,F){var G=g.extend(true,{},F);G.samples=H.samples;G.colors=H.colors;G.numSamples=H.filledSampleCount;return I.drawSegmentVector(D,G)},cleanupVectorRendering:function(E,D){return E.cleanupSegmentVector(D)},closedPath:false,verificationString:function f(E,D){var G=(f.base||arguments.callee.base).call(this,E,D),H,F;if(G===""&&this.state.exists){H=y.GeometricPoint(E.p0.x,E.p0.y);F=y.GeometricPoint(E.p1.x,E.p1.y);if(!y.GeometricPoint.expect(H,this.getP0())||!y.GeometricPoint.expect(F,this.getP1())){G+='geom: <span class="error">'+this.getP0()+" -> "+this.getP1()+'</span>(<span class="expected">'+H+" -> "+F+"</span>)"}}return G}});y.gObjects.Text=y.makeClass([y.gObjects.Kind,y.Genus,y.mixins.vector],(function(){function F(H,J){var I={left:H.getX(),top:H.getY(),width:J.width(),height:J.height()};if(J.attrs&&(J.attrs["text-align"]==="center")){I.left-=I.width/2}if(J.attrs&&(J.attrs["vertical-align"]==="middle")){I.top-=I.height/2}return{left:I.left,right:I.left+I.width,top:I.top,bottom:I.top+I.height}}var E={_prepareCommon:function(K,I){var H=y.getFontFamilyFromStyle(K.style,K.sQuery()),L=K.sQuery().getSketch(),M=L.document.resources.fontList||K.sQuery().prefs().fontList;I.kind=K.kind;I.color=K.style.color;I.fontTable=M;I["font-family"]=H;I["font-style"]=K.style["font-style"];I["font-weight"]=K.style["font-weight"];I["font-size"]=K.style["font-size"];I["text-decoration"]=K.style["text-decoration"];I["text-align"]=K.style["text-align"];I["vertical-align"]=K.style["vertical-align"];I.padding=K.style.padding;var J=y.mfs.getLineHeight(I["font-family"],I["font-size"]);if(J){I["line-height"]=J}y.mfs.normalizeFont(H,function(N,O){I[N]=O})},create:function(I,J,H){this._prepareCommon(I,H);H.id=I.id;return J.prepareText(H)},createVector:function(K,N,M,I){var H={},L,O;this._prepareCommon(K,I);H.initialArgs=g.extend(true,{},I);H.sampleRefCons=[];H.parentId=K.id;for(var J=0;J<N.numSamples;J++){L={};O=g.extend(true,{},I);O.id=H.parentId+"vector"+J;L.object=M.prepareText(O);L.visible=true;H.sampleRefCons[J]=L}return H},updateVector:function(O,N,J){var H,M,K,L=J.sampleRefCons.length,I=O.filledSampleCount;for(K=0;K<L;++K){J.sampleRefCons[K].visible=(K<I)}for(K=L;K<I;++K){H={};M=g.extend(true,{},J.initialArgs);M.id=J.parentId+"vector"+K;M.parsedMFS=O.parsedMFSValues[K];H.object=N.prepareText(M);H.visible=true;J.sampleRefCons[K]=H}},cleanupVector:function(K,H){var I,J=(H&&H.sampleRefCons)?H.sampleRefCons.length:0;for(I=0;I<J;++I){K.cleanupText(H.sampleRefCons[I])}}};return{doc:{description:"A displayable message.",inherits:"Kind",refspec:{gspKindRef:"TextKind"},usage:{},properties:{geom:{description:"The basic geometry of the GObject",properties:{loc:{description:"The position of the GObject",properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"}}}}},style:{description:"",properties:{color:{description:"Foreground color of the traced GObject.",type:"Color"},"font-family":{description:"The basis font family for text in this GObject. See GSP.getFontFamilyFromStyle() for supported formats",type:"FontFamily"},"font-size":{description:"The basis font size for text in this GObject",type:"FontSize"},"font-style":{description:"The basis font style (slant) for text in this GObject",type:"FontStyle"},"font-weight":{description:"The basis font weight (boldness) for text in this GObject",type:"FontWeight"},"letter-spacing":{description:"The basis font letter spacing for text in this GObject",type:"LetterSpacing"},"text-decoration":{description:"line-through, underlines, and other variations on the label text",type:"TextDecoration"}}},text:{description:"The message.",required:false,type:"String"},textMFS:{description:"The message formatted as an MFS string.",required:false,type:"String"}}},kind:"Text",style:{"text-align":"left","vertical-align":"top"},state:{},geom:{loc:{x:0,y:0}},autoplacementType:"Measurement",doPostReadFromSpec:function G(){(G.base||G.callee.base).call(this);this.geom.loc=y.GeometricPoint(this.geom.loc.x,this.geom.loc.y)},updateLabelForKind:function D(){(D.base||D.callee.base).call(this);if(this.textMFS){this.parsedMFS=y.mfsParser.parse(this.textMFS)}else{if(this.text){this.parsedMFS=y.mfs.makeTextMFS(this.text)}}},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},getTextType:function(){return"Caption"},beginPulsing:function(){},stopPulsing:function(){},modifyRenderAttrsForCurrentState:function(H){switch(this.state.renderState){case"speculative":H.opacity=y.speculativeOpacity;break;case"targetHighlit":case"matchedGiven":H.targetHighlight=true;break;case"invisible":H.opacity=0;break;case"unmatchedGiven":H.pulse=true;break;case"none":case h:break;default:y.log("Unexpected render state: "+this.state.renderState+" for kind: "+this.kind);break}},renderPrepare:function(I,H){return E.create(this,I,H)},renderCleanup:function(I,H){I.cleanupText(H)},render:function(J,L,H){var O=0,N=0,K=this.isRenderable(),I=K?"visible":"hidden",M=(this.unitPowers&&this.unitPowers.angle===1&&this.sQuery().prefs().units.angle==="rad")?"rad":"scalar",P={visibility:I,constraintFrame:this.state.constraintFrame,opacity:this.calculateOpacity()};if(this.state.selected){return}if(K){O=this.geom.loc.getX();if(isNaN(O)){O=0}N=this.geom.loc.getY();if(isNaN(N)){N=0}P.x=O;P.y=N;P.parsedMFS=this.parsedMFS;if(typeof this.uValue!=="undefined"){P.MFSValues={value:this.formatNumberAsMFS(this.uValue,this.style.precision,M)};this.uValueLast=this.uValue}if(this.parentMFSValues!==h){P.MFSValues=this.parentMFSValues}if(this.isMultimeasure){P.MFSValues=this.getValuesAsMFS()}}this.modifyRenderAttrsForCurrentState(P);J.drawText(L,P)},determineParentalBlank:function(){var I,H=this.parentsList;if(!H){return false}for(I in H){if(H.hasOwnProperty(I)){if(H[I].blank){return true}}}return false},formatNumberAsMFS:function(L,M,K,Q){var O,I=this;function H(R){var S=6;return Math.log(Math.abs(R))*Math.LOG10E>=S}function N(T,S){var V=Math.abs(T),W=Math.floor(Math.log(V)*Math.LOG10E),X=Math.pow(10,W),R=T/X,U=y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(R.toFixed(S)),{type:"symbol",value:"B4"},{type:"super",value:[y.mfs.makeTextMFS("10"),y.mfs.makeTextMFS(W)]});return U}function J(R){var W,S,T,V,U,X=y.math.getSimplePiFraction(R);if(X){T=X.numerator;S=X.denominator;if(T===0){W=y.mfs.makeTextMFS("0")}else{V=Math.abs(T);if(V===1){U={type:"symbol",value:"70"}}else{U=y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(V),{type:"symbol",value:"70"})}if(S===1){W=U}else{W={type:"fraction",value:[y.mfs.makeHorizontalMFS(U),y.mfs.makeTextMFS(S)]};if(T<0){W=y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("-"),W)}}}}else{W=y.mfs.makeTextMFS(R.toFixed(M))}return W}function P(R){var S;S=I.getUnitsMFS&&I.getUnitsMFS();if(!S){return R}return y.mfs.makeHorizontalMFS(R,S)}if(this.blank){O=y.mfs.makeTextMFS(" ")}else{if(isNaN(L)){O=y.mfs.makeTextMFS("undefined")}else{if(!isFinite(L)){if(L===Number.NEGATIVE_INFINITY){O=y.mfs.makeHorizontalMFS({type:"symbol",value:"103"},{type:"symbol",value:"A5"})}else{O={type:"symbol",value:"A5"}}}else{if(K==="rad"){O=J(L)}else{if(H(L)){O=N(L,M)}else{O=L.toFixed(M);O=O.replace(/^-(0(\.0+)?)$/,"$1");O=y.mfs.makeTextMFS(O.replace("-","\u2212"))}}}}}if(Q){return P(O)}return O},getMFSAppearanceForVariant:function(){if(!this.state.exists){return null}var H=g.extend(true,{},this.parsedMFS);if(this.parentMFSValues!==h){y.mfs.realizeParamNodes(H,this.parentMFSValues)}if(this.isMultimeasure){y.mfs.realizeParamNodes(H,this.getValuesAsMFS())}H=y.mfs.replaceNodes(H,"vertical",y.mfs.flattenVerticalNode);return H},constrainLabel:function(){},hitTest:function(I){var J=this.sQuery.sketch.getDisplayObjForGObj(this);var H=F(this.geom.loc,J);return y.Geom.isIntersectRects(H,I)},getGeomBounds:function(){var H=this.sQuery.sketch.getDisplayObjForGObj(this);return H&&F(this.geom.loc,H)},transform:function(I,H){this.geom.loc=H.geom.loc.copy();H.affine.transform(this.geom.loc)},createTransformer:function(H){var I=H.getTransform();return{getAffineTransform:function(){return y.AffineTransform.fromPointTransform(I)},transformGeom:function(J,K){K.loc=I(J.loc)}}},createVectorContext:function(J,I,K){var H={numSamples:J,samples:y.createFloatVector(2*J),parsedMFSValues:[]};if(typeof this.uValue!=="undefined"){H.uValues=[]}return H},fillSingleSample:function(I,H){I.filledSampleCount++;I.samples[H*2]=this.geom.loc.x;I.samples[H*2+1]=this.geom.loc.y;I.parsedMFSValues[H]=this.parsedMFS;if(typeof I.uValues!=="undefined"){I.uValues[H]=this.uValue}},getGeomBoundsVector:function(O){if(!O.geomBounds){var L=O.samples,N=this.sQuery.sketch.getDisplayObjForGObj(this),H=N&&N.sampleRefCons,K=O.filledSampleCount,J,I;if(!H||!H.length){return null}for(var M=0;M<K;++M){J=y.GeometricPoint(L[M*2],L[M*2+1]);if(H[M]){I=F(J,H[M].object);O.geomBounds=y.Geom.unionRects(O.geomBounds,I)}}}return O.geomBounds},hitTestVector:function(M,P){var O=M.samples,H=this.sQuery.sketch.getDisplayObjForGObj(this),I=H&&H.sampleRefCons,N=M.filledSampleCount,Q,J;if(!I||!I.length){return false}for(var L=0,K=N;L<K;++L){Q=y.GeometricPoint(O[L*2],O[L*2+1]);J=F(Q,I[L].object);if(y.Geom.isIntersectRects(J,P)){return true}}return false},getVectorRenderingLayer:function(H){return"Text"},prepareVectorRendering:function(J,I,H){return E.createVector(this,I,J,H)},renderVector:function(I,L,H,P,Q){var J=L,K=J.sampleRefCons,R,N=!Q.hidden,T=(typeof P.uValues!=="undefined"),O=(T&&this.unitPowers&&this.unitPowers.angle===1&&this.sQuery().prefs().units.angle==="rad")?"rad":"scalar",S={constraintFrame:Q.constraintFrame},M;E.updateVector(P,I,J);R=K?K.length:0;for(M=0;M<R;M++){S.visibility=(N&&K[M].visible)?"visible":"hidden";S.x=P.samples[M*2];S.y=P.samples[M*2+1];S.parsedMFS=P.parsedMFSValues[M];if(T){S.MFSValues={value:this.formatNumberAsMFS(P.uValues[M],this.style.precision,O)}}I.drawText(K[M].object,S)}},cleanupVectorRendering:function(I,H){E.cleanupVector(I,H)}}}()));y.gObjects.Arc=y.makeClass([y.gObjects.Kind,y.mixins.label,y.mixins.arcVector,y.genera.Path],{doc:{description:"",inherits:"Kind",refspec:{gspKindRef:"ArcKind"},usage:{},properties:{style:{description:"",properties:{"line-style":{description:"Type of line: 'solid', 'dotted', 'dashed'",type:"String",required:false},width:{description:"The width of the curve line in pixels.",type:"Number"}}}}},kind:"Arc",style:{hidden:false,width:3},hasLabel:true,geom:{},getGeometricArc:function(){return this.geom.arc},radius:function(){return this.geom.arc.radius},doPostReadFromSpec:function m(){(m.base||arguments.callee.base).call(this);this.geom.arc=y.GeometricArc.FromCenterAndRadius(y.GeometricPoint.ORIGIN,0)},getColorableComponent:function(){return"Curves"},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareArc(D)},renderCleanup:function(E,D){return E.cleanupArc(D)},render:function(G,D,F){var E={renderable:this.isRenderable(),arc:this.geom.arc,color:this.style.color,width:this.style.width,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(E);this.setLineDash(E);G.drawArc(D,E)},getArcBounds:function(F,G){var E=F.center,D=F.radius,H={};if(F.pointIsInBounds(y.GeometricPoint(E.x+1,E.y))){H.right=E.x+D}else{H.right=Math.max(F.initialPoint.x,F.finalPoint.x)}if(F.pointIsInBounds(y.GeometricPoint(E.x-1,E.y))){H.left=E.x-D}else{H.left=Math.min(F.initialPoint.x,F.finalPoint.x)}if(F.pointIsInBounds(y.GeometricPoint(E.x,E.y-1))){H.top=E.y-D}else{H.top=Math.min(F.initialPoint.y,F.finalPoint.y)}if(F.pointIsInBounds(y.GeometricPoint(E.x,E.y+1))){H.bottom=E.y+D}else{H.bottom=Math.max(F.initialPoint.y,F.finalPoint.y)+G}return y.Geom.insetRect(H,-G)},getGeomBounds:function q(){if(!this.state.exists){return}var D=this.geom.arc,E=this.style.width;return this.getArcBounds(D,E)},hitTest:function(E,D){return y.Geom.RectIntersectsCurve(E,{type:"arc",curve:this.geom.arc})},transform:function(E,D){},mapPositionToPathValue:function(D){return this.geom.arc.mapPositionToPathValue(D,this.genus)},mapPathValueToPosition:function(E,D){return this.geom.arc.mapPathValueToPosition(E,this.genus,D)},area:function(){return 0},pathLength:function(){return this.geom.arc.getCache(this.genus).perimeterLength},closedPath:false});(function(){var E=5,Z=3.5,J=2.5*Z,D=27,K=2.5*D,F=1.25,I=500,S=15,T=[{expansionFactor:2,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:4},{expansionFactor:2.5,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:5},{expansionFactor:2,diminishmentFactor:2.5,largeTickInterval:2,largeIntervalsPerText:10}],P=[{expansionFactor:2,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:2},{expansionFactor:2.5,diminishmentFactor:2,largeTickInterval:5,largeIntervalsPerText:2},{expansionFactor:2,diminishmentFactor:2.5,largeTickInterval:2,largeIntervalsPerText:5}],H=[{expansionFactor:2,diminishmentFactor:2,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:3/2,diminishmentFactor:12/6,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:4/3,diminishmentFactor:6/4,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:6/4,diminishmentFactor:4/3,largeTickInterval:6,largeIntervalsPerText:2},{expansionFactor:12/6,diminishmentFactor:3/2,largeTickInterval:6,largeIntervalsPerText:2}],Q={"24":{decimal:{precision:6,smallExponentBound:9.9e-7,largeExponentBound:9999999},trigonometric:{precision:3,smallExponentBound:0.000999,largeExponentBound:9999}},"48":{decimal:{precision:3,smallExponentBound:0.000999,largeExponentBound:9999},trigonometric:{precision:3,smallExponentBound:0.000999,largeExponentBound:9999}}},O=function(ab,aa){if(ab==="trigonometric"){return H}if(aa==="vertical"){return P}return T},W=function(af,ae,aa,aj,ai){var ab=O(af,ae),ah=aa,ag=aj,ac=ai,ad=0;if(af==="trigonometric"){ah*=Math.PI;ag*=F;ac*=F}if(ah>0){while(ah<ag){ah*=ab[ad].expansionFactor;ad=(ad+1)%ab.length}}while(ah>ac){ah/=ab[ad].diminishmentFactor;if(--ad<0){ad=ab.length-1}}return{pixelsBetweenTicks:ah,largeTickInterval:ab[ad].largeTickInterval,largeIntervalsPerText:ab[ad].largeIntervalsPerText}};y.gObjects.Axis=y.makeClass([y.gObjects.Straight],{doc:{description:"A one dimensional coordinate line.",inherits:"Straight",refspec:{gspKindRef:"AxisKind"},usage:{},properties:{orientation:{description:"Orientation of the axis: 'horizontal' or 'vertical'.",type:"String"},style:{description:"",properties:{tickNumbering:{description:"Tick mark numbering system: 'decimal' or 'trigonometric'.",type:"String",required:false},tickNumberStyle:{description:"Style of tick numbers: 'auto' for default behavior (show them), 'none' to hide them",type:"String",required:false}}}}},orientation:"horizontal",kind:"Axis",style:{tickNumbering:"decimal",tickNumberStyle:"auto"},geom:{},getColorableComponent:function(){return"Axis"},renderPrepare:function N(ab,aa){return ab.prepareAxis(aa)},renderCleanup:function G(ab,aa){return ab.cleanupAxis(aa)},render:function Y(af,ab,ac){var ae=this.style["font-size"],aa=this.getTickNumberPrecisionInfo(ae,this.style.tickNumbering),ad={renderable:this.isRenderable(),origin:this.geom.origin,orientation:this.orientation,unitPixels:this.getUnitPixels(),isPolar:this.isPolar(),color:this.style.color,"line-style":this.style["line-style"],tickNumbering:this.style.tickNumbering,tickSpacing:this.getTickSpacing(),majorTickLength:E,width:this.style.width,tickNumberStyle:this.style.tickNumberStyle,"font-family":this.style["font-family"],"font-size":ae,precisionInfo:aa,sketchRect:this.sQuery.sketch.sketchRect(),opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(ad);this.setLineDash(ad);af.drawAxis(ab,ad)},hitTest:function M(ab,aa){return(M.base||arguments.callee.base).call(this,ab,aa)},transform:function R(ab,aa){(R.base||arguments.callee.base).call(this,ab,aa)},getZeroPoint:function(){return this.geom.origin},getUnitPoint:function(){return this.geom.unit},getUnitPixels:function(){return this.orientation==="horizontal"?this.geom.unit.x-this.geom.origin.x:-(this.geom.unit.y-this.geom.origin.y)},isPolar:function(){var aa=0,ac=0;function ab(ad){if(ad.kind==="CoordSys"){++aa;if(ad.shape&&(ad.shape==="polar")){++ac}}}this.children.forEach(ab);return(aa>0)&&(aa===ac)},getTickSpacing:function(){return W(this.style.tickNumbering,this.orientation,this.getUnitPixels(),Z,J)},getLineSpacing:function(){return W(this.style.tickNumbering,this.orientation,this.getUnitPixels(),D,K)},getPolarSpacing:function(aa){var ad=O(this.style.tickNumbering,this.orientation),ac={x:aa.x,y:aa.y},ab=0;if(this.style.tickNumbering==="trigonometric"){ac.x*=Math.PI;ac.y*=Math.PI}while(ac.x*ac.y>I){ac.x/=ad[ab].diminishmentFactor;ac.y/=ad[ab].diminishmentFactor;if(--ab<0){ab=ad.length-1}}if((ac.x>0)&&(ac.y>0)){while((ac.x*ac.y<I)||(ac.x<S)||(ac.y<S)){ac.x*=ad[ab].expansionFactor;ac.y*=ad[ab].expansionFactor;if(++ab>=ad.length){ab=0}}}return{pixelsBetweenTicks:{x:ac.x,y:ac.y},largeTickInterval:ad[ab].largeTickInterval,intervalsPerText:ad[ab].largeTickInterval*ad[ab].largeIntervalsPerText}},getTextType:function(){return"AxisTicksAndOptionalLabel"},getTickNumberPrecisionInfo:function(ac,ah){var ab,ae,ad=0,af=1024;for(ab in Q){ae=Number(ab);if((ac<ae)&&(ae<af)){af=ae}else{if(ad<ae){ad=ae}}}if(af>=1024){af=ad}var aa=af<1024?Q[af]:null,ag=aa&&aa[ah];return ag},getGeomBounds:function V(){var ad=3,ab=0.65,ag=2.5,ah=2,ac=E,aj=Math.round(this.style["font-size"]*ab),ae=(this.style.tickNumbering==="trigonometric")?ag:ah,af=this.getTickNumberPrecisionInfo(aj,this.style.tickNumbering),ai=(2+af.precision)*aj,aa=(V.base||arguments.callee.base).call(this);aa=y.Geom.insetRect(aa,-ac);aa.left-=(ai+ad);aa.bottom+=(aj*ae)+ad;return aa},pathLength:function(){return this.geom.unit.subtract(this.geom.origin).vLength()},getPointOnPath:function X(aa,ab){return(X.base||arguments.callee.base).call(this,aa,ab)},getClosestPointOnLine:function U(ab,aa){return(U.base||arguments.callee.base).call(this,ab,aa)},pointIsInBounds:function L(aa){return(L.base||arguments.callee.base).call(this,aa)}})}());y.gObjects.CircleInterior=y.makeClass([y.gObjects.Circle,y.genera.Interior],{doc:{description:"The region comprising the interior of a circle.",inherits:"Circle",refspec:{gspKindRef:"CircleInteriorKind"},usage:{},properties:{style:{properties:{layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)","default":"0.5",type:"Number"}}}}},style:{hidden:false,"line-style":"solid",opacity:0.5,width:1},state:{},kind:"CircleInterior",getColorableComponent:function(){return"Interior"},modifyRenderAttrsForCurrentState:function(D){this.modifyRenderAttrsForInterior(D)},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareCircleInterior(D)},renderCleanup:function(E,D){return E.cleanupCircleInterior(D)},render:function(J,E,G){var D,K,I,H=this.isRenderable();if(H){D=Number(this.geom.c.x);if(isNaN(D)){D=0}K=Number(this.geom.c.y);if(isNaN(K)){K=0}I=Number(this.geom.r);if(isNaN(I)){I=0}}else{D=K=I=-100}var F={renderable:H,cx:D,cy:K,r:I,color:this.style.color,opacity:this.calculateOpacity()};this.modifyRenderAttrsForCurrentState(F);J.drawCircleInterior(E,F)},hitTest:function(E,D){return y.Geom.RectIntersectsCurve(E,{type:"circleInterior",curve:y.GeometricArc.FromCenterAndRadius(this.geom.c,this.geom.r)})},transform:function(E,D){}});y.gObjects.ArcInterior=y.makeClass([y.gObjects.Arc,y.genera.Interior],{doc:{description:"The region comprising the interior of an arc.",inherits:"Arc",refspec:{},usage:{},properties:{style:{properties:{layerOrder:{description:"z-index within the set of Interiors and Images",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)","default":"0.5",type:"Number"}}}}},style:{hidden:false,"line-style":"solid",opacity:0.5,width:1},state:{},kind:"ArcInterior",perimeter:function(){return this.geom.arc.getCache(this.genus).perimeterLength},area:function(){var E=this.geom.arc,D=E.radius*E.radius,F=E.arcAngle*D;if("ArcSegment"===this.genus){F-=D*Math.sin(E.arcAngle)}return F/2},getColorableComponent:function(){return"Interior"},modifyRenderAttrsForCurrentState:function(D){this.modifyRenderAttrsForInterior(D)},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.prepareArcInterior(D)},renderCleanup:function(E,D){return E.cleanupArcInterior(D)},render:function(G,D,F){var E={renderable:this.isRenderable(),arc:this.geom.arc,genus:this.genus,opacity:this.calculateOpacity(),color:this.style.color};this.modifyRenderAttrsForCurrentState(E);G.drawArcInterior(D,E)},getGeomBounds:function q(){var D=(q.base||arguments.callee.base).call(this);if(D){D=y.Geom.unionRectPoint(D,this.geom.arc.center)}return D},hitTest:function(F,D){var E=this.genus==="ArcSector"?"arcSector":"arcSegment";return y.Geom.RectIntersectsCurve(F,{type:E,curve:this.geom.arc})},transform:function(E,D){},closedPath:true});(function(){y.gObjects.CoordSys=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"A Coordinate System.",inherits:"Kind",refspec:{gspKindRef:"CoordSysKind"},usage:{},properties:{shape:{description:"Type or coordinate system: 'polar', 'square', or 'rectangular'.",type:"String"},style:{description:"",properties:{grid:{description:"Appearance of the coordinate system grid: 'gridlines' or 'dotted'",type:"String"},width:{description:"Line width for 'gridlines' coordinate systems",type:"Number"},radius:{description:"Radius of points for 'dotted' coordinate systems",type:"Number"}}}}},kind:"CoordSys",style:{width:0.5,radius:1.5},geom:{},doPostReadFromSpec:function D(){(D.base||arguments.callee.base).call(this);this.geom.origin=y.GeometricPoint.ORIGIN;this.geom.unit0=y.GeometricPoint.ORIGIN;this.geom.unit1=y.GeometricPoint.ORIGIN},getColorableComponent:function(){return"CoordSys"},renderPrepare:function(F,E){return F.prepareCoordSys(E)},renderCleanup:function(F,E){return F.cleanupCoordSys(E)},render:function(H,E,G){var F={renderable:this.isRenderable(),origin:this.geom.origin,shape:this.shape,grid:this.style.grid,gridSpacing:this.geom.gridSpacing,radius:this.style.radius,opacity:this.calculateOpacity(),color:this.style.color,width:this.style.width,sketchRect:this.sQuery.sketch.sketchRect()};this.modifyRenderAttrsForCurrentState(F);H.drawCoordSys(E,F)},hitTest:function(F,P){var I=function(aa,X){var Z=[{cos:1,sin:0},{cos:0.96592582628907,sin:0.25881904510252},{cos:0.86602540378444,sin:0.5},{cos:0.70710678118655,sin:0.70710678118655},{cos:0.5,sin:0.86602540378444},{cos:0.25881904510252,sin:0.96592582628907},{cos:0,sin:1}];var ac,ab,Y;for(ac=0;ac<7;ac++){ab=Z[ac].cos*X;Y=Z[ac].sin*X;if(y.Geom.PointInRect(y.GeometricPoint(ab,Y),aa)){return true}if(y.Geom.PointInRect(y.GeometricPoint(ab,-Y),aa)){return true}if(y.Geom.PointInRect(y.GeometricPoint(-ab,Y),aa)){return true}if(y.Geom.PointInRect(y.GeometricPoint(-ab,-Y),aa)){return true}}return false};if(this.shape==="polar"){var H={x:this.geom.unit0.x-this.geom.origin.x,y:-(this.geom.unit1.y-this.geom.origin.y)},Q=this.getParent("axisX").getPolarSpacing(H).pixelsBetweenTicks,N=Q.y/Q.x,V={left:(F.left-this.geom.origin.x)*N,right:(F.right-this.geom.origin.x)*N,top:F.top-this.geom.origin.y,bottom:F.bottom-this.geom.origin.y},J,M,W,S,K;if(y.Geom.PointInRect(y.GeometricPoint(0,0),V)){return true}J=V.top*V.top+V.left*V.left;M=J;W=V.top*V.top+V.right*V.right;M=(W>M)?W:M;J=(W<M)?W:J;W=V.bottom*V.bottom+V.left*V.left;M=(W>M)?W:M;J=(W<M)?W:J;W=V.bottom*V.bottom+V.right*V.right;M=(W>M)?W:M;J=(W<J)?W:J;S=Q.y;K=S*S;while(K<J){S+=Q.y;K=S*S}while(K<M){if(I(V,S)){return true}S+=Q.y;K=S*S}return false}else{var T={left:F.left-this.geom.origin.getX(),right:F.right-this.geom.origin.getX(),top:F.bottom-this.geom.origin.getY(),bottom:F.top-this.geom.origin.getY()};var L=this.getParent("axisX").getLineSpacing().pixelsBetweenTicks;var G=Math.floor(T.left/L)*L;var U=T.right-G;if(U<L){return false}var E=this.getParent("axisY").getLineSpacing().pixelsBetweenTicks;var O=Math.floor(T.bottom/E)*E;var R=T.top-O;if(R<E){return false}return true}},locatePlot:function(E,J){var I=this.geom.unit0.x-this.geom.origin.x,F=this.geom.origin.x,H=this.geom.unit1.y-this.geom.origin.y,G=this.geom.origin.y;return y.GeometricPoint(E*I+F,J*H+G)},vectorLocatePlot:function(N){var I=N.length,K=y.createFloatVector(I),G,E=this.geom.unit0.x-this.geom.origin.x,F=this.geom.origin.x,H=this.geom.unit1.y-this.geom.origin.y,M=this.geom.origin.y,L,J;if(K.set){K.set(N)}else{K=N.concat()}for(G=0;G<I;G+=2){L=K[G];J=K[G+1];K[G]=L*E+F;K[G+1]=J*H+M}return K},locatePoint:function(F){var H=this.geom.unit0.subtract(this.geom.origin),G=this.geom.unit1.subtract(this.geom.origin),J=F.subtract(this.geom.origin),E=J.x/H.x,I=J.y/G.y;return y.GeometricPoint(E,I)},snapPoint:function(G,J){var Q=this.geom.origin.x,N=this.geom.origin.y,L=this.geom.unit0.x-this.geom.origin.x,K=this.geom.unit1.y-this.geom.origin.y,E=G.x,S=G.y;if(h===J){J=100}if(this.shape==="polar"){var P=(G.x-Q)/L,M=(G.y-N)/K,H=Math.round(Math.sqrt(P*P+M*M)),F=0;if(0!==H){var I=Math.PI/12;F=Math.atan2(-M,P);F=Math.round(F/I)*I}E=Q+L*H*Math.cos(F);S=N-K*H*Math.sin(F)}else{E=Math.round((G.x-Q)/L)*L+Q;S=Math.round((G.y-N)/K)*K+N}var R=Math.abs(E-G.x),O=Math.abs(S-G.y);if(!J||((R<J)&&(O<J))){G.x=E;G.y=S}},createDefaultSpec:function(O,N){var G=(N&&N.origin&&N.origin.style)||{},K=(N&&N.xUnitPoint&&N.xUnitPoint.style)||{},Q=(N&&N.xAxis&&N.xAxis.style)||{},P=(N.yUnitPoint&&N.yUnitPoint.style)||{},J=(N&&N.yAxis&&N.yAxis.style)||{},M=(N&&N.shape)||"square",F=(N&&N.style)||{},E=M==="rectangular";var L={"1":{kind:"Point",genus:"OriginPoint",constraint:"Free",style:G},"2":{kind:"Point",genus:"UnitPoint",parents:{origin:"1"},value:28.346456692913385,constraint:"HorizontalUnitPoint",style:K},"3":{kind:"Axis",genus:"Axis",parents:{origin:"1",unitPoint:"2"},constraint:"AxisInternalDist",orientation:"horizontal",label:"x",style:Q},"4":{kind:"Point",genus:"UnitPoint",parents:{unitPoint:"2"},constraint:"UnitPointInternalSquare",style:P},"5":{kind:"Axis",genus:"Axis",parents:{origin:"1",unitPoint:"4"},constraint:"AxisInternalDist",orientation:"vertical",label:"y",style:J},"6":{kind:"CoordSys",genus:"CoordSys",parents:{axisX:"3",axisY:"5"},constraint:"CoordSys",shape:M,style:F}};var I=(O.metadata.sketchRect.right-O.metadata.sketchRect.left)/2;var H=(O.metadata.sketchRect.bottom-O.metadata.sketchRect.top)/2;L["1"].geom={loc:{x:I,y:H}};if(E){L["4"].constraint="UnitPointInternalRectangle";L["4"].unitDistance=28.346456692913364}return L}})}());y.gObjects.Measure=y.makeClass([y.gObjects.Text,y.mixins.labelBase],{doc:{description:"A message rendered in to a sketch canvas.",inherits:"Text",properties:{label:{description:"Text that describes or identifies the value of this object.",type:"String",required:false},style:{properties:{precision:{description:"The number of digits to display after the decimal point.",type:"Number",required:false},nameOrigin:{description:"What identifying value to display.",type:"NameOrigin",required:false},showUnits:{description:"Do we show the unit measurement?",required:false}}},blank:{description:"a display property indicating that the value or result of the calculation should be blank",type:"Boolean","default":false,required:false},debug:{properties:{value:{description:"The numeric value of a measure",required:false,type:"Number"},defined:{description:"Whether the measure is defined",required:false,type:"Boolean"}}}}},kind:"Measure",style:{precision:h,showUnits:true},unitPowers:{scalar:1},initPrecision:function(){var F="scalar",D=this.unitsObject.hasOwnProperty("length"),E=this.unitsObject.hasOwnProperty("angle"),G;if(!(D&&E)){if(D){F="length"}if(E){F="angle"}}if(this.style.precision!==h){G=this.style.precision}else{G=this.sQuery().prefs().precision[F]}return G},initKind:function j(){(j.base||arguments.callee.base).call(this);this.initMeasure();this.style.precision=this.initPrecision(this.sQuery().prefs())},updateLabelForKind:function e(){(e.base||arguments.callee.base).call(this);this.generateMeasureMFS()},initMeasure:function k(){this.setUnits(this.unitPowers);if(this.value!==h){this.uValue=y.units.convertFromBaseToUnitObject(this.value,this.unitsObject)}},generateMeasureMFS:function p(){var D=[],E=this.getNameMFS(),F;if(this.style.nameOrigin==="namedFromFixedString"){this.parsedMFS=y.mfs.makeTextMFS(this.label);return}if(this.style.nameOrigin!=="noVisibleName"){D.push(E);D.push(y.mfs.makeTextMFS(" = "))}D.push(this.getValueMFS());F=this.getUnitsMFS();if(F!==null){D.push(F)}if(this.style.suffix){D.push(y.mfs.makeTextMFS(this.style.suffix))}this.parsedMFS=y.mfs.makeHorizontalMFS.apply(this,D)},getValueMFS:function w(){return{type:"parameter",value:"value"}},getNameMFS:function(){var E,D=this.style.nameOrigin,F;switch(D){case"namedFromLabel":E=this.label?this.label.replace(/ += +$/,""):"";F=y.labels.parseLabelExpression(E,this.getMathItalicization());break;case"noVisibleName":F=y.mfs.makeTextMFS("");break;case"namedFromTemplate":F=this.getParentalNameMFS();break;default:F=y.mfs.makeTextMFS("Measure "+this.id);break}return F},setUnits:function(D){this.unitPowers=D;this.unitsObject=y.units.makeUnitObjectFromUnitsAndPowers(this.sQuery().prefs().units,D)},getUnitsMFS:function(){if(this.style.showUnits===false){return y.mfs.makeTextMFS("")}return y.units.getMFSForUnitObject(this.unitsObject)},getRawValue:function(){return this.value},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},getTextType:function(){return"Measurement"},getMFSAppearanceForVariant:function c(G){var I=this,D,F=[],J;function H(){var L=(I.unitPowers&&I.unitPowers.angle===1&&I.sQuery().prefs().units.angle==="rad")?"rad":"scalar";return I.formatNumberAsMFS(I.uValue,I.style.precision,L,true)}switch(G){case"valueAsAddend":if(!this.state.exists){return null}if(I.uValue<0){F.push(y.mfs.makeTextMFS(" "));F.push({type:"symbol",value:"103"});F.push(y.mfs.makeTextMFS(" "))}else{F.push(y.mfs.makeTextMFS(" + "))}D=I.uValue;I.uValue=Math.abs(I.uValue);F.push(H());J=y.mfs.makeHorizontalMFS.apply(this,F);I.uValue=D;return J;case"byLabel":return this.getLabelMFS();case"byName":return this.getParentalNameMFS();default:if(!this.state.exists){return null}var E=(G==="default"&&this.style.prefixWithLabel&&this.label);if(E||this.style.suffix){var K=[H()];if(E){K.unshift(y.mfs.makeTextMFS(this.label))}if(this.style.suffix){K.push(y.mfs.makeTextMFS(this.style.suffix))}return y.mfs.makeHorizontalMFS.apply(this,K)}else{return H()}}},verificationString:function f(F,E){var H=(f.base||arguments.callee.base).call(this,F,E);var D,G;if(F.exists&&this.state.exists){if(this.genus!=="Function"){if(!y.math.expect(this.uValue,F.value)){H+='value: <span class="error">'+this.uValue+'</span>(<span class="expected">'+F.value+"</span>)"}D=this.unitPowers.length?this.unitPowers.length:0;if(!y.math.expect(D,F.lengthPower)){H+='length power: <span class="error">'+D+'</span>(<span class="expected">'+F.lengthPower+"</span>)"}G=this.unitPowers.angle?this.unitPowers.angle:0;if(!y.math.expect(G,F.anglePower)){H+='length power: <span class="error">'+G+'</span>(<span class="expected">'+F.anglePower+"</span>)"}}}return H}});y.gObjects.Expression=y.makeClass(y.gObjects.Measure,(function(){var K=y.makeClass(y.TouchTracker,{forwardTouchToSystem:true});return{doc:{description:"A numeric expression.",inherits:"Measure",properties:{expression:{description:"An infix expression",type:"String"},expressionType:{description:"The type of expression. Used mainly for interpreting functions.",type:"UnivExpressionType"},functionExpr:{description:"A set of properties used for function expressions.",required:false,properties:{notation:{description:"Display notation type of the function: 'function' (e.g. 'f(x)') or 'dependentVariable' (e.g. 'y =')",type:"String",required:false},name:{description:"The name of the function, e.g. 'f' in 'y = f(x)'.",type:"String",required:false},dependentVar:{description:"The name of the dependent variable, e.g. 'y' in 'y = f(x)'.",type:"String",required:false},independentVar:{description:"The name of the independent variable, e.g. 'x' in 'y = f(x)'.",type:"String",required:false}}},style:{description:"Properties that influence the appearance of a GObject.",properties:{contenteditable:{description:"Whether the element is inline-editable. Applicable only to Parameters.",type:"Boolean"}}}}},kind:"Expression",expression:"",isExpressionDirty:false,unitPowers:{scalar:1},notation:"function",parsedInfix:h,style:{contenteditable:false},value:h,isFunction:function(){return this.expressionType!=="UniMeasure_ExprType"},isParameter:function(){return((this.genus==="ScalarParameter")||(this.genus==="AngleParameter")||(this.genus==="DistanceParameter"))},renderPrepare:function I(N,M){if(!this.isParameter()){M.isEditableByCalculator=true}return(I.base||arguments.callee.base).apply(this,arguments)},initMeasure:function D(){var M=this.sQuery().prefs().units;this.unit="";if(this.genus==="AngleParameter"){this.setUnits({angle:1});this.unit=M.angle}else{if(this.genus==="DistanceParameter"){this.setUnits({length:1});this.unit=M.length}}this.parseInfixExpression()},initPrecision:function H(){if(!this.isFunction()){return(H.base||arguments.callee.base).call(this)}return h},getValueMFS:function E(){if(this.isFunction()){return y.mfs.makeMFSFromParsedInfix(this.parsedInfix,this.parentsList,true,this.getMathItalicization())}else{if(this.isEditableSimpleExpression()){return{type:"input",value:"value"}}else{return{type:"parameter",value:"value"}}}},isHittable:function G(){return this.isRenderable()&&(this.style.contenteditable||this.style.selectable)},hitTest:function(P,O){var R=this.sQuery.sketch.getDisplayObjForGObj(this),Q={left:this.geom.loc.getX(),top:this.geom.loc.getY(),width:R.width(),height:R.height()},N={left:Q.left,right:Q.left+Q.width,top:Q.top,bottom:Q.top+Q.height},T={left:Math.max(P.left,N.left),right:Math.min(P.right,N.right),top:Math.max(P.top,N.top),bottom:Math.min(P.bottom,N.bottom)},M=(T.left<T.right&&T.top<T.bottom),S=false;if(M&&O&&(this.style.contenteditable||this.state.selected)){g(".mfs-input",g(R.element)).each(function(){var V=g(this).convertPointFromPage(O.pageX,O.pageY,O.mouseEvent),U=V.x>=0&&V.y>=0&&V.x<=g(this).outerWidth()&&V.y<=g(this).outerHeight();if(U){S=true;return false}})}if(S){return Object.create(K)}if(M&&this.style.selectable){return true}return false},presentUI:function(P,O){var M;var N=P.mfsElement;if(this.isParameter()){M=g(".mfs-input",N).data("wsp-numfield-ctl")}else{M=g(N).data("wsp-numfield-ctl")}if(O){M.setListener(function(Q){O(Q);M.clearListener()})}M.vFocus(this)},doubleClicked:function(O){var N=this.sQuery.sketch.getDisplayObjForGObj(this).element;var M=g(N).data("wsp-numfield-ctl");if(M){M.click(O,this)}},makeFnFromInfixExpression:function(){var M=y.mfs.getParsedInfixAndFunction(this.expression);this.parsedInfix=M.parsedInfix;this.setUnits(y.mfs.determineUnit(this.parsedInfix,this.parentsList));this.unitMultiplier=y.units.convertToBaseFromUnitObject(1,this.unitsObject);return M.func},getUnitPowers:function(M){return y.mfs.determineUnit(this.parsedInfix,this.parentsList,M)},curryReferences:function(N,O,M){return function(P){var Q=N.functionExpr&&N.functionExpr.independentVar?N.functionExpr.independentVar:"x";O[Q]=P;return N.fnExpression(O,M)}},parseInfixExpression:function(N){var M=this.sQuery().prefs().units;if(N!==h){this.expression=N}this.fnExpression=this.makeFnFromInfixExpression();this.fnUnits=this.sQuery().prefs().units;if(this.constraint==="Free"){if(!this.isFunction()){this.uValue=this.fnExpression([],M);this.value=this.uValue*this.unitMultiplier}else{var O=this;this.uValue=this.curryReferences(this,[],M);this.value=function(P){return O.uValue(P)*O.unitMultiplier}}this.isExpressionDirty=false}},isEditableSimpleExpression:function(){if(!this.style.contenteditable){return false}if(this.parsedInfix===h){this.parsedInfix=y.mfs.getParsedInfix(this.expression)}return y.mfs.isSimpleExpression(this.parsedInfix)},getUnitsMFS:function L(){if(this.isFunction()){return null}return(L.base||arguments.callee.base).call(this)},getNameMFS:function(){if(this.functionExpr){var T=this.getMathItalicization(),R=this.getLabelMFS()||y.mfs.makeTextMFS("f",T),N=y.mfs.makeTextMFS(this.functionExpr.dependentVar||"y",T),S=y.mfs.makeTextMFS(this.functionExpr.independentVar||"x",T),M=this.functionExpr.notation==="function"?[R,{type:"paren",value:[S]}]:[N];return y.mfs.makeHorizontalMFS.apply(this,M)}var P,O=this.style.nameOrigin,Q;switch(O){case"namedFromLabel":case"noVisibleName":P=this.label?this.label.replace(/ = $/,""):"";Q=y.labels.parseLabelExpression(P);break;case"namedFromTemplate":Q=this.createMFSFromInfixExpression();break;default:Q=y.mfs.makeTextMFS("Expression "+this.id);break}return Q},createMFSFromInfixExpression:function(){if(this.parsedInfix===h){this.parsedInfix=y.mfs.getParsedInfix(this.expression)}return y.mfs.makeMFSFromParsedInfix(this.parsedInfix,this.parentsList,false)},getMFSAppearanceForVariant:function J(M){var O=this;function N(){var P=O.getMathItalicization();switch(M){case"expressionOnly":if(!O.parsedInfix){O.parseInfixExpression()}return y.mfs.makeMFSFromParsedInfix(O.parsedInfix,O.parentsList,true,O.getMathItalicization());case"independentVariable":return y.mfs.makeTextMFS(O.functionExpr.independentVar||"x",P);case"dependentVariable":return y.mfs.makeTextMFS(O.functionExpr.dependentVar||"y",P);case"byLabel":return O.getLabelMFS();default:return O.parsedMFS}}if(this.isFunction()){return N()}if(M==="byName"){return this.createMFSFromInfixExpression()}else{return(J.base||arguments.callee.base).call(this,M)}},updateValue:function(M){if((typeof M==="function")||(typeof this.value==="function")){throw y.createError("Expression.updateValue() called on function or with value arg that is a function")}this.value=M;this.uValue=this.value/this.unitMultiplier;this.isExpressionDirty=true;this.fnExpression=h;this.parsedInfix=h;this.sQuery().invalidateGeom(this)},prepareToSerialize:function(){if(this.isExpressionDirty){this.setParameterValue(this.uValue,this.unit)}},setEditedValue:function(N){var S,R,O=N.trim(),M=false,T=M?this.sQuery().prefs().units:h,P=(N===""),U=false;try{R=y.mfs.getParsedInfixAndFunction(O);S=R.func&&R.func([],T);U=y.math.isFiniteScalar(S)}catch(Q){}if(U||P){this.setParameterValue(O);this.blank=P}this.sQuery().invalidateGeom(this)},setParameterValue:function(S,R){var O=this.fnExpression,T=this.expression,P=this.parsedInfix,M=R||this.unit;this.expression=String(S);if(this.expression!==""&&M){this.expression="("+this.expression+")*1"+M}this.parsedInfix=h;try{this.fnExpression=this.makeFnFromInfixExpression()}catch(Q){Q.message="In expression: '"+this.expression+"': "+Q.message;y.signalCaughtError(Q);this.fnExpression=O;this.expression=T;this.parsedInfix=P}var N=this.sQuery().prefs().units;this.uValue=this.fnExpression([],N);this.value=this.uValue*this.unitMultiplier;this.isExpressionDirty=false;this.sQuery().invalidateGeom(this)},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},verificationString:function F(P,M){var Q=(F.base||arguments.callee.base).call(this,P,M);if(this.blank||/^isDefined\(/.test(this.expression)){return"NO_VERIFICATION"}else{if(P.exists&&this.state.exists){if(this.isFunction()){var N=this.uValue(0),O=this.uValue(1);if(!y.math.expect(N,P.zeroValue)){Q+='Function zero value: <span class="error">'+N+'</span>(<span class="expected">'+P.zeroValue+"</span>)"}if(!y.math.expect(O,P.oneValue)){Q+='Function one value: <span class="error">'+O+'</span>(<span class="expected">'+P.oneValue+"</span>)"}}}}return Q}}})());y.gObjects.AngleMarker=y.makeClass(y.gObjects.Arc,(function(){var G=0.001,D=0.7071067811865475,E=4;return{doc:{description:"Marks the span of an angle. In geometry, angle markers are used to assert congruency relationships.",inherits:"Arc",refspec:{gspKindRef:"AngleMarkerKind"},properties:{style:{properties:{"inner-radius":{description:"The arc radius contained within the angle marker, in pixels",type:"Number"},opacity:{description:"0 (transparent) to 1 (fully opaque)",type:"Number"},"radial-spacing":{description:"The separation between arc strokes in an angle marker, in pixels",type:"Number"},"show-angle-direction":{description:"Whether to show a direction arrow.",type:"Boolean"},strokes:{description:"The number of strokes to draw for the marker.",type:"Number"}}}}},kind:"AngleMarker",hasLabel:true,geom:{},invertArrowhead:false,style:{"show-angle-direction":false,"inner-radius":24,opacity:0.25,"radial-spacing":3,strokes:1},getAngleMarkerMFS:function(I){var L=this.getParent("p0"),K=this.getParent("p1"),J=this.getParent("p2"),M=[L.getNameMFS(),K.getNameMFS(),J.getNameMFS()];if(I){M.unshift({type:"symbol",value:"d0"})}return y.mfs.makeHorizontalMFS.apply(this,M)},getNameMFSForLabel:function(){return this.getAngleMarkerMFS(false)},getColorableComponent:function(){return"AngleMarker"},renderPrepare:function(J,I){I={kind:this.kind,id:this.id,strokes:this.style.strokes};return J.prepareAngleMarker(I)},renderCleanup:function(J,I){return J.cleanupAngleMarker(I)},render:function(K,N,I){var Q=this.getParent("p0"),O=this.getParent("p1"),M=this.getParent("p2"),U=Q.geom.loc,S=O.geom.loc,R=M.geom.loc,J=y.Geom.ThreePointCollinear(U,S,R).orientation,P=this.geom.arc,L,T;if(P){L=P.arcAngle<=Math.PI?(J<0):(J>=0);T={color:this.style.color,firstArc:P,isRight:Math.abs((P.arcAngle)-Math.PI/2)<G,opacity:this.style.opacity,fadeOpacity:this.calculateFadeOpacity(),radialSpacing:this.style["radial-spacing"],renderable:this.isRenderable(),"show-angle-direction":this.style["show-angle-direction"],invertArrowhead:this.invertArrowhead,strokes:this.style.strokes,width:this.style.width,swap:L};this.modifyRenderAttrsForCurrentState(T);K.drawAngleMarker(N,T)}},getGeomBounds:function F(){if(!this.state.exists||!this.geom.arc){return}var M=this.geom.arc,N=this.style.width,O=this.style.strokes,U=this.style["radial-spacing"],L=this.style.width,R=Math.abs((M.arcAngle)-Math.PI/2)<G,P=R?D:1,Q=(M.radius*P)+(O-1)*(U+L),J,T,K,S=[],I;if(this.style["show-angle-direction"]){N+=E}if(R){S.push(M.center);J=M.initialPoint.subtract(M.center).unit().multiply(Q);S.push(M.center.add(J));S.push(M.center.add(new y.GeometricPoint(-J.y,J.x)));S.push(S[2].add(J));I={};g.each(S,function(W,V){if((I.left===h)||(I.left>V.x)){I.left=V.x}if((I.top===h)||(I.top>V.y)){I.top=V.y}if((I.right===h)||(I.right<V.x)){I.right=V.x}if((I.bottom===h)||(I.bottom<V.y)){I.bottom=V.y}});I=y.Geom.insetRect(I,-N)}else{J=M.initialPoint.subtract(M.center).unit().multiply(Q).add(M.center);T=M.finalPoint.subtract(M.center).unit().multiply(Q).add(M.center);K=y.GeometricArc.FromCenterAndEndpoints(M.center,J,T);I=this.getArcBounds(K,N);I=y.Geom.unionRectPoint(I,this.geom.arc.center)}return I},hitTest:function(P,L){var M=this,O,S,I,Q,N,K,R;function J(){var U=y.GeometricArc.FromCenterAndEndpoints(M.geom.arc.center,S,I,1);return y.Geom.RectIntersectsCurve(P,{type:"arcSector",curve:U})}function T(){return y.Geom.ParallelogramSectsRect(P,S,M.geom.arc.center,I)}if(!this.geom.arc){return false}Q=Math.abs(this.geom.arc.arcAngle-Math.PI/2)<G;N=Q?D:1;O=this.geom.arc.radius*N+((this.style["radial-spacing"]+this.style.width)*(this.style.strokes-1));K=y.GeometricPoint(Math.cos(this.geom.arc.initialAngle),Math.sin(this.geom.arc.initialAngle)).multiply(O);R=y.GeometricPoint(Math.cos(this.geom.arc.finalAngle),Math.sin(this.geom.arc.finalAngle)).multiply(O);S=K.add(this.geom.arc.center);I=R.add(this.geom.arc.center);if(Q){return T()}else{return J()}},verificationString:function H(J,I){var K=(H.base||arguments.callee.base).call(this,J,I);if(J.exists&&this.state.exists){if(!y.math.expect(this.value,J.value)){K+='value: <span class="error">'+this.value+'</span>(<span class="expected">'+J.value+"</span>)"}}return K}}}()));y.gObjects.PathMarker=y.makeClass([y.gObjects.Kind,y.Genus],{doc:{description:"A location in the Euclidean plane.",inherits:"Kind",refspec:{gspKindRef:"PathMarkerKind"},usage:{},properties:{style:{description:"",properties:{color:{description:"Foreground color of the path marker.",type:"Color"},"tick-mark-style":{description:"type of tick marks",type:"TickMarkStyle"},"arrow-direction":{description:"The direction of the arrows of the path marker.",type:"ArrowDirection"},width:{description:"Width of the strokes in pixels",type:"Number"},strokes:{description:"The number of strokes to draw for the marker.",type:"Number"}}}}},kind:"PathMarker",style:{hidden:false,label:{showLabel:false},selectable:true,traced:false,width:3,"tick-mark-style":"Crossbar",strokes:1,"arrow-direction":"Forward"},state:{},renderPrepare:function(E,D){D.kind=this.kind;D.id=this.id;return E.preparePathMarker(D)},renderCleanup:function(E,D){return E.cleanupPathMarker(D)},render:function(K,E,H){var J,D,G,F=this.calculateOpacity(),I=this.style;if(this.state.renderState==="invisible"){return}D=I.color;J=this.isRenderable();G={renderable:J,metrics:this.state.renderMetrics,color:D,width:I.width,opacity:F,strokes:I.strokes,"tick-mark-style":I["tick-mark-style"]};this.modifyRenderAttrsForCurrentState(G);K.drawPathMarker(E,G)},calculateRenderMetrics:function(){var F={},I=this.geom.normal,J=this.style["tick-mark-style"],O=this.style.strokes,R,K,Q,P,N,M,L=J!=="Crossbar",E=6+1.5*this.style.width,H=E,D=O-1,G;switch(J){case"Crossbar":H*=0.5;E*=0.75;break;case"OpenArrow":H*=0.75;D++;break;case"HollowArrow":case"SolidArrow":H*=1;D++;break}G=O*H;F.delta=y.GeometricPoint(-H*I.y,H*I.x);F.normal=I.multiply(E);F.len=y.GeometricPoint(-G*I.y,G*I.x);F.diagonal=F.normal.add(F.len);R=F.delta.multiply(D*0.5);F.origin=this.geom.loc.subtract(R);K=F.origin;if(!L){K=K.subtract(F.delta.multiply(1.5))}Q=K.add(F.normal);P=K.subtract(F.normal);K=F.origin.add(F.len);K=K.add(F.delta.multiply(0.5));N=K.add(F.normal);M=K.subtract(F.normal);F.boundingQuad={A:Q,B:P,C:M,D:N};F.boundingRect=y.Geom.boundingRect(Q,P,N,M);return F},getGeomBounds:function(){var D,E=this.style.width/2;if(this.state.exists){D=y.Geom.insetRect(this.state.renderMetrics.boundingRect,-E)}return D},hitTest:function(F,D){var E=this.state.renderMetrics.boundingQuad;return y.Geom.ParallelogramSectsRect(F,E.A,E.B,E.C)},verificationString:function f(E,D){var F=(f.base||arguments.callee.base).call(this,E,D),G;if(F===""&&this.state.exists){G=y.GeometricPoint(E.loc.x,E.loc.y);if(!y.GeometricPoint.expect(G,this.geom.loc)){F+='loc: <span class="error">'+this.geom.loc+'</span>(<span class="expected">'+G+"</span>)"}}return F}});y.gConstraints.Constraint={doc:{description:"The parent class for all constraints.",refspec:{},usage:{"abstract":true},supported:true,properties:{}},constraintSupportsSpecObj:function(){return true},initConstraint:function(){},updateConstraintAncestry:function(){},supportsAutoplacement:function(){return h!==this.autoplacementType},updateLabelForConstraint:function i(){},constrain:function(){this.state.exists=false;throw y.createError("Unimplemented method")},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Object "+this.id)},constraintVerificationString:function z(D){return""}};y.gConstraints.Unknown=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Placeholder for an unrecognized constraint.",inherits:"Constraint",refspec:{msg:"An artifact of convenience of the application design."},usage:{"abstract":true},properties:{}},constraint:"Unknown",constrain:function(){this.state.exists=false;this.state.supported=false}});y.gConstraints.Free=y.makeClass(y.gConstraints.Constraint,{doc:{description:"An object with a free constraint can be dragged anywhere in the sketch space and is not bound by any dependencies that affect its geometry.",inherits:"Constraint",refspec:{gspRef:"Free_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Free_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point","Expression","Text"]},existenceRule:"Exists iff the coordinates of its location exist.",properties:{geom:{description:"The basic geometry of the GObject",properties:{loc:{description:"The position of the GObject",properties:{x:{description:"The horizontal screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"},y:{description:"The vertical screen coordinate relative to the canvas upper left, in pixel units.",type:"Number"}}}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Free_export.json"},constrain:function(){this.state.exists=this.geom.loc&&this.geom.loc.isDefined()}});y.gConstraints.PictureFree=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A free picture can be dragged anywhere in the sketch space and is not bound by any dependencies that affect its geometry.",inherits:"Constraint",refspec:{gspRef:"Free_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Free_C, when applied to Pictures in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Picture"]},existenceRule:"Exists iff its image exists.",properties:{geom:{description:"The basic geometry of the GObject",properties:{transform:{description:"Affine transform of picture from its original (0,0)x(width,height) position.",type:"AffineTransform",properties:{m00:{description:"m00",type:"Number"},m01:{description:"m01",type:"Number"},m10:{description:"m10",type:"Number"},m11:{description:"m11",type:"Number"},m20:{description:"m20",type:"Number"},m21:{description:"m21",type:"Number"}}}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Picture-Misc_export.json"},constrain:function(){this.state.exists=true}});y.gConstraints.PictureNonFree=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Abstract base class for picture constraints.",inherits:"Constraint",refspec:{msg:"This class is an internal object and doesn't have an independent source of requirements."},usage:{"abstract":true,kinds:["Picture"]}}});y.gConstraints.Locus=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A virtual base class for locus subclasses",inherits:"Constraint",refspec:{},usage:{"abstract":true},existenceRule:"Exists if any samples exist",properties:{parents:{description:"",type:"Object",properties:{driverObject:{description:"The object whose motion along a path defines the locus",kind:"Point|Expression"},drivenObject:{description:"The object being driven whose locations define the locus",kind:"Point|Expression|Text|Arc|Circle|Picture|Polygon|Straight|ArcInterior|CircleInterior"}},regex:/^[0-9]+$/}}},constraintSupportsSpecObj:function(E,G){var D=this.doc.properties.parents.properties.drivenObject.kind;var F=G[E.parents.drivenObject].kind;if(D.match(F)===null){return false}return true},clonedDriverGObj:h,clonedSampleGObj:h,sampleGObj:function(){return this.parents.drivenObject},updateConstraintAncestry:function B(){var K=this.sQuery.sketch,J=[],D,I=0,H=this.numSamples,G=this.getParent("driverObject"),F=this.getParent("drivenObject").id,E;J.push(this.getParent("driverObject"));while(this.parents.hasOwnProperty(I)){J.push(this.getParent(I));I++}J.sort(function(M,L){return Number(M.topologicalIndex)-Number(L.topologicalIndex)});D=K.cloneGObjects(J);for(I=0;I<D.length;I++){if(D[I].id===G.id){this.clonedDriverGObj=D[I];D.splice(I,1);break}}for(I=0;I<D.length;I++){if(D[I].id===F){E=D[I];this.driveChain=D;this.clonedSampleGObj=E;break}}this.clonedDriverGObj.state.exists=true;this.vectorContext=E.createVectorContext(H,this,E.constraintChangesColor);this.lastSampleCount=H},prepareDriverWalkInfo:function(){y.signalErrorWithMessage("Locus subclasses must implement prepareDriverWalkInfo")},advanceDriver:function(F,D,E){y.signalErrorWithMessage("Locus subclasses must implement advanceDriver")},moveDriverForValue:function(E,D){y.signalErrorWithMessage("Locus subclasses must implement moveDriverForValue")},constrain:function(J){var E=this.driveChain,H=this.clonedSampleGObj,L=this.clonedDriverGObj,F=this.numSamples,G=this.lastSampleCount!==F,D,K,I;if(G){this.vectorContext=H.createVectorContext(F,this,H.constraintChangesColor);this.lastSampleCount=F}if(this.prepareDriverWalkInfo){I=this.prepareDriverWalkInfo()}this.state.exists=false;H.resetVectorSamples(this.vectorContext);K=0;for(D=0;D<F;D++){this.advanceDriver(L,I,D);J.constrainDriveChain(E);if(H.state.exists||this.vectorContext.isContinuous){H.fillSingleSample(this.vectorContext,K);K++}this.state.exists=this.state.exists||H.state.exists}if(H.recomputeDiscontinuities){H.recomputeDiscontinuities(this.vectorContext)}},constrainSampleGObjToConvertedValue:function(G){var D=this.driveChain,E=this.clonedSampleGObj,F=this.clonedDriverGObj;this.moveDriverForValue(F,G);this.sQuery.sketch.constrainDriveChain(D);return E.state.exists?E.geom.loc:y.GeometricPoint.UNDEFINED},samplerPathValueToPosition:function(J,G){var D=this.driverDomain.low,I=this.driverDomain.high,H=I-D,F=D+H*J,K,E=this;K=this.constrainSampleGObjToConvertedValue(F);if(G&&K.isDefined()){G.derivative=y.math.secantApproximationToDerivative(F,K,function(L){return(L<=I&&L>=D)?E.constrainSampleGObjToConvertedValue(L):y.GeometricPoint.UNDEFINED})}return K},samplerPositionToPathValue:function(D){return this.clonedSampleGObj.positionToPathValueForVector(this.vectorContext,D)},samplerPathLength:function(){return this.clonedSampleGObj.pathLengthForVector(this.vectorContext)}});y.gConstraints.GeomLocus=y.makeClass(y.gConstraints.Locus,{doc:{description:"A Geometric Locus of an object as a parent driver moves along a path.",inherits:"Locus",refspec:{gspRef:"GeomLocus_C"},usage:{"abstract":false,kinds:["Sampler"]},supported:true,properties:{parents:{properties:{domainObject:{description:"The drive path the driver travels along",genus:"Path"}}}}},updateConstraintAncestry:function B(){var D=this.getParent("domainObject");this.closedPath=D.closedPath;(B.base||arguments.callee.base).call(this)},checkParentsExist:function(){var D=this.getParent("domainObject");return D.state.exists},prepareDriverWalkInfo:function(){var G=this.numSamples,F=y.createFloatVector(G),K=this.getParent("domainObject"),E,J=this.driverDomain,H,D=J.low,I;if(K.closedPath){I=(J.high-D)/G}else{I=(J.high-D)/(G-1)}for(H=0;H<G;H++){F[H]=D+(H*I)}if(!K.closedPath){F[G-1]=J.high}E=K.mapVectorPathValuesToPositions(F);return E},advanceDriver:function(F,D,E){F.geom.loc=D[E];F.state.exists=true},moveDriverForValue:function(E,D){var F=this.getParent("domainObject");if(F.closedPath){D=D%1}E.geom.loc=F.mapPathValueToPosition(D);E.state.exists=true}});y.gConstraints.CustomTransformedPath=y.makeClass(y.gConstraints.GeomLocus,{doc:{description:"A Geometric Locus of an object as a parent driver of the custom trasform moves along a path.",inherits:"Locus",refspec:{gspRef:"CustomTransformedPath_C"}}});y.gConstraints.ParametricLocus=y.makeClass(y.gConstraints.Locus,{doc:{description:"A Parametric Locus of an object as a driver parameter moves through a range of values.",inherits:"Locus",refspec:{gspRef:"ParametricLocus_C"},usage:{"abstract":false,kinds:["Sampler"]},supported:true,properties:{parents:{properties:{drivenObject:{description:"The object whose position changes as the driver moves along the path"},driverObject:{description:"The point to drive along the path",kind:"Expression"}}}}},checkParentsExist:function(){return this.getParent("driverObject").state.exists},prepareDriverWalkInfo:function(){var F=this.numSamples,E=y.createFloatVector(F),I=this.driverDomain,G,D=I.low,H=(I.high-D)/(F-1);for(G=0;G<F;G++){E[G]=D+(G*H)}return E},advanceDriver:function(F,D,E){F.updateValue(D[E])},moveDriverForValue:function(E,D){E.updateValue(D)},samplerPathValueToPosition:function n(F,E){var G=this.driverDomain.high-this.driverDomain.low,D=G?((F-this.driverDomain.low)/G):0;return(n.base||arguments.callee.base).call(this,D,E)},samplerPositionToPathValue:function d(F){var E=(d.base||arguments.callee.base).call(this,F),D=this.driverDomain.high-this.driverDomain.low;return this.driverDomain.low+E*D},samplerConstrainRange:function(F){var E=F,D=this.driverDomain.low,G=this.driverDomain.high;if(F>G){E=G}if(F<D){E=D}return E},samplerIsValueInBounds:function(D){return((D>=this.driverDomain.low)&&(D<=this.driverDomain.high))}});y.gConstraints.IterateMap=y.makeClass(y.gConstraints.Constraint,(function(){var I=/^preimage\d+$/,J=/^map\d+image\d+$/,H=/^\d+$/;function G(M,L){var K;g.each(M,function(N,O){if(O.id===L){K=O;return false}});return K}function F(M,L){var K=[];g.each(L,function(N,O){K.push(G(M,O))});return K}function D(K){return{map:/map(\d+)/.exec(K)[1],image:/image(\d+)/.exec(K)[1]}}function E(L,K){if(g.inArray(K,L)===-1){L.push(K)}}return{doc:{description:"Iteration Map.",inherits:"Free",refspec:{gspRef:"IterateMap_C"},usage:{"abstract":false,kinds:["Map"]},properties:{parents:{description:"",type:"Object",properties:{preimage0:{description:"The first preimage.  There can be an arbitrary number of preimages, with the form 'preimageX'",kind:"kind"},map0image0:{description:"The first postimage.  There can be an arbitrary number of post-images, with the form 'mapXimageY",kind:"kind"},"0":{description:"The first object in the drive chain.  There may be many objects in the drivechain, numbered from 0 to N",kind:"kind"}},regex:/^preimage[0-9]+$|^map[0-9]+image[0-9]+$|^[0-9]+$/},currentDepth:{description:"The depth of the iteration",required:true,type:"Number"}}},imageArray:null,preImageClones:null,postImageMapArray:null,driveChain:null,randomValueCache:null,onPathPostImages:null,rerandomizeNow:true,updateConstraintAncestry:function(){var O=this.sQuery.sketch,M=[],K,L=this;function N(Q,P){return Number(Q.topologicalIndex)-Number(P.topologicalIndex)}this.imageArray=[];this.preImageClones=[];this.postImageMapArray=[];this.driveChain=[];if(this.rerandomizePointsOnPaths){this.randomValueCache=[];this.onPathPostImages=[]}g.each(L.parents,function(R,Q){var P,S;if(I.test(R)){P=R.match(/\d+/)[0];L.preImageClones[P]=Q.id}else{if(J.test(R)){S=D(R);if(!L.postImageMapArray[S.map]){L.postImageMapArray[S.map]=[]}L.postImageMapArray[S.map][S.image]=Q.id;E(L.driveChain,Q.id);if(L.rerandomizePointsOnPaths&&Q.isFreePointOnPath){E(L.onPathPostImages,Q.id)}}else{if(H.test(R)){E(L.driveChain,Q.id)}else{return}}}E(M,Q)});M.sort(N);K=O.cloneGObjects(M);L.preImageClones=F(K,L.preImageClones);g.each(L.postImageMapArray,function(P,Q){L.postImageMapArray[P]=F(K,L.postImageMapArray[P])});if(L.rerandomizePointsOnPaths){L.onPathPostImages=F(K,L.onPathPostImages)}L.driveChain=F(K,L.driveChain);L.driveChain.sort(N);L.numMaps=L.postImageMapArray.length},registerImageAndGetClone:function(L){var K=L.getParent("source");this.imageArray.push(L);return G(this.driveChain,K.id)},deregisterImage:function(L){var K=g.inArray(L,this.imageArray);if(K>=0){this.imageArray.splice(K,1)}},checkParentsExist:function(){var K=true;function L(N,M){if(M.state){if(!M.state.exists&&!H.test(N)){K=false;return false}}}g.each(this.parents,L);this.state.exists=K;return K},constrain:function(V){var Q=this.finalIterationOnly,P=this,O=this.numMaps,T=0;if(this.rerandomizeNow){this.randomValueCache=[]}function R(W,X){X.collectSample()}function S(W,X){X.clearSamples()}function U(W,X){if(P.currentDepth===0||X.clonedGObj.state.exists){X.stampTerminalSample()}}function N(W){var X=[],Y,aa;function Z(ab){if(ab.kind==="Point"){return{loc:ab.geom.loc.copy(),exists:ab.state.exists}}else{return{value:ab.value,exists:ab.state.exists}}}if(g.isArray(W)){aa=W.length;for(Y=0;Y<aa;Y++){X.push(Z(W[Y]))}return X}else{return Z(W)}}function L(X,W){var Y,aa=X.length,Z;for(Y=0;Y<aa;Y++){Z=X[Y];if(Z.kind==="Point"){Z.geom.loc=W[Y].loc;Z.state.exists=W[Y].exists}else{Z.updateValue(W[Y].value);Z.state.exists=W[Y].exists}}}function M(ab){var aa=ab.onPathPostImages.length,X,Y,Z,W;for(X=0;X<aa;X++){Y=ab.onPathPostImages[X];if(ab.randomValueCache[T]===h){Z=Y.getParent("path");W=Z.getAnimationRange();ab.randomValueCache[T]=W.min+(W.max-W.min)*Math.random()}Y.updateValue(P.randomValueCache[T++])}}function K(X){var W,Y=[];if(X===P.currentDepth){g.each(P.parents,function(Z,aa){var ab;if(J.test(Z)){ab=D(Z);if(!Y[ab.map]){Y[ab.map]=[]}Y[ab.map][ab.image]=N(aa)}})}else{for(W=0;W<O;W++){Y[W]=N(P.postImageMapArray[W])}}for(W=0;W<O;W++){L(P.preImageClones,Y[W]);if(P.rerandomizePointsOnPaths){M(P)}V.constrainDriveChain(P.driveChain);if((!Q)||(X===1)){g.each(P.imageArray,R)}if(X-1){K(X-1)}}}g.each(this.imageArray,S);if(this.currentDepth>0){K(this.currentDepth)}g.each(P.imageArray,U);this.rerandomizeNow=false}}}()));y.gConstraints.IterateMapByParametricDepth=y.makeClass(y.gConstraints.IterateMap,{doc:{description:"Itereation Map by parametric depth.",inherits:"IterateMap",refspec:{gspRef:"IterateMapByParametricDepth_C"},usage:{"abstract":false,kinds:["Map"]},properties:{parents:{description:"",type:"Object",properties:{depth:{description:"the depth to which the construction is iterated",kind:"Measure"}}},currentDepth:{suppressed:true}}},constrain:function u(D){var E=Number(this.getParent("depth").uValue.toFixed());if(E<0){E=0}if(!isFinite(E)){E=null}if(E!==this.currentDepth){this.currentDepth=E;this.rerandomizeNow=true;g.each(this.imageArray,function(F,G){G.sampleCountChanged()})}if(this.currentDepth!==null){this.state.exists=true;(u.base||arguments.callee.base).call(this,D)}else{this.state.exists=false}},constraintVerificationString:function z(D){var E=(z.base||arguments.callee.base).call(this);if(D){E+=this.testConsistency("depth",this.currentDepth,D.depth)}return E}});y.gConstraints.IterateImage=y.makeClass(y.gConstraints.Constraint,{doc:{description:"",inherits:"Constraint",refspec:{gspRef:"IterateImage_C"},usage:{"abstract":false,kinds:["IterateImage"]},existenceRule:"",properties:{parents:{description:"",type:"Object",properties:{source:{description:"The preimage that is to be iterated",kind:"Point|Expression|Text|Arc|Circle|Picture|Polygon|Straight|ArcInterior|CircleInterior"},map:{description:"The iteration map defining the iteration",kind:"Map"}}}}},updateConstraintAncestry:function B(){(B.base||arguments.callee.base).call(this);var E=this.getParent("map"),D=E.registerImageAndGetClone(this);this.clonedGObj=D;this.initializeSampleBuffer()},constrain:function(){this.state.exists=(this.curSampleNum>0)},checkParentsExist:function(){if(!this.getParent("map").state.exists){if(this.state.exists){this.state.exists=false;this.clearSamples()}return false}return true}});y.gConstraints.PointTerminalIteration=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The terminal point of an iterated image of points",inherits:"Constraint",refspec:{gspRef:"TerminalIterationPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Midpoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists if the parental image exists.",properties:{parents:{description:"",properties:{image:{description:"",kind:"IterateImage"}}}},example:""},state:{},checkParentsExist:function(){var D=this.getParent("image").getParent("map");return D.state.exists},constrain:function(){var E=this.getParent("image"),D=E.getTerminalGeom();if(D===null){this.state.exists=false;this.geom.loc=y.GeometricPoint.UNDEFINED}else{this.geom=D;this.state.exists=true}}});y.gConstraints.CompositeText=(function(){var D="-";var I=new RegExp("\\d+"+D+".*");function H(J){switch(J){case 10:return"byLabel";case 11:return"byName";case 12:return"byValue";case 13:return"valueAsAddend";case 14:return"expressionOnly";case 15:return"independentVariable";case 16:return"dependentVariable";case 17:return"pictureIcon";default:return"default"}}function F(M,N){var L=parseInt(N,16),K=(L&65535)-1,J=H((L&4294901760)>>16);return K+D+J}return y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines a caption that has references to dynamically generated text from other objects.",inherits:"Constraint",refspec:{gspRef:"CompositeText_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CompositeText_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff parents exist.",properties:{parents:{description:"Objects referenced in the caption",properties:{"0":{description:'Objects labeled "0", ..., "n"',kind:"kind"}},regex:/^[0-9]+$/}}},updateLabelForConstraint:function E(){(E.base||arguments.callee.base).call(this);var K=this;this.parentMFSValues={};function J(M){var L=F(K,M.refCon);M.visibleNode=1;M.value[0]={type:"parameter",value:L};K.parentMFSValues[L]={type:"text",value:"unfilled"}}y.mfs.walkNode(this.parsedMFS,"switch",J)},constrain:function G(){var J=this;J.state.exists=true;g.each(J.parentMFSValues,function(M){if(!M.match(I)){return}var K=M.split(D),P=K[0],L=K[1],N=J.parentsList[P],O=N.getStrippedMFSAppearanceForVariant(L);if(O===null){J.state.exists=false;return false}J.parentMFSValues[M]=O})},checkParentsExist:function(){return true}})}());y.gConstraints.PictureAcrossThreePoints=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture with upper left defined by a <span class="kind">Param</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{p0:{description:"The location of the original bottom left of the picture",kind:"Point"},p1:{description:"The location of the original bottom right of the picture",kind:"Point"},p2:{description:"The location of the original top left of the picture",kind:"Point"}}}}},constrain:function(){var H=this.getParent("p0").geom.loc,G=this.getParent("p1").geom.loc,F=this.getParent("p2").geom.loc,E=this.getImage(),D=y.AffineTransform.fromPointMapping([y.GeometricPoint(0,E.height),y.GeometricPoint(E.width,E.height),y.GeometricPoint(0,0)],[H,G,F]);if(D){this.geom.transform=D}else{this.state.exists=false}}});y.gConstraints.PictureBetweenTwoPoints=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture with upper left defined by a <span class="kind">Param</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent points exist, and their rounded-to-integer coordinates differ in both x and y values.",properties:{parents:{description:"",properties:{p0:{description:"One corner of the rectangle in which the picture is presented",kind:"Point"},p1:{description:"The other corner of the rectangle in which the picture is presented",kind:"Point"}}}}},constrain:function(){var G=this.getParent("p0").geom.loc.round(),E=this.getParent("p1").geom.loc.round(),F=E.subtract(G),D=this.getImage();this.state.exists=F.getX()!==0&&F.getY()!==0;if(this.state.exists){this.geom.transform=y.AffineTransform({m20:F.getX()<0?E.getX():G.getX(),m21:F.getY()<0?E.getY():G.getY(),m00:Math.abs(F.getX())/D.width,m11:Math.abs(F.getY())/D.height})}}});y.gConstraints.PictureCenteredOnOnePoint=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture centered on a <span class="kind">Point</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"}}},scaleX:{description:"Horizontal scaling factor about center.",type:"Number"},scaleY:{description:"Vertical scaling factor about center.",type:"Number"},angle:{description:"Angle of rotation about center.",type:"Number"}}},constrain:function(){var H=this.getParent("p0").geom.loc,E=this.scaleX,D=this.scaleY,G=this.angle,F=this.getImage();this.geom.transform=y.AffineTransform.Identity.translate(-F.width/2,-F.height/2).scale(E,D).rotate(G).translate(H)}});y.gConstraints.PictureCroppedByInterior=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture cropped by an <span class="genus">Interior</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{source:{description:"Picture to be cropped",kind:"Picture"},cropInterior:{description:"Polygon to which picture will be cropped",kind:"Polygon"}}}}},updateConstraintAncestry:function(){var D=this.getParent("cropInterior");this.geom.clipVertices=D.getVertices()},constrain:function(){var G=this.getParent("source"),E=this.getParent("cropInterior"),F=this;function D(){var I=[],J={top:0,left:0,bottom:G.getImage().height,right:G.getImage().width},K=F.geom.transform.inverse(),H;if(!K){return false}for(H=0;H<E.geom.points.length;H++){I.push(E.geom.points[H].copy())}K.transform(I);return y.Geom.RectSectsPolygon(J,I)}this.geom.transform=G.geom.transform;this.geom.clipVertices=E.getVertices();this.state.exists=D()}});y.gConstraints.PictureHungOnOnePoint=y.makeClass(y.gConstraints.PictureNonFree,{doc:{description:'Defines a picture with upper left at a <span class="kind">Point</span>.',inherits:"PictureNonFree",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent point exists.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"}}}}},constrain:function(){var D=this.getParent("p0").geom.loc;this.geom.transform=y.AffineTransform({m20:D.getX(),m21:D.getY(),m00:1,m11:1})}});y.gConstraints.PointOnPathBase=y.makeClass(y.gConstraints.Constraint,{value:0.5,isFreePointOnPath:true,constrain:function u(){var E=this.getParent("path"),F=false,D=y.GeometricPoint.UNDEFINED;if(E.isValueInBounds(this.value)){D=E.mapPathValueToPosition(this.value);if(D&&D.isDefined()){F=true}else{D=y.GeometricPoint.UNDEFINED}}this.state.exists=F;this.geom.loc=D}});y.gConstraints.Straight=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The base class for all straight constraints.",inherits:"Constraint"},getStraightP0:function(){var D=this.getParent("p0");return D.geom.loc},getStraightP1:function(){var D=this.getParent("p1");return D.geom.loc},getOverBarType:function(){return this.overbarType},getParentalNameMFS:function(){var G,F,D,E;G=this.getParent("p0");F=this.getParent("p1");D=G.getNameMFS();E=F.getNameMFS();return{type:"overbar",variant:this.getOverBarType(),value:y.mfs.makeHorizontalMFS(D,E)}}});y.gConstraints.Transform=y.makeClass([y.gConstraints.Constraint,y.mixins.transformable],{doc:{description:"The parent class for all transformations.",inherits:"Constraint",refspec:{msg:"This class is an internal object and doesn't have an independent source of requirements."},usage:{"abstract":true,kinds:["Arc","ArcInterior","Circle","CircleInterior","Picture","Point","Polygon","Straight"]},properties:{parents:{description:"",properties:{source:{description:"The source of the transformation",kind:"kind",type:"GObject"}}}}},isTransformationConstraint:true,determineExists:function(){return h},getSourceGeom:function(){return this.getParent("source").geom},constrain:function(){var D=this.getTransformer();D.transformGeom(this.getSourceGeom(),this.geom);this.state.exists=this.determineExists()},getParentalNameMFS:function(){var D=this.getParent("source");return y.mfs.makeHorizontalMFS(D.getNameMFS(),y.mfs.makeTextMFS("'"))}});y.gConstraints.Ray=y.makeClass(y.gConstraints.Straight,{doc:{description:"Defines a ray from two points. The first point, p0, is the base of the ray.",inherits:"Straight",refspec:{gspRef:"Ray_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Ray_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent points exist and are not coincident.",properties:{parents:{description:"",properties:{p0:{description:"The foot of the ray.",kind:"Point"},p1:{description:"A point on the ray not incident with the foot.",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Ray_export.json"},overbarType:3,getPointOnPath:function(D,E){return this.getPointOnRay(D,E)},constrain:function(){var I,G,E,D,H,F;I=this.getStraightP0();this.geom.p0=I;G=this.getStraightP1();this.geom.p1=G;E=G.subtract(I);if(E.isZeroLength()){this.geom.xp0=y.GeometricPoint(0,0);this.geom.xp1=y.GeometricPoint(0,0)}else{D=E.vLength();H=10000/D;F=I.add(E.multiply(H));this.geom.xp0=I;this.geom.xp1=F}this.state.exists=!E.isZeroLength()}});y.gConstraints.AngleBisector=y.makeClass(y.gConstraints.Ray,{doc:{description:"Constrains a ray to bisect an angle. The ray's foot is the angle vertex.",usage:{"abstract":false,kinds:["Straight"],genus:["Ray"]},inherits:"Ray",refspec:{gspRef:"Bisector_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Bisector_C, in the currently published version of desktop Geometer's Sketchpad."},properties:{parents:{properties:{A:{description:"A point",kind:"Point"},B:{description:"A point",kind:"Point"},C:{description:"A point",kind:"Point"},p0:{suppressed:true},p1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-AngleBisector_export.json"},constrain:function(){var F=this.getParent("A").geom.loc,E=this.getParent("B").geom.loc,K=this.getParent("C").geom.loc,J,H,I,G,D;this.geom.p0=this.geom.p1=this.geom.xp0=this.geom.xp1=h;if(F.equals(E)||E.equals(K)){this.state.exists=false}else{J=F.subtract(E);H=Math.sqrt(9000/J.dot(J));I=E.add(J.multiply(H));J=K.subtract(E);H=Math.sqrt(9000/J.dot(J));G=E.add(J.multiply(H));D=I.add(G).multiply(0.5);J=D.subtract(E);if((Math.abs(J.x)>0.01)||(Math.abs(J.y)>0.01)){this.geom.p1=D;this.geom.xp0=this.geom.p0=E;this.geom.xp1=E.add(J.multiply(10000))}else{this.state.exists=false}}},getParentalNameMFS:function(){return y.mfs.makeTextMFS("AngleBisector "+this.id)}});y.gConstraints.ArcAroundPoint=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines an arc centered about a point, counter-clockwise from the first selected bounding point to the second.",inherits:"Constraint",refspec:{gspRef:"ArcAroundPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcAroundPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Arc"]},existenceRule:"Exists iff parents exist, and parental points are not coincident.",properties:{parents:{description:"",properties:{center:{description:"Center of circle on which the arc is situated",kind:"Point"},p0:{description:"First bounding point",kind:"Point"},p1:{description:"Second bounding point",kind:"Point"}}}}},constrain:function(){var F=this.getParent("center").geom.loc;var E=this.getParent("p0").geom.loc;var D=this.getParent("p1").geom.loc;this.geom.arc=y.GeometricArc.FromCenterAndEndpoints(F,E,D,-1);this.state.exists=this.geom.arc.exists},getParentalNameMFS:function(){return y.mfs.parentsHorizontalOverbar(this,["p0","p1"])}});y.gConstraints.Arc3Points=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines an arc from three points.",inherits:"Constraint",refspec:{gspRef:"Arc3Points_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Arc3Points_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Arc"]},existenceRule:"Exists iff parent points exist and are not pairwise coincident.",properties:{parents:{description:"",properties:{p0:{description:"Initial point",kind:"Point"},p1:{description:"Middle point",kind:"Point"},p2:{description:"Final point",kind:"Point"}}}}},constrain:function(){var F=this.getParent("p0").geom.loc;var E=this.getParent("p1").geom.loc;var D=this.getParent("p2").geom.loc;this.geom.arc=y.GeometricArc.FromThreePoints(F,E,D);this.state.exists=this.geom.arc.exists},getParentalNameMFS:function(){return y.mfs.parentsHorizontalOverbar(this,["p0","p1","p2"])}});y.gConstraints.ArcInterior=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Base class for arc interiors: ArcSegment, ArcSector.",inherits:"Constraint",usage:{"abstract":true,kinds:["ArcInterior"]},existenceRule:"Exists iff parents exist.",properties:{parents:{description:"",properties:{arc:{description:"Defining arc",kind:"Arc"}}}}},constrain:function(){var D=this.getParent("arc");this.geom.arc=D.getGeometricArc();this.state.exists=D.state.exists&&isFinite(this.geom.arc.radius)},getParentalNameMFS:function(){return this.getParent("arc").getNameMFS()}});y.gConstraints.ArcOnCircle=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines an arc on circle, counter-clockwise from the first selected bounding point to the second.",inherits:"Constraint",refspec:{gspRef:"ArcOnCircle_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcOnCircle_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Arc"]},existenceRule:"Exists iff parent points exist and are not coincident.",properties:{parents:{description:"",properties:{circle:{description:"Circle on which the arc is situated",kind:"Circle"},p0:{description:"First bounding point",kind:"Point"},p1:{description:"Second bounding point",kind:"Point"}}}}},constrain:function(){var F=this.getParent("circle").geom.c;var E=this.getParent("p0").geom.loc;var D=this.getParent("p1").geom.loc;this.geom.arc=y.GeometricArc.FromCenterAndEndpoints(F,E,D,-1);this.state.exists=this.geom.arc.exists},getParentalNameMFS:function(){return y.mfs.parentsHorizontalOverbar(this,["p0","p1"])}});y.gConstraints.ActionButton=y.makeClass(y.gConstraints.Free,{doc:{description:"The parent class of all action button constraints.",refspec:{},inherits:"Free",usage:{"abstract":true,kinds:["Button"]},existenceRule:"Exists regardless of existence of parents.",properties:{messages:{description:"First message is default button label",type:"Array",required:false}}},constrain:function(){if(this.messages&&this.messages.length){this.label=this.messages[0]}},press:function(E,D){y.log("press() not implemented for this button; Constraint: "+this.constraint)}});y.gConstraints.Calculation=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A calculated expression",inherits:"Constraint",refspec:{gspRef:"CalculationM_C"},usage:{"abstract":false,kinds:["Expression"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"An associative array of objects used in the expression.",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Expression-Calculation_export.json"},baseUnits:{angle:y.units.unitFamilies.angle.baseUnit,length:y.units.unitFamilies.length.baseUnit},constrain:function(){this.uValue=this.fnExpression(this.parentsList,this.fnUnits);this.blank=(this.expression==="")||(y.math.isDefined(this.uValue)?false:this.determineParentalBlank());this.value=this.uValue*this.unitMultiplier}});y.gConstraints.CircleByRadius=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a circle from a center point and the length of a <span class="genus">Path</span>.',inherits:"Constraint",refspec:{gspRef:"CircleRadius_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CircleRadius_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Circle"]},existenceRule:"Exists iff parent center point and path or measure exist and the length or the value is finite and positive.",properties:{parents:{description:"",properties:{p0:{description:"The center point.",kind:"Point"},radius:{description:"A parent whose length or value provides the radius.",kind:"Measure",genus:"Path"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Circle-CircleByRadius_export.json"},constrain:function(){var G,E,D,F;G=this.getParent("center");if(!G){G=this.getParent("p0")}E=G.geom.loc;D=this.getParent("radius");if(D.pathLength){F=D.pathLength()}else{F=D.value}this.geom.c=E;this.geom.r=F;this.state.exists=(this.geom.r>0)&&y.math.isFiniteScalar(this.geom.r)}});y.gConstraints.CircleFromTwoPoints=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines a circle from a center point and a point on the circumference.",inherits:"Constraint",refspec:{gspRef:"Circle_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Circle_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Circle"]},existenceRule:"Exists iff parent points exist and are not coincident.",properties:{parents:{description:"",properties:{p0:{description:"The center of the circle",kind:"Point"},p1:{description:"A point on the circle",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Circle-CircleFromTwoPoints_export.json"},constrain:function(){var E=this.getParent("p0").geom.loc;var D=this.getParent("p1").geom.loc;this.geom.c=E;this.geom.r=D.subtract(E).vLength();this.state.exists=Boolean(this.geom.r)},getParentalNameMFS:function(){var G,F,D,E;G=this.getParent("p0");F=this.getParent("p1");D=G.getNameMFS();E=F.getNameMFS();return y.mfs.makeHorizontalMFS(D,E)}});y.gConstraints.CircleInterior=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Defines a circle interior from a circle.",inherits:"Constraint",refspec:{gspRef:"CircleInterior_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CircleInterior_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["CircleInterior"]},existenceRule:"Exists iff parents exist.",properties:{parents:{description:"",properties:{circle:{description:"The defining circle",kind:"Circle"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/CircleInterior-CircleInterior_export.json"},constrain:function(){var D=this.getParent("circle");this.geom.c=D.geom.c;this.geom.r=D.geom.r},getParentalNameMFS:function(){return this.getParent("circle").getNameMFS()}});y.gConstraints.Colorize=y.makeClass(y.gConstraints.Transform,{doc:{description:"Defines a new GObject that is coincident to another GObject, but colored differently.",inherits:"Transform",refspec:{gspRef:"Colorization_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Colorization_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":true,subKinds:["Picture"]},existenceRule:"Exists iff the parent measures exist and are finite.",properties:{colorRange:{description:"Color Range: 'LimitToRange', 'WrapToRange', 'ReflectToRange'",type:"String"},colorModel:{description:"Color model of parameters: 'UnivariateHue', 'UnivariateIntensity', 'TrivariateRGB', 'TrivariateHSV'",type:"String"},parameterDomainFrom:{description:"Lower bound of parameter domain.",type:"Number"},parameterDomainTo:{description:"Upper bound of parameter domain.",type:"Number"},style:{type:"Object",properties:{color:{suppressed:true}}}}},constraintChangesColor:true,getTransform:function(){return function(D){return D.copy()}},normalizeColorParameter:function(E){var D,F;F=(E-this.parameterDomainFrom)/(this.parameterDomainTo-this.parameterDomainFrom);D=Math.floor(F);F=F-D;if("LimitToRange"===this.colorRange){if(D<0){F=0}else{if(D>0){F=1}}D=0}D=Math.abs(D);if((1===(D%2))&&(0===F)){D--;F=1}if(("ReflectToRange"===this.colorRange)&&(1===((D)%2))){F=1-F}if(F<0){F=0}else{if(F>1){F=1}}return F},constrain:function u(){var E,D;(u.base||arguments.callee.base).call(this);E=this.convertToColor();if(E){D="rgb(";D+=Math.floor(255*E.red);D+=",";D+=Math.floor(255*E.green);D+=",";D+=Math.floor(255*E.blue);D+=")";this.style.color=D}},constraintVerificationString:function z(D){var E=(z.base||arguments.callee.base).call(this);if(D&&D.color){E+=this.testConsistency("color",this.style.color,D.color)}return E}});y.gConstraints.Function=y.makeClass(y.gConstraints.Constraint,{doc:{description:"A calculated expression",inherits:"Constraint",refspec:{gspRef:"FunctionM_C"},usage:{"abstract":false,kinds:["Expression"]},existenceRule:"Exists iff the parent objects exist.",properties:{parents:{description:"An associative array of objects used in the expression.",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Expression-Function_export.json"},baseUnits:{angle:y.units.unitFamilies.angle.baseUnit,length:y.units.unitFamilies.length.baseUnit},constrain:function(){var D=this;this.uValue=this.curryReferences(this,this.parentsList,this.fnUnits);this.blank=(this.expression==="")||this.determineParentalBlank();this.value=function(E){return D.uValue(E)*D.unitMultiplier}}});y.gConstraints.FunctionPlot=(function(){return y.makeClass([y.gConstraints.Constraint,y.mixins.pointVector],{doc:{description:"A simple function plot",inherits:"Constraint",refspec:{gspRef:"FunctionPlot_C"},usage:{"abstract":false,kinds:["Sampler"]},existenceRule:"Exists iff the parent function and coordinate system exist and at least one sample of the plot exists",properties:{parents:{properties:{"function":{description:"The function evaluated for x",kind:"Expression"},coordSys:{description:"The coordinate system in which the function is evaluated.",kind:"CoordSys"}}}}},getFunctionType:function(){var E=this.getParent("function");return E&&E.expressionType},updateConstraintAncestry:function D(){var G=this.getFunctionType(),F=this.sQuery.sketch.preferences.units.angle,E={};if(G==="RofT_FunctionExprType"){E.conversionFactor=y.units.convert(1,"rad",F,1);E.polar=true;E.invertXAndY=false}else{if(G==="TofR_FunctionExprType"){E.conversionFactor=y.units.convert(1,F,"rad",1);E.polar=true;E.invertXAndY=true}else{if(G==="XofY_FunctionExprType"){E.conversionFactor=1;E.polar=false;E.invertXAndY=true}else{if(G==="YofX_FunctionExprType"){E.conversionFactor=1;E.polar=false;E.invertXAndY=false}}}}this.plottingInfo=E;this.pseudoSampleGObj=y.makeClass(y.mixins.pointVector,{fillSingleSample:function(){throw y.createError("fillSingleSample() should not be called on functionPlot's sample vector")},setAllSamples:function(M,O,N){if(O){M.samples=O;M.filledSampleCount=N;var K=null,I=null,J=null,H=null,Q,P;for(var L=0;L<O.length;L+=2){Q=O[L];P=O[L+1];if(isFinite(Q)&&isFinite(P)){K=((K===null)||(Q<K))?Q:K;J=((J===null)||(P<J))?P:J;I=((I===null)||(Q>I))?Q:I;H=((H===null)||(P>H))?P:H}}M.geomBounds={left:K,top:J,right:I,bottom:H}}else{M.samples=null;M.filledSampleCount=0;M.geomBounds=null}}});this.vectorContext=this.pseudoSampleGObj.createVectorContext(this.numSamples,this,false);this.vectorContext.isDiscrete=this.isDiscrete},isSamplingRequired:function(F){var E=this.getParent("function");return !this.rawSamples||(this.state.constraintFrame<=E.state.constraintFrame)},computeSamples:function(I,S,K,L){var M=y.createFloatVector(L*2),Q,P,T=(K-S)/(L-1),H,J=false,O=this.plottingInfo.conversionFactor,F=this.plottingInfo.polar,N=this.plottingInfo.invertXAndY,R,E,G;for(H=0;H<L;++H){Q=T*H+S;P=I(Q)*O;if(!J&&isFinite(P)){J=true}if(N){R=Q;Q=P;P=R}if(F){G=Q;E=P;Q=E*Math.cos(G);P=E*Math.sin(G)}M[2*H]=Q;M[2*H+1]=P}return J&&M},updateDomain:function(L){var H=this.getParent("coordSys"),G=this.driverDomain,E,N,M,J,I,K,F;this.funcType=this.getFunctionType();if(this.funcType==="RofT_FunctionExprType"){G.low=0;G.high=2*Math.PI}else{if(H.state.exists){M=H.geom.origin;if(this.funcType==="XofY_FunctionExprType"){I=H.geom.unit1;F=M.y-I.y;G.high=-(L.top-M.y)/F;G.low=-(L.bottom-M.y)/F}else{E=L.left;N=L.right;J=H.geom.unit0;K=J.x-M.x;G.high=(N-M.x)/K;if(this.funcType==="TofR_FunctionExprType"){G.low=0;if(G.high<0){G.high=((N-E)/2)/K}}else{G.low=(E-M.x)/K}}}else{G.low=10;G.high=-10}}},initConstraint:function(){this.funcType=this.getFunctionType()},constrain:function(J){var H=this.getParent("function"),G=this.getParent("coordSys"),I=this.isSamplingRequired(J),E=H&&G&&H.state.exists&&G.state.exists;if(E){if(I){if(this.funcType!==this.getFunctionType()){this.updateDomain(J.sketchRect())}this.rawSamples=this.computeSamples(H.uValue,this.driverDomain.low,this.driverDomain.high,this.numSamples)}if(this.rawSamples){var F=G.vectorLocatePlot(this.rawSamples);this.pseudoSampleGObj.setAllSamples(this.vectorContext,F,this.numSamples);if(I){this.pseudoSampleGObj.recomputeDiscontinuities(this.vectorContext)}}else{this.pseudoSampleGObj.setAllSamples(this.vectorContext,null)}}this.state.exists=this.rawSamples&&E},getParentalNameMFS:function(){var H=this.getParent("function"),G=this.getParent("coordSys"),J=G.getParent("axisX"),E=G.getParent("axisY"),K=H.expressionType,F,I;if((K==="RofT_FunctionExprType")||(K==="YofX_FunctionExprType")){F=J.getNameMFS();I=E.getNameMFS()}else{I=J.getNameMFS();F=E.getNameMFS()}return y.mfs.makeHorizontalMFS(I,y.mfs.makeTextMFS(" = "),H.getLabelMFS(),y.mfs.makeTextMFS("("),F,y.mfs.makeTextMFS(")"))},sampleGObj:function(){return this.pseudoSampleGObj},samplerPathValueToPosition:function(F,E){var I=this.getParent("function"),G=this.getParent("coordSys"),H=this.plottingInfo,K;function J(N){var L=N,Q=I.uValue(L)*H.conversionFactor,M,P,O;if(H.invertXAndY){M=L;L=Q;Q=M}if(H.polar){O=L;P=Q;L=P*Math.cos(O);Q=P*Math.sin(O)}return G.locatePlot(L,Q)}K=J(F);if(E&&K.isDefined()){E.derivative=y.math.secantApproximationToDerivative(F,K,J).multiply(this.driverDomain.high-this.driverDomain.low)}return K},samplerPositionToPathValue:function(G){var F=this.pseudoSampleGObj.positionToPathValueForVector(this.vectorContext,G),E=this.driverDomain.high-this.driverDomain.low;return this.driverDomain.low+F*E},samplerConstrainRange:function(G){var F=G,E=this.driverDomain.low,H=this.driverDomain.high;if(G>H){F=H}if(G<E){F=E}return F},samplerIsValueInBounds:function(E){return((E>=this.driverDomain.low)&&(E<=this.driverDomain.high))}})})();y.gConstraints.Intersection=y.makeClass(y.gConstraints.Constraint,{doc:{description:'A point defined by the intersection of two <span class="kind">Straight</span> objects.',inherits:"Constraint",refspec:{gspRef:"InterLL_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, InterLL_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff parents exist and are not parallel and the intersection point is within the extent of both parents. E.g., the lines containing two segments might intersect outside the extent of the segments. In this case the intersection point for the segments would not exist.",properties:{parents:{description:"",properties:{line0:{description:"",kind:"Straight"},line1:{description:"",kind:"Straight"}}},style:{description:"Appearance of GObject",properties:{color:{description:'"(black)',type:"Color"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Intersection_export.json"},constrain:function(){var E=this.getParent("line0");var D=this.getParent("line1");this.geom.loc=y.Geom.LineLineIntersection(E,D);this.state.exists=this.geom.loc.isDefined()}});y.gConstraints.Line=y.makeClass(y.gConstraints.Straight,{doc:{description:"A straight line that extends to infinity.",inherits:"Straight",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent points exist and are not coincident.",properties:{parents:{description:"",properties:{p0:{description:"First reference point defining the line",kind:"Point"},p1:{description:"Second reference point defining the line",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Line_export.json"},overbarType:4,getPointOnPath:function(D,E){return this.getPointOnLine(D,E)},constrain:function(){var J,H,E,D,I,G,F;J=this.getStraightP0();this.geom.p0=J;H=this.getStraightP1();this.geom.p1=H;E=H.subtract(J);if(E.isZeroLength()){this.geom.xp0=y.GeometricPoint(0,0);this.geom.xp1=y.GeometricPoint(0,0)}else{D=E.vLength();I=10000/D;G=J.add(E.multiply(-I));F=J.add(E.multiply(I));this.geom.xp0=G;this.geom.xp1=F}this.state.exists=!E.isZeroLength()}});y.gConstraints.MeasurementAngle=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of an angle defined by three points.",inherits:"Constraint",refspec:{gspRef:"Angle3PointsMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Angle3PointsMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},p1:{description:"",kind:"Point"},p2:{description:"",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementAngle_export.json"},unitPowers:{angle:1},constrain:function(){var E=this.getParent("p0").geom.loc,D=this.getParent("p1").geom.loc,H=this.getParent("p2").geom.loc,G,F=this.sQuery().prefs().units.angle;G=y.GeometricPoint.threePointFlippedAngle(E,D,H);if(F==="deg"){if(G<0){G+=(2*Math.PI)}if(G>Math.PI){G=(2*Math.PI)-G}}this.value=G;this.uValue=y.units.convert(G,"radians",F)},getParentalNameMFS:function(){var G,D,F,H=[];G=this.parentsList;for(D=0;D<G.length;D+=1){F=G[D].getNameMFS();if(y.mfs.isEmptyTextMFS(F)){F=y.mfs.makeTextMFS(G[D].id)}H.push(F)}var E=y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS.apply(this,H));return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m",true),{type:"symbol",value:"d0"},E)}});y.gConstraints.MeasurementAngleMarker=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The value of an angle marker",inherits:"Constraint",refspec:{gspRef:"AngleMarkerMeasure_C"},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent marker exists.",properties:{parents:{properties:{marker:{description:"The AngleMarker to be measured",kind:"AngleMarker"}}}}},unitPowers:{angle:1},genus:"AngleMeasure",constrain:function(){var D=this.getParent("marker"),E=this.sQuery().prefs().units.angle,F;F=-D.value;this.value=F;if(E==="deg"){if(F<0){F=-F}}this.uValue=y.units.convert(F,"radians",E)},getParentalNameMFS:function(){var D=this.getParent("marker"),E;E=D.getNameMFS();if(y.mfs.isEmptyTextMFS(E)){E=y.mfs.makeTextMFS(D.id)}var F=y.mfs.makeItalicMFS(E);var G=D.label?[F]:[y.mfs.makeTextMFS("m",true),{type:"symbol",value:"d0"},F];return y.mfs.makeHorizontalMFS.apply(this,G)}});y.gConstraints.MeasurementArea=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the area of a <span class="kind">Polygon</span>, <span class="kind">Circle</span>, or <span class="kind">CircleInterior</span>.',inherits:"Constraint",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint, TBD, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist and are not all coincident.",properties:{parents:{description:"",properties:{shape:{description:"",kind:"Arc|Circle|Polygon"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementArea_export.json"},unitPowers:{length:2},constrain:function(){var D,E;E=this.getParent("shape");D=E.area();this.value=D;this.uValue=y.units.convertFromBaseToUnitObject(D,this.unitsObject)},getParentalNameMFS:function(){var D=this.getParent("shape"),E=[y.mfs.makeTextMFS("Area ")];if(D.kind==="Circle"||D.kind==="CircleInterior"){E.push({type:"symbol",value:"100"})}E.push(y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(D.getNameMFS())));return y.mfs.makeHorizontalMFS.apply(this,E)}});y.gConstraints.MeasurementCircumference=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the circumference of a <span class="kind">Circle</span>.',inherits:"Constraint",refspec:{gspRef:"CircumferenceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CircumferenceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent circle exists.",properties:{parents:{description:"",properties:{shape:{description:"The circle whose circumference is to be measured",kind:"Circle"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementCircumference_export.json"},unitPowers:{length:1},constrain:function(){var F,E,D=this.sQuery().prefs().units.length;E=this.getParent("shape");F=E.circumference();this.value=F;this.uValue=y.units.convert(F,"pixels",D)},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Circumference "),{type:"symbol",value:"100"},y.mfs.makeItalicMFS(this.getParent("shape").getNameMFS()))}});y.gConstraints.MeasurementCoordinateBased=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The parent class for all coordinate-system based constraints.",inherits:"Constraint",usage:{"abstract":true,kinds:["Measure"]},properties:{parents:{description:"",properties:{coordSys:{description:"The coordinate system used for the measurements",kind:"CoordSys"}}}}},unitPowers:{scalar:1},getCoordinates:function(E){var D=this.getParent("coordSys");return D.locatePoint(E.geom.loc)}});y.gConstraints.MeasurementDistance=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the distance between two <span class="kind">Point</span>s.',inherits:"Constraint",refspec:{gspRef:"DistanceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, DistanceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"",properties:{p0:{description:"The point from which distance is to be measured",kind:"Point"},obj0:{description:"The point or line to which distance is to be measured",kind:"Point|Straight"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementDistance_export.json"},unitPowers:{length:1},constrain:function(){var H,G,F,I,E,D=this.sQuery().prefs().units.length;G=this.getParent("p0");I=G.geom.loc;F=this.getParent("obj0");if(F.kind==="Point"){E=F.geom.loc;H=E.subtract(I).vLength()}else{if(F.isOfKind("Straight")){E=F.getClosestPointOnLine({p0:F.getZeroPoint(),p1:F.getUnitPoint()},I);H=E.subtract(I).vLength()}else{y.log(this.id+": Cannot compute distance from point to object: "+F.id+"("+F.kind+")")}}this.value=H;this.uValue=y.units.convert(H,"pixels",D)},getParentalNameMFS:function(){var G,F,E,D;F=this.getParent("obj0");G=this.getParent("p0");D=F.getNameMFS();E=G.getNameMFS();if(F.kind==="Straight"){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Distance "),y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(E)),y.mfs.makeTextMFS(" to "),y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(D)))}else{return y.mfs.makeItalicMFS(y.mfs.makeHorizontalMFS(E,D))}}});y.gConstraints.MeasurementLength=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the length of a <span class="constraint">Segment</span>s.',inherits:"Constraint",refspec:{gspRef:"LengthM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, LengthM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists if the parent segment exists. Also exists if the parent segment is an original segment and end-points are coincident. Then, the length is zero.",properties:{parents:{description:"",properties:{path:{description:"",genus:"Path"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementLength_export.json"},unitPowers:{length:1},checkParentsExist:function(){return true},checkExists:function(){var D=this.getParent("path");if(D.state.exists){return true}if((D.constraint==="Segment")&&D.getParent("p0").state.exists&&D.getParent("p1").state.exists){return true}return false},constrain:function(){var D,F=this.getParent("path"),E=this.sQuery().prefs().units.length;this.state.exists=this.checkExists();if(this.state.exists){D=(F.state.exists)?F.pathLength():0;this.value=D;this.uValue=y.units.convert(D,"pixels",E)}},getParentalNameMFS:function(){var E,F=this.getParent("path"),D=(F.label||F.isTransformationConstraint)?[]:[y.mfs.makeTextMFS("m ",true)];E=F.getNameMFS();if(y.mfs.isEmptyTextMFS(E)){E=y.mfs.makeTextMFS(F.id)}D.push(y.mfs.makeItalicMFS(E));return y.mfs.makeHorizontalMFS.apply(this,D)}});y.gConstraints.MeasurementPerimeter=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the perimeter of a <span class="kind">Polygon</span>s.',inherits:"Constraint",refspec:{gspRef:"PerimeterM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PerimeterM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points all exist and are not coincident.",properties:{parents:{description:"",properties:{shape:{description:"",kind:"Arc|Polygon"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementPerimeter_export.json"},unitPowers:{length:1},constrain:function(){var F,E,D;E=this.getParent("shape");F=E.perimeter();D=this.sQuery().prefs().units.length;this.value=F;this.uValue=y.units.convert(F,"pixels",D)},getParentalNameMFS:function(){var D=this.getParent("shape");return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Perimeter "),y.mfs.makeItalicMFS(D.getNameMFS()))}});y.gConstraints.MeasurementRadius=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The measurement of the radius of a <span class="kind">Circle</span>.',inherits:"Constraint",refspec:{gspRef:"RadiusM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RadiusM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent circle exist.",properties:{parents:{description:"",properties:{shape:{description:"",kind:"Arc|Circle"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementRadius_export.json"},unitPowers:{length:1},constrain:function(){var D,F,E=this.sQuery().prefs().units.length;F=this.getParent("shape");D=F.radius();if(!isFinite(D)){D=Number.POSITIVE_INFINITY}this.value=D;this.uValue=y.units.convert(D,"pixels",E)},getParentalNameMFS:function(){var E=[y.mfs.makeTextMFS("Radius ")],D=this.getParent("shape").kind;if(D==="Circle"||D==="CircleInterior"){E.push({type:"symbol",value:"100"})}E.push(y.mfs.makeItalicMFS(this.getParent("shape").getNameMFS()));return y.mfs.makeHorizontalMFS.apply(this,E)}});y.gConstraints.MeasurementRatio=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of the ratio of two segments or three points.",inherits:"Constraint",refspec:{gspRef:"RatioM_C"},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points all exist and are not coincident.",properties:{parents:{description:"",properties:{obj0:{description:"First segment or point",kind:"Straight|Point"},obj1:{description:"Second segment or point",kind:"Straight|Point"},obj2:{description:"Third point",kind:"Point",required:false}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Measure-MeasurementRatio_export.json"},unitPowers:{scalar:1},ratioFromTwoSegments:function(){var E=this.getParent("obj0"),D=this.getParent("obj1"),F;this.state.exists=E.state.exists&&D.state.exists;if(this.state.exists){F=E.pathLength()/D.pathLength();return F}},ratioFromThreePoints:function(){var G=this.getParent("obj0"),F=this.getParent("obj1"),E=this.getParent("obj2"),D;this.state.exists=G.state.exists&&F.state.exists&&E.state.exists;if(this.state.exists){D=y.GeometricPoint.mapPointToLine(G.geom.loc,F.geom.loc,E.geom.loc).param;if(isNaN(D)){if(G.geom.loc.equals(F.geom.loc)&&!F.geom.loc.equals(E.geom.loc)){D=Number.POSITIVE_INFINITY}}return D}},constrain:function(){var D,E=this.getParent("obj0");if(E.kind==="Straight"){D=this.ratioFromTwoSegments()}else{D=this.ratioFromThreePoints()}this.value=D;this.uValue=D},nameFromTwoSegments:function(){var E=this.getParent("obj0"),D=this.getParent("obj1");return{type:"fraction",value:[y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m ",true),E.getNameMFS()),y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m ",true),D.getNameMFS())]}},nameFromThreePoints:function(){var F=this.getParent("obj0"),E=this.getParent("obj1"),D=this.getParent("obj2");return{type:"fraction",value:[y.mfs.makeHorizontalMFS(F.getNameMFS(),D.getNameMFS()),y.mfs.makeHorizontalMFS(F.getNameMFS(),E.getNameMFS())]}},getParentalNameMFS:function(){var D,E=this.getParent("obj0");if(E.kind==="Straight"){D=this.nameFromTwoSegments()}else{D=this.nameFromThreePoints()}return D}});y.gConstraints.MeasurementValueOfPointOnPath=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of the value of a point on path",inherits:"Constraint",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint, TBD, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parent points exist and are not all coincident.",properties:{parents:{properties:{point:{description:"The point",kind:"Point"},path:{description:"The path that the point lives on.",genus:"Path"}}}}},unitPowers:{scalar:1},constrain:function(F){var D,E;D=this.getParent("point");E=this.getParent("path");this.value=E.mapPositionToPathValue(D.geom.loc);this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(this.getParent("point").getNameMFS(),y.mfs.makeTextMFS(" on "),this.getParent("path").getNameMFS())}});y.gConstraints.MultimeasureBase=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Abstract class for multimeasure constraints .",inherits:"Constraint",usage:{"abstract":true,kinds:["Text"]},existenceRule:"Exists iff the parents exist."},isMultimeasure:true,values:{},precisions:{},units:{},initTextMFS:function(){y.signalErrorWithMessage("Multimeasures must implement initTextMFS")},initUnits:function(){y.signalErrorWithMessage("Multimeasures must implement initUnits")},initPrecision:function(){y.signalErrorWithMessage("Multimeasures must implement initPrecision")},initConstraint:function(){this.initUnits();this.initPrecision()},updateLabelForConstraint:function i(){(i.base||i.callee.base).call(this);this.initTextMFS()},getValuesAsMFS:function(){var E=this,D={};if(!E.formatNumberAsMFS){y.signalErrorWithMessage("multimeasures are required to be Text kind")}g.each(E.values,function(F,G){D[F]=E.formatNumberAsMFS(G,E.precisions[F],E.units[F],false)});return D},getColorableComponent:function(){return"TextGObject_BackgroundContrast"},verificationString:function f(E,D){return""}});y.gConstraints.MeasurementRectCoordinates=y.makeClass(y.gConstraints.MultimeasureBase,{doc:{description:"The (x, y) coordinates of a point relative to a coordinate system.",inherits:"MultiMeasureBase",refspec:{gspRef:"RectCoordinateM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RectCoordinateM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},initTextMFS:function(){var F=this.getParent("point"),E=F.getNameMFS(),H={type:"parameter",value:"xValue"},D={type:"parameter",value:"yValue"},G=y.mfs.makeHorizontalMFS(H,y.mfs.makeTextMFS(", "),D);this.valuesMFS={type:"paren",value:[G]};this.parsedMFS=y.mfs.makeHorizontalMFS(E,y.mfs.makeTextMFS(": "),this.valuesMFS)},initUnits:function(){this.units={xValue:"scalar",yValue:"scalar"}},initPrecision:function(){var D=this.sQuery().prefs(),E=D.precision.scalar;this.precisions={xValue:E,yValue:E}},constrain:function(){var E=this.getParent("coordSys"),D=this.getParent("point"),F=E.locatePoint(D.geom.loc);this.values={xValue:F.x,yValue:F.y}},getMFSAppearanceForVariant:function(){var D=g.extend(true,{},this.valuesMFS);y.mfs.realizeParamNodes(D,this.getValuesAsMFS());return D}});y.gConstraints.MeasurementPolarCoordinates=y.makeClass(y.gConstraints.MultimeasureBase,{doc:{description:"The (r, theta) coordinates of a point relative to a coordinate system.",inherits:"MultiMeasureBase",refspec:{gspRef:"PolarCoordinateM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PolarCoordinateM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},initTextMFS:function(){var E=this.getParent("point"),D=E.getNameMFS(),G={type:"parameter",value:"rValue"},H={type:"parameter",value:"thetaValue"},F=y.units.makeUnitObjectFromUnitsAndPowers({angle:this.units.thetaValue},{angle:1}),I=y.units.getMFSForUnitObject(F),J=y.mfs.makeHorizontalMFS(G,y.mfs.makeTextMFS(", "),H,I);this.valuesMFS={type:"paren",value:[J]};this.parsedMFS=y.mfs.makeHorizontalMFS(D,y.mfs.makeTextMFS(": "),this.valuesMFS)},initUnits:function(){var D=this.sQuery().prefs().units;this.units={rValue:"scalar",thetaValue:D.angle}},initPrecision:function(){var D=this.sQuery().prefs();this.precisions={rValue:D.precision.scalar,thetaValue:D.precision.angle}},constrain:function(){var E=this.getParent("coordSys"),D=this.getParent("point"),H=E.locatePoint(D.geom.loc),G=H.vLength(),F=Math.atan2(H.y,H.x);this.values={rValue:G,thetaValue:y.units.convert(F,"radians",this.units.thetaValue)}},getMFSAppearanceForVariant:function(){var D=g.extend(true,{},this.valuesMFS);y.mfs.realizeParamNodes(D,this.getValuesAsMFS());return D}});y.gConstraints.Midpoint=y.makeClass(y.gConstraints.Constraint,{doc:{description:'The midpoint of a <span class="constraint">Segment</span>.',inherits:"Constraint",refspec:{gspRef:"Midpoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Midpoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent segment exists.",properties:{parents:{description:"",properties:{path:{description:"",kind:"Straight"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Midpoint_export.json"},state:{},constrain:function(){var E,D;E=this.getParent("path");D=E.mapPathValueToPosition(0.5);this.state.exists=E.state.exists;this.geom.loc=D}});y.gConstraints.Pegged=y.makeClass(y.gConstraints.Constraint,{doc:{description:'A translation of a <span class="kind">Text</span> message to a <span class="kind">Point</span>.',inherits:"Constraint",refspec:{gspRef:"PeggedText_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PeggedText_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Text"]},existenceRule:"Exists iff the parent text and point exist.",properties:{parents:{description:"",properties:{p0:{description:"The point to which the pegged text is bound.",kind:"Point"},text:{description:"The original text replicated by this object.",kind:"Text"}}},geom:{suppressed:true}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Text/Pegged_export.json"},style:{"text-align":"center","vertical-align":"middle"},supportsAutoplacement:function(){return false},constrain:function(){var D=this.getParent("p0"),E=this.getParent("text");this.parsedMFS=E.getStrippedMFSAppearanceForVariant("default");this.text=null;this.state.exists=(this.parsedMFS!==null)&&D.state.exists;if(this.state.exists){this.geom.loc=D.geom.loc}else{this.geom.loc=y.GeometricPoint.INFINITY}}});y.gConstraints.PointOnPath=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'A point on a <span class="genus">Path</span>.',inherits:"Constraint",refspec:{gspRef:"OnPath_C"},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent path exists.",properties:{value:{description:"",type:"Number"},parents:{description:"",properties:{path:{description:"",genus:"Path"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-PointOnPath_export.json"},updateValue:function(D){this.value=D},transform:function(G,D){var F,E;E=D.geom.loc.copy();D.affine.transform(E);F=this.getParent("path");this.updateValue(F.mapPositionToPathValue(E))},constraintVerificationString:function z(D){return this.testConsistency("value",this.value,D.value)}});y.gConstraints.PlotFixedValueOnPath=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'Defines a point on a <span class="genus">Path</span> that has a fixed value.',inherits:"Constraint",refspec:{gspRef:"PlotFixedValueOnPath_C"},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent path exists.",properties:{value:{description:"",type:"Number"},parents:{description:"",properties:{path:{description:"Identifies the path on which the point is plotted",genus:"Path"}}}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Point-PlotFixedValueOnPath_export.json"},isFreePointOnPath:false});y.gConstraints.PlotValueOnPath=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'Defines a point on a <span class="genus">Path</span> that has a value defined by a <span class="kind">Param</span>.',inherits:"Constraint",refspec:{gspRef:"PlotMarkedValueOnPath_C"},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent param and path exist.",properties:{parents:{description:"",properties:{param:{description:"Identifies a measure whose value determines the position on the path as a normalized path coordinate",kind:"Measure"},path:{description:"Identifies the path on which the point is plotted",genus:"Path"}}}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Point/PlottedPoint_export.json"},isFreePointOnPath:false,constrain:function u(){var D=this.getParent("param");this.value=D.uValue;(u.base||arguments.callee.base).call(this)}});y.gConstraints.Reflect=y.makeClass(y.gConstraints.Transform,{doc:{description:'Defines a <span class="kind">GObject</span> that is the reflection of another GObject with respect to a <span class="kind">Straight</span> object.',inherits:"Transform",refspec:{gspRef:"Reflect_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Reflect_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and mirror exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Reflection_export.json",properties:{parents:{description:"",properties:{mirror:{description:"",kind:"Straight"}}}}},determineExists:function(){return true},getTransform:function(){var D=this.getParent("mirror");return function(K){var F=D.geom.xp0,E=D.geom.xp1,M=F.x,L=F.y,J=E.x-M,I=E.y-L,H=J*J+I*I,G=((K.x-M)*J+(K.y-L)*I)/H;return y.GeometricPoint(2*(G*J+M)-K.x,2*(G*I+L)-K.y)}}});y.gConstraints.Rotate=y.makeClass(y.gConstraints.Transform,{doc:{description:"Defines a new GObject as a rotation of a GObject by a fixed angle about a pivot point p0.",inherits:"Transform",refspec:{gspRef:"RotatefA_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RotatefA_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Rotation_export.json",properties:{parents:{description:"",properties:{center:{description:"The center of the rotation",kind:"Point"}}},angle:{description:"",type:"Number",required:true}}},angle:0,determineExists:function(){var D=this.getAngle();return((typeof D!=="undefined")&&isFinite(D))},getPivot:function(){var D=this.getParent("center");return D.geom.loc},getAngle:function(){return this.angle},getTransform:function(){var D=this;return function(E){return E.rotate(D.getPivot(),D.getAngle())}}});y.gConstraints.Segment=y.makeClass(y.gConstraints.Straight,{doc:{description:"Defines a line segment from two points.",inherits:"Straight",refspec:{gspRef:"Segment_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Segment_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent points exist.",properties:{parents:{description:"",properties:{p0:{description:"First reference point defining the segment",kind:"Point"},p1:{description:"Second reference point defining the segment",kind:"Point"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Segment_export.json"},overbarType:2,getPointOnPath:function(D,E){return this.getPointOnSegment(D,E)},constrain:function(){var D;this.geom.xp0=this.geom.p0=this.getStraightP0();this.geom.xp1=this.geom.p1=this.getStraightP1();D=this.geom.p1.subtract(this.geom.p0);this.state.exists=!D.isZeroLength()}});y.gConstraints.ColorizeTrivariate=y.makeClass(y.gConstraints.Colorize,{doc:{description:"Defines a new GObject that is coincident to another GObject, but colored differently.",inherits:"Colorize",refspec:{gspRef:"Colorization_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Colorization_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent measures exist and are finite.",properties:{parents:{description:"",properties:{red:{description:"For a trivariate parameterization, the red value.",kind:"Measure"},green:{description:"For a trivariate parameterization, the green value.",kind:"Measure"},blue:{description:"For a trivariate parameterization, the blue value.",kind:"Measure"}}}}},determineExists:function(){var F=this.getParent("red"),E=this.getParent("green"),D=this.getParent("blue");return !!(F&&y.math.isFiniteScalar(F.uValue)&&E&&y.math.isFiniteScalar(E.uValue)&&D&&y.math.isFiniteScalar(D.uValue))},convertToColor:function(){var G=this.getParent("red"),H=this.getParent("green"),P=this.getParent("blue"),D=G&&G.uValue,L=H&&H.uValue,N=P&&P.uValue;if(!y.math.isFiniteScalar(D)||!y.math.isFiniteScalar(L)||!y.math.isFiniteScalar(N)){return null}D=this.normalizeColorParameter(D);L=this.normalizeColorParameter(L);N=this.normalizeColorParameter(N);if("TrivariateHSV"===this.colorModel){var I,M,F,E,Q,K=D,J=L,O=N;if(J===0){D=L=N=O}else{K=K/(60/360);I=Math.floor(K);M=K-I;F=O*(1-J);E=O*(1-J*M);Q=O*(1-J*(1-M));switch(I){case 0:D=O;L=Q;N=F;break;case 1:D=E;L=O;N=F;break;case 2:D=F;L=O;N=Q;break;case 3:D=F;L=E;N=O;break;case 4:D=Q;L=F;N=O;break;default:D=O;L=F;N=E;break}}}return{red:D,green:L,blue:N}}});y.gConstraints.UnitPoint=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Base class for all unit point constraints",inherits:"Constraint",usage:{"abstract":true,kinds:["Point"]}},state:{},kMinUnitPointDistanceFromOrigin:0.1,unitPointDeltaX:function(){return 0},unitPointDeltaY:function(){return 0},unitPointOrigin:function(){return this.parents.origin},constrain:function(){var D=this.unitPointOrigin();this.geom.loc=y.GeometricPoint(D.geom.loc.getX()+this.unitPointDeltaX(),D.geom.loc.getY()+this.unitPointDeltaY())}});y.gConstraints.ColorizeUnivariate=y.makeClass(y.gConstraints.Colorize,{doc:{description:"Defines a new GObject that is coincident to another GObject, but colored differently.",inherits:"Colorize",refspec:{gspRef:"Colorization_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Colorization_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent measures exist and are finite.",properties:{parents:{description:"",properties:{color:{description:"For a univariate parameterization, the color value.",kind:"Measure"}}}}},determineExists:function(){var D=this.getParent("color");return !!(D&&y.math.isFiniteScalar(D.uValue))},convertToColor:function(){var G=this.getParent("color"),P=G&&G.uValue;if(!y.math.isFiniteScalar(P)){return null}var H=3800,K=5100,F=6450,L=4400,N=7800,S=3850,E=6750;var D=0,I=0,M=0,R,Q,O,J;O=this.normalizeColorParameter(P);if("UnivariateHue"===this.colorModel){Q=S+O*(E-S);if((Q<L)&&(Q>H)){M=1;D=(L-Q)/(L-H)}else{if(Q<K){J=(K-Q)/(K-L);I=1-J*J;J=(Q-L)/(K-L);M=1-J*J}else{if(Q<F){J=(Q-K)/(F-K);I=1-J*J;J=(F-Q)/(F-K);D=1-J*J}else{if(Q<N){D=1}else{D=1;I=1;M=1}}}}if(Q>7000){R=0.3+0.7*(N-Q)/(7800-7000)}else{R=1}}else{D=1;I=1;M=1;R=O}return{red:D*R,green:I*R,blue:M*R}}});y.gConstraints.AxisDist=y.makeClass(y.gConstraints.Line,{doc:{description:"An axis determined by origin and unitPoint.",inherits:"Line",refspec:{gspRef:"DistAxis_C"},usage:{"abstract":true,kinds:["Axis"]},existenceRule:"Exists iff the parent origin point and unitPoint exists.",properties:{parents:{description:"",properties:{origin:{description:"The origin of the axis",kind:"Point"},unitPoint:{description:"The unit point defines one unit along the axis",kind:"Point"},p0:{suppressed:true},p1:{suppressed:true}}}}},getStraightP0:function(){return this.geom.p0},getStraightP1:function(){return this.geom.p1},constrain:function u(){var F=100,E=this.geom.unit.subtract(this.geom.origin),D=E.multiply(F/E.vLength());D.y=-D.getY();this.geom.p0=this.geom.origin.subtract(D);this.geom.p1=this.geom.origin.add(D);(u.base||arguments.callee.base).call(this)},getParentalNameMFS:function(){var D=this.getParent("origin");return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("axis "),D.getNameMFS())}});y.gConstraints.ArcSector=y.makeClass(y.gConstraints.ArcInterior,{doc:{description:"Defines an arc sector, bounded by the arc and by the radii to the two endpoints of the arc",inherits:"ArcInterior",usage:{"abstract":false}}});y.gConstraints.ArcSegment=y.makeClass(y.gConstraints.ArcInterior,{doc:{description:"Defines a arc segment, bounded by the arc and by the chord connecting the two endpoints of the arc.",inherits:"ArcInterior",usage:{"abstract":false}}});y.gConstraints.DilateFixFactor=y.makeClass(y.gConstraints.Transform,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by a fixed factor.",inherits:"Transform",refspec:{gspRef:"DilatefR_C"},usage:{"abstract":false},existenceRule:"Exists iff the source object and the center point exists. For dilations of non-points, existence also requires that the dilation factor be non-zero.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-DilateFixFactor_export.json",properties:{parents:{description:"",properties:{center:{description:"The center of the dilation",kind:"Point"}}},scaleFactor:{description:"A scale factor.",type:"Number",required:false}}},scaleFactor:0,determineExists:function(){var D=this.getScaleFactor();return y.math.isFiniteScalar(D)&&((this.kind==="Point")||(D!==0))},getScaleFactor:function(){return this.scaleFactor},getPivot:function(){return this.getParent("center").geom.loc},getTransform:function(){var D=this;return function(E){return E.scale(D.getPivot(),D.getScaleFactor())}},getScalarTransform:function(){var D=this;return function(E){return Math.abs(E*D.getScaleFactor())}}});y.gConstraints.AxisExternalDist=y.makeClass(y.gConstraints.AxisDist,{doc:{description:"An axis determined by origin and parental unit distance.",inherits:"AxisDist",refspec:{gspRef:"ExternalDistAxis_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ExternalDistAxis_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Axis"]},existenceRule:"Exists iff the parent origin point exists and distance parent exists and is positive.",properties:{parents:{description:"",properties:{unitDistance:{description:"A measure or segment",kind:"Measure|Straight"},unitPoint:{suppressed:true}}}}},constrain:function u(){var H=this.getParent("unitDistance"),G=this.getParent("origin").geom.loc,F=H.pathLength?H.pathLength():H.value,E=0,D=0;if(isNaN(F)||(F<=0)){this.state.exists=false;return}if(this.orientation==="horizontal"){E=F}if(this.orientation==="vertical"){D=-F}this.geom.origin=y.GeometricPoint(G.getX(),G.getY());this.geom.unit=y.GeometricPoint(G.getX()+E,G.getY()+D);(u.base||arguments.callee.base).call(this)}});y.gConstraints.UnitPointExternalRectangle=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:"A unit point displaced perpendicularly from the origin of an axis by a given distance.",inherits:"UnitPoint",refspec:{gspRef:"ExternalRectangleUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ExternalRectangleUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent axis exists.",properties:{parents:{description:"",properties:{axis:{description:"The Axis for which this point is the unit point",kind:"Axis"}}},unitDistance:{description:"unit distance from grand-parental origin in pixels",type:"Number"}}},constrain:function(){var G=this.getParent("axis"),F=G.geom.origin.getX(),H=G.geom.origin.getY(),E=G.geom.unit.getX()-F,D=G.geom.unit.getY()-H,I=this.unitDistance;E=(E>0)?1:((E===0)?0:-1);D=(D>0)?1:((D===0)?0:-1);E*=I;D*=I;this.geom.loc=y.GeometricPoint(F+D,H-E)}});y.gConstraints.UnitPointExternalSquare=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:"A unit point displaced perpendicularly from the origin of an axis by the unit distance of that axis.",inherits:"UnitPoint",refspec:{gspRef:"ExternalSquareUnitPoint_C"},usage:{"abstract":false},existenceRule:"Exists iff the parent origin point exists and distance parent exists and is positive.",properties:{parents:{description:"",properties:{axis:{description:"The Axis for which this point is the unit point",kind:"Axis"}}}}},constrain:function(){var G=this.getParent("axis"),F=G.geom.origin.getX(),H=G.geom.origin.getY(),E=G.geom.unit.getX()-F,D=G.geom.unit.getY()-H;this.geom.loc=y.GeometricPoint(F+D,H-E)}});y.gConstraints.HorizontalUnitPoint=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:'A unit point of a horizontal <span class="kind">Axis</span>.',inherits:"UnitPoint",refspec:{gspRef:"HorizontalUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, HorizontalUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent origin point exists.",properties:{value:{description:"horizontal displacement from parental origin in pixels.",type:"Number"},parents:{description:"",properties:{origin:{description:"origin point of related axis.",kind:"Point"}}}}},value:20,unitPointDeltaX:function(){return this.value},transform:function(G,F){var D=this.unitPointOrigin(),E=F.geom.loc.copy();F.affine.transform(E);this.value=Math.max(this.kMinUnitPointDistanceFromOrigin,(E.getX()-D.geom.loc.getX()))}});y.gConstraints.AxisInternalDist=y.makeClass(y.gConstraints.AxisDist,{doc:{description:"An axis determined by origin and unitPoint.",inherits:"AxisDist",refspec:{gspRef:"InternalDistAxis_C"},usage:{"abstract":false,kinds:["Axis"]},existenceRule:"Exists iff the parent origin point and unitPoint exists.",properties:{parents:{description:"",properties:{origin:{description:"",genus:"Point"},unitPoint:{description:"",genus:"Point"}}}}},constrain:function u(){var E=this.getParent("origin").geom.loc,D=this.getParent("unitPoint").geom.loc;this.geom.origin=y.GeometricPoint(E.getX(),E.getY());this.geom.unit=y.GeometricPoint(D.getX(),D.getY());(u.base||arguments.callee.base).call(this)}});y.gConstraints.UnitPointInternalRectangle=y.makeClass(y.gConstraints.UnitPoint,{doc:{description:"A unit point displaced perpendicularly from the origin of a parental axis of a unit point by a given distance.",inherits:"UnitPoint",refspec:{gspRef:"InternalRectangleUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, InternalRectangleUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent unitPoint exists.",properties:{parents:{description:"",properties:{unitPoint:{description:"",kind:"Point"}}},unitDistance:{description:"unit distance from grand-parental origin in pixels",type:"Number"}}},transform:function(H,F){var G=this.getParent("unitPoint"),D=G.getParent("origin"),E=F.geom.loc.copy();F.affine.transform(E);this.unitDistance=Math.max(this.kMinUnitPointDistanceFromOrigin,(D.geom.loc.getY()-E.getY()))},constrain:function(){var J=this.getParent("unitPoint"),F=J.getParent("origin"),G=F.geom.loc.getX(),H=F.geom.loc.getY(),I=this.unitDistance,E=J.geom.loc.getX()-G,D=J.geom.loc.getY()-H;E=(E>0)?1:((E===0)?0:-1);D=(D>0)?1:((D===0)?0:-1);E*=I;D*=I;this.geom.loc=y.GeometricPoint(G+D,H-E)}});y.gConstraints.UnitPointInternalSquare=y.makeClass([y.gConstraints.UnitPoint,y.mixins.transformable],{doc:{description:"A unit point displaced perpendicularly from the origin of a parental axis of a unit point by the unit distance of that axis.",inherits:"UnitPoint",refspec:{gspRef:"InternalSquareUnitPoint_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, InternalSquareUnitPoint_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent unitPoint exists.",properties:{parents:{description:"",properties:{unitPoint:{description:"",kind:"Point"}}}}},constrain:function(){var I=this.getParent("unitPoint"),F=I.getParent("origin"),G=F.geom.loc.getX(),H=F.geom.loc.getY(),E=I.geom.loc.getX()-G,D=I.geom.loc.getY()-H;this.geom.loc=y.GeometricPoint(G+D,H-E)},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Unit point "+this.id)}});y.gConstraints.MeasurementAbscissa=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The abscissa (x coordinate) of a point relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"AbscissaM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AbscissaM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getCoordinates(this.getParent("point"));this.value=D.x;this.uValue=this.value},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeTextMFS("x",true),this.getParent("point").getNameMFS()]}}});y.gConstraints.MeasurementAnalyticSlope=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The slope of a straight relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"AnalyticSlopeM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AnalyticSlopeM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{seg:{description:"",kind:"Straight"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getParent("seg"),E=this.getParent("coordSys"),H=E.locatePoint(D.geom.p0),F=E.locatePoint(D.geom.p1),G=F.subtract(H);this.value=(G.getX()===0)?NaN:(G.getY()/G.getX());this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Slope "),this.getParent("seg").getNameMFS())}});y.gConstraints.GeometricSlope=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The slope of a straight.",inherits:"Constraint",refspec:{gspRef:"GeometricSlopeM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, GeometricSlopeM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Measure"]},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{straight:{description:"",kind:"Straight"}}}}},constrain:function(){var D=this.getParent("straight"),G=D.getP0(),E=D.getP1(),F=E.subtract(G);this.value=(F.getX()===0)?NaN:-(F.getY()/F.getX());this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("Slope "),this.getParent("straight").getNameMFS())}});y.gConstraints.MeasurementArcBase=y.makeClass(y.gConstraints.Constraint,{doc:{description:"The measurement of the angle of an arc. The arc is either an arc object, or a circle and points on the circle which define an arc.",inherits:"Constraint",usage:{"abstract":true,kinds:["Measure"]},existenceRule:"Exists iff the parents and are non-coincident exist."},getParentalArc:function(){throw y.createError("MeasurementArcBase.getParentalArc: Derived class must override!")},getArcNameMFS:function(){throw y.createError("MeasurementArcBase.getParentalArc: Derived class must override!")},measureArcAngle:function(){var E=this.getParentalArc(),F=E.arcAngle,D=this.sQuery().prefs().units.angle;this.value=F;this.uValue=y.units.convert(F,"radians",D)},measureArcLength:function(){var F=this.getParentalArc(),D=F.getCache(F.genus).arcLength||F.arcLength,E=this.sQuery().prefs().units.length;this.value=D;this.uValue=y.units.convert(D,"pixels",E)},getAngleNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS("m ",true),this.getArcNameMFS())},getLengthNameMFS:function(){return y.mfs.makeHorizontalMFS(y.mfs.makeTextMFS(y.Strings.loc("GSP.Measure.arcLength")+" "),this.getArcNameMFS())}});y.gConstraints.MeasurementArc=y.makeClass(y.gConstraints.MeasurementArcBase,{doc:{description:"The measurement of the angle of an arc.",inherits:"MeasurementArcBase",existenceRule:"Exists iff the parents and are non-coincident exist.",properties:{parents:{description:"",properties:{arc:{description:"The arc to be measured",kind:"Arc"}}}}},getParentalArc:function(){var D=this.getParent("arc");return D&&D.geom.arc},getArcNameMFS:function(){var D=this.getParent("arc");return D&&D.getParentalNameMFS()}});y.gConstraints.MeasurementArcAngle=y.makeClass(y.gConstraints.MeasurementArc,{doc:{description:"The measurement of an angle defined by three points.",inherits:"MeasurementArc",refspec:{gspRef:"ArcAngle3PointsMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcAngle3PointsMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{angle:1},constrain:function(){this.measureArcAngle()},getParentalNameMFS:function(){return this.getAngleNameMFS()}});y.gConstraints.MeasurementArcLength=y.makeClass(y.gConstraints.MeasurementArc,{doc:{description:'The measurement of the length of a <span class="kind">Arc</span>s.',inherits:"MeasurementArc",refspec:{gspRef:"ArcLengthM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcLengthM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{length:1},constrain:function(){this.measureArcLength()},getParentalNameMFS:function(){return this.getLengthNameMFS()}});y.gConstraints.MeasurementArcOnCircle=y.makeClass(y.gConstraints.MeasurementArcBase,{doc:{description:"The measurement of the angle of an arc. The arc is defined by a circle and points on the circle which define an arc.",inherits:"MeasurementArcBase",existenceRule:"Exists iff the parents and are non-coincident exist.",properties:{parents:{description:"",properties:{circle:{description:"Circle containing arc",kind:"Circle"},p0:{description:"Initial point",kind:"Point"},p1:{description:"Final point (or if p2 is set, middle point)",kind:"Point"},p2:{description:"Final point",kind:"Point",required:false}}}}},getParentalArc:function(){var F,E,D,I,G,H;H=this.getParent("circle");E=this.getParent("p0").geom.loc;D=this.getParent("p1").geom.loc;I=this.getParent("p2");if(I){G=y.Geom.ThreePointCollinear(E,I.geom.loc,D);F=y.GeometricArc.FromCenterAndEndpoints(H.geom.c,E,I.geom.loc,G.orientation)}else{G=y.Geom.ThreePointCollinear(E,H.geom.c,D);F=y.GeometricArc.FromCenterAndEndpoints(H.geom.c,E,D,G.orientation)}return F},measureArcAngle:function(){var E=this.getParentalArc(),F=E.arcAngle,D=this.sQuery().prefs().units.angle;if(D!=="deg"){F*=-E.orientation}this.value=F;this.uValue=y.units.convert(F,"radians",D)},getArcNameMFS:function(){var G=this.getParent("circle"),E=this,D=function(K){var J=E.getParent(K);return J&&J.getNameMFS()||y.mfs.makeTextMFS("")},F={type:"style",value:[{code:"fontStyle",value:"2"}]},I=[];["p0","p1","p2"].forEach(function(J){I.push(D(J))});F.value.push(y.mfs.makeHorizontalMFS.apply(this,I));F={type:"overbar",variant:5,value:F};var H=y.mfs.makeHorizontalMFS({type:"symbol",value:"100"},G.getParentalNameMFS());return y.mfs.makeHorizontalMFS(F,y.mfs.makeTextMFS(" on "),H)}});y.gConstraints.MeasurementArcOnCircleAngle=y.makeClass(y.gConstraints.MeasurementArcOnCircle,{doc:{description:'The measurement of the length of a <span class="kind">Arc</span>s.',inherits:"MeasurementArcOnCircle",refspec:{gspRef:"ArcAngle3PointsMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcAngle3PointsMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{angle:1},constrain:function(){this.measureArcAngle()},getParentalNameMFS:function(){return this.getAngleNameMFS()}});y.gConstraints.MeasurementArcOnCircleLength=y.makeClass(y.gConstraints.MeasurementArcOnCircle,{doc:{description:'The measurement of the length of a <span class="kind">Arc</span>s.',inherits:"MeasurementArcOnCircle",refspec:{gspRef:"ArcLengthM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, ArcLengthM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},unitPowers:{length:1},constrain:function(){this.measureArcLength()},getParentalNameMFS:function(){return this.getLengthNameMFS()}});y.gConstraints.MeasurementCoordinateDistance=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The distance between two points relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"CoordinateDistanceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CoordinateDistanceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{p0:{description:"The point from which distance is to be measured",kind:"Point"},p1:{description:"The point to which distance is to be measured",kind:"Point"}}}}},constrain:function(){var E=this.getCoordinates(this.getParent("p0")),D=this.getCoordinates(this.getParent("p1"));this.value=D.subtract(E).vLength();this.uValue=this.value},getParentalNameMFS:function(){return y.mfs.makeHorizontalMFS(this.getParent("p0").getNameMFS(),this.getParent("p1").getNameMFS())}});y.gConstraints.MeasurementOrdinate=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The ordinate (y coordinate) of a point relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"OrdinateM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, OrdinateM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getCoordinates(this.getParent("point"));this.value=D.y;this.uValue=this.value},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeTextMFS("y",true),this.getParent("point").getNameMFS()]}}});y.gConstraints.MeasurementPolarDirection=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The angle (theta-value of the polar coordinates) of a point relative to the x-axis of a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"PolarDirectionM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PolarDirectionM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},unitPowers:{angle:1},constrain:function(F){var G=this.getCoordinates(this.getParent("point")),D=F.preferences.units.angle,E;E=Math.atan2(G.getY(),G.getX());this.value=E;this.uValue=y.units.convert(E,"radians",D)},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeItalicMFS({type:"symbol",value:"71"}),this.getParent("point").getNameMFS()]}}});y.gConstraints.MeasurementPolarDistance=y.makeClass(y.gConstraints.MeasurementCoordinateBased,{doc:{description:"The distance from the origin (r-value of the polar coordinates) of a point relative to a coordinate system.",inherits:"MeasurementCoordinateBased",refspec:{gspRef:"PolarDistanceM_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PolarDistanceM_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parents exist.",properties:{parents:{description:"",properties:{point:{description:"",kind:"Point"},coordSys:{description:"",kind:"CoordSys"}}}}},constrain:function(){var D=this.getCoordinates(this.getParent("point"));this.value=D.vLength();this.uValue=this.value},getParentalNameMFS:function(){return{type:"sub",value:[y.mfs.makeTextMFS("r",true),this.getParent("point").getNameMFS()]}}});y.gConstraints.PointOnPolygonEdge=y.makeClass(y.gConstraints.PointOnPathBase,{doc:{description:'A point on a <span class="kind">Polygon</span>.',inherits:"Constraint",refspec:{gspRef:"OnPath_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, OnPath_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent param and path exist.",properties:{baseVertex:{description:"index of initial vertex of edge containing point",type:"Number"},baseValue:{description:"parameterized location on edge starting at baseVertex",type:"Number"},parents:{description:"",properties:{path:{description:"",kind:"Polygon"}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-PointOnPath_export.json"},value:0.5,isPathValuePrimary:false,updateValue:function(E){this.value=E-Math.floor(E);this.isPathValuePrimary=true;var D=this.getParent("path"),F=D.mapPathValueToCharacteristic(this.value);this.baseVertex=F.baseVertex;this.baseValue=F.baseValue},transform:function(G,E){var D=this.getParent("path"),F=E.geom.loc.copy();E.affine.transform(F);this.updateValue(D.mapPositionToPathValue(F))},constrain:function(){var D=this.getParent("path");var E=D.geom.points,G=E[this.baseVertex],F=E[(this.baseVertex+1)%E.length];this.geom.loc=G.add(F.subtract(G).multiply(this.baseValue));if(!this.isPathValuePrimary){this.value=D.mapPositionToPathValue(this.geom.loc)}}});y.gConstraints.RotateAngleMarker=y.makeClass(y.gConstraints.Rotate,{doc:{description:"Defines a new GObject as a rotation of a GObject by the measure of a marked angle about a pivot point.",inherits:"Rotate",refspec:{gspRef:"RotateByMarkedAngleMarker_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RotateByMarkedAngleMarker_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and the three angle points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-RotateAngleMarker_export.json",properties:{parents:{description:"",properties:{angle:{description:"",kind:"AngleMarker"}}},angle:{suppressed:true}}},getAngle:function(){var D;D=this.getParent("angle");return D.value}});y.gConstraints.RotateMeasureAngle=y.makeClass(y.gConstraints.Rotate,{doc:{description:"Defines a new GObject as a rotation of a GObject by a measure about a pivot point, p0.",inherits:"Rotate",refspec:{gspRef:"RotateByMarkedAngleMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, RotateByMarkedAngleMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and the three angle points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-RotateMeasureAngle_export.json",properties:{parents:{description:"",properties:{angle:{description:"",kind:"Measure"}}},angle:{suppressed:true}}},getAngle:function(){var D;D=this.getParent("angle");return -D.value}});y.gConstraints.Rotate3=y.makeClass(y.gConstraints.Rotate,{doc:{description:"Defines a new GObject as a rotation of a GObject about a pivot point, p0, by an angle from three points.",inherits:"Rotate",refspec:{gspRef:"Rotate3A_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Rotate3A_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object and the three angle points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Rotation3_export.json",properties:{parents:{description:"",properties:{A:{description:"",kind:"Point"},B:{description:"",kind:"Point"},C:{description:"",kind:"Point"}}},angle:{suppressed:true}}},getAngle:function(){var E,D,F;E=this.getParent("A").geom.loc;D=this.getParent("B").geom.loc;F=this.getParent("C").geom.loc;return y.GeometricPoint.threePointAngle(E,D,F)}});y.gConstraints.AxisUnitCircle=y.makeClass(y.gConstraints.AxisDist,{doc:{description:"An axis determined a unit circle.",inherits:"AxisDist",refspec:{gspRef:"UnitCircleAxis_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, UnitCircleAxis_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Axis"]},existenceRule:"Exists iff the parent circle exists and has positive radius.",properties:{parents:{description:"",properties:{circle:{description:"",kind:"Circle"},origin:{suppressed:true},unitPoint:{suppressed:true}}}}},constrain:function u(){var G=this.getParent("circle"),F=G.geom.r,E=0,D=0;this.geom.origin=G.geom.c;if(isNaN(F)||(F<=0)){this.state.exists=false;return}if(this.orientation==="horizontal"){E=F}if(this.orientation==="vertical"){D=-F}this.geom.unit=y.GeometricPoint(this.geom.origin.getX()+E,this.geom.origin.getY()+D);(u.base||arguments.callee.base).call(this)}});y.gConstraints.AngleMarker=y.makeClass(y.gConstraints.Constraint,{doc:{description:"Marks the angle between two lines.",inherits:"Constraint",refspec:{},usage:{"abstract":true,kinds:["AngleMarker"]},existenceRule:"Exists iff parents exist, and define a non-zero angle.",properties:{parents:{properties:{p0:{description:"A point on an angle edge",kind:"Point"},p1:{description:"The focal point of an angle",kind:"Point"},p2:{description:"A point on the other angle edge",kind:"Point"}}}}},makeArcs:function(E,D,K,J,G){var F=E.subtract(D),I,H;if(Math.abs(this.value)<0.0004){this.geom.arc=h;this.state.exists=true;return}if(F.isZeroLength()){this.state.exists=false}else{I=F.multiply(this.style["inner-radius"]/F.vLength());F=K.subtract(D);if(F.isZeroLength()){this.state.exists=false}else{H=F.multiply(this.style["inner-radius"]/F.vLength());this.geom.arc=y.GeometricArc.FromCenterAndEndpoints(D,D.add(I),D.add(H),G);this.state.exists=this.geom.arc.exists}}},getParentalNameMFS:function(){return this.getAngleMarkerMFS(false)},constrainedAngle:function(E,D){return E},constrain:function(){var E=this.getParent("p0").geom.loc,D=this.getParent("p1").geom.loc,I=this.getParent("p2").geom.loc,H=y.GeometricPoint.threePointAngle(E,D,I),G=y.Geom.ThreePointCollinear(E,D,I),F;if(!G.isStraight){if((H+Math.PI)<y.math.SIMPLE_PI_THRESHOLD){H+=2*Math.PI}}this.value=this.constrainedAngle(H,G);F=G.orientation;this.makeArcs(E,D,I,H,F)}});y.gConstraints.ActionButtonAnimate=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that moves a point on a path.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{parents:{description:"Animating objects",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"kind"}},regex:/^[0-9]+$/},animationStates:{description:"Array of objects containing state information (rate, repeat, motionType, etc.) for each animation controlled by this button.  State information depends on the kind of animation",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Button-Animation_export.json"},animationStates:[],smoothInSpace:true,press:function(O,E){var J=this,I,P,G;function K(){if(!this.animateFunction(O)){O.MotionManager.EndMotion(this.motionID)}}function F(){var Q;this.motionID=h;J.state.isActive=(J.state.motions.length>1);for(Q=0;Q<J.state.motions.length;Q++){if(this===J.state.motions[Q]){J.state.motions.splice(Q,1);break}}if(!J.state.isActive){O.invalidateGeom(J)}}function L(W){var Y=(Math.PI/2),Q,X=Number(new Date()),T,V=this.gobj,U=W.sketchRect(),R;if(!this.animContext){this.animContext={currentAngle:Math.random()*2*Math.PI,lastSampleTime:Number(new Date())-16}}function S(ad,aa,ai,ab,af){var Z=0.2,ag=0.3,aj=ab-ai,ac,ah,ae=aa;if(aj){ac=(ad-ai)/aj;if(ac<Z){ah=Z-ac;if(ah>=ag){ae+=af}else{ae+=(af*ah/ag)}}else{if(ac>(1-Z)){ah=ac-(1-Z);if(ah>=ag){ae-=af}else{ae-=(af*ah/ag)}}}}return ae}R=this.animContext;R.currentAngle+=(Y*Math.random())-(Y*0.5);Q=this.rate*y.kWebSpeedMultiplier;T={x:Math.cos(R.currentAngle)*Q,y:Math.sin(R.currentAngle)*Q};T.x=S(V.geom.loc.getX(),T.x,U.left,U.right,Q);T.y=S(V.geom.loc.getY(),T.y,U.top,U.bottom,Q);V.transform(W,{geom:V.geom,affine:y.AffineTransform({m00:1,m11:1,m20:T.x,m21:T.y})});W.invalidateGeom(V);R.lastSampleTime=X;return true}function M(ab,ad,R){var U=ad.animContext,aa=ad.gobj,X=R.curSampleTime-U.lastSampleTime,Z=(ad.smoothInSpace)?U.stepSize:U.stepSize*(X*y.kIdealFrameRate/1000),T,Q=aa.value,S=true,ac,W=false;function Y(ah,aj){var ag=ah.maxValue-ah.minValue,ae=aj-ah.minValue,ai,ak,af;if((ae>=0)&&(ae<=ag)){y.signalErrorWithMessage("calculateWrappedPosition() should only be called when we need wrapping");return}af=ae%ag;if(ah.oscillate){ai=(ae>0)?(ae-ag):ae;ak=1+Math.floor(Math.abs(ai/ag));if((ak%2)===1){af*=-1}}if(af>0){return{value:ah.minValue+af,direction:1}}else{return{value:ah.maxValue+af,direction:-1}}}function V(){var ae=U.maxValue-U.minValue;if(U.finalValue!==null){if(Z>=ae){return true}else{if(R.firstTime){return false}}if(W){if(((T>=U.finalValue)&&(Q>=U.finalValue))||((T<=U.finalValue)&&(Q<=U.finalValue))){return true}}else{if(((T>=U.finalValue)&&(U.finalValue>=Q))||((Q>=U.finalValue)&&(U.finalValue>=T))){return true}}}return false}if(Q<U.minValue){Q=U.minValue}if(Q>U.maxValue){Q=U.maxValue}T=Q+(Z*U.direction);if((T<U.minValue)||(T>U.maxValue)){ac=Y(U,T);T=ac.value;U.direction=ac.direction;W=true}if(V()){T=U.finalValue;S=false}if(aa.updateValue){aa.updateValue(T)}else{y.signalErrorWithMessage("animateOneStep encountered unexpected object type")}ab.invalidateGeom(aa);return S}function D(U,Q,T){var R=Q.animContext,S=true;if(T.curSampleTime>=R.nextRandomEventTime){Q.gobj.updateValue(R.minValue+Math.random()*(R.maxValue-R.minValue));U.invalidateGeom(Q.gobj);R.nextRandomEventTime=T.curSampleTime+R.randomPeriod;S=R.repeat}return S}function H(W){var S,T=this.path,Q={curSampleTime:Number(new Date()),firstTime:false},X=T.pathLength(),R=T.getAnimationRange(),V=true;if(!this.animContext){Q.firstTime=true;this.animContext={lastPathLength:0,lastSampleTime:Q.curSampleTime-(1000/y.kIdealFrameRate),stepSize:null,minValue:null,maxValue:null,direction:(this.motionType==="backward")?-1:1,oscillate:(this.motionType==="both"),random:(this.motionType==="random"),repeat:this.repeat,finalValue:null,perFrameAdvanceFn:M};if(!this.repeat){this.animContext.finalValue=this.gobj.value}if(this.animContext.random){this.animContext.randomPeriod=y.kNormalSpeedRate/this.rate*1000;this.animContext.nextRandomEventTime=Q.curSampleTime;this.animContext.perFrameAdvanceFn=D}}S=this.animContext;if(!((R.min===S.minValue)&&(R.max===S.maxValue)&&(X===S.lastPathLength))){var U=T.unitLength();if(!S.random){S.stepSize=Math.abs(this.rate/U*y.kWebSpeedMultiplier)}S.minValue=R.min;S.maxValue=R.max;S.lastPathLength=X}V=S.perFrameAdvanceFn(W,this,Q);S.lastSampleTime=Q.curSampleTime;return V}function N(T){var R={curSampleTime:Number(new Date()),firstTime:false},S=true;function Q(Y,U,X){var V=true,W=U.animContext;if(X.curSampleTime>=W.nextDiscreteEventTime){V=M(Y,U,X);W.nextDiscreteEventTime=X.curSampleTime+W.discretePeriod}return V}if(!this.animContext){R.firstTime=true;this.animContext={lastSampleTime:R.curSampleTime-(1000/y.kIdealFrameRate),stepSize:null,minValue:this.paramMinValue,maxValue:this.paramMaxValue,direction:(this.motionType==="backward")?-1:1,oscillate:(this.motionType==="both"),random:(this.motionType==="random"),repeat:this.repeat,finalValue:null,perFrameAdvanceFn:M};if(!this.repeat){this.animContext.finalValue=this.gobj.value}if(this.animContext.random){this.animContext.randomPeriod=1000*this.timeInterval;this.animContext.nextRandomEventTime=R.curSampleTime;this.animContext.perFrameAdvanceFn=D}else{if(this.discrete){this.animContext.discretePeriod=1000*this.timeInterval;this.animContext.nextDiscreteEventTime=R.curSampleTime;this.animContext.stepSize=Math.abs(this.rate);this.animContext.perFrameAdvanceFn=Q}else{if(this.timeInterval===0){y.signalErrorWithMessage("invalid time interval")}this.animContext.stepSize=Math.abs(this.rate/(y.kIdealFrameRate*this.timeInterval))}}}S=this.animContext.perFrameAdvanceFn(T,this,R);this.animContext.lastSampleTime=R.curSampleTime;return S}if(!this.state.isActive){y.log("Started animation "+this.id);this.state.motions=[];this.state.isActive=true;for(I=0;I<this.parentsList.length;I++){G=this.parentsList[I];P={applyMotion:K,completeMotion:F,animateFunction:h,controlList:O.Bap.createControlList([G]),gobj:G,rate:this.animationStates[I].rate,repeat:this.animationStates[I].repeat,motionType:this.animationStates[I].motionType,smoothInSpace:this.smoothInSpace};if(G.isFreePointOnPath){P.path=G.parents.path;P.animateFunction=H}else{if(P.gobj.kind==="Point"){P.animateFunction=L}else{if(P.gobj.kind==="Expression"){P.animateFunction=N;P.isValueChangingMotion=true;P.timeInterval=this.animationStates[I].timeInterval;P.paramMinValue=this.animationStates[I].lowerParamBound;P.paramMaxValue=this.animationStates[I].upperParamBound;P.discrete=this.animationStates[I].discrete}}}P.motionID=O.MotionManager.StartMotion(P);this.state.motions.push(P)}O.invalidateGeom(this)}else{y.log("Canceling animation "+this.id);for(I=0;I<this.state.motions.length;I++){O.MotionManager.EndMotion(this.state.motions[I].motionID)}}}});y.gConstraints.CoordSys=y.makeClass(y.gConstraints.Constraint,{doc:{description:"An coordinate system determined by two axes.",inherits:"Constraint",refspec:{gspRef:"CoordSys_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, CoordSys_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["CoordSys"]},existenceRule:"Exists iff the parent axes exists.",properties:{parents:{description:"",properties:{axisX:{description:"The horizontal axis",kind:"Axis"},axisY:{description:"The vertical axis",kind:"Axis"}}}}},isVisible:function(){return(!this.style.hidden)||(!this.getParent("axisX").style.hidden&&!this.getParent("axisY").style.hidden)},constrain:function(){var F=this.getParent("axisX"),E=this.getParent("axisY"),D;this.geom.origin=F.geom.origin;this.geom.unit0=F.geom.unit;this.geom.unit1=E.geom.unit;D={x:this.geom.unit0.x-this.geom.origin.x,y:-(this.geom.unit1.y-this.geom.origin.y)};this.geom.gridSpacing=(this.shape==="polar")?F.getPolarSpacing(D).pixelsBetweenTicks:{x:F.getLineSpacing().pixelsBetweenTicks,y:E.getLineSpacing().pixelsBetweenTicks}}});y.gConstraints.Dilate2SegRatio=y.makeClass(y.gConstraints.DilateFixFactor,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by the ratio of the lengths of two segments.",inherits:"DilateFixFactor",refspec:{gspRef:"Dilate2R_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Dilate2R_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, the center, and the two segments all exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Dilate2SegRatio_export.json",properties:{parents:{description:"",properties:{seg0:{description:"Segment defining the numerator of the scale ratio",kind:"Straight"},seg1:{description:"Segment defining the denominator of the scale ratio",kind:"Straight"}}},scaleFactor:{suppressed:true}}},getScaleFactor:function(){var D=this.getParent("seg0");var F=this.getParent("seg1");var E=D.pathLength()/F.pathLength();return E}});y.gConstraints.Dilate3PtRatio=y.makeClass(y.gConstraints.DilateFixFactor,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by a ratio of three points, A, B, C. The ratio is |AB|/|AC|.",inherits:"DilateFixFactor",refspec:{gspRef:"Dilate3R_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Dilate3R_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object, the three angle points exist and the |AB| evaluates to a non-zero length.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Dilate3PtRatio_export.json",properties:{parents:{description:"",properties:{A:{description:"First control point of the line",kind:"Point"},B:{description:"Second control point of the line",kind:"Point"},C:{description:"The point that is mapped to the line",kind:"Point"}}},scaleFactor:{suppressed:true}}},getScaleFactor:function(){var E=this.getParent("A").geom.loc;var D=this.getParent("B").geom.loc;var F=this.getParent("C").geom.loc;return y.GeometricPoint.mapPointToLine(E,D,F).param}});y.gConstraints.DilateMeasureFactor=y.makeClass(y.gConstraints.DilateFixFactor,{doc:{description:"Defines a new GObject as a dilation about a point of a GObject by a measurement.",inherits:"DilateFixFactor",refspec:{gspRef:"DilatemR_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, DilatemR_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, the center point and the measurement exist and the measurement evaluates to a finite, non-zero number.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-DilateMeasureFactor_export.json",properties:{parents:{description:"",properties:{measure:{description:"A measurement or calculation",kind:"Measure"}}},scaleFactor:{suppressed:true}}},getScaleFactor:function(){var E=this.getParent("measure");var D=E.value;return D}});y.gConstraints.Intersection1=y.makeClass(y.gConstraints.Intersection,{doc:{description:'One of two points of intersection of an <span class="kind">Arc</span> or <span class="kind">Circle</span> with another Arc, Circle, or <span class="kind">Straight</span> object.',inherits:"Intersection",refspec:{gspRef:"InterLCA",msg:"This constraint is intended to behave in the same way as the corresponding constraints, InterLCA and InterCCA, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent objects exist and have at least one point of intersection.",properties:{parents:{description:"",properties:{circle:{description:"The first of two GObjects for which intersection(s) are to be determined",kind:"Arc|Circle"},obj:{description:"The second of two GObjects for which intersection(s) are to be determined",kind:"Arc|Circle|Straight",type:"GObject"},line0:{suppressed:true},line1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Intersection12_export.json"},getIntersectionPoints:function(){var L=[],E=this.getParent("circle"),I=this.getParent("obj"),M=E.getGeometricArc(),K=(I.kind==="Straight"||I.kind==="Axis"),G=K?I:I.getGeometricArc(),D=0,H=(M.orientation===0)?"Straight":"Arc",F=(G.kind==="Straight"||G.kind==="Axis"||G.orientation===0)?"Straight":"Arc",J=H+F,N;switch(J){case"StraightStraight":N=y.Geom.LineLineIntersection(M,G);if(N.isDefined()){L.push(N,N)}break;case"ArcStraight":D=M.orientation;L=y.Geom.CircleStraightIntersection(M,G);break;case"StraightArc":D=-G.orientation;L=y.Geom.CircleStraightIntersection(G,M);break;case"ArcArc":D=M.orientation*G.orientation;L=y.Geom.CircleCircleIntersection(M,G);break}L=g.grep(L,function(O){return M.pointIsInBounds(O)&&(K||G.pointIsInBounds(O))});if(-1===D){L.reverse()}return(L)},constrain:function(){var D=this.getIntersectionPoints();if(D[0]){this.geom.loc=D[0];this.state.exists=true}else{this.geom.loc=y.GeometricPoint(h,h);this.state.exists=false}}});(function(){var K={init:function Q(){this.isAtTarget=false;this.controlList=this.sketch.Bap.createControlList([this.moverGObj]);this.motionID=null;this.lastSample=Number(new Date())},isInstant:function(){return(this.button.rate===0)},reconfigureFromConstraints:function N(){var U=this.targetGObj.state.constraintFrame;if(U!==this.constraintFrame){this.constraintFrame=U;if(this.isAtTarget&&this.canKeepMoving()&&this.getStep().isAlreadyThere){this.isAtTarget=true}else{this.isAtTarget=false}}},canKeepMoving:function H(){return this.moverGObj.state.exists&&(false!==this.getDestination())},applyMotion:function G(){var U=Number(new Date()),W=Math.max(U-this.lastSample,1),V;if(!this.isInstant()){this.reconfigureFromConstraints()}if(this.isAtTarget){this.sketch.MotionManager.EndMotion(this.motionID)}else{if(this.canKeepMoving()){V=(this.rate*y.kWebSpeedMultiplier*(W/1000)*y.kIdealFrameRate);this.isAtTarget=this.getStep().move(V);this.sketch.invalidateGeom(this.moverGObj)}this.lastSample=U}},completeMotion:function J(){var U;this.motionID=h;this.button.state.isActive=(this.button.state.motions.length>1);for(U=0;U<this.button.state.motions.length;U++){if(this===this.button.state.motions[U]){this.button.state.motions.splice(U,1);break}}if(!this.button.state.isActive){this.sketch.invalidateGeom(this.button)}}};var I=y.makeClass(K,{initializeDistance:function E(){var U=this.moverGObj,V=this.getDestination();if(this.getDestination()){this.distance=V.subtract(U.geom.loc).vLength()}else{this.distance=10}},getDestination:function P(){return this.targetGObj.geom.loc.isDefined()&&this.targetGObj.geom.loc}});var O=y.makeClass(K,{init:function Q(){(Q.base||arguments.callee.base).call(this);this.isValueChangingMotion=true},getDestination:function P(){if(this.targetGObj.blank){return this.isInstant()?"blank":false}if(this.moverGObj.blank&&!this.isInstant()){return false}return !isNaN(this.targetGObj.value)&&this.targetGObj.value},initializeDistance:function D(){var U=this.moverGObj;if(U.value===this.targetGObj.value){this.distance=0}else{this.distance=-1}},getStep:function F(){var aa=this.moverGObj,Y=this.getDestination(),Z=Y-aa.value,W=(Z<0)?-1:1,U=(Z===0),X={isAlreadyThere:U,move:function V(ab){if(Y==="blank"){aa.setParameterValue("");aa.blank=true;return true}if(!U){if((ab===0)||Math.abs(Z)<=Math.abs(ab)){aa.updateValue(Y);if(aa.blank){aa.blank=false}}else{aa.updateValue(aa.value+W*Math.abs(ab))}}return(ab===0)||U}};return X}});var T=y.makeClass(I,{getStep:function S(){var Y=this.moverGObj.geom.loc,W=this.getDestination().subtract(Y),U=W.vLength(),V=this,X={isAlreadyThere:U<=0.01,move:function(aa){var Z=false,ab;if((aa===0)||(Math.abs(aa)>=U)){ab=W;Z=true}else{ab=W.multiply(aa/U)}V.sketch.MotionManager.ApplyTransformToControlList(V.sketch,new y.AffineTransform({m00:1,m11:1,m20:ab.x,m21:ab.y}),V.controlList,{snapPoints:false,onPathTracksIdealLoc:false});return Z}};return X}});var R=y.makeClass(I,{getStep:function L(){var X=this.moverGObj,ad=this.getDestination(),Y=0.05,ae=X.getParent("path"),af=X.value,Z=ae.mapPositionToPathValue(ad),ac=ae.makeMotionPath(af,Z),U,ab=ae.mapPathValueToPosition(af),aa=ab.equals(ad,Y),V={isAlreadyThere:aa,move:function W(ag){if(!aa){if(ag===0){U=ac.advance(ac.getDistance())}else{U=ac.advance(ag)}X.updateValue(U)}return(ag===0)||aa}};return V}});y.gConstraints.ActionButtonMove=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that moves a set of points towards other points.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{parents:{description:"Set of objects to be moved",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"Point|Expression"}},regex:/^[0-9]+$/},rate:{description:"For point animation, the number of pixels to advance per frame cycle.",type:"Number"},towardInitialDestination:{description:"Rather than follow a moving destination, move to the position the destination was when the movement started ","default":false,type:"Boolean"}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/Move_export.json"},rate:1,towardInitialDestination:false,updateConstraintAncestry:function M(){(M.base||arguments.callee.base).call(this);this.state.motions=[]},press:function(ab,U){var Z=this,Y,V,W=-1,X;function aa(ae,ag){var ac,af,ad;switch(ae.kind){case"Point":af=ae.isFreePointOnPath?R:T;break;case"Expression":af=O;break;default:throw y.createError("Move button encountered unexpected object type")}ad=y.makeInstance(af);g.extend(ad,{moverGObj:ae,targetGObj:ag,sketch:ab,button:Z});ad.init();if(Z.towardInitialDestination){if(!ad.targetGObj.state.exists){return}ac=ad.getDestination();ad.getDestination=function(){return ac}}if(ad.moverGObj.state.exists){ad.initializeDistance();if(0!==this.distance){return ad}}}if(!this.state.isActive){this.state.isActive=true;y.log("Starting move "+Z.id);for(Y=0;Y<this.parentsList.length;Y+=2){V=aa(this.parentsList[Y+1],this.parentsList[Y]);if(V){W=Math.max(W,V.distance);this.state.motions.push(V)}}if(this.state.motions.length===0){this.state.isActive=false;ab.invalidateGeom(this);return}if(this.rate!==0){W=(W===-1)?400:W;X=W/this.rate;if(X===0){X=1}}g.each(this.state.motions,function(ad,ag){var ac,ae,af;if(Z.rate===0){ag.rate=0}else{if(ag.targetGObj.kind==="Point"){ag.rate=ag.distance/X}else{ac=ag.moverGObj.value;ae=ag.getDestination();if(ae!==false){af=ae-ac;ag.rate=af/X}else{ag.rate=100/X}}}if(isNaN(ag.rate)){y.signalErrorWithMessage("This Move Button calculated a Nan rate of speed!");ag.rate=Z.rate}ag.motionID=ab.MotionManager.StartMotion(ag)})}else{y.log("Canceling move "+Z.id);for(Y=0;Y<this.state.motions.length;Y++){ab.MotionManager.EndMotion(this.state.motions[Y].motionID)}}}})})();y.gConstraints.ActionButtonScroll=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that scrolls the sketch to the position of a point.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{parents:{description:"First object can be scrolled to particular location",type:"Array"},scrollDest:{description:"scrolls the page so that the parental point is at specified destination of the window (possible values: center | topLeft).",type:"String"}},example:""},scrollDest:"topLeft",press:function(N,G){var M=this.parentsList[0],J=M.geom.loc.copy(),L=N.sketchRect(),F,I,E;if(this.scrollDest==="center"){I=y.GeometricPoint(L.left+(L.right-L.left)/2,L.top+(L.bottom-L.top)/2);E=J.subtract(I)}else{F=y.GeometricPoint(L.left,L.top);E=J.subtract(F)}var D=0;var K=8,O=this;function H(){N.Scroll.translate(E.x/K,E.y/K);D++;if(D<K){N.addDeferredCall(O,H)}}N.addDeferredCall(O,H)}});y.gConstraints.ActionButtonLinkPage=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that switches to another page in the sketch.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{pageId:{description:"Id of the page being linked to.",type:"String"},buttonId:{description:"(Optional) Id of button to activate on the on the linked page.",type:"String",required:false}},example:""},pageId:"1",press:function(G,D){var F=G.document;F.switchPage(this.pageId);var H=F.focusPage;var E=this.buttonId&&H.sQuery().get(this.buttonId);if(E){E.press(H,"linkButton")}}});y.gConstraints.ActionButtonLinkURL=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"A button that opens a url.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Button"]},properties:{url:{description:"Url to link to.",type:"String"}},example:""},url:"",init:function x(){(x.base||arguments.callee.base).call(this)},constrain:function(D){},press:function(E,D){if(l){l.open(this.url)}}});y.gConstraints.Parallel=y.makeClass(y.gConstraints.Line,{doc:{description:'Defines a line through a <span class="kind">Point</span> parallel with another <span class="kind">Straight</span>.',inherits:"Line",refspec:{gspRef:"Parallel_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Parallel_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent point and line exist.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},line:{description:"",kind:"Straight"},p1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Parallel_export.json"},constrain:function(){var D=this.getParent("line");var L=D.geom.p0;var K=D.geom.p1;var H=this.getParent("p0").geom.loc;var I=K.subtract(L).multiply(0.5);this.geom.p0=H.subtract(I);this.geom.p1=H.add(I);var G=I.vLength();var J=10000/G;var E=H.add(I.multiply(-J));var F=H.add(I.multiply(J));this.geom.xp0=E;this.geom.xp1=F},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Parallel line "+this.id)}});y.gConstraints.Perpendicular=y.makeClass(y.gConstraints.Line,{doc:{description:'Defines a line through a <span class="kind">Point</span> perpendicular with another <span class="kind">Straight</span>.',inherits:"Line",refspec:{gspRef:"Perpend_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, Perpend_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Straight"]},existenceRule:"Exists iff the parent point and line exist.",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},line:{description:"",kind:"Straight"},p1:{suppressed:true}}}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Straight-Perpendicular_export.json"},constrain:function(){var F=this.getParent("line");var D=F.getP1().subtract(F.getP0());var G=y.GeometricPoint(-D.y,D.x);var E=this.getParent("p0").geom.loc;var H=10000;this.geom.p0=E.add(G.multiply(-1/2));this.geom.p1=E.add(G.multiply(1/2));this.geom.xp0=E.add(G.multiply(-H));this.geom.xp1=E.add(G.multiply(H))},getParentalNameMFS:function(){return y.mfs.makeTextMFS("Perpendicular line "+this.id)}});y.gConstraints.PolygonFromPoints=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a polygon from a sequence of <span class="kind">Point</span>s.',inherits:"Free",refspec:{gspRef:"Polygon_C"},usage:{kinds:["Polygon"],"abstract":false},existenceRule:"Exists iff the parent points exist and are not all coincident.",properties:{parents:{description:"An associative array of points that define the polygon. Key values are ignored in processing.",properties:{"0":{description:'Vertices labeled "0", ..., "n"',kind:"Point"}},regex:/^[0-9]+$/}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Polygon-Polygon_export.json"},updateConstraintAncestry:function B(){(B.base||arguments.callee.base).call(this);this.geom.points=[]},constrain:function(){var D,E=false,F;this.geom.points=[];for(D in this.parents){if(this.parents.hasOwnProperty(D)){F=this.getParent(D).geom.loc;this.geom.points.push(F)}if(!E&&this.geom.points.length){E=!F.equals(this.geom.points[0])}}this.state.exists=E},getParentalNameMFS:function(){var D=[];if(this.genus==="Triangle"){D.push({type:"symbol",value:"102"})}this.eachParent(function(E,F){D.push(F.getNameMFS())});return y.mfs.makeHorizontalMFS.apply(this,D)}});y.gConstraints.ActionButtonPresent=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"Defines an action that executes a set of actions.",inherits:"ActionButton",refspec:{msg:"Internal class not intended for instantiation."},usage:{"abstract":true},properties:{parents:{description:"Set of objects to be triggered",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"Button"}},regex:/^[0-9]+$/},stopAnyMotions:{description:"Stop any previously started animations before commencing the presentation.","default":false,type:"Boolean"},eraseAnyTraces:{description:"Erase any previously displayed traces before commencing the presentation.","default":false,type:"Boolean"}}},stopAnyMotions:false,eraseAnyTraces:false,press:function(E,D){if(!this.state.isActive){if(this.eraseAnyTraces){E.clearTraces()}if(this.stopAnyMotions){E.MotionManager.StopAllMotions()}}}});y.gConstraints.ActionButtonPresentSequentially=y.makeClass(y.gConstraints.ActionButtonPresent,{doc:{description:"Defines an action from an ordered sequence of action buttons.",inherits:"ActionButtonPresent",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{waitTime:{description:"Pause between sequential actions in seconds.",type:"Number"}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/Sequence_export.json"},waitTime:0,constrain:function u(F){(u.base||arguments.callee.base).call(this,F);var D,E;if(this.state.isActive){if(!this.state.inInterval){D=this.state.buttonList[this.state.current];if(!D.state.isActive){this.state.current+=1;if(this.state.current>=this.state.buttonList.length){this.state.isActive=false}if(this.state.isActive){this.state.inInterval=true;E=1000*this.waitTime+Number(new Date());y.log("Begin interval: now="+Number(new Date())+" start="+E);F.addDeferredCall(this,function G(J){var I,H;if(this.state.inInterval){I=Number(new Date());if(E<=I){this.state.inInterval=false;y.log("Activating button: "+this.state.current);H=this.state.buttonList[this.state.current];if(!H.state.isActive){H.press(J,"sequenceButton")}}else{J.addDeferredCall(this,G)}}})}}}}},press:function s(H,D){var G,F,E;(s.base||arguments.callee.base).call(this,H);G=this.state.isActive;if(!G){this.state.isActive=true;this.state.buttonList=[];for(F in this.parents){if(this.parents.hasOwnProperty(F)){E=this.getParent(F);this.state.buttonList.push(E)}}this.state.current=0;this.state.inInterval=false;E=this.state.buttonList[this.state.current];if(!E.state.isActive){E.press(H,"sequenceButton")}}else{this.state.isActive=false;E=this.state.buttonList[this.state.current];if(E.state.isActive){E.press(H,"sequenceButton")}if(this.state.inInterval){H.cancelDeferredCall(this)}}}});y.gConstraints.ActionButtonPresentSimultaneously=y.makeClass(y.gConstraints.ActionButtonPresent,{doc:{description:"Defines an action that executes a collection of actions simultaneously.",inherits:"ActionButtonPresent",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{stopAfter:{description:"Stop the presentation after the last action stops, first action stops, or an elapsed number of seconds","default":"lastActionStops",type:"StopCondition"}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/Simultaneous_export.json"},activeButtons:[],stopAfter:"lastActionStops",activateButtons:function(E){var D=this;this.eachParent(function(F,G){if(!G.state.isActive){G.press(E,"simultaneousButton")}if(G.state.isActive){D.activeButtons.push(G)}})},deactivateRemainingButtons:function(E){var D;while(this.activeButtons.length){D=this.activeButtons.pop();if(D.state.isActive){D.press(E)}}},constrain:function u(I){var D=false,H=false,G,F=[];(u.base||arguments.callee.base).call(this,I);if(this.state.isActive){for(G=0;G<this.activeButtons.length;G++){var E=this.activeButtons[G].state.isActive;D=D||(!E);H=H||E;if(E){F.push(this.activeButtons[G])}}this.activeButtons=F;if(this.stopAfter==="firstActionStops"){this.state.isActive=!D;if((!this.state.isActive)&&H){this.deactivateRemainingButtons(I)}}else{this.state.isActive=H}}if(this.state.timerSet&&!this.state.isActive){I.cancelDeferredCall(this)}},press:function s(H,D){var F=!this.state.isActive,E;y.log("SimultaneousButton: state: "+this.state.isActive+" new state: "+F);(s.base||arguments.callee.base).call(this,H);if(F){this.activateButtons(H)}else{this.deactivateRemainingButtons(H)}this.state.isActive=(this.activeButtons.length>0);if(F&&(typeof this.stopAfter==="number")){E=1000*this.stopAfter+Number(new Date());this.state.timerSet=true;H.addDeferredCall(this,function G(J){var I;if(this.state.timerSet){I=Number(new Date());if(E<=I){this.state.timerSet=false;this.deactivateRemainingButtons(J)}else{J.addDeferredCall(this,G)}}})}if(this.state.timerSet&&!F){H.cancelDeferredCall(this)}}});y.gConstraints.ActionButtonToggleHideShow=y.makeClass(y.gConstraints.ActionButton,{doc:{description:"Defines a button that hides visible objects or shows hidden objects, depending on their state.",inherits:"ActionButton",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{messages:{description:"Hide message, Show message",type:"Array"},parents:{description:"Set of objects to be hidden/shown",type:"Object",properties:{"0":{description:"The first target to be acted upon.  There can be an arbitrary number of objects numbered from 0 to N",kind:"kind"}},regex:/^[0-9]+$/},fade:{description:"when true, the objects fade in or out",type:"Boolean","default":false}},example:"../../wsp-test/test-bed.html?sketch=documents/GSPSketches/Button/ToggleDisplayButton_export.json"},fade:false,value:false,updateLabelFromMessage:function(){var E=this.messages[0];var D=this.messages[1];if(!D){D=E}this.label=this.value?D:E},constrain:function(D){this.value=this.areHidden();this.updateLabelFromMessage()},areHidden:function(){var D=true;this.eachParent(function(E,F){if(!F.style.hidden){D=false}},false);return D},beginAction:function(H,E,J){var F=this;function D(N){var L=this.hideShowState,K=Number(new Date()),M=(K-L.startTime)/(L.timeToComplete-L.startTime);if(K>=L.timeToComplete){this.eachParent(function(O,P){this.state.fade=h;P.hide()},false);this.state.isActive=false;this.hideShowState=h;N.invalidateGeom(this)}else{this.eachParent(function(O,P){this.state.fade=M;N.invalidateAppearance(this)},false);N.addDeferredCall(this,D)}}function G(N){var L=this.hideShowState,K=Number(new Date()),M=(K-L.startTime)/(L.timeToComplete-L.startTime);if(!L.oneTimeShow){this.eachParent(function(O,P){if(P.style.hidden){P.state.fade=1;P.show()}});L.oneTimeShow=true}if(K>=L.timeToComplete){this.eachParent(function(O,P){this.state.fade=h;N.invalidateGeom(this)},false);this.state.isActive=false;this.hideShowState=h;N.invalidateGeom(this)}else{this.eachParent(function(O,P){if(h!==P.state.fade){P.state.fade=1-M;N.invalidateAppearance(P)}},false);N.addDeferredCall(this,G)}}function I(N,K){var M=500,L=Number(new Date()),O={startTime:L,timeToComplete:L};if(F.fade&&(K!=="simultaneousButton")){if(K==="sequenceButton"){O.timeToComplete+=M/2}else{O.timeToComplete+=M}}return O}this.hideShowState=I(H,E);switch(H){case"hide":J.addDeferredCall(this,D);break;case"show":J.addDeferredCall(this,G);break}if(E==="simultaneousButton"||(E==="sequenceButton"&&!this.fade)){this.state.isActive=false}},press:function(E,D){if(this.state.isActive){return}this.state.isActive=true;E.invalidateGeom(this);if(this.areHidden()){this.beginAction("show",D,E)}else{this.beginAction("hide",D,E)}}});y.gConstraints.TranslateBase=y.makeClass(y.gConstraints.Transform,{doc:{description:"Abstract class that defines a new GObject that is identical to another GObject, but translated by some amount.",inherits:"Transform",usage:{"abstract":true},existenceRule:"Exists iff the parent point exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-Translation_export.json"},determineExists:function(){var D=this.getOffset();return(typeof D!=="undefined")&&D.isFinite()},getParentPixelValue:function(F){var D=this.getParent(F),E;if(this.unit){return D.value}E=this.sQuery().prefs().units;return y.units.convert(D.uValue,E.length,"pixels")},getOffset:function(){throw y.createError("Translation subclasses required to implement getOffset()")},getTransform:function(){var D=this;return function(E){return E.add(D.getOffset())}}});y.gConstraints.TranslateFixXFixY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed x,y coordinate.",inherits:"TranslateBase",refspec:{gspRef:"TranslatefXfY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefXfY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},properties:{offset:{description:"Offset in pixel coordinates from the source object",type:"GeometricPoint",required:false,properties:{x:{description:"Horizontal coordinate in pixels",type:"Number"},y:{description:"Vertical coordinate in pixels",type:"Number"}}}}},offset:{x:0,y:0},getOffset:function(){if(!this.offset.transformClass){this.offset=y.GeometricPoint(this.offset.x,this.offset.y)}return this.offset}});y.gConstraints.TranslateFixDist3PtAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction of an angle delineated by three points.",inherits:"Translate",refspec:{gspRef:"TranslatefD3A_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefD3A_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the three points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDist3PtAngle_export.json",properties:{parents:{description:"",properties:{A:{description:"",kind:"Point"},B:{description:"",kind:"Point"},C:{description:"",kind:"Point"}}},distance:{description:"A distance in pixels.","default":"0",type:"Number"}}},distance:0,getOffset:function(){var F=this.getParent("A");var J=this.getParent("B");var G=this.getParent("C");var E=F.geom.loc;var D=J.geom.loc;var K=G.geom.loc;var I=y.GeometricPoint.threePointAngle(E,D,K);var H=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,I);return H}});y.gConstraints.TranslateFixDistAngleMarker=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction specified by an angle marker.",inherits:"Translate",refspec:{gspRef:"TranslateFixedDataMarkedAngleMarker_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateFixedDataMarkedAngleMarker_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the angle marker exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDistAngleMarker_export.json",properties:{parents:{description:"",properties:{marker:{description:"",kind:"AngleMarker"}}},distance:{description:"A distance.",type:"Number"}}},distance:0,getOffset:function(){var D=this.getParent("marker");var F=D.value;var E=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateFixDistFixAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction of a fixed angle.",inherits:"Translate",refspec:{gspRef:"TranslatefDfA_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefDfA_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDistFixAngle_export.json",properties:{distance:{description:"A distance.",type:"Number"},angle:{description:"An angle, in radians.",type:"Number"}}},distance:0,angle:0,getOffset:function(){var D=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,this.angle);return D}});y.gConstraints.TranslateFixDistMeasureAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed distance in the direction defined by an angle measurement.",inherits:"Translate",refspec:{gspRef:"TranslateFixedDistanceMarkedAngleMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateFixedDistanceMarkedAngleMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent object exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixDistMeasureAngle_export.json",properties:{parents:{description:"",properties:{measure:{description:"",kind:"Measure"}}},distance:{description:"A distance in pixels.",type:"Number"}}},distance:0,getOffset:function(){var D=this.getParent("measure");var F=-D.value;var E=y.GeometricPoint(this.distance,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateFixXMeasureY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed x coordinate and a y coordinate defined by a measure.",inherits:"Translate",refspec:{gspRef:"TranslatefXmY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatefXmY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the measurement exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateFixXMeasureY_export.json",properties:{parents:{description:"",properties:{measure:{description:"",kind:"Measure"}}},offsetX:{description:"","default":"0",type:"Number"}}},offsetX:0,getOffset:function(){var D=this.offsetX;var F=-this.getParentPixelValue("measure");var E=y.GeometricPoint(D,F);return E}});y.gConstraints.TranslateMeasureDist3PtAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance from a measurement and an angle from three points.",inherits:"Translate",refspec:{gspRef:"TranslatemD3A_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemD3A_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, the measurement and the three points all exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDist3PtAngle_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"},A:{description:"",kind:"Point"},B:{description:"",kind:"Point"},C:{description:"",kind:"Point"}}}}},getOffset:function(){var D=this.getParentPixelValue("distance");var I=this.getParent("A");var H=this.getParent("B");var F=this.getParent("C");var L=I.geom.loc;var K=H.geom.loc;var J=F.geom.loc;var E=y.GeometricPoint.threePointAngle(L,K,J);var G=y.GeometricPoint(D,0).rotate(y.GeometricPoint.ORIGIN,E);return G}});y.gConstraints.TranslateMeasureDistAngleMarker=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance measurement in the direction defined by a specified angle marker.",inherits:"Translate",refspec:{gspRef:"TranslateMarkedDistanceMarkedAngleMarker_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateMarkedDistanceMarkedAngleMarker_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object, distance measure, and angle marker exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDistAngleMarker_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"},marker:{description:"",kind:"AngleMarker"}}}}},getOffset:function(){var G=this.getParentPixelValue("distance");var D=this.getParent("marker");var F=D.value;var E=y.GeometricPoint(G,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateMeasureDistFixAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance derived from a measurement in the direction defined by a fixed angle in radians.",inherits:"Translate",refspec:{gspRef:"TranslatemDfA_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemDfA_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and angle measurement exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDistFixAngle_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"}}},angle:{description:"A angle(radians).",type:"Number"}}},angle:0,getOffset:function(){var F=this.getParentPixelValue("distance");var E=this.angle;var D=y.GeometricPoint(F,0).rotate(y.GeometricPoint.ORIGIN,E);return D}});y.gConstraints.TranslateMeasureDistMeasureAngle=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a distance measurement in the direction defined by an angle measurement.",inherits:"Translate",refspec:{gspRef:"TranslateMarkedDistanceMarkedAngleMeasure_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateMarkedDistanceMarkedAngleMeasure_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the distance and angle measurements exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureDistMeasureAngle_export.json",properties:{parents:{description:"",properties:{distance:{description:"",kind:"Measure"},angle:{description:"",kind:"Measure"}}}}},getOffset:function(){var G=this.getParentPixelValue("distance");var D=this.getParent("angle");var F=-D.value;var E=y.GeometricPoint(G,0).rotate(y.GeometricPoint.ORIGIN,F);return E}});y.gConstraints.TranslateMeasureXFixY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by a fixed y coordinate and an x coordinate defined by a measure.",inherits:"Translate",refspec:{gspRef:"TranslatemXfY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemXfY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the measurement exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureXFixY_export.json",properties:{parents:{description:"",properties:{measure:{description:"",kind:"Measure"}}},offsetY:{description:"",type:"Number"}}},offsetY:0,getOffset:function(){var D=this.getParentPixelValue("measure");var F=-this.offsetY;var E=y.GeometricPoint(D,F);return E}});y.gConstraints.TranslateMeasureXMeasureY=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a new GObject that is identical to another GObject, but offset by x and y coordinates defined by measures.",inherits:"Translate",refspec:{gspRef:"TranslatemXmY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslatemXmY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the source object and the two measurements exists.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-TranslateMeasureXMeasureY_export.json",properties:{parents:{description:"",properties:{measureX:{description:"",kind:"Measure"},measureY:{description:"",kind:"Measure"}}}}},getOffset:function(){var D=this.getParentPixelValue("measureX");var F=-this.getParentPixelValue("measureY");var E=y.GeometricPoint(D,F);return E}});y.gConstraints.TranslateVector=y.makeClass(y.gConstraints.TranslateBase,{doc:{description:"Defines a translation of a GObject by an offset that matches the vector defined by two points.",inherits:"Translate",refspec:{gspRef:"TranslateVector_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, TranslateVector_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the transformed object and both length defining points exist.",example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Gobj-VectorTranslation_export.json",properties:{parents:{description:"",properties:{p0:{description:"",kind:"Point"},p1:{description:"",kind:"Point"}}}}},getOffset:function(){var E=this.getParent("p0"),D=this.getParent("p1"),G=E.geom.loc,F=D.geom.loc;return F.subtract(G)},getTransform:function(){var D=this;return function(E){return(E.add(D.getOffset()))}}});y.gConstraints.AngleMarker_CCW=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A counter-clockwise angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_CCW_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_CCW_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?0:-Math.PI}else{E-=y.math.TWO_PI}D.orientation=-1;return E}});y.gConstraints.AngleMarker_CW=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A clockwise angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_CW_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_CW_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?0:Math.PI}D.orientation=1;return E}});y.gConstraints.AngleMarker_Reflex=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A reflex angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_Reflex_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_Reflex_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?y.math.TWO_PI:Math.PI}else{if(E<=y.math.SIMPLE_PI_THRESHOLD){E=-(2*Math.PI-E)}}D.orientation=(E<=0)?-1:1;return E}});y.gConstraints.AngleMarker_Simple=y.makeClass(y.gConstraints.AngleMarker,{doc:{description:"A simple angle marker",inherits:"AngleMarker",refspec:{gspRef:"AngleMarker_Simple_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, AngleMarker_Simple_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false}},constrainedAngle:function(E,D){if(D.isStraight){E=D.isStraight==="fullCircle"?0:-Math.PI;D.orientation=-1}else{if(E>y.math.SIMPLE_PI_THRESHOLD){E=-(2*Math.PI-E)}D.orientation=(E<=0)?-1:1}return E}});y.gConstraints.PathMarker=y.makeClass(y.gConstraints.Constraint,{doc:{description:'A path marker on a <span class="genus">Path</span>.',inherits:"Constraint",refspec:{gspRef:"PathMarker_C"},usage:{"abstract":false,kinds:["PathMarker"]},existenceRule:"Exists iff the parent path exists.",properties:{value:{description:"",type:"Number"},parents:{description:"",properties:{path:{description:"",genus:"Path"}}}}},value:0.5,constrain:function u(){var H=this.getParent("path"),I=false,G={},D,F,E=y.GeometricPoint.UNDEFINED;if(H.isValueInBounds(this.value)){E=H.mapPathValueToPosition(this.value,G);if(E&&E.isDefined()&&G.derivative.isDefined()){D=G.derivative.vLength();F=1;if(this.style["tick-mark-style"]!=="Crossbar"&&this.style["arrow-direction"]!=="Forward"){F*=-1}this.geom.normal=y.GeometricPoint(-F*G.derivative.y/D,F*G.derivative.x/D);I=true}else{E=y.GeometricPoint.UNDEFINED}}this.state.exists=I;this.geom.loc=E;if(I){this.state.renderMetrics=this.calculateRenderMetrics()}}});y.gConstraints.PlotRhoTheta=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two polar coordinates.',inherits:"Constraint",usage:{"abstract":true,kinds:["Point"]},existenceRule:"Exists iff the parent CoordSys exists and the coordinates are numbers.",properties:{parents:{description:"",properties:{coordSys:{description:"The coordinate system for the coordinates.",kind:"CoordSys"}}}}},getCoordRho:function(){return this.getParent("coordRho").uValue},getCoordTheta:function(){return this.getParent("coordTheta").value},constrain:function(){var G=this.getParent("coordSys"),E=this.getCoordRho(),F=this.getCoordTheta(),D=E*Math.cos(F),H=E*Math.sin(F);this.geom.loc=G.locatePlot(D,H)}});y.gConstraints.PlotXY=y.makeClass(y.gConstraints.Constraint,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two coordinates.',inherits:"Constraint",usage:{"abstract":true,kinds:["Point"]},existenceRule:"Exists iff the parent CoordSys exists and the coordinates are numbers.",properties:{parents:{description:"",properties:{coordSys:{description:"The coordinate system for the coordinates.",kind:"CoordSys"}}}}},getCoordX:function(){return this.getParent("coordX").uValue},getCoordY:function(){return this.getParent("coordY").uValue},constrain:function(){var E=this.getParent("coordSys"),D=this.getCoordX(),F=this.getCoordY();if(!isFinite(D)||!isFinite(F)){this.state.exists=false}else{this.state.exists=true;this.geom.loc=E.locatePlot(D,F)}}});y.gConstraints.ActionButtonHide=y.makeClass(y.gConstraints.ActionButtonToggleHideShow,{doc:{description:"A button that hides its parents.",inherits:"ActionButtonToggleHideShow",refspec:{msg:"This constraint does not have a functional match in the current version of Geometer's Sketchpad. It was implemented to meet requirements from the Dynamic Number project."},usage:{"abstract":false},properties:{parents:{description:"Set of objects to be hidden",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Button-HideShow_export.json"},updateLabelFromMessage:function(){this.label=this.messages[0]},press:function(E,D){if(this.state.isActive){return}this.state.isActive=true;E.invalidateGeom(this);this.beginAction("hide",D,E)}});y.gConstraints.Intersection2=y.makeClass(y.gConstraints.Intersection1,{doc:{description:'One of two points of intersection of a <span class="kind">Circle</span> with another Circle or a Circle with a <span class="kind">Straight</span> object.',inherits:"Intersection1",refspec:{gspRef:"InterLCB",msg:"This constraint is intended to behave in the same way as the corresponding constraints, InterLCB and InterCCB, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false,kinds:["Point"]},existenceRule:"Exists iff the parent objects exist and have at least one point of intersection.",properties:{},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Point-Intersection12_export.json"},constrain:function(){var D=this.getIntersectionPoints(),E=D[1]||D[0];if(E){this.geom.loc=E;this.state.exists=true}else{this.geom.loc=y.GeometricPoint(h,h);this.state.exists=false}}});y.gConstraints.PlotFixedRhoFixedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two fixed polar coordinates.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotFixedRhoFixedTheta",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotFixedRhoFixedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordRho:{description:"",type:"Number"},coordTheta:{description:"",kind:"Number"}}},getCoordRho:function(){return this.coordRho},getCoordTheta:function(){return this.coordTheta}});y.gConstraints.PlotFixedRhoMarkedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a fixed and a <span class="kind">Param</span> polar coordinate.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotFixedRhoMarkedTheta_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotFixedRhoMarkedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordRho:{description:"",type:"Number"},parents:{description:"",properties:{coordTheta:{description:"",kind:"Measure"}}}}},getCoordRho:function(){return this.coordRho}});y.gConstraints.PlotFixedXFixedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two fixed coordinates.',inherits:"PlotXY",refspec:{gspRef:"PlotFixedXFixedY_C"},usage:{"abstract":false},existenceRule:"Exists iff the parent CoordSys exists and the coordinates are numbers.",properties:{coordX:{description:"",type:"Number"},coordY:{description:"",type:"Number"}}},getCoordX:function(){return this.coordX},getCoordY:function(){return this.coordY}});y.gConstraints.PlotFixedXMarkedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a fixed coordinate and a <span class="kind">Param</span> coordinate.',inherits:"PlotXY",refspec:{gspRef:"PlotFixedXMarkedY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotFixedXMarkedY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordX:{description:"",type:"Number"},parents:{description:"",properties:{coordY:{description:"",kind:"Measure"}}}}},getCoordX:function(){return this.coordX}});y.gConstraints.PlotMarkedRhoFixedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a <span class="kind">Param</span> and a fixed polar coordinate.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotMarkedRhoFixedTheta_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedRhoFixedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordTheta:{description:"",type:"Number"},parents:{description:"",properties:{coordRho:{description:"",kind:"Measure"}}}}},getCoordTheta:function(){return this.coordTheta}});y.gConstraints.PlotMarkedRhoMarkedTheta=y.makeClass(y.gConstraints.PlotRhoTheta,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two <span class="kind">Param</span> polar coordinates.',inherits:"PlotRhoTheta",refspec:{gspRef:"PlotMarkedRhoMarkedTheta_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedRhoMarkedTheta_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{parents:{description:"",properties:{coordRho:{description:"",kind:"Measure"},coordTheta:{description:"",kind:"Measure"}}}}}});y.gConstraints.PlotMarkedXFixedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by a <span class="kind">Param</span> coordinate and a fixed coordinate.',inherits:"PlotXY",refspec:{gspRef:"PlotMarkedXFixedY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedXFixedY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Param and CoordSys exist.",properties:{coordY:{description:"",type:"Number"},parents:{description:"",properties:{coordX:{description:"",kind:"Measure"}}}}},getCoordY:function(){return this.coordY}});y.gConstraints.PlotMarkedXMarkedY=y.makeClass(y.gConstraints.PlotXY,{doc:{description:'Defines a point on a <span class="kind">CoordSys</span> determined by two <span class="kind">Param</span> coordinates.',inherits:"PlotXY",refspec:{gspRef:"PlotMarkedXMarkedY_C",msg:"This constraint is intended to behave in the same way as the corresponding constraint, PlotMarkedXMarkedY_C, in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent Params and CoordSys exist.",properties:{parents:{description:"",properties:{coordX:{description:"",kind:"Measure"},coordY:{description:"",kind:"Measure"}}}}}});y.gConstraints.ActionButtonShow=y.makeClass(y.gConstraints.ActionButtonToggleHideShow,{doc:{description:"Defines an action that reveals a hidden GObject.",inherits:"ActionButtonToggleHideShow",refspec:{msg:"This constraint is intended to behave in the same way as the corresponding constraint (TBD) in the currently published version of desktop Geometer's Sketchpad."},usage:{"abstract":false},existenceRule:"Exists iff the parent objects exist.",properties:{parents:{description:"Set of objects to be shown",type:"Array"}},example:"../../wsp-test/gsp-test-bed.html?sketch=documents/GSPSketches/Button-HideShow_export.json"},updateLabelFromMessage:function(){this.label=this.messages[0]},press:function(E,D){if(this.state.isActive){return}this.state.isActive=true;E.invalidateGeom(this);this.beginAction("show",D,E)}});y.css='/* For now, these are not in less. Just import them raw. */\n/*!\n  Web Sketchpad. Copyright &copy; 2015 KCP Technologies, a McGraw-Hill Education Company. All rights reserved.\n  Version: Release: 2015Q1, Semantic Version: 4.1.0, Build Number: 832.19-r, Build Stamp: dn.kcptech.com/20150326110202\n*/\n\n/*\n * Styles governing drawing contexts. Within the node we are given we \n * construct a relatively positioned base node. It contains an absolutely\n * positioned node that is used for clipping. All drawing context nodes \n * (canvas layers, html layers) are created within the \n * clipping node and are absolutely positioned. They must correspond exactly\n * to the height and width of the clipping node.\n */\n.wsp-version-4-1-0.wsp-base-node {\n    position: relative;\n    display: inline-block;\n    cursor: default;\n    vertical-align: top;\n    font-size: 0px; /* inline-block adds grot heights for whitespace without this */\n    overflow: visible; /* prevents inheritance of overflow: scroll, which can\n                          cause layout issues */\n}\n\n.wsp-version-4-1-0 .wsp-transform-node {\n  transform-origin: top left;\n  -webkit-transform-origin: top left;\n  -ms-transform-origin: top left;\n  position:absolute;\n  display: inline-table;\n  border-collapse: collapse;\n  border-spacing: 0px;\n  top: 0px; left: 0px;\n  padding: 0px; margin: 0px;\n}\n\n.wsp-version-4-1-0 .wsp-main-row {\n  display: table-row;\n}\n\n.wsp-version-4-1-0 .wsp-sketch-container {\n  display: table-cell;\n  vertical-align: top;\n}\n\n.wsp-version-4-1-0 .wsp-text-layer .wsp-responsive-borderwidth {\n  border-width: 1px;\n}\n\n.wsp-version-4-1-0 .wsp-transform-large {\n  display: inline-block;\n}\n.wsp-version-4-1-0  .wsp-transform-medium {\n  display: none;\n}\n.wsp-version-4-1-0 .wsp-transform-small {\n  display: none;\n}\n\n\n.wsp-version-4-1-0 .wsp-clip-node {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n}\n.wsp-version-4-1-0 .wsp-clip-node canvas, .wsp-version-4-1-0 .wsp-text-layer {\n    position: absolute;\n    left: 0; top: 0;\n}\n\n.wsp-version-4-1-0 .sketch_canvas {\n    -webkit-user-select: none;\n    -moz-user-select: -moz-none;\n}\n\n/*\n * Styles governing html-layer sketch objects.\n */\n.wsp-version-4-1-0 .wsp-Measure, .wsp-version-4-1-0 .wsp-Point, .wsp-version-4-1-0 .wsp-Text, .wsp-version-4-1-0 .wsp-Param, .wsp-version-4-1-0 .wsp-Button, .wsp-version-4-1-0 .wsp-Expression, .wsp-version-4-1-0 .wsp-Label {\n    /*-webkit-touch-callout: none*/\n    /*-moz-touch-callout: none;*/\n    position:absolute;\n}\n\n\n/*\n  Buttons - see comment in wsp-skin.css for details\n*/\n\n.wsp-version-4-1-0 .wsp-Button {\n    display: table;\n    border-collapse: separate;\n    border-spacing: 0px;\n}\n\n.wsp-version-4-1-0 .wsp-Button-row {\n  display: table-row;\n}\n\n.wsp-version-4-1-0 .wsp-Button-drag-handle {\n  display: table-cell;\n  content: "";\n  height:100%;\n}\n  \n.wsp-version-4-1-0 .wsp-Button-label-frame {\n  display: table-cell;\n}\n\n.wsp-version-4-1-0 .wsp-Measure, .wsp-version-4-1-0 .wsp-Text, .wsp-version-4-1-0 .wsp-Param, .wsp-version-4-1-0 .wsp-Expression, .wsp-version-4-1-0 .wsp-Label {\n    font-size: 12px;\n    border: none;\n    margin: 0;\n    padding: 0;\n    background-color:transparent;\n    overflow-x: visible;\n    white-space: pre;\n}\n\n.wsp-version-4-1-0 .wsp-Measure, .wsp-version-4-1-0 .wsp-Text {\n    cursor: default;\n}\n\n.wsp-version-4-1-0 .wsp-Measure {\n    line-height: 1;\n}\n\n.wsp-version-4-1-0 .wsp-Point {\n    cursor: pointer;\n    font-size: 8px;\n}\n\n.wsp-version-4-1-0 .wsp-Expression .mfs-input {\n    cursor: text;\n}\n\n/* styles for MFS to HTML conversion */\n.wsp-version-4-1-0 .mfs {\n    /*\n      border: solid thin red;\n    */\n    display: run-in;\n}\n\n.wsp-version-4-1-0 .mfs-bracket:before {\n    content: \'[\';\n}\n\n.wsp-version-4-1-0 .mfs-bracket:after {\n    content: \']\';\n}\n\n.wsp-version-4-1-0 .mfs-curly:before {\n    content: \'{\';\n}\n\n.wsp-version-4-1-0 .mfs-curly:after {\n    content: \'}\';\n}\n\n.wsp-version-4-1-0 .mfs-tightness-normal {\n    letter-spacing: normal;\n}\n.wsp-version-4-1-0 .mfs-tightness-condensed {\n    letter-spacing: -0.1em;\n}\n.wsp-version-4-1-0 .mfs-tightness-expanded {\n    letter-spacing: .2em;\n}\n\n.wsp-version-4-1-0 .mfs-frac {\n    display: inline-block;\n    font-size: 90%;\n    vertical-align: middle;\n    text-align: center;\n}\n\n.wsp-version-4-1-0 .mfs-exponent{\n    vertical-align: super;\n    font-size: 70%;\n}\n\n.wsp-version-4-1-0 .mfs-frac .mfs-numr, .wsp-version-4-1-0 .mfs-frac .mfs-denm{\n    display: block;\n}\n\n.wsp-version-4-1-0 .mfs-numr {\n    border-bottom: thin black solid;\n}\n\n\n.wsp-version-4-1-0 .mfs-super-group, .wsp-version-4-1-0 .mfs-sub-group, .wsp-version-4-1-0 .mfs-horizontal, .wsp-version-4-1-0 .mfs-root, .wsp-version-4-1-0 .mfs-paren,\n.wsp-version-4-1-0 .mfs-bracket, .wsp-version-4-1-0 .mfs-curly, .wsp-version-4-1-0 .mfs-abs {\n    display: inline-block;\n    text-decoration: inherit;\n}\n.wsp-version-4-1-0 .mfs-horizontal {\n  white-space: pre;\n}\n.wsp-version-4-1-0 .mfs-param {\n    /*\n     * background-color: lightgray;\n     */\n    display: inline-block;\n}\n\n.wsp-version-4-1-0 tbody { vertical-align: baseline; }\n\n.wsp-version-4-1-0 .mfs-paren, .wsp-version-4-1-0 .mfs-root,\n.wsp-version-4-1-0 .mfs-abs {\n    display: inline-table;\n    border-collapse: collapse;\n    border-spacing: 0px;\n}\n\n.wsp-version-4-1-0 .mfs-paren td, .wsp-version-4-1-0 .mfs-root td,\n.wsp-version-4-1-0 .mfs-abs td {\n    padding: 0px;\n}\n\n.wsp-version-4-1-0 .mfs-paren td.mfs-left-paren,\n.wsp-version-4-1-0 .mfs-paren td.mfs-right-paren,\n.wsp-version-4-1-0 .mfs-abs td.mfs-abs-bar\n {\n    background-size: 100% 100%;\n}\n\n.wsp-version-4-1-0 .mfs-root td.mfs-left-root {\n    background-size: 105% 100%;\n}\n\n.wsp-version-4-1-0 .mfs-root td.mfs-right-root {\n    background-size: 100% 100%;\n}\n\n.wsp-version-4-1-0 td.mfs-right-root {\n    padding-top: .15em;\n}\n\n/* Paren TD\'s have a dummy span under them, which fixes a rendering\nissue with chrome. If you set the width of the TD itself, chrome adds\nan extra two pixels to the adjoing td containing the parenthesized\nexpression! */\n.wsp-version-4-1-0 .mfs-paren td.mfs-left-paren >span,\n.wsp-version-4-1-0 .mfs-paren td.mfs-right-paren >span\n{\n    display: inline-block;\n    width: .35em;\n}\n\n/* See above comment on paren TD\'s */\n.wsp-version-4-1-0 .mfs-root td.mfs-left-root >span\n{\n    display: inline-block;\n    width: .7em;\n}\n\n/* See above comment on paren TD\'s */\n.wsp-version-4-1-0 .mfs-abs td.mfs-abs-bar >span\n{\n    display: inline-block;\n    width: .2em;\n}\n\n.wsp-version-4-1-0 .mfs-subscript {\n    font-size: smaller;\n    vertical-align: sub;\n}\n.wsp-version-4-1-0 .mfs-style {\n    display: inline;\n}\n\n.wsp-version-4-1-0 .mfs-overbar-arc, .wsp-version-4-1-0 .mfs-overbar-ray, .wsp-version-4-1-0 .mfs-overbar-line,\n.wsp-version-4-1-0 .mfs-overbar-seg {\n    display: inline-block;\n    line-height: 1.4;\n    background-repeat: no-repeat;\n}\n\n.wsp-version-4-1-0 .mfs-overbar-ray, .wsp-version-4-1-0 .mfs-overbar-line {\n    background-size: 100% .3em;\n    padding-top: .02em;\n}\n\n.wsp-version-4-1-0 .mfs-overbar-arc {\n    background-size: 100% .7em;\n    padding-top: .55em;\n}\n\n.wsp-version-4-1-0 .mfs-overbar-seg {\n    background-size: 100% 100%;\n}\n\n.wsp-version-4-1-0 .mfs-overbar-line > .mfs-horizontal .mfs-text:last-child:after,\n.wsp-version-4-1-0 .mfs-overbar-ray > .mfs-horizontal .mfs-text:last-child:after {\n    content: "\\200A\\200A"; /* two hair spaces */\n}\n\n.wsp-version-4-1-0 .mfs-overbar-seg > .mfs-horizontal .mfs-text:last-child:after {\n    content: "\\200A"; /* one hair space */\n}\n\n.wsp-version-4-1-0 .mfs-underbar-seg {\n    border-bottom-width: thin;\n    border-bottom-color: black;\n    border-bottom-style: solid;\n    line-height: 0.9;\n    display: inline-block;\n}\n\n.wsp-version-4-1-0 .mfs-text {\n    display: inline;\n}\n\n.wsp-version-4-1-0 .mfs-vertical-group {\n    display: inline-block;\n}\n\n.wsp-version-4-1-0 .mfs-vertical-group > * {\n    display: block;\n}\n\n.wsp-version-4-1-0 .wsp-text-layer * {\n    -ms-user-select: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -o-user-select: none;\n    user-select: none;\n}\n\n.wsp-version-4-1-0 .wsp-text-layer {\n    line-height: normal;\n}\n\n.wsp-version-4-1-0 .mfs-input {\n    font-size: inherit;\n    display: inline-block;\n    white-space: nowrap;\n    overflow: visible;\n}\n\n.wsp-version-4-1-0 .wsp-numeric {\n     position: absolute;\n   }\n\n.wsp-version-4-1-0 .wsp-numfield-text {\n    white-space: nowrap;\n}\n\n@-webkit-keyframes blinker { from {opacity:1.0;} to {opacity:0.0;} }\n          @keyframes blinker { from {opacity:1.0;} to {opacity:0.0;} }\n.wsp-version-4-1-0 .wsp-blink {\n    font-size: larger;\n    color: black;\n    font-stretch: ultra-condensed;\n    /*text-decoration:blink;*/\n\n    -webkit-animation-name:blinker;\n            animation-name:blinker;  \n    -webkit-animation-iteration-count:infinite;  \n            animation-iteration-count:infinite;  \n    -webkit-animation-timing-function:cubic-bezier(1.0,0,0,1.0);\n            animation-timing-function:cubic-bezier(1.0,0,0,1.0);\n    -webkit-animation-duration:1s; \n            animation-duration:1s; \n}\n\n.wsp-version-4-1-0 .wsp-selected {\n    background-color: yellow;\n}\n.wsp-version-4-1-0 .wsp-Numberpad {\n    position: absolute;\n    pointer-events: auto;\n    -webkit-user-drag: element;\n}\n\n.wsp-version-4-1-0 .wsp-Numberpad, .wsp-version-4-1-0 .wsp-Numberpad *,\n.wsp-version-4-1-0 .wsp-Numberpad *:before, .wsp-version-4-1-0 .wsp-Numberpad *:after {\n    /** needs to be set to default in case it has been changed by any plugins/frameworks **/\n    /* Bootstrap changes the setting of box-sizing, which is a setting\n       that tells browser whether to take margin, padding into account when imposing the\n       height/width property. */\n    -webkit-box-sizing: content-box;\n    -moz-box-sizing: content-box;\n    box-sizing: content-box;\n}\n\n/* The body of the Numberpad */\n.wsp-version-4-1-0 .wsp-Numberpad-body {\n    display: -webkit-flex;\n    display: flex;\n    -webkit-flex-direction: column;\n    flex-direction: column;\n    -webkit-justify-content: space-around;\n    justify-content: space-around;\n}\n\n/* A row of Buttons */\n.wsp-version-4-1-0 .wsp-Numberpad-row {\n    display: -webkit-flex;\n    display: flex;\n    -webkit-flex-direction: row;\n    flex-direction: row;\n    -webkit-justify-content: space-around;\n    justify-content: space-around;\n}\n\n\n/*\n.wsp-version-4-1-0 .wsp-numpad-key:hover {\n    background-image: linear-gradient(to bottom, #aaa, #666);\n    background-color: #888;\n    color: #eee;\n}\n*/\n\n.wsp-version-4-1-0 .wsp-error-message {\n  text-align: center;\n  margin-top: 25px;\n  margin-bottom: 25px;\n  color: red;\n  font-size: 125%;\n}\n\n.wsp-version-4-1-0 .wsp-tool-container {\n  display: table-cell;\n  vertical-align: top;\n  background-color: #F5F5F5;\n  padding-right: 10px;\n  margin-right: 5px;\n }\n\n.wsp-version-4-1-0 .wsp-tool-column {\n  background:black;\n  border-radius:5px;\n  box-shadow: 3px 3px 7px black;\n}\n\n.wsp-version-4-1-0 .wsp-tool {\n  border: 2px solid black;\n  border-radius: 5px;\n  background-color: white;\n  text-align: center;\n  font-size: 24px;\n  font-weight: 200;\n}\n\n.wsp-version-4-1-0 .wsp-tool > img {\n  display: block;\n}\n\n.wsp-version-4-1-0 .wsp-tool-active {\n  opacity: 0.5;\n  /*border: 2px solid red;*/\n  \n}\n\n.wsp-version-4-1-0 .wsp-text-target-highlight {\n  background-color: rgba(255,0,0,0.5) !important;\n}\n\n.wsp-version-4-1-0 .wsp-text-target-highlight, .wsp-version-4-1-0 .wsp-text-unmatched-given {\n    border: 2px solid rgba(255,0,0,0.5) !important;\n    border-radius: 5px !important;\n    box-shadow: 3px 3px 7px black !important;\n}\n\n@keyframes wsp-version-4-1-0FlickerAnimation {\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n@-o-keyframes wsp-version-4-1-0FlickerAnimation{\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n@-moz-keyframes wsp-version-4-1-0FlickerAnimation{\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n@-webkit-keyframes wsp-version-4-1-0FlickerAnimation{\n    0%   { background-color: rgba(255,0,0,0.0); }\n    10%  { background-color: rgba(255,0,0,0.5); }\n    20% { background-color: rgba(255,0,0,0.0); }\n}\n\n.wsp-version-4-1-0 .wsp-text-unmatched-given {\n    -webkit-animation: wsp-version-4-1-0FlickerAnimation 5s infinite;\n    -moz-animation: wsp-version-4-1-0FlickerAnimation 5s infinite;\n    -o-animation: wsp-version-4-1-0FlickerAnimation 5s infinite;\n    animation: wsp-version-4-1-0FlickerAnimation 5s infinite;\n}\n\n\n/* We could, if desired, move the wsp-Transform section into\n * wsp-skin.css and make the transform skinnable.\n * For that to be worthwhile, we would need to make the scale factors\n * used customizable. The css transform isn\'t a problem - customizers\n * just change it. But wsp.js needs to know that at init time, and it\'s\n * a bit tricky to encode something in css readable by js (e.g. hiding some info\n * in a hidden node is stymied by browsers that don\'t set properties until the node\n * is displayed. You could stash something in content::after but querying that isn\'t\n * supported on IE). Best I can think of here is to have a wsp-responsize-size-small-factor\n * class (and medium, etc.), with some property like opacity set to [0,1]. Code would then sniff that\n * by inserting a node into the DOM. This would have to match the value used in transform: scale();\n */\n/* Section Start: wsp-Transform */\n\n/* The transform node is the target for css transforms that\n  scale down the content to fit in smaller form factor devices.\n\n  CSS transforms are used for the scaling - but since those\n  do not change the content size of their targets, we need\n  to fix our content size too. The technique used is to take\n  the actual content containing wsp-transform-node out of the flow,\n  and create sibling DOM elements (wsp-transform-large, wsp-transform-medium,\n  wsp-transform-small) of appropriate size, and make sure the right one is displayed\n  while the rest are not.\n*/\n\n/* .wsp-transform-node will be position: absolute, with transform-origin: top left \n  wsp-transform-large by default is display: inline-block,\n  wsp-transform-medium, wsp-transform-small are display: none\n  Turn on large, medium, small using media queries - you\'ll need to override the\n  default ones.\n*/\n\n/*\n *  For our default sizing, some assumptions and numbers.\n *  For a normal desktop sketch, we\'ll take a usual width as 800px (Mac window is 780x540 by default)\n *  \n *  For a mobile friendly document, we\'ll take as a baseline iPad landscape width (1024), where our ideal sketch width is 600px.\n *  On iPad portrate width (768px = 75% of 1024px), our ideal sketch width is 400px (75% of 600px)\n *  On Smartphone portrate (480px = 46.875% of 1024px), our ideal sketch width is 300px (50% of 600px)\n *\n *  The media queries are conditionalized by several classes on the root node.\n *  wsp-responsiveSizing: must be present for responsive sizing to be in effect\n *  wsp-responsiveSizing-small-size: support the 50% size;\n *  wsp-responsiveSizing-medium-size: support the 75% size;\n *  wsp-responsiveSizing-medium-break: if present, a break at the medium device width\n *    chooses medium size if available, otherwise small size\n *  wsp-responsiveSizing-small-break: if present, a break at the small device width\n *    chooses small size if available, otherwise medium size\n *\n */\n\n/* \n * First break half way between iPad landscape and iPad Portrate\n * ideal sketch width: 400px;\n * max-width: 892px\n * scale factor: 0.75;\n*/\n@media only screen and (max-width: 892px) {\n  \n\n  /* Small size default if .wsp-responsiveSizing-medium-size*/\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-medium {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-small {\n    display: inline-block;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-small-size .wsp-transform-node {\n    transform: scale(0.5);\n    -webkit-transform: scale(0.5);\n    -ms-transform: scale(0.5);\n  }\n\n  /* Override with medium size if wsp-responsiveSizing-medium-size */\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-medium {\n    display: inline-block;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-small {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-medium-break.wsp-responsiveSizing-medium-size .wsp-transform-node {\n    transform: scale(0.75);\n    -webkit-transform: scale(0.75);\n    -ms-transform: scale(0.75);\n  }\n}\n\n/*\n * Second break half way between iPad portrate and Smartphone portrate\n * ideal sketch width: 300px;\n * max-width: 624px\n * scale factor: 0.5;\n*/\n@media only screen and (max-width: 624px) {\n\n  /* Default to medium size if .wsp-responsiveSizing-medium-size */\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-medium {\n    display: inline-block;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-small {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-medium-size .wsp-transform-node {\n    transform: scale(0.75);\n    -webkit-transform: scale(0.75);\n    -ms-transform: scale(0.75);\n  }\n  \n  /* Override to small size if .wsp-responsiveSizing-small-size */\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-large {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .mfs-responsive-borderwidth {\n    border-width: 2px;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-medium {\n    display: none;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-small {\n    display: inline-block;\n  }\n  .wsp-version-4-1-0.wsp-responsiveSizing.wsp-responsiveSizing-small-break.wsp-responsiveSizing-small-size .wsp-transform-node {\n    transform: scale(0.5);\n    -webkit-transform: scale(0.5);\n    -ms-transform: scale(0.5);\n  }\n}\n/* Section End: wsp-Transform */\n\n/*\n  Web Sketchpad. Copyright &copy; 2015 KCP Technologies, a McGraw-Hill Education Company. All rights reserved.\n  Version: Release: 2015Q1, Semantic Version: 4.1.0, Build Number: 832.19-r, Build Stamp: dn.kcptech.com/20150326110202\n*/\n\n\n/* Section Start: wsp-Button */\n/*\n\n  The outer element of a button will have class .wsp-Button\n  Additional modifiers will be added as classes\n  .wsp-appearance-drag: The button is being dragged / moved;\n  .wsp-appearance-unselect: The button is not arrow selectable\n    and thus not draggable;\n  .wsp-appearance-short: The button is < 28 pixels high;\n  .wsp-appearance-pressed: The button is depressed by user action;\n  .wsp-appearance-active: The button is performing its action, which may\n    continue after it\'s been clicked;\n\n\n  Within the button we have some substructure to allow\n  for a drag handle, a row of mfs text, and allow for the text\n  top to move down one pixel during a click as part of it\'s depressed\n  appearance.\n\n  wsp-Button contains a wsp-Button-row\n  wsp-Button-row contains a wsp-Button-drag-handle and a wsp-Button-label-frame\n  wsp-Button-label-frame contains a wsp-Button-label\n\n+-------------------wsp-Button--------------------------+\no--wsp-Button-row-x------wsp-Button-label-frame--------o|\n||                |                                    ||\n||                +------------------------------------||\n|| wsp-Button-    |                                    ||\n|| drag-handle    |                                    ||\n||                |    wsp-Button-label                ||\n||                |                                    ||\n||                |                                    ||\no-----------------x------------------------------------o|\n+-------------------------------------------------------+\n\n*/\n\n/* base style for the whole button */\n.wsp-Button {\n    cursor: pointer;\n}\n\n/* When it\'s dragging about, lighten it up */\n.wsp-Button.wsp-appearance-drag {\n  opacity: .8;\n}\n\n\n/* Styles for the handle - the dragable bit on the left of the button */\n.wsp-Button-drag-handle {\n  width: 30px;\n  min-width: 30px;\n  padding:0px;\n  margin:0px;\n  border: 1px solid;\n  border-bottom: 3px solid;\n  border-color: rgba(0,0,0,.20);\n  border-bottom-left-radius: 5px;\n  border-top-left-radius: 5px;\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozMTk3Q0Q2QUEyOEMxMUUzQkJDNThBNzkxMDgzM0M1NiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozMTk3Q0Q2QkEyOEMxMUUzQkJDNThBNzkxMDgzM0M1NiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjMxOTdDRDY4QTI4QzExRTNCQkM1OEE3OTEwODMzQzU2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjMxOTdDRDY5QTI4QzExRTNCQkM1OEE3OTEwODMzQzU2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+krwYJAAAATBJREFUeNpi/P//PwOtABOJ6iVoZbgXEG8E4mCidYCChQgcDMSngPgMEJ8G4ihi9DESEeYxQJwPxIxo4pOBeCE+jYQMTwHiDDzys6CYLMORwRkktgklEapLYirSIdZwTWh4kgKmALEaIcNVoQp5SDQcpH4qECvhCnOQxEwgFqQgU74C4nQgfoxsuBgQLwJiESrk+hdAHA/Eb2HB8gaIT1OpSLkOxB/RgwVkUScQO+JIbviSIkzuGBAXA/Fv9Aj9B8RVUAXkgFNAXAozGFtqAUmUAfFZEg0+B8RFQPyTmBzKBcTfSAgWbOoJZv9EIM7GI78Ami/IKs/nA/EEUMmMRW47NOMwUFpwhUEjC1bsHoeG8W9qVBYgHAitMBYAMQe1Kgtk4AxNGe+JUcxIy9ofIMAAebvg5/LOIwYAAAAASUVORK5CYII=);\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n\n/* When the button is short (< 28 px heigh */\n.wsp-appearance-short .wsp-Button-drag-handle {\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA40lEQVQY023RIU+XcRTF8c/vD5O5OQMGdGCgwGZgFqEQ3SC5yZsw+woMvgDegY1KoFEtElGr0UBlM7Gxr+V5NgRvuXfnnrt77rmgMke1qFZm7G7vPnGp2q1Oq8P/cWZgVK+q8+pHdVbtPxiYiOtTvVZdzMRqtVrAohrYxnH1fKoHNqo9fMAbGNUKvmAHf7DAEm4RnuArPi3jBud4hs94iY84wW8c4Duu7x54NOW9SfP76kX1uno0awZjjNNqA++m1W/xdIxxOca4qSz/a6ArfMMmfuLXbNsY4+FzJhu3qsf3H/IXCFmh/vAsFrYAAAAASUVORK5CYII=);\n}\n\n/* Non-arrow selectable buttons don\'t have a full sided drag handle.\n It just becomes a narrow vertical strip */\n.wsp-appearance-unselectable .wsp-Button-drag-handle {\n  background-image: none;\n  width: 5px;\n  min-width: 5px;\n}\n \n/* frame the button label (where the text is).\n The frame is the part that\'s stable when the button is pressed down,\n so it\'s just responsible for the top border */\n.wsp-Button-label-frame {\n  border-top: 1px solid #c2b892;\n  border-bottom-right-radius: 5px;\n  border-top-right-radius: 5px; \n  background-color: #f5f5ed;\n}\n\n/* Some padding and border for the interior portion of the label */\n.wsp-Button-label {\n  padding-left: 2px;\n  padding-right: 2px;\n  border-style: solid;\n  border-color: #c2b892;\n  border-left-width: 0px;\n  border-right-width: 1px;\n  border-top-width: 0px;\n  border-bottom-width: 3px;\n  border-bottom-right-radius: 5px;\n  border-top-right-radius: 5px;\n}\n\n/* When pressed the frame lets the the label handle the \n border so it can move down a pixel */\n.wsp-appearance-pressed .wsp-Button-label-frame {\n  border-top-color: transparent; \n}\n\n/* Add the border on the top now that the frame has punted it to us */\n.wsp-appearance-pressed .wsp-Button-label {\n  padding-top:1px;\n  border-top-width: 1px;\n  border-bottom-width: 1px;\n}\n\n/* When the button is working, a background */\n.wsp-appearance-active .wsp-Button-label-frame {\n  border-top-color: transparent; \n  opacity: 1;\n  background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAoCAIAAACw1AcgAAAKmWlDQ1BpY2MAAHjalZZ3UJPpFsbP933phZaAgJTQO1KkCyT0AArSwUZIAgRCjCFBBGzI4gqsBRURrOiiiIKrUmQtiAXbItiwb5BFRV1FXWyo3D+4xHvv3Dt39sy8M78588zzvue8/zwAtL08qVSMagDkSOSymNAAVlJyCov4AChAAxKogQ2PnyvlREdHwv+s97cBAQC44cCTSsXw90pTIMzlAyDRAJAmyOXnACDHAJAyvlQmB8DYAGC+WC6VA2ACAGDKkpJTALB8AGBmTHAFADDTJngXADBlcTGBANgxABKNx5NlAFA7AYCVx8+QA1CVAOAkEYgkADQNAPDjZ/IEALRoALDPyVkoAKAVAYB12r/4ZPybZ5rKk8fLUPHELAAAQAoS5UrFvCV/cx3/v3LEisk7jACAlpsdGwEAWgBIPp8XHDvJmUJu5CRL5QExkyySc+NUGkVY/CQrsuM5k5y9MEKll6TNilL55wamTHJBZlziJAuEQcGTLFsYo9Ln5sUGf9cHzprkLF549CTzZACTLBSHxnx/c7TqnRLxLNUs6bIQlUaY+31eeWZcmIplcSpNuiiEq5pXFvbdXxyt8pQpYlR7EEriVZ4CXpBqtxAIIpCAEHKABywIgyAAuTBfDgAQuFC6RCbKyJSzOFKpWGjP4kr4jvYsFydnF0hKTmFNfNe7O4AAAKJD+t4rPAnAKQRAI773EmwBGnoBmAu+98xfAzBbAE4U8xWyvIkeDgAADxRQBybogRGYgTU4gAu4gw+wIRjCIQriIBnmAx8yIQdksBiKYCWUQjmsh81QAzthD+yHQ3AE2uAEnIELcAV64RbcByUMwQsYgfcwhiAIEaEjDEQPMUYsEDvEBfFE/JBgJBKJQZKRVCQDkSAKpAhZhZQjlUgNshtpQH5BjiNnkEtIH3IXGUCGkbfIZxRDaSgTNUQt0WmoJ8pBI9A4dB6agS5CC9ASdC1ajdahB9FW9Ax6Bb2FKtEX6CgGGBXTwUwwB8wTC8SisBQsHZNhy7AyrAqrw5qwDqwbu4EpsZfYJxwBx8CxcA44H1wYLh7Hxy3CLcNV4Gpw+3GtuHO4G7gB3AjuG56ON8Db4b3xXHwSPgO/GF+Kr8LX41vw5/G38EP49wQCQYdgRfAghBGSCVmEQkIFYTuhmdBJ6CMMEkaJRKIe0Y7oS4wi8ohyYilxK/Eg8TTxOnGI+JFEJRmTXEghpBSShFRMqiIdIJ0iXSc9JY2RNcgWZG9yFFlAXkJeR95L7iBfIw+RxyiaFCuKLyWOkkVZSammNFHOUx5Q3lGpVFOqF3U2VURdQa2mHqZepA5QP9G0aLa0QNpcmoK2lraP1km7S3tHp9Mt6Wx6Cl1OX0tvoJ+lP6J/VGOoOapx1QRqy9Vq1VrVrqu9UierW6hz1OerF6hXqR9Vv6b+UoOsYakRqMHTWKZRq3Fco19jVJOh6awZpZmjWaF5QPOS5jMtopalVrCWQKtEa4/WWa1BBsYwYwQy+IxVjL2M84whJoFpxeQys5jlzEPMHuaItpb2dO0E7XztWu2T2kodTMdSh6sj1lmnc0Tnts7nKYZTOFOEU9ZMaZpyfcoH3am6bF2hbplus+4t3c96LL1gvWy9DXpteg/1cfq2+rP1F+vv0D+v/3Iqc6rPVP7UsqlHpt4zQA1sDWIMCg32GFw1GDU0Mgw1lBpuNTxr+NJIx4htlGW0yeiU0bAxw9jPWGS8yfi08XOWNovDErOqWedYIyYGJmEmCpPdJj0mY6ZWpvGmxabNpg/NKGaeZulmm8y6zEbMjc1nmheZN5rfsyBbeFpkWmyx6Lb4YGllmWi52rLN8pmVrhXXqsCq0eqBNd3a33qRdZ31TRuCjadNts12m15b1NbNNtO21vaaHWrnbiey227XZ4+397KX2NfZ9zvQHDgOeQ6NDgOOOo6RjsWObY6vpplPS5m2YVr3tG9Obk5ip71O9521nMOdi507nN+62LrwXWpdbrrSXUNcl7u2u76ZbjddOH3H9DtuDLeZbqvduty+unu4y9yb3Ic9zD1SPbZ59HsyPaM9KzwveuG9AryWe53w+uTt7i33PuL92sfBJ9vngM+zGVYzhDP2zhj0NfXl+e72Vfqx/FL9dvkp/U38ef51/o/ZZmwBu579lGPDyeIc5LwKcAqQBbQEfAj0Dlwa2BmEBYUGlQX1BGsFxwfXBD8KMQ3JCGkMGQl1Cy0M7QzDh0WEbQjr5xpy+dwG7ki4R/jS8HMRtIjYiJqIx5G2kbLIjpnozPCZG2c+mGUxSzKrLQqiuFEbox5GW0Uviv51NmF29Oza2U9inGOKYrpjGbELYg/Evo8LiFsXdz/eOl4R35WgnjA3oSHhQ2JQYmWiMmla0tKkK8n6yaLk9hRiSkJKfcronOA5m+cMzXWbWzr39jyrefnzLs3Xny+ef3KB+gLegqOp+NTE1AOpX3hRvDreaBo3bVvaCD+Qv4X/QsAWbBIMC32FlcKn6b7plenPMnwzNmYMZ/pnVmW+FAWKakRvssKydmZ9yI7K3pc9Lk4UN+eQclJzjku0JNmScwuNFuYv7JPaSUulykXeizYvGpFFyOpzkdx5ue1yplwqv6qwVvygGMjzy6vN+7g4YfHRfM18Sf7VJbZL1ix5WhBS8HMhrpBf2FVkUrSyaGApZ+nuZciytGVdy82WlywfWhG6Yv9Kysrslb8VOxVXFv+1KnFVR4lhyYqSwR9Cf2gsVSuVlfav9lm980fcj6Ife9a4rtm65luZoOxyuVN5VfmXCn7F5Z+cf6r+aXxt+tqede7rdqwnrJesv73Bf8P+Ss3KgsrBjTM3tm5ibSrb9NfmBZsvVU2v2rmFskWxRVkdWd2+1Xzr+q1fajJrbtUG1DZvM9i2ZtuH7YLt13ewdzTtNNxZvvPzLtGuO7tDd7fWWdZV7SHsydvzZG/C3u6fPX9uqNevL6//uk+yT7k/Zv+5Bo+GhgMGB9Y1oo2KxuGDcw/2Hgo61N7k0LS7Wae5/DAcVhx+/kvqL7ePRBzpOup5tOmYxbFtLYyWslakdUnrSFtmm7I9ub3vePjxrg6fjpZfHX/dd8LkRO1J7ZPrTlFOlZwaP11werRT2vnyTMaZwa4FXffPJp29eW72uZ7zEecvXgi5cLab0336ou/FE5e8Lx2/7Hm57Yr7ldarbldbfnP7raXHvaf1mse19l6v3o6+GX2nrvtfP3Mj6MaFm9ybV27NutV3O/72nf65/co7gjvP7orvvrmXd2/s/ooH+AdlDzUeVj0yeFT3u83vzUp35cmBoIGrj2Mf3x/kD774I/ePL0MlT+hPqp4aP2145vLsxHDIcO/zOc+HXkhfjL0s/VPzz22vrF8de81+fXUkaWTojezN+NuKd3rv9v01/a+u0ejRR+9z3o99KPuo93H/J89P3Z8TPz8dW/yF+KX6q83Xjm8R3x6M54yPS3kyHgAAYACApqcDvN0HQE8GYPQCUNQm8i4AACATGR1gIoP8d57IxAAA4A6wpxMgsRMgvBNgBxvAgg3AAIBoNkAcG1BXV9X5Z+Wmu7pMeFHbAPBV4+PvEgGINgBf+8fHx9rGx7/WA2D3ADrfT+RsAACCBkClGbrCpep06/oV/5l3/wHNmfXlY/st0gAAAAlwSFlzAAAASAAAAEgARslrPgAAAAl2cEFnAAAAAQAAACgAg9PABgAAADBJREFUCNdjWPjgPxMjAwMTEyMDEzOUZmJkYGJGphmIE4OJMzMhyRNhJgwzMmCYBQDI9ANK1RWWcgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxMi0xMi0xOFQxNjoxNDowOS0wODowMMK1MMQAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTItMTItMThUMTY6MTQ6MDktMDg6MDCz6Ih4AAAAAElFTkSuQmCC\');\n  background-repeat: no;\n  background-size: 100% 100%;\n}\n\n/* When the button is working, it looks pressed */\n.wsp-appearance-active .wsp-Button-label {\n  padding-top:1px;\n  border-top-width: 1px;\n  border-bottom-width: 1px;\n}\n\n/*\nIf you want to remove the drag handle completely, here is one approach:\n\n.wsp-Button-drag-handle {  \n  display: none !important;\n}\n  \n.wsp-Button-label-frame {\n  border-left: 2px solid #c2b892 !important;\n  border-bottom-left-radius: 5px !important;\n  border-top-left-radius: 5px !important;\n}\n\n.wsp-Button-label {\n  padding: 0px 3px 0px 3px !important;  \n}\n*/\n\n/* Section End: wsp-Button */\n\n/* The "cancel" button in the header, contains an "x" */\n.wsp-Numberpad-cancel {\n    margin-left: auto ;\n    text-align: center ;\n    vertical-align: middle ;\n\n    font-weight: bold ;\n    font-size: larger ;\n    background-repeat: no-repeat;\n    background-position: center;\n}\n\n/* Section Start: wsp-tool */\n/* Numpad and Tools share a png of a "X" */\n.wsp-tool-cancel, .wsp-Numberpad-cancel {\n    cursor: pointer ;\n    display: block ;\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAB4ElEQVQ4y61UvWsUQRx9s1mEIyF6FpYKFxvB2ORSBgu54giYIoWg/0Caa201nVUqMWksgohY2KlXuFttkBR3CSQHFprAFRZinHXvbm/d25t5FnGP2w8ICz4YmHnDvPl9zBsBSyKNzr3LtVsw1oMx6rMzuAoAvoIsmWh+gX532/Y+ZQ7BkpNRpaoEig4vQKDoVKkq02cnkza5wiLQWrbJlYRQlapCrSWLQmsZR2YAgKONXQhRRlEIUXa0sXteWKpa5iZ3KNsejxJcNCLP9KsgJ7AOVQ2K3EmwfT+K8377m12SpBqRn+UTWBLrX/k6LaTIHSMYo54I95JpEmgAwIMW7kDzJVqDZ2KITQC4P4/FdIbBGHVBzT4E5hI7oxGw7zdEhOfT9PZiubtxDdcztSIG+UIA4A8h9kMRLxdulN9/u4nV3KITfcNXyD5tHQFH4dNp6qSLR28kvDwdX8E1SiaaCXYcAc5gM64J785vcRaPAdd7eOhe+djDcVqoZKKZbX9vEMRd2z7717UwJC3ZgCWBDl/kth+WRMZfP/3vH36l3lEYkj/0Vi/Hd1mLFLVJ2iIt2zs9EGKtkE1I90CItZbtnQI4FwKAJdt1lqEXIo29izT+aOwtC1aXbNeZ2O5/fWx/AXUQdBRBFjTDAAAAAElFTkSuQmCC);\n}\n\n.wsp-tool-ok {\n    cursor: pointer;\n    display: block;\n    top: 0px;\n    right: 38px;\n\n    background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAKQWlDQ1BJQ0MgUHJvZmlsZQAASA2dlndUU9kWh8+9N73QEiIgJfQaegkg0jtIFQRRiUmAUAKGhCZ2RAVGFBEpVmRUwAFHhyJjRRQLg4Ji1wnyEFDGwVFEReXdjGsJ7601896a/cdZ39nnt9fZZ+9917oAUPyCBMJ0WAGANKFYFO7rwVwSE8vE9wIYEAEOWAHA4WZmBEf4RALU/L09mZmoSMaz9u4ugGS72yy/UCZz1v9/kSI3QyQGAApF1TY8fiYX5QKUU7PFGTL/BMr0lSkyhjEyFqEJoqwi48SvbPan5iu7yZiXJuShGlnOGbw0noy7UN6aJeGjjAShXJgl4GejfAdlvVRJmgDl9yjT0/icTAAwFJlfzOcmoWyJMkUUGe6J8gIACJTEObxyDov5OWieAHimZ+SKBIlJYqYR15hp5ejIZvrxs1P5YjErlMNN4Yh4TM/0tAyOMBeAr2+WRQElWW2ZaJHtrRzt7VnW5mj5v9nfHn5T/T3IevtV8Sbsz55BjJ5Z32zsrC+9FgD2JFqbHbO+lVUAtG0GQOXhrE/vIADyBQC03pzzHoZsXpLE4gwnC4vs7GxzAZ9rLivoN/ufgm/Kv4Y595nL7vtWO6YXP4EjSRUzZUXlpqemS0TMzAwOl89k/fcQ/+PAOWnNycMsnJ/AF/GF6FVR6JQJhIlou4U8gViQLmQKhH/V4X8YNicHGX6daxRodV8AfYU5ULhJB8hvPQBDIwMkbj96An3rWxAxCsi+vGitka9zjzJ6/uf6Hwtcim7hTEEiU+b2DI9kciWiLBmj34RswQISkAd0oAo0gS4wAixgDRyAM3AD3iAAhIBIEAOWAy5IAmlABLJBPtgACkEx2AF2g2pwANSBetAEToI2cAZcBFfADXALDIBHQAqGwUswAd6BaQiC8BAVokGqkBakD5lC1hAbWgh5Q0FQOBQDxUOJkBCSQPnQJqgYKoOqoUNQPfQjdBq6CF2D+qAH0CA0Bv0BfYQRmALTYQ3YALaA2bA7HAhHwsvgRHgVnAcXwNvhSrgWPg63whfhG/AALIVfwpMIQMgIA9FGWAgb8URCkFgkAREha5EipAKpRZqQDqQbuY1IkXHkAwaHoWGYGBbGGeOHWYzhYlZh1mJKMNWYY5hWTBfmNmYQM4H5gqVi1bGmWCesP3YJNhGbjS3EVmCPYFuwl7ED2GHsOxwOx8AZ4hxwfrgYXDJuNa4Etw/XjLuA68MN4SbxeLwq3hTvgg/Bc/BifCG+Cn8cfx7fjx/GvyeQCVoEa4IPIZYgJGwkVBAaCOcI/YQRwjRRgahPdCKGEHnEXGIpsY7YQbxJHCZOkxRJhiQXUiQpmbSBVElqIl0mPSa9IZPJOmRHchhZQF5PriSfIF8lD5I/UJQoJhRPShxFQtlOOUq5QHlAeUOlUg2obtRYqpi6nVpPvUR9Sn0vR5Mzl/OX48mtk6uRa5Xrl3slT5TXl3eXXy6fJ18hf0r+pvy4AlHBQMFTgaOwVqFG4bTCPYVJRZqilWKIYppiiWKD4jXFUSW8koGStxJPqUDpsNIlpSEaQtOledK4tE20Otpl2jAdRzek+9OT6cX0H+i99AllJWVb5SjlHOUa5bPKUgbCMGD4M1IZpYyTjLuMj/M05rnP48/bNq9pXv+8KZX5Km4qfJUilWaVAZWPqkxVb9UU1Z2qbapP1DBqJmphatlq+9Uuq43Pp893ns+dXzT/5PyH6rC6iXq4+mr1w+o96pMamhq+GhkaVRqXNMY1GZpumsma5ZrnNMe0aFoLtQRa5VrntV4wlZnuzFRmJbOLOaGtru2nLdE+pN2rPa1jqLNYZ6NOs84TXZIuWzdBt1y3U3dCT0svWC9fr1HvoT5Rn62fpL9Hv1t/ysDQINpgi0GbwaihiqG/YZ5ho+FjI6qRq9Eqo1qjO8Y4Y7ZxivE+41smsImdSZJJjclNU9jU3lRgus+0zwxr5mgmNKs1u8eisNxZWaxG1qA5wzzIfKN5m/krCz2LWIudFt0WXyztLFMt6ywfWSlZBVhttOqw+sPaxJprXWN9x4Zq42Ozzqbd5rWtqS3fdr/tfTuaXbDdFrtOu8/2DvYi+yb7MQc9h3iHvQ732HR2KLuEfdUR6+jhuM7xjOMHJ3snsdNJp9+dWc4pzg3OowsMF/AX1C0YctFx4bgccpEuZC6MX3hwodRV25XjWuv6zE3Xjed2xG3E3dg92f24+ysPSw+RR4vHlKeT5xrPC16Il69XkVevt5L3Yu9q76c+Oj6JPo0+E752vqt9L/hh/QL9dvrd89fw5/rX+08EOASsCegKpARGBFYHPgsyCRIFdQTDwQHBu4IfL9JfJFzUFgJC/EN2hTwJNQxdFfpzGC4sNKwm7Hm4VXh+eHcELWJFREPEu0iPyNLIR4uNFksWd0bJR8VF1UdNRXtFl0VLl1gsWbPkRoxajCCmPRYfGxV7JHZyqffS3UuH4+ziCuPuLjNclrPs2nK15anLz66QX8FZcSoeGx8d3xD/iRPCqeVMrvRfuXflBNeTu4f7kufGK+eN8V34ZfyRBJeEsoTRRJfEXYljSa5JFUnjAk9BteB1sl/ygeSplJCUoykzqdGpzWmEtPi000IlYYqwK10zPSe9L8M0ozBDuspp1e5VE6JA0ZFMKHNZZruYjv5M9UiMJJslg1kLs2qy3mdHZZ/KUcwR5vTkmuRuyx3J88n7fjVmNXd1Z752/ob8wTXuaw6thdauXNu5Tnddwbrh9b7rj20gbUjZ8MtGy41lG99uit7UUaBRsL5gaLPv5sZCuUJR4b0tzlsObMVsFWzt3WazrWrblyJe0fViy+KK4k8l3JLr31l9V/ndzPaE7b2l9qX7d+B2CHfc3em681iZYlle2dCu4F2t5czyovK3u1fsvlZhW3FgD2mPZI+0MqiyvUqvakfVp+qk6oEaj5rmvep7t+2d2sfb17/fbX/TAY0DxQc+HhQcvH/I91BrrUFtxWHc4azDz+ui6rq/Z39ff0TtSPGRz0eFR6XHwo911TvU1zeoN5Q2wo2SxrHjccdv/eD1Q3sTq+lQM6O5+AQ4ITnx4sf4H++eDDzZeYp9qukn/Z/2ttBailqh1tzWibakNml7THvf6YDTnR3OHS0/m/989Iz2mZqzymdLz5HOFZybOZ93fvJCxoXxi4kXhzpXdD66tOTSna6wrt7LgZevXvG5cqnbvfv8VZerZ645XTt9nX297Yb9jdYeu56WX+x+aem172296XCz/ZbjrY6+BX3n+l37L972un3ljv+dGwOLBvruLr57/17cPel93v3RB6kPXj/Mejj9aP1j7OOiJwpPKp6qP6391fjXZqm99Oyg12DPs4hnj4a4Qy//lfmvT8MFz6nPK0a0RupHrUfPjPmM3Xqx9MXwy4yX0+OFvyn+tveV0auffnf7vWdiycTwa9HrmT9K3qi+OfrW9m3nZOjk03dp76anit6rvj/2gf2h+2P0x5Hp7E/4T5WfjT93fAn88ngmbWbm3/eE8/syOll+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADoklEQVRIDb2WTY9MURCG+2t8dTIkWPnYspPYETGJWdC7EaxI7Nj7J3Z+gLAYCWIlwvQIdiRigS1hPRNGZnT3bc9znOpcd3q+QlRSXXXOqfO+p+rUvbfrtdVSZ6qJ9vNSu9lsnq7X69PD4fAYegj/sGv4n/A/o2/xnw4Gg+dML+V9LezAsDweaxrMSqZsh+hao9F4gx1uRol97R73JoTfWGKOFRfMrjYxMXGcjd0KSZ9xaIGvxlhbPlRXjMwi5irSERkbZ9CFDCDoT1RbBhznV2PFmKmSyh4nGBBwnvEsallX0G1oyhq7WSkI7KGW1Tu8xN3ex4pZCObl9i1BURTP8HejksU94G5KojnE1P+JirHI3Z7p9Xpv8FuJ1QU67Tb2CPq3ZECMqiZpmw4+it7F76XLpJRXGUyhnswybkXcYxnN7BHAN7A+UmKbkOtTmQOXE+R2thFskHENsdZcdKrr82DtERC864y/ZawVLXOWtF1j0MkLbqp2Y4+5assHeZlsLsiwZlVrtVo3M245iU6Du5s2ALGjLItiGRzbUALEWwc3SZTRtS5daHcvoDtQu71DA17AV4wRqyZXg5ofc1ASwSRusvYO/YIvsa2ulMnmK2TLZHaOmFnAD2AlGj30iYvafsipR+mS9V4J3gvAKdbjPpbxI67LerozrJnF9XzPeOnuythyGfQjT5bv5AX79wmiQDpNTLx9vMM5ptcjK99buTd+rEVox01Khuz0B9IzEJnhS4axNi6zKtmfhGuVFOBXAEeW6dmE9ARzB1El5s4RG2UcRyZhXFMq6RMmRpP4ltZOc85sgjRlk6j+JFvKseU7c29Z496f+Fi8zSBh7FDVR+EkGx9iJV1G2+gEaiYduu4e/i7H6IZvKLl8LJ4SrPi82PJKeiywQfoAfz/q19yXQQfrV8UDbEQmptj+Q0hcvtriq169A8srQZR3MjdPdHY1vlzG8FOMHHC2fSiXSPWWJ0DKWTqOTD3lSTY9L4bFHXw71+wt73oyyi5zLAmo+P/lMXYKHfd5cqMabw3fIKlM2PUksHwjnSVwRQBfWyuc3s/KIupH08CyeDBjJfJTtBWyhYwtZvoAp7R52X5l4SOTF1FLZYDAUQXcRFoeO1cV8eJr7wGv9Pv9OaxYRZw0gdBF7yF9x4IvYDtQ8a7MbjNEEWvVrNbl/H8m9nqYkYxA/8ffxGCVNLKOP8L+uY0WX9dSnQ3/CEeqQah1TlLLo/zTv/q/APGU2dKb/f3qAAAAAElFTkSuQmCC);\n}\n\n.wsp-tool-cancel {\n\n    top: 0px;\n    right: 0px;\n}\n\n.wsp-tool-cancel, .wsp-tool-ok {\n    position: absolute;\n    margin-right: 10px;\n    margin-top:10px;\n    height: 28px;\n    width: 28px;\n    background-size:28px, 28px;\n    background-color: #888888;\n    border-radius: 14px;\n    border-color:#888888;\n    border-style: solid;\n    border-width: thin;\n    box-shadow: 3px 3px 7px #888888\n}\n\n.wsp-tool-background {\n    background-color:rgba(0,0,0,0.1);\n}\n\n/* Section Start: wsp-Parameter */\n/*\n  Styles for the box around editable values in the sketch\n*/\n.mfs-input {\n    background-color: white;\n    border: thin black solid;\n    padding: 2px;\n    margin: 2px;\n    vertical-align: middle;\n    min-width: .6em;\n    min-height: 1.2em;\n}\n/* Section End: wsp-Parameter */\n\n/* Section Start: wsp-Numberpad */\n\n/*\n  A numeric entry keypad or "Numberpad" has a header and a body. The\n  body contains rows of entries, which are either keys or blank\n  spaces.\n  \n *\n *  +-wsp-Numberpad------------------------------------------------------------------+\n *  | +-wsp-Numberpad-header-------------------------------------------------------+ |\n *  | |                                                                            | |\n *  | |                                                       wsp-Numberpad-cancel | |\n *  | |                                                           +--------------+ | |\n *  | |                                                           |              | | |\n *  | |                                                           |       X      | | |\n *  | |                                                           +--------------+ | |\n *  | +----------------------------------------------------------------------------+ |\n *  | +-wsp-Numberpad-Body---------------------------------------------------------+ |\n *  | | +wsp-Numberpad-Row-------------------------------------------------------+ | |\n *  | | | +wsp-Numberpad-key/element/key-1-----+           +-----------+         | | |\n *  | | | |          |             |           |           |           |         | | |\n *  | | | |    1     |             |      2    |           |     3     |         | | |\n *  | | | +----------+             +-----------+           +-----------+         | | |\n *  | | +------------------------------------------------------------------------+ | |\n *  | | +------------------------------------------------------------------------+ | |\n *  | | |  +----------+             +----------+           +-----------+         | | |\n *  | | |  |          |             |          |           |           |         | | |\n *  | | |  |    4     |             |     5    |           |     6     |         | | |\n *  | | |  +----------+             +----------+           +-----------+         | | |\n *  | | +------------------------------------------------------------------------+ | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | +  +----------+             +----------+           +-----------+        |  | |\n *  | | |  |          |             |          |           |           |        |  | |\n *  | | |  |    7     |             |     8    |           |     9     |        |  | |\n *  | | |  +----------+             +----------+           +-----------+        |  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | |  +----------+             +-----------+          +-----------+        |  | |\n *  | | |  |          |             |           |          |           |        |  | |\n *  | | |  |    .     |             |     0     |          |    +/-    |        |  | |\n *  | | |  +----------+             +-----------+          +-----------+        |  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | |                                                                            | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | | |  +---------+                                     +-----------+        |  | |\n *  | | |  |         |                                     |           |        |  | |\n *  | | |  | clear   |                                     |delete-left|        |  | |\n *  | | |  +---------+                                     +-----------+        |  | |\n *  | | +-----------------------------------------------------------------------+  | |\n *  | |                                                                            | |\n *  | |                                                                            | |\n *  | +----------------------------------------------------------------------------+ |\n *  +--------------------------------------------------------------------------------+\n *\n *\n *\n */\n\n/* The Numberpad as a whole */\n.wsp-Numberpad {\n    width: 172px;\n    height: 298px;\n    background-color: #00bdec;\n    border-radius: 9px;\n    border: thin gray solid;\n    padding: 0px 8px 8px 8px;\n}\n\n/* The Numberpad header bar. Contains the cancel button. */\n.wsp-Numberpad-header {\n    background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMDAlJyBoZWlnaHQ9JzI1Jz48cmVjdCBmaWxsPSd3aGl0ZScgeD0nNicgeT0nNicgd2lkdGg9JzkwJScgaGVpZ2h0PScyJy8+PHJlY3QgZmlsbD0nd2hpdGUnIHg9JzYnIHk9JzEyJyB3aWR0aD0nOTAlJyBoZWlnaHQ9JzInLz48cmVjdCBmaWxsPSd3aGl0ZScgeD0nNicgeT0nMTknIHdpZHRoPSc5MCUnIGhlaWdodD0nMicvPjwvc3ZnPgo=");\n    background-repeat: no-repeat;\n    background-color: #00bdec;\n    height: 25px;\n    margin-bottom: 8px;\n}\n\n/* The "cancel" button in the header, contains an "x" */\n.wsp-Numberpad-cancel {\n\n    background-color: #00bdec;\n    border-color: #00bdec;\n    height: 28px;\n    width: 28px;\n\n    border-style: solid;\n    border-width: thick;\n    border-radius: 16px;\n\n}\n\n/* The "erase to left" button */\n.wsp-Numberpad-erase-to-left {\n    /* the following is an svg image of the \'erase to left\' unicode character,\n       \\u232b, base64 encoded. To see original, cut out the quoted part after\n       base64, then un-base64 encode.  */\n    background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCnhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbC1vcGFjaXR5PSIxIiBjb2xvci1yZW5kZXJpbmc9ImF1dG8iCmNvbG9yLWludGVycG9sYXRpb249ImF1dG8iIHN0cm9rZT0iYmxhY2siIHRleHQtcmVuZGVyaW5nPSJhdXRvIgpzdHJva2UtbGluZWNhcD0ic3F1YXJlIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1vcGFjaXR5PSIxIgpzaGFwZS1yZW5kZXJpbmc9ImF1dG8iIGZpbGw9ImJsYWNrIiBzdHJva2UtZGFzaGFycmF5PSJub25lIiBzdHJva2Utd2lkdGg9IjEiCnN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1kYXNob2Zmc2V0PSIwIiBpbWFnZS1yZW5kZXJpbmc9ImF1dG8iCndpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIgdmlld0JveD0iMCAwIDI3NyAyMDAiID4KPHBhdGggZD0iTTI2MiAxODYKTDEwMSAxODYKTDE1ICAxMDAKTDEwMSAgMTMKTDI2MiAgMTMKTDI2MiAxODYKWk0yNDggMTcyIApMMjQ4ICAyNwpMMTA3ICAyNwpMMzUgIDEwMApMMTA3IDE3MgpMMjQ4IDE3MgpaTTIxNyAxMzMKTDIwNyAxNDMKTDE3NCAxMDkKTDE0MCAxNDMKTDEzMSAxMzMKTDE2NCAxMDAKTDEzMSAgNjYKTDE0MCAgNTYgCkwxNzQgIDkwCkwyMDcgIDU2CkwyMTcgIDY2CkwxODMgMTAwCkwyMTcgMTMzIFoiIHN0cm9rZT0ibm9uZSIvPgo8L3N2Zz4K");\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: 30px;\n}\n\n/* The clear button */\n.wsp-Numberpad-clear {\n    /* the following is an svg image of the \'circled latin capital letter c\'\n       unicode character, \\u2428, base64 encoded. To see original, cut out\n       the quoted part after base64, then un-base64 encode.  */\n    background-image: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+Cgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAnLS8vVzNDLy9EVEQgU1ZHIDEuMC8vRU4nICdodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCc+CjxzdmcgZmlsbC1vcGFjaXR5PSIxIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKY29sb3ItcmVuZGVyaW5nPSJhdXRvIiBjb2xvci1pbnRlcnBvbGF0aW9uPSJhdXRvIiBzdHJva2U9ImJsYWNrIgp0ZXh0LXJlbmRlcmluZz0iYXV0byIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIgpzdHJva2Utb3BhY2l0eT0iMSIgc2hhcGUtcmVuZGVyaW5nPSJhdXRvIiBmaWxsPSJibGFjayIgc3Ryb2tlLWRhc2hhcnJheT0ibm9uZSIKc3Ryb2tlLXdpZHRoPSIxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiCnN0cm9rZS1kYXNob2Zmc2V0PSIwIiBpbWFnZS1yZW5kZXJpbmc9ImF1dG8iIHdpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIKdmlld0JveD0iMCAxNTMgMjg3IDI4NyI+CjxwYXRoIGQ9Ik0xNDQgMTc2IApRMTc2IDE3NiAyMDQgMTkyIApRMjMyLjMxMjUgMjA4LjY4NzUgMjQ4IDIzNyAKUTI2NC42NTYyIDI2NC42NTYyIDI2NSAyOTcgClEyNjQuNjU2MiAzMjguOTIxOSAyNDggMzU3IApRMjMyLjE3MTkgMzg0Ljg5MDYgMjA0IDQwMSAKUTE3Ni4wNjI1IDQxNy4yMzQ0IDE0NCA0MTcgClExMTEuOTM3NSA0MTcuMjM0NCA4NCA0MDEgClE1NS44MjgxIDM4NC44OTA2IDQwIDM1NyAKUTIzLjM0MzggMzI4LjkyMTkgMjMgMjk3IApRMjMuMzQzOCAyNjQuNjU2MiA0MCAyMzcgClE1NS42ODc1IDIwOC41NDY5IDg0IDE5MiAKUTExMS43OTY5IDE3NiAxNDQgMTc2IApaTTE0NCAzOTkgClExODUuOTA2MiAzOTkgMjE2IDM2OSAKUTI0Ni41MTU2IDMzOC43NjU2IDI0NyAyOTcgClEyNDYuNTE1NiAyNjkuNTc4MSAyMzMgMjQ2IApRMjE4Ljk1MzEgMjIxLjkwNjIgMTk1IDIwOCAKUTE3MS4yODEyIDE5NC4zNDM4IDE0NCAxOTQgClExMDEuODEyNSAxOTQuMzQzOCA3MiAyMjUgClE0MS40ODQ0IDI1NC44MTI1IDQxIDI5NyAKUTQxLjQ4NDQgMzM4Ljc2NTYgNzEgMzY5IApRMTAyIDM5OSAxNDQgMzk5IApaTTIwMyAzMjAKUTE5Ni41OTM4IDM0Mi44NDM4IDE4MiAzNTQgClExNjcuMzQzOCAzNjUuMjAzMSAxNDcgMzY1IApRMTE0LjA0NjkgMzY1LjIwMzEgOTkgMzQ0IApRODQuMDkzOCAzMjMuNTc4MSA4NCAyOTUgClE4NC4wOTM4IDI2Mi44MjgxIDEwMiAyNDUgClExMTkuMzkwNiAyMjYuNTQ2OSAxNDcgMjI3IApRMTY2Ljc4MTIgMjI2LjU0NjkgMTgxIDIzNyAKUTE5NC42MjUgMjQ2LjUxNTYgMjAwIDI2NiAKTDE4MyAyNzAgClExNzguMzEyNSAyNTUuNzk2OSAxNjkgMjQ5IApRMTYwLjQ1MzEgMjQxLjU5MzggMTQ3IDI0MiAKUTEyNS4xNTYyIDI0MS41OTM4IDExNCAyNTYgClExMDIuNTE1NiAyNzAuMjgxMiAxMDMgMjk1IApRMTAyLjUxNTYgMzIzLjE1NjIgMTE0IDMzNyAKUTEyNi40MjE5IDM0OS44NzUgMTQ1IDM0OS44NzUgClExNjEuMDE1NiAzNDkuODc1IDE3MSAzNDEgClExODAuODQzOCAzMzIuODU5NCAxODUgMzE2IApMMjAzIDMyMCBaCiIgc3Ryb2tlPSJub25lIiAvPgo8L3N2Zz4K");\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: 30px;\n}\n\n/* A pressable key, like a number or a control key */\n.wsp-Numberpad-key {\n    cursor: pointer;\n    background-color: #eee;\n    border: thin black solid;\n    border-radius: 8px;\n    font-family: Lucida Grande, sans-serif;\n    font-size: 20px;\n    color: black;\n    text-align: center;\n}\n\n/* A pressable key or empty space between keys */\n.wsp-Numberpad-element {\n    margin: 1px;\n    width: 44px;\n    height: 44px;\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 48px;\n}\n\n/* Each key contains its button text as an attribute. Remove or\n   override this to change how keys look. */\n.wsp-Numberpad-key:after { content: attr(data-keyText);}\n\n/* You can override the key text for any key. */\ndiv.wsp-Numberpad-key-0:after {}\ndiv.wsp-Numberpad-key-1:after {}\ndiv.wsp-Numberpad-key-2:after {}\ndiv.wsp-Numberpad-key-3:after {}\ndiv.wsp-Numberpad-key-4:after {}\ndiv.wsp-Numberpad-key-5:after {}\ndiv.wsp-Numberpad-key-6:after {}\ndiv.wsp-Numberpad-key-7:after {}\ndiv.wsp-Numberpad-key-8:after {}\ndiv.wsp-Numberpad-key-9:after {}\ndiv.wsp-Numberpad-key-dot:after {}\ndiv.wsp-Numberpad-key-minus:after {}\ndiv.wsp-Numberpad-key-del:after {}\ndiv.wsp-Numberpad-key-esc:after {}\n\n/* These keys are not present by default, but can be enabled with\njavascript (see section on Javascript customization). */\n\ndiv.wsp-Numberpad-key-plus:after {}\ndiv.wsp-Numberpad-key-star:after {}\ndiv.wsp-Numberpad-key-slash:after {}\ndiv.wsp-Numberpad-key-lparen:after {}\ndiv.wsp-Numberpad-key-rparen:after {}\ndiv.wsp-Numberpad-key-pi:after {}\ndiv.wsp-Numberpad-key-submit:after {}\n\n\n/* Style for a pressed key */\n.wsp-Numberpad-key:active,\n.wsp-Numberpad-key-down {\n    background-color: #636568;\n    border-color: transparent;\n    color: white;\n}\n\n/* One of the special control keys: delete left, clear, or "+-". These\n   control key elements also have the wsp-Numberpad-key class, but the\n   style rule below will override styles applied only to that class. */\ndiv.wsp-Numberpad-control-key {\n    background-color: #c5dee5;\n    border-radius: 5px;\n}\n\n/* Section End: wsp-Numberpad */\n\n/* Section Start: misc */\n/*\n  Various misc. styles\n*/\n\n/* In sketch text for error messages e.g. when the document has an unsupported version. */\n.wsp-error-message {\n  text-align: center;\n  margin-top: 25px;\n  margin-bottom: 25px;\n  color: red;\n  font-size: 125%;\n}\n\n/* Section End: misc */\n\n.wsp-Calculator {\n    width: 389px;\n    height: 356px;\n    background-color: #00bdec;\n    border-radius: 9px;\n    border: thin gray solid;\n    padding: 0px 6px 10px 8px;;\n    cursor: default;\n}\n\n.wsp-Calculator-title {\n  background-color:  #ecf8ff;\n  text-align: center;\n  border-radius: 5px;\n  margin-top: 4px;\n  padding: 2px 0;\n}\n\n.wsp-Calculator-display {\n  border-radius: 4px;\n  height: 80px;\n  background-color: white;\n  margin: 7px 0;\n  overflow: auto;\n  font-size: 18px;\n}\n\n.wsp-Calculator-display-wrapper {\n  position: relative;\n}\n\n.wsp-Calculator-body-wrapper {\n  display: inline-block;\n}\n.wsp-Calculator-body-wrapper > .wsp-Calculator-body {\n  display: inline-block;\n  margin-left: 7px;\n  /* The default vertical-align for display:inline-block is\n     baseline. This leaves room at the bottom for letters like "j."\n     Setting vertical-align to "top" eliminates the spacing. */\n  vertical-align: top;\n}\n\n.wsp-Calculator-left {\n  display: inline-block;\n  border-radius: 4px;\n  vertical-align: top;\n  width: 140px;\n  height: 186px;\n  background-color: #ecf8ff;\n  margin-top: 3px;\n}\n\n.wsp-Calculator-label-insert {\n  width: 50%;\n  text-align: center;\n  margin: 35px auto 10px auto;\n}\n\n.wsp-Calculator-textual {\n  font-family: Lucida Grande,sans-serif;\n  font-size: 16px;\n}\n\n.wsp-Calculator button.dropdown-toggle {\n  background-color: rgb(240, 240, 240);\n  border: 2px outset rgb(240, 240, 240);\n}\n\n.wsp-Calculator .dropdown-toggle {\n  width: 110px;\n  white-space: nowrap;\n}\n\n.wsp-Calculator-left .dropdown-toggle {\n  height: 24px;\n}\n\n.wsp-Calculator .dropdown {\n  display: inline-block;\n}\n\n.wsp-Calculator .wsp-select-function ul {\n    top: -220px;\n    left: 110px;\n}\n\n.wsp-Calculator .wsp-select-units ul {\n    top: -70px;\n    left: 110px;\n}\n\n.wsp-Calculator-select-equation ul {\n    top: -170px;\n    left: 135px;\n}\n\n.wsp-Calculator-topmost-select-for-insert,\n.wsp-Calculator-select-for-insert {\n  margin-top: 10px;\n}\n\n.wsp-Calculator .wsp-Calculator-left .dropdown {\n  margin-left: 15px;\n  margin-right: 15px;\n}\n\n.wsp-Calculator .wsp-Calculator-select-for-insert > button,\n.wsp-Calculator .wsp-Calculator-topmost-select-for-insert > button {\n  box-sizing: border-box;\n}\n\n.wsp-Calculator-bottom {\n  margin-top: 15px;\n}\n\n.wsp-Calculator-select-equation {\n  margin-left: 30px;\n}\n\n.wsp-Calculator-bottom-button {\n  margin-left: 30px;\n  border-radius: 5px;\n  padding: 2px 10px 3px;\n  background-color: #C0C0C0;\n  border: 2px outset #C0C0C0;\n  height: 19px;\n}\n \n.wsp-Calculator-ok-button-inner {\n  padding: 0 10px;\n}\n \n\n.wsp-Calculator .dropdown a {\n  cursor: pointer;\n  margin-left: 3px;\n}\n\n.wsp-Calculator .selected a {\n  background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+Cjxzdmcgd2lkdGg9IjE5LjIxMzE1IiBoZWlnaHQ9IjE4LjI5NDk5NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KIDxtZXRhZGF0YSBpZD0ibWV0YWRhdGE3Ij5pbWFnZS9zdmcreG1sPC9tZXRhZGF0YT4KCiA8Zz4KICA8dGl0bGU+TGF5ZXIgMTwvdGl0bGU+CiAgPGcgaWQ9ImxheWVyMSI+CiAgIDxwYXRoIGQ9Im00Ljc3NDY5LDE4LjI5NDk3OWMtMC4yNzUwMSwtMC4wMDM1NCAtMS40NjE4MSwtMS43Nzg0MzkgLTIuNjM3MzQsLTMuOTQ0MTQ5bC0yLjEzNzM0LC0zLjkzNzgxbDAuNTU0MDIsLTAuNTUzOTZjMC4zMDQ2OSwtMC4zMDQ3NSAxLjEyMzY3LC0wLjU1NDAyIDEuODE5OTUsLTAuNTU0MDJsMS4yNjU5NSwwbDAuNjM2MzgsMi4wMDUwN2wwLjYzNjM4LDIuMDA1MDdsNS4wNjQ0OCwtNS41NDEzMmMyLjc4NTQ1LC0zLjA0NzczIDYuMDAzMDcsLTYuMDQzNjQgNy4xNTAyNDEsLTYuNjU3NTlsMi4wODU3NDksLTEuMTE2MjdsLTQuMjA5NDM5LDQuNzgyMTdjLTIuMzE1MiwyLjYzMDI1IC01LjQ1MTM1LDYuNzQ4MDUgLTYuOTY5MjQsOS4xNTA3NmMtMS41MTc4OCwyLjQwMjcxIC0yLjk4NDc5LDQuMzY1NjYgLTMuMjU5NzgsNC4zNjIwNjFsLTAuMDAwMDEsLTAuMDAwMDExeiIgaWQ9InBhdGgyMjIzIiBmaWxsPSIjMDAwMDAwIi8+CiAgPC9nPgogPC9nPgo8L3N2Zz4=);\n  background-repeat: no-repeat;\n  background-position: left;\n  background-size: 16px 16px;\n}\n\n.wsp-Calculator .mathquill-rendered-math sup {\n    margin-top: 0.5em;\n}\n\n.wsp-Calculator .mathquill-rendered-math sup {\n    margin-top: 0.5em;\n}\n\n.wsp-Calculator .mathquill-editable.hasCursor {\n  box-shadow: none;\n}\n\n.wsp-Calculator .wsp-calculator-edited {\n  padding: 5px;\n  min-width: 364px;;\n  min-height: 69px;;\n}\n\n.wsp-Calculator .wsp-calculator-edited .mq-blob > .wsp-ref {\n  background-color: rgba(238, 238, 238, 0.8);\n  display: inline-block;\n  margin: 0px 2px;\n  min-width: 0.7em;\n  text-align: center;\n  padding: 0 1px;\n}\n\n.wsp-Calculator .mathquill-rendered-math .numerator {\n  padding: 0.1em 0.1em;\n}\n\n/* override  bootstrap within a calculator */\n.wsp-Calculator, .wsp-Calculator *, .wsp-Calculator *:before, .wsp-Calculator *:after {\n-webkit-box-sizing: content-box;\n-moz-box-sizing: content-box;\nbox-sizing: content-box;\n}\n\n.wsp-Calculator .wsp-independent-variable {\n  font-style: italic;\n}\n\n.wsp-Calculator .wsp-syntax-error-notice {\n  display: none;\n}\n\n.wsp-Calculator .wsp-syntax-error-notice:after {\n  content: \'!\';\n}\n\n.wsp-Calculator.wsp-syntax-error .wsp-syntax-error-notice {\n  color: red;\n  background-color: #f8f8f8;\n  font-size: 24px;\n  display: inline;\n  padding: 4px;\n  position: absolute;\n  right: 20px;\n  border: 2px solid red;\n  top: 10px;\n}\n\n.wsp-Calculator .mq-root-block .mq-hasCursor {\n  -webkit-box-shadow: inset #68b4df 0 0 2px 1px;\n  -moz-box-shadow: inset #68b4df 0 0 2px 1px;\n  box-shadow: inset #68b4df 0 0 2px 1px;\n}\n\n.wsp-Calculator .mq-math-mode .mq-editable-field.mq-focused,\n.wsp-Calculator .mq-editable-field.mq-focused {\n      box-shadow: none;\n      border: none;\n}\n\n.wsp-Calculator .mq-math-mode .mq-sqrt-prefix {\n  top: .18em;\n}\n\n.wsp-Calculator .dropdown-menu > li > a {\n  padding: 3px 19px;\n}\n\n.wsp-Calculator .mq-editable-field .mq-textarea > * {\n  z-index: -999;\n  /* Mathquill uses a tiny (1px x 1px) textarea for cut/paste event handling, and\n  this triggered a bug. Chrome got confused when selecting, then blurring, then\n  focusing this textarea whenever it contained any text. Empirically, setting the\n  textarea to overflow: hidden fixes the bug; so that is what we do. */\n  overflow: hidden;\n}\n\n/*\n * MathQuill: http://mathquill.com\n * by Jay and Han (laughinghan@gmail.com)\n *\n * This Source Code Form is subject to the terms of the\n * Mozilla Public License, v. 2.0. If a copy of the MPL\n * was not distributed with this file, You can obtain\n * one at http://mozilla.org/MPL/2.0/.\n */\n@font-face {\n  font-family: Symbola;\n  src: local("Symbola Regular"), local("Symbola");\n}\n.mq-editable-field {\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-editable-field .mq-root-block {\n  display: -moz-inline-box;\n  display: inline-block;\n  width: 100%;\n  padding: 2px;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  white-space: pre;\n  overflow: hidden;\n  vertical-align: middle;\n}\n.mq-editable-field .mq-root-block:after {\n  content: \'\';\n}\n.mq-editable-field .mq-cursor {\n  border-left: 1px solid black;\n  margin-left: -1px;\n  position: relative;\n  z-index: 1;\n  padding: 0;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-editable-field .mq-cursor.mq-blink {\n  visibility: hidden;\n}\n.mq-editable-field,\n.mq-math-mode .mq-editable-field {\n  border: 1px solid gray;\n}\n.mq-editable-field.mq-focused,\n.mq-math-mode .mq-editable-field.mq-focused {\n  -webkit-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n  -moz-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n  box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\n  border-color: #709AC0;\n  border-radius: 1px;\n}\n.mq-math-mode .mq-editable-field {\n  margin: 1px;\n}\n.mq-editable-field .mq-latex-command-input {\n  color: inherit;\n  font-family: "Courier New", monospace;\n  border: 1px solid gray;\n  padding-right: 1px;\n  margin-right: 1px;\n  margin-left: 2px;\n}\n.mq-editable-field .mq-latex-command-input.mq-empty {\n  background: transparent;\n}\n.mq-editable-field .mq-latex-command-input.mq-hasCursor {\n  border-color: ActiveBorder;\n}\n.mq-editable-field.mq-empty:after,\n.mq-editable-field.mq-text-mode:after,\n.mq-math-mode .mq-empty:after {\n  visibility: hidden;\n  content: \'c\';\n}\n.mq-editable-field .mq-cursor:only-child:after,\n.mq-editable-field .mq-textarea + .mq-cursor:last-child:after {\n  visibility: hidden;\n  content: \'c\';\n}\n.mq-editable-field .mq-text-mode .mq-cursor:only-child:after {\n  content: \'\';\n}\n.mq-editable-field.mq-text-mode {\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n.mq-math-mode {\n  font-variant: normal;\n  font-weight: normal;\n  font-style: normal;\n  font-size: 115%;\n  line-height: 1;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode .mq-non-leaf,\n.mq-math-mode .mq-scaled {\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode var,\n.mq-math-mode .mq-text-mode,\n.mq-math-mode .mq-nonSymbola {\n  font-family: "Times New Roman", Symbola, serif;\n  line-height: .9;\n}\n.mq-math-mode * {\n  font-size: inherit;\n  line-height: inherit;\n  margin: 0;\n  padding: 0;\n  border-color: black;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\n.mq-math-mode .mq-empty {\n  background: #ccc;\n}\n.mq-math-mode .mq-empty.mq-root-block {\n  background: transparent;\n}\n.mq-math-mode.mq-empty {\n  background: transparent;\n}\n.mq-math-mode .mq-text-mode {\n  font-size: 87%;\n}\n.mq-math-mode .mq-font {\n  font: 1em "Times New Roman", Symbola, serif;\n}\n.mq-math-mode .mq-font * {\n  font-family: inherit;\n  font-style: inherit;\n}\n.mq-math-mode b,\n.mq-math-mode b.mq-font {\n  font-weight: bolder;\n}\n.mq-math-mode var,\n.mq-math-mode i,\n.mq-math-mode i.mq-font {\n  font-style: italic;\n}\n.mq-math-mode var.mq-florin {\n  display: -moz-inline-box;\n  display: inline-block;\n  width: .3em;\n  position: relative;\n  left: -0.1em;\n}\n.mq-math-mode big {\n  font-size: 125%;\n}\n.mq-math-mode .mq-roman {\n  font-style: normal;\n}\n.mq-math-mode .mq-sans-serif {\n  font-family: sans-serif, Symbola, serif;\n}\n.mq-math-mode .mq-monospace {\n  font-family: monospace, Symbola, serif;\n}\n.mq-math-mode .mq-overline {\n  border-top: 1px solid black;\n  margin-top: 1px;\n}\n.mq-math-mode .mq-underline {\n  border-bottom: 1px solid black;\n  margin-bottom: 1px;\n}\n.mq-math-mode .mq-binary-operator {\n  padding: 0 0.2em;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode .mq-supsub {\n  font-size: 90%;\n  vertical-align: -0.5em;\n}\n.mq-math-mode .mq-supsub.mq-limit {\n  font-size: 80%;\n  vertical-align: -0.4em;\n}\n.mq-math-mode .mq-supsub.mq-sup-only {\n  vertical-align: .5em;\n}\n.mq-math-mode .mq-supsub.mq-sup-only .mq-sup {\n  display: inline-block;\n  vertical-align: text-bottom;\n}\n.mq-math-mode .mq-supsub .mq-sup {\n  display: block;\n}\n.mq-math-mode .mq-supsub .mq-sub {\n  display: block;\n  float: left;\n}\n.mq-math-mode .mq-supsub.mq-limit .mq-sub {\n  margin-left: -0.25em;\n}\n.mq-math-mode .mq-supsub .mq-binary-operator {\n  padding: 0 .1em;\n}\n.mq-math-mode .mq-supsub .mq-fraction {\n  font-size: 70%;\n}\n.mq-math-mode sup.mq-nthroot {\n  font-size: 80%;\n  vertical-align: 0.8em;\n  margin-right: -0.6em;\n  margin-left: .2em;\n  min-width: .5em;\n}\n.mq-math-mode .mq-paren {\n  padding: 0 .1em;\n  vertical-align: top;\n  -webkit-transform-origin: center .06em;\n  -moz-transform-origin: center .06em;\n  -ms-transform-origin: center .06em;\n  -o-transform-origin: center .06em;\n  transform-origin: center .06em;\n}\n.mq-math-mode .mq-paren.mq-ghost {\n  color: silver;\n}\n.mq-math-mode .mq-paren + span {\n  margin-top: .1em;\n  margin-bottom: .1em;\n}\n.mq-math-mode .mq-array {\n  vertical-align: middle;\n  text-align: center;\n}\n.mq-math-mode .mq-array > span {\n  display: block;\n}\n.mq-math-mode .mq-operator-name {\n  font-family: Symbola, "Times New Roman", serif;\n  line-height: .9;\n  font-style: normal;\n}\n.mq-math-mode var.mq-operator-name.mq-first {\n  padding-left: .2em;\n}\n.mq-math-mode var.mq-operator-name.mq-last {\n  padding-right: .2em;\n}\n.mq-math-mode .mq-fraction {\n  font-size: 90%;\n  text-align: center;\n  vertical-align: -0.4em;\n  padding: 0 .2em;\n}\n.mq-math-mode .mq-fraction,\n.mq-math-mode .mq-large-operator,\n.mq-math-mode x:-moz-any-link {\n  display: -moz-groupbox;\n}\n.mq-math-mode .mq-fraction,\n.mq-math-mode .mq-large-operator,\n.mq-math-mode x:-moz-any-link,\n.mq-math-mode x:default {\n  display: inline-block;\n}\n.mq-math-mode .mq-numerator,\n.mq-math-mode .mq-denominator {\n  display: block;\n}\n.mq-math-mode .mq-numerator {\n  padding: 0 0.1em;\n}\n.mq-math-mode .mq-denominator {\n  border-top: 1px solid;\n  float: right;\n  width: 100%;\n  padding: .15em .1em 0 .1em;\n  margin-right: -0.1em;\n  margin-left: -0.1em;\n}\n.mq-math-mode .mq-sqrt-prefix {\n  padding-top: 0;\n  position: relative;\n  top: .05em;\n  vertical-align: top;\n  -webkit-transform-origin: top;\n  -moz-transform-origin: top;\n  -ms-transform-origin: top;\n  -o-transform-origin: top;\n  transform-origin: top;\n}\n.mq-math-mode .mq-sqrt-stem {\n  border-top: 1px solid;\n  margin-top: 1px;\n  padding-left: .15em;\n  padding-right: .2em;\n  margin-right: .1em;\n  padding-top: 1px;\n}\n.mq-math-mode .mq-vector-prefix {\n  display: block;\n  text-align: center;\n  line-height: .25em;\n  margin-bottom: -0.1em;\n  font-size: 0.75em;\n}\n.mq-math-mode .mq-vector-stem {\n  display: block;\n}\n.mq-math-mode .mq-large-operator {\n  text-align: center;\n}\n.mq-math-mode .mq-large-operator .mq-from,\n.mq-math-mode .mq-large-operator big,\n.mq-math-mode .mq-large-operator .mq-to {\n  display: block;\n}\n.mq-math-mode .mq-large-operator .mq-from,\n.mq-math-mode .mq-large-operator .mq-to {\n  font-size: 80%;\n}\n.mq-math-mode .mq-large-operator .mq-from {\n  float: right;\n  /* take out of normal flow to manipulate baseline */\n  width: 100%;\n}\n.mq-math-mode,\n.mq-math-mode .mq-editable-field {\n  cursor: text;\n  font-family: Symbola, "Times New Roman", serif;\n}\n.mq-math-mode .mq-selection,\n.mq-editable-field .mq-selection,\n.mq-math-mode .mq-selection .mq-non-leaf,\n.mq-editable-field .mq-selection .mq-non-leaf,\n.mq-math-mode .mq-selection .mq-scaled,\n.mq-editable-field .mq-selection .mq-scaled {\n  background: #B4D5FE !important;\n  background: Highlight !important;\n  color: HighlightText;\n  border-color: HighlightText;\n}\n.mq-math-mode .mq-selection .mq-matrixed,\n.mq-editable-field .mq-selection .mq-matrixed {\n  background: #39F !important;\n}\n.mq-math-mode .mq-selection .mq-matrixed-container,\n.mq-editable-field .mq-selection .mq-matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color=\'#3399FF\') !important;\n}\n.mq-math-mode .mq-selection.mq-blur,\n.mq-editable-field .mq-selection.mq-blur,\n.mq-math-mode .mq-selection.mq-blur .mq-non-leaf,\n.mq-editable-field .mq-selection.mq-blur .mq-non-leaf,\n.mq-math-mode .mq-selection.mq-blur .mq-scaled,\n.mq-editable-field .mq-selection.mq-blur .mq-scaled,\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed,\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed {\n  background: #D4D4D4 !important;\n  color: black;\n  border-color: black;\n}\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed-container,\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color=\'#D4D4D4\') !important;\n}\n.mq-editable-field .mq-textarea,\n.mq-math-mode .mq-textarea {\n  position: relative;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n.mq-editable-field .mq-textarea *,\n.mq-math-mode .mq-textarea *,\n.mq-editable-field .mq-selectable,\n.mq-math-mode .mq-selectable {\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n  position: absolute;\n  clip: rect(1em 1em 1em 1em);\n  resize: none;\n  width: 1px;\n  height: 1px;\n}\n.mq-math-mode .mq-matrixed {\n  background: white;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.mq-math-mode .mq-matrixed-container {\n  filter: progid:DXImageTransform.Microsoft.Chroma(color=\'white\');\n  margin-top: -0.1em;\n}\n\n/* Import only the bits of bootstrap needed for our components. Code\nis not generated as css output unless actually referenced. */\n/* Components we adopt from bootstrap. */\n.caret {\n  display: inline-block;\n  width: 0;\n  height: 0;\n  margin-left: 2px;\n  vertical-align: middle;\n  border-top: 4px solid;\n  border-right: 4px solid transparent;\n  border-left: 4px solid transparent;\n}\n.dropdown {\n  position: relative;\n}\n.dropdown-toggle:focus {\n  outline: 0;\n}\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  z-index: 1000;\n  display: none;\n  float: left;\n  min-width: 160px;\n  padding: 5px 0;\n  margin: 2px 0 0;\n  list-style: none;\n  font-size: 14px;\n  text-align: left;\n  background-color: #ffffff;\n  border: 1px solid #cccccc;\n  border: 1px solid rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);\n  background-clip: padding-box;\n}\n.dropdown-menu.pull-right {\n  right: 0;\n  left: auto;\n}\n.dropdown-menu .divider {\n  height: 1px;\n  margin: 9px 0;\n  overflow: hidden;\n  background-color: #e5e5e5;\n}\n.dropdown-menu > li > a {\n  display: block;\n  padding: 3px 20px;\n  clear: both;\n  font-weight: normal;\n  line-height: 1.42857143;\n  color: #333333;\n  white-space: nowrap;\n}\n.dropdown-menu > li > a:hover,\n.dropdown-menu > li > a:focus {\n  text-decoration: none;\n  color: #262626;\n  background-color: #f5f5f5;\n}\n.dropdown-menu > .active > a,\n.dropdown-menu > .active > a:hover,\n.dropdown-menu > .active > a:focus {\n  color: #ffffff;\n  text-decoration: none;\n  outline: 0;\n  background-color: #337ab7;\n}\n.dropdown-menu > .disabled > a,\n.dropdown-menu > .disabled > a:hover,\n.dropdown-menu > .disabled > a:focus {\n  color: #777777;\n}\n.dropdown-menu > .disabled > a:hover,\n.dropdown-menu > .disabled > a:focus {\n  text-decoration: none;\n  background-color: transparent;\n  background-image: none;\n  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);\n  cursor: not-allowed;\n}\n.open > .dropdown-menu {\n  display: block;\n}\n.open > a {\n  outline: 0;\n}\n.dropdown-menu-right {\n  left: auto;\n  right: 0;\n}\n.dropdown-menu-left {\n  left: 0;\n  right: auto;\n}\n.dropdown-header {\n  display: block;\n  padding: 3px 20px;\n  font-size: 12px;\n  line-height: 1.42857143;\n  color: #777777;\n  white-space: nowrap;\n}\n.dropdown-backdrop {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  z-index: 990;\n}\n.pull-right > .dropdown-menu {\n  right: 0;\n  left: auto;\n}\n.dropup .caret,\n.navbar-fixed-bottom .dropdown .caret {\n  border-top: 0;\n  border-bottom: 4px solid;\n  content: "";\n}\n.dropup .dropdown-menu,\n.navbar-fixed-bottom .dropdown .dropdown-menu {\n  top: auto;\n  bottom: 100%;\n  margin-bottom: 2px;\n}\n@media (min-width: 768px) {\n  .navbar-right .dropdown-menu {\n    left: auto;\n    right: 0;\n  }\n  .navbar-right .dropdown-menu-left {\n    left: 0;\n    right: auto;\n  }\n}\n';y.noConflict=function(){if(l.GSP===y){l.GSP=C}return y};g(function(){var D="wsp-css-4-1-0";if(g("style#"+D).length===0){g("head").append(g("<style>").attr({id:D}).text(y.css))}});if(typeof l.GSPConfig==="undefined"){l.GSPConfig={}}if(typeof l.GSPConfig.instances==="undefined"){l.GSPConfig.instances=[]}l.GSPConfig.instances.push(y);l.GSP=y})(window,jQuery);